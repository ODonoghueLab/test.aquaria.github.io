(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["vendor~wrapper"],{"00ad":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||"");if(!1===t.opts.format)return l&&(n+=" if (true) { "),n;var h,d=t.opts.$data&&s&&s.$data;d?(n+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ",h="schema"+i):h=s;var p=t.opts.unknownFormats,f=Array.isArray(p);if(d){var m="format"+i,g="isObject"+i,v="formatType"+i;n+=" var "+m+" = formats["+h+"]; var "+g+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+v+" = "+g+" && "+m+".type || 'string'; if ("+g+") { ",t.async&&(n+=" var async"+i+" = "+m+".async; "),n+=" "+m+" = "+m+".validate; } if (  ",d&&(n+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),n+=" (","ignore"!=p&&(n+=" ("+h+" && !"+m+" ",f&&(n+=" && self._opts.unknownFormats.indexOf("+h+") == -1 "),n+=") || "),n+=" ("+m+" && "+v+" == '"+r+"' && !(typeof "+m+" == 'function' ? ",t.async?n+=" (async"+i+" ? await "+m+"("+c+") : "+m+"("+c+")) ":n+=" "+m+"("+c+") ",n+=" : "+m+".test("+c+"))))) {"}else{m=t.formats[s];if(!m){if("ignore"==p)return t.logger.warn('unknown format "'+s+'" ignored in schema at path "'+t.errSchemaPath+'"'),l&&(n+=" if (true) { "),n;if(f&&p.indexOf(s)>=0)return l&&(n+=" if (true) { "),n;throw new Error('unknown format "'+s+'" is used in schema at path "'+t.errSchemaPath+'"')}g="object"==typeof m&&!(m instanceof RegExp)&&m.validate,v=g&&m.type||"string";if(g){var y=!0===m.async;m=m.validate}if(v!=r)return l&&(n+=" if (true) { "),n;if(y){if(!t.async)throw new Error("async format in sync schema");var w="formats"+t.util.getProperty(s)+".validate";n+=" if (!(await "+w+"("+c+"))) { "}else{n+=" if (! ";w="formats"+t.util.getProperty(s);g&&(w+=".validate"),n+="function"==typeof m?" "+w+"("+c+") ":" "+w+".test("+c+") ",n+=") { "}}var b=b||[];b.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'format' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { format:  ",n+=d?""+h:""+t.util.toQuotedString(s),n+="  } ",!1!==t.opts.messages&&(n+=" , message: 'should match format \"",n+=d?"' + "+h+" + '":""+t.util.escapeQuotes(s),n+="\"' "),t.opts.verbose&&(n+=" , schema:  ",n+=d?"validate.schema"+a:""+t.util.toQuotedString(s),n+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var x=n;return n=b.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+x+"]); ":n+=" validate.errors = ["+x+"]; return false; ":n+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",l&&(n+=" else { "),n}},"00f5":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="errs__"+i,d=t.util.copy(t);d.level++;var p="valid"+d.level;if(t.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:t.util.schemaHasRules(s,t.RULES.all)){d.schema=s,d.schemaPath=a,d.errSchemaPath=u,n+=" var "+h+" = errors;  ";var f,m=t.compositeRule;t.compositeRule=d.compositeRule=!0,d.createErrors=!1,d.opts.allErrors&&(f=d.opts.allErrors,d.opts.allErrors=!1),n+=" "+t.validate(d)+" ",d.createErrors=!0,f&&(d.opts.allErrors=f),t.compositeRule=d.compositeRule=m,n+=" if ("+p+") {   ";var g=g||[];g.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: 'should NOT be valid' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var v=n;n=g.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+v+"]); ":n+=" validate.errors = ["+v+"]; return false; ":n+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",t.opts.allErrors&&(n+=" } ")}else n+="  var err =   ",!1!==t.createErrors?(n+=" { keyword: 'not' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: 'should NOT be valid' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(n+=" if (false) { ");return n}},"0302":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d=t.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; "),d||(n+=" var schema"+i+" = validate.schema"+a+";"),n+="var "+h+" = equal("+c+", schema"+i+"); if (!"+h+") {   ";var p=p||[];p.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'const' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { allowedValue: schema"+i+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be equal to constant' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var f=n;return n=p.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+f+"]); ":n+=" validate.errors = ["+f+"]; return false; ":n+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",l&&(n+=" else { "),n}},"077a":function(t,e){t.exports={full:"0.6.4",major:0,minor:6,dot:4}},"07d6":function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},"08dc":function(t,e,r){var n=r("9bdf");t.exports.leap=n},"0b16":function(t,e,r){"use strict";var n=r("1985"),i=r("35e8");function o(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=x,e.resolve=S,e.resolveObject=M,e.format=_,e.Url=o;var s=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["<",">",'"',"`"," ","\r","\n","\t"],c=["{","}","|","\\","^","`"].concat(l),h=["'"].concat(c),d=["%","/","?",";","#"].concat(h),p=["/","?","#"],f=255,m=/^[+a-z0-9A-Z_-]{0,63}$/,g=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},w={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=r("b383");function x(t,e,r){if(t&&i.isObject(t)&&t instanceof o)return t;var n=new o;return n.parse(t,e,r),n}function _(t){return i.isString(t)&&(t=x(t)),t instanceof o?t.format():o.prototype.format.call(t)}function S(t,e){return x(t,!1,!0).resolve(e)}function M(t,e){return t?x(t,!1,!0).resolveObject(e):e}o.prototype.parse=function(t,e,r){if(!i.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var o=t.indexOf("?"),a=-1!==o&&o<t.indexOf("#")?"?":"#",l=t.split(a),c=/\\/g;l[0]=l[0].replace(c,"/"),t=l.join(a);var x=t;if(x=x.trim(),!r&&1===t.split("#").length){var _=u.exec(x);if(_)return this.path=x,this.href=x,this.pathname=_[1],_[2]?(this.search=_[2],this.query=e?b.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var S=s.exec(x);if(S){S=S[0];var M=S.toLowerCase();this.protocol=M,x=x.substr(S.length)}if(r||S||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===x.substr(0,2);!E||S&&y[S]||(x=x.substr(2),this.slashes=!0)}if(!y[S]&&(E||S&&!w[S])){for(var T,A,P=-1,C=0;C<p.length;C++){var R=x.indexOf(p[C]);-1!==R&&(-1===P||R<P)&&(P=R)}A=-1===P?x.lastIndexOf("@"):x.lastIndexOf("@",P),-1!==A&&(T=x.slice(0,A),x=x.slice(A+1),this.auth=decodeURIComponent(T)),P=-1;for(C=0;C<d.length;C++){R=x.indexOf(d[C]);-1!==R&&(-1===P||R<P)&&(P=R)}-1===P&&(P=x.length),this.host=x.slice(0,P),x=x.slice(P),this.parseHost(),this.hostname=this.hostname||"";var L="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!L)for(var O=this.hostname.split(/\./),I=(C=0,O.length);C<I;C++){var D=O[C];if(D&&!D.match(m)){for(var N="",k=0,F=D.length;k<F;k++)D.charCodeAt(k)>127?N+="x":N+=D[k];if(!N.match(m)){var V=O.slice(0,C),z=O.slice(C+1),U=D.match(g);U&&(V.push(U[1]),z.unshift(U[2])),z.length&&(x="/"+z.join(".")+x),this.hostname=V.join(".");break}}}this.hostname.length>f?this.hostname="":this.hostname=this.hostname.toLowerCase(),L||(this.hostname=n.toASCII(this.hostname));var j=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+j,this.href+=this.host,L&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!v[M])for(C=0,I=h.length;C<I;C++){var H=h[C];if(-1!==x.indexOf(H)){var G=encodeURIComponent(H);G===H&&(G=escape(H)),x=x.split(H).join(G)}}var q=x.indexOf("#");-1!==q&&(this.hash=x.substr(q),x=x.slice(0,q));var W=x.indexOf("?");if(-1!==W?(this.search=x.substr(W),this.query=x.substr(W+1),e&&(this.query=b.parse(this.query)),x=x.slice(0,W)):e&&(this.search="",this.query={}),x&&(this.pathname=x),w[M]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){j=this.pathname||"";var $=this.search||"";this.path=j+$}return this.href=this.format(),this},o.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,s="";this.host?o=t+this.host:this.hostname&&(o=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(s=b.stringify(this.query));var a=this.search||s&&"?"+s||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||w[e])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),a&&"?"!==a.charAt(0)&&(a="?"+a),r=r.replace(/[?#]/g,(function(t){return encodeURIComponent(t)})),a=a.replace("#","%23"),e+o+r+a+n},o.prototype.resolve=function(t){return this.resolveObject(x(t,!1,!0)).format()},o.prototype.resolveObject=function(t){if(i.isString(t)){var e=new o;e.parse(t,!1,!0),t=e}for(var r=new o,n=Object.keys(this),s=0;s<n.length;s++){var a=n[s];r[a]=this[a]}if(r.hash=t.hash,""===t.href)return r.href=r.format(),r;if(t.slashes&&!t.protocol){for(var u=Object.keys(t),l=0;l<u.length;l++){var c=u[l];"protocol"!==c&&(r[c]=t[c])}return w[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(t.protocol&&t.protocol!==r.protocol){if(!w[t.protocol]){for(var h=Object.keys(t),d=0;d<h.length;d++){var p=h[d];r[p]=t[p]}return r.href=r.format(),r}if(r.protocol=t.protocol,t.host||y[t.protocol])r.pathname=t.pathname;else{var f=(t.pathname||"").split("/");while(f.length&&!(t.host=f.shift()));t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=t.search,r.query=t.query,r.host=t.host||"",r.auth=t.auth,r.hostname=t.hostname||t.host,r.port=t.port,r.pathname||r.search){var m=r.pathname||"",g=r.search||"";r.path=m+g}return r.slashes=r.slashes||t.slashes,r.href=r.format(),r}var v=r.pathname&&"/"===r.pathname.charAt(0),b=t.host||t.pathname&&"/"===t.pathname.charAt(0),x=b||v||r.host&&t.pathname,_=x,S=r.pathname&&r.pathname.split("/")||[],M=(f=t.pathname&&t.pathname.split("/")||[],r.protocol&&!w[r.protocol]);if(M&&(r.hostname="",r.port=null,r.host&&(""===S[0]?S[0]=r.host:S.unshift(r.host)),r.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),x=x&&(""===f[0]||""===S[0])),b)r.host=t.host||""===t.host?t.host:r.host,r.hostname=t.hostname||""===t.hostname?t.hostname:r.hostname,r.search=t.search,r.query=t.query,S=f;else if(f.length)S||(S=[]),S.pop(),S=S.concat(f),r.search=t.search,r.query=t.query;else if(!i.isNullOrUndefined(t.search)){if(M){r.hostname=r.host=S.shift();var E=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");E&&(r.auth=E.shift(),r.host=r.hostname=E.shift())}return r.search=t.search,r.query=t.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var T=S.slice(-1)[0],A=(r.host||t.host||S.length>1)&&("."===T||".."===T)||""===T,P=0,C=S.length;C>=0;C--)T=S[C],"."===T?S.splice(C,1):".."===T?(S.splice(C,1),P++):P&&(S.splice(C,1),P--);if(!x&&!_)for(;P--;P)S.unshift("..");!x||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),A&&"/"!==S.join("/").substr(-1)&&S.push("");var R=""===S[0]||S[0]&&"/"===S[0].charAt(0);if(M){r.hostname=r.host=R?"":S.length?S.shift():"";E=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");E&&(r.auth=E.shift(),r.host=r.hostname=E.shift())}return x=x||r.host&&S.length,x&&!R&&S.unshift(""),S.length?r.pathname=S.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=t.auth||r.auth,r.slashes=r.slashes||t.slashes,r.href=r.format(),r},o.prototype.parseHost=function(){var t=this.host,e=a.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},"0b25":function(t,e,r){var n=r("a691"),i=r("50c4");t.exports=function(t){if(void 0===t)return 0;var e=n(t),r=i(e);if(e!==r)throw RangeError("Wrong length or index");return r}},"0e33":function(t,e,r){(function(n){var i,o,s;(function(n){o=[r("1157")],i=n,s="function"===typeof i?i.apply(e,o):i,void 0===s||(t.exports=s)})((function(t){var e=function(){if(t&&t.fn&&t.fn.select2&&t.fn.select2.amd)var e=t.fn.select2.amd;return function(){
/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */
var t,r,n;e&&e.requirejs||(e?r=e:e={},function(e){var i,o,s,a,u={},l={},c={},h={},d=Object.prototype.hasOwnProperty,p=[].slice,f=/\.js$/;function m(t,e){return d.call(t,e)}function g(t,e){var r,n,i,o,s,a,u,l,h,d,p,m,g=e&&e.split("/"),v=c.map,y=v&&v["*"]||{};if(t){for(t=t.split("/"),s=t.length-1,c.nodeIdCompat&&f.test(t[s])&&(t[s]=t[s].replace(f,"")),"."===t[0].charAt(0)&&g&&(m=g.slice(0,g.length-1),t=m.concat(t)),h=0;h<t.length;h++)if(p=t[h],"."===p)t.splice(h,1),h-=1;else if(".."===p){if(0===h||1===h&&".."===t[2]||".."===t[h-1])continue;h>0&&(t.splice(h-1,2),h-=2)}t=t.join("/")}if((g||y)&&v){for(r=t.split("/"),h=r.length;h>0;h-=1){if(n=r.slice(0,h).join("/"),g)for(d=g.length;d>0;d-=1)if(i=v[g.slice(0,d).join("/")],i&&(i=i[n],i)){o=i,a=h;break}if(o)break;!u&&y&&y[n]&&(u=y[n],l=h)}!o&&u&&(o=u,a=l),o&&(r.splice(0,a,o),t=r.join("/"))}return t}function v(t,r){return function(){var n=p.call(arguments,0);return"string"!==typeof n[0]&&1===n.length&&n.push(null),o.apply(e,n.concat([t,r]))}}function y(t){return function(e){return g(e,t)}}function w(t){return function(e){u[t]=e}}function b(t){if(m(l,t)){var r=l[t];delete l[t],h[t]=!0,i.apply(e,r)}if(!m(u,t)&&!m(h,t))throw new Error("No "+t);return u[t]}function x(t){var e,r=t?t.indexOf("!"):-1;return r>-1&&(e=t.substring(0,r),t=t.substring(r+1,t.length)),[e,t]}function _(t){return t?x(t):[]}function S(t){return function(){return c&&c.config&&c.config[t]||{}}}s=function(t,e){var r,n=x(t),i=n[0],o=e[1];return t=n[1],i&&(i=g(i,o),r=b(i)),i?t=r&&r.normalize?r.normalize(t,y(o)):g(t,o):(t=g(t,o),n=x(t),i=n[0],t=n[1],i&&(r=b(i))),{f:i?i+"!"+t:t,n:t,pr:i,p:r}},a={require:function(t){return v(t)},exports:function(t){var e=u[t];return"undefined"!==typeof e?e:u[t]={}},module:function(t){return{id:t,uri:"",exports:u[t],config:S(t)}}},i=function(t,r,n,i){var o,c,d,p,f,g,y,x=[],S=typeof n;if(i=i||t,g=_(i),"undefined"===S||"function"===S){for(r=!r.length&&n.length?["require","exports","module"]:r,f=0;f<r.length;f+=1)if(p=s(r[f],g),c=p.f,"require"===c)x[f]=a.require(t);else if("exports"===c)x[f]=a.exports(t),y=!0;else if("module"===c)o=x[f]=a.module(t);else if(m(u,c)||m(l,c)||m(h,c))x[f]=b(c);else{if(!p.p)throw new Error(t+" missing "+c);p.p.load(p.n,v(i,!0),w(c),{}),x[f]=u[c]}d=n?n.apply(u[t],x):void 0,t&&(o&&o.exports!==e&&o.exports!==u[t]?u[t]=o.exports:d===e&&y||(u[t]=d))}else t&&(u[t]=n)},t=r=o=function(t,r,n,u,l){if("string"===typeof t)return a[t]?a[t](r):b(s(t,_(r)).f);if(!t.splice){if(c=t,c.deps&&o(c.deps,c.callback),!r)return;r.splice?(t=r,r=n,n=null):t=e}return r=r||function(){},"function"===typeof n&&(n=u,u=l),u?i(e,t,r,n):setTimeout((function(){i(e,t,r,n)}),4),o},o.config=function(t){return o(t)},t._defined=u,n=function(t,e,r){if("string"!==typeof t)throw new Error("See almond README: incorrect module build, no module name");e.splice||(r=e,e=[]),m(u,t)||m(l,t)||(l[t]=[t,e,r])},n.amd={jQuery:!0}}(),e.requirejs=t,e.require=r,e.define=n)}(),e.define("almond",(function(){})),e.define("jquery",[],(function(){var e=t||n;return null==e&&console&&console.error&&console.error("Select2: An instance of jQuery or a jQuery-compatible library was not found. Make sure that you are including jQuery before Select2 on your web page."),e})),e.define("select2/utils",["jquery"],(function(t){var e={};function r(t){var e=t.prototype,r=[];for(var n in e){var i=e[n];"function"===typeof i&&("constructor"!==n&&r.push(n))}return r}e.Extend=function(t,e){var r={}.hasOwnProperty;function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},e.Decorate=function(t,e){var n=r(e),i=r(t);function o(){var r=Array.prototype.unshift,n=e.prototype.constructor.length,i=t.prototype.constructor;n>0&&(r.call(arguments,t.prototype.constructor),i=e.prototype.constructor),i.apply(this,arguments)}function s(){this.constructor=o}e.displayName=t.displayName,o.prototype=new s;for(var a=0;a<i.length;a++){var u=i[a];o.prototype[u]=t.prototype[u]}for(var l=function(t){var r=function(){};t in o.prototype&&(r=o.prototype[t]);var n=e.prototype[t];return function(){var t=Array.prototype.unshift;return t.call(arguments,r),n.apply(this,arguments)}},c=0;c<n.length;c++){var h=n[c];o.prototype[h]=l(h)}return o};var n=function(){this.listeners={}};n.prototype.on=function(t,e){this.listeners=this.listeners||{},t in this.listeners?this.listeners[t].push(e):this.listeners[t]=[e]},n.prototype.trigger=function(t){var e=Array.prototype.slice,r=e.call(arguments,1);this.listeners=this.listeners||{},null==r&&(r=[]),0===r.length&&r.push({}),r[0]._type=t,t in this.listeners&&this.invoke(this.listeners[t],e.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},n.prototype.invoke=function(t,e){for(var r=0,n=t.length;r<n;r++)t[r].apply(this,e)},e.Observable=n,e.generateChars=function(t){for(var e="",r=0;r<t;r++){var n=Math.floor(36*Math.random());e+=n.toString(36)}return e},e.bind=function(t,e){return function(){t.apply(e,arguments)}},e._convertData=function(t){for(var e in t){var r=e.split("-"),n=t;if(1!==r.length){for(var i=0;i<r.length;i++){var o=r[i];o=o.substring(0,1).toLowerCase()+o.substring(1),o in n||(n[o]={}),i==r.length-1&&(n[o]=t[e]),n=n[o]}delete t[e]}}return t},e.hasScroll=function(e,r){var n=t(r),i=r.style.overflowX,o=r.style.overflowY;return(i!==o||"hidden"!==o&&"visible"!==o)&&("scroll"===i||"scroll"===o||(n.innerHeight()<r.scrollHeight||n.innerWidth()<r.scrollWidth))},e.escapeMarkup=function(t){var e={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!==typeof t?t:String(t).replace(/[&<>"'\/\\]/g,(function(t){return e[t]}))},e.appendMany=function(e,r){if("1.7"===t.fn.jquery.substr(0,3)){var n=t();t.map(r,(function(t){n=n.add(t)})),r=n}e.append(r)},e.__cache={};var i=0;return e.GetUniqueElementId=function(t){var e=t.getAttribute("data-select2-id");return null==e&&(t.id?(e=t.id,t.setAttribute("data-select2-id",e)):(t.setAttribute("data-select2-id",++i),e=i.toString())),e},e.StoreData=function(t,r,n){var i=e.GetUniqueElementId(t);e.__cache[i]||(e.__cache[i]={}),e.__cache[i][r]=n},e.GetData=function(r,n){var i=e.GetUniqueElementId(r);return n?e.__cache[i]&&null!=e.__cache[i][n]?e.__cache[i][n]:t(r).data(n):e.__cache[i]},e.RemoveData=function(t){var r=e.GetUniqueElementId(t);null!=e.__cache[r]&&delete e.__cache[r],t.removeAttribute("data-select2-id")},e})),e.define("select2/results",["jquery","./utils"],(function(t,e){function r(t,e,n){this.$element=t,this.data=n,this.options=e,r.__super__.constructor.call(this)}return e.Extend(r,e.Observable),r.prototype.render=function(){var e=t('<ul class="select2-results__options" role="listbox"></ul>');return this.options.get("multiple")&&e.attr("aria-multiselectable","true"),this.$results=e,e},r.prototype.clear=function(){this.$results.empty()},r.prototype.displayMessage=function(e){var r=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var n=t('<li role="alert" aria-live="assertive" class="select2-results__option"></li>'),i=this.options.get("translations").get(e.message);n.append(r(i(e.args))),n[0].className+=" select2-results__message",this.$results.append(n)},r.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},r.prototype.append=function(t){this.hideLoading();var e=[];if(null!=t.results&&0!==t.results.length){t.results=this.sort(t.results);for(var r=0;r<t.results.length;r++){var n=t.results[r],i=this.option(n);e.push(i)}this.$results.append(e)}else 0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"})},r.prototype.position=function(t,e){var r=e.find(".select2-results");r.append(t)},r.prototype.sort=function(t){var e=this.options.get("sorter");return e(t)},r.prototype.highlightFirstItem=function(){var t=this.$results.find(".select2-results__option[aria-selected]"),e=t.filter("[aria-selected=true]");e.length>0?e.first().trigger("mouseenter"):t.first().trigger("mouseenter"),this.ensureHighlightVisible()},r.prototype.setClasses=function(){var r=this;this.data.current((function(n){var i=t.map(n,(function(t){return t.id.toString()})),o=r.$results.find(".select2-results__option[aria-selected]");o.each((function(){var r=t(this),n=e.GetData(this,"data"),o=""+n.id;null!=n.element&&n.element.selected||null==n.element&&t.inArray(o,i)>-1?r.attr("aria-selected","true"):r.attr("aria-selected","false")}))}))},r.prototype.showLoading=function(t){this.hideLoading();var e=this.options.get("translations").get("searching"),r={disabled:!0,loading:!0,text:e(t)},n=this.option(r);n.className+=" loading-results",this.$results.prepend(n)},r.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},r.prototype.option=function(r){var n=document.createElement("li");n.className="select2-results__option";var i={role:"option","aria-selected":"false"},o=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var s in(null!=r.element&&o.call(r.element,":disabled")||null==r.element&&r.disabled)&&(delete i["aria-selected"],i["aria-disabled"]="true"),null==r.id&&delete i["aria-selected"],null!=r._resultId&&(n.id=r._resultId),r.title&&(n.title=r.title),r.children&&(i.role="group",i["aria-label"]=r.text,delete i["aria-selected"]),i){var a=i[s];n.setAttribute(s,a)}if(r.children){var u=t(n),l=document.createElement("strong");l.className="select2-results__group";t(l);this.template(r,l);for(var c=[],h=0;h<r.children.length;h++){var d=r.children[h],p=this.option(d);c.push(p)}var f=t("<ul></ul>",{class:"select2-results__options select2-results__options--nested"});f.append(c),u.append(l),u.append(f)}else this.template(r,n);return e.StoreData(n,"data",r),n},r.prototype.bind=function(r,n){var i=this,o=r.id+"-results";this.$results.attr("id",o),r.on("results:all",(function(t){i.clear(),i.append(t.data),r.isOpen()&&(i.setClasses(),i.highlightFirstItem())})),r.on("results:append",(function(t){i.append(t.data),r.isOpen()&&i.setClasses()})),r.on("query",(function(t){i.hideMessages(),i.showLoading(t)})),r.on("select",(function(){r.isOpen()&&(i.setClasses(),i.options.get("scrollAfterSelect")&&i.highlightFirstItem())})),r.on("unselect",(function(){r.isOpen()&&(i.setClasses(),i.options.get("scrollAfterSelect")&&i.highlightFirstItem())})),r.on("open",(function(){i.$results.attr("aria-expanded","true"),i.$results.attr("aria-hidden","false"),i.setClasses(),i.ensureHighlightVisible()})),r.on("close",(function(){i.$results.attr("aria-expanded","false"),i.$results.attr("aria-hidden","true"),i.$results.removeAttr("aria-activedescendant")})),r.on("results:toggle",(function(){var t=i.getHighlightedResults();0!==t.length&&t.trigger("mouseup")})),r.on("results:select",(function(){var t=i.getHighlightedResults();if(0!==t.length){var r=e.GetData(t[0],"data");"true"==t.attr("aria-selected")?i.trigger("close",{}):i.trigger("select",{data:r})}})),r.on("results:previous",(function(){var t=i.getHighlightedResults(),e=i.$results.find("[aria-selected]"),r=e.index(t);if(!(r<=0)){var n=r-1;0===t.length&&(n=0);var o=e.eq(n);o.trigger("mouseenter");var s=i.$results.offset().top,a=o.offset().top,u=i.$results.scrollTop()+(a-s);0===n?i.$results.scrollTop(0):a-s<0&&i.$results.scrollTop(u)}})),r.on("results:next",(function(){var t=i.getHighlightedResults(),e=i.$results.find("[aria-selected]"),r=e.index(t),n=r+1;if(!(n>=e.length)){var o=e.eq(n);o.trigger("mouseenter");var s=i.$results.offset().top+i.$results.outerHeight(!1),a=o.offset().top+o.outerHeight(!1),u=i.$results.scrollTop()+a-s;0===n?i.$results.scrollTop(0):a>s&&i.$results.scrollTop(u)}})),r.on("results:focus",(function(t){t.element.addClass("select2-results__option--highlighted")})),r.on("results:message",(function(t){i.displayMessage(t)})),t.fn.mousewheel&&this.$results.on("mousewheel",(function(t){var e=i.$results.scrollTop(),r=i.$results.get(0).scrollHeight-e+t.deltaY,n=t.deltaY>0&&e-t.deltaY<=0,o=t.deltaY<0&&r<=i.$results.height();n?(i.$results.scrollTop(0),t.preventDefault(),t.stopPropagation()):o&&(i.$results.scrollTop(i.$results.get(0).scrollHeight-i.$results.height()),t.preventDefault(),t.stopPropagation())})),this.$results.on("mouseup",".select2-results__option[aria-selected]",(function(r){var n=t(this),o=e.GetData(this,"data");"true"!==n.attr("aria-selected")?i.trigger("select",{originalEvent:r,data:o}):i.options.get("multiple")?i.trigger("unselect",{originalEvent:r,data:o}):i.trigger("close",{})})),this.$results.on("mouseenter",".select2-results__option[aria-selected]",(function(r){var n=e.GetData(this,"data");i.getHighlightedResults().removeClass("select2-results__option--highlighted"),i.trigger("results:focus",{data:n,element:t(this)})}))},r.prototype.getHighlightedResults=function(){var t=this.$results.find(".select2-results__option--highlighted");return t},r.prototype.destroy=function(){this.$results.remove()},r.prototype.ensureHighlightVisible=function(){var t=this.getHighlightedResults();if(0!==t.length){var e=this.$results.find("[aria-selected]"),r=e.index(t),n=this.$results.offset().top,i=t.offset().top,o=this.$results.scrollTop()+(i-n),s=i-n;o-=2*t.outerHeight(!1),r<=2?this.$results.scrollTop(0):(s>this.$results.outerHeight()||s<0)&&this.$results.scrollTop(o)}},r.prototype.template=function(e,r){var n=this.options.get("templateResult"),i=this.options.get("escapeMarkup"),o=n(e,r);null==o?r.style.display="none":"string"===typeof o?r.innerHTML=i(o):t(r).append(o)},r})),e.define("select2/keys",[],(function(){var t={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46};return t})),e.define("select2/selection/base",["jquery","../utils","../keys"],(function(t,e,r){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,e.Observable),n.prototype.render=function(){var r=t('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=e.GetData(this.$element[0],"old-tabindex")?this._tabindex=e.GetData(this.$element[0],"old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),r.attr("title",this.$element.attr("title")),r.attr("tabindex",this._tabindex),r.attr("aria-disabled","false"),this.$selection=r,r},n.prototype.bind=function(t,e){var n=this,i=t.id+"-results";this.container=t,this.$selection.on("focus",(function(t){n.trigger("focus",t)})),this.$selection.on("blur",(function(t){n._handleBlur(t)})),this.$selection.on("keydown",(function(t){n.trigger("keypress",t),t.which===r.SPACE&&t.preventDefault()})),t.on("results:focus",(function(t){n.$selection.attr("aria-activedescendant",t.data._resultId)})),t.on("selection:update",(function(t){n.update(t.data)})),t.on("open",(function(){n.$selection.attr("aria-expanded","true"),n.$selection.attr("aria-owns",i),n._attachCloseHandler(t)})),t.on("close",(function(){n.$selection.attr("aria-expanded","false"),n.$selection.removeAttr("aria-activedescendant"),n.$selection.removeAttr("aria-owns"),n.$selection.trigger("focus"),n._detachCloseHandler(t)})),t.on("enable",(function(){n.$selection.attr("tabindex",n._tabindex),n.$selection.attr("aria-disabled","false")})),t.on("disable",(function(){n.$selection.attr("tabindex","-1"),n.$selection.attr("aria-disabled","true")}))},n.prototype._handleBlur=function(e){var r=this;window.setTimeout((function(){document.activeElement==r.$selection[0]||t.contains(r.$selection[0],document.activeElement)||r.trigger("blur",e)}),1)},n.prototype._attachCloseHandler=function(r){t(document.body).on("mousedown.select2."+r.id,(function(r){var n=t(r.target),i=n.closest(".select2"),o=t(".select2.select2-container--open");o.each((function(){if(this!=i[0]){var t=e.GetData(this,"element");t.select2("close")}}))}))},n.prototype._detachCloseHandler=function(e){t(document.body).off("mousedown.select2."+e.id)},n.prototype.position=function(t,e){var r=e.find(".selection");r.append(t)},n.prototype.destroy=function(){this._detachCloseHandler(this.container)},n.prototype.update=function(t){throw new Error("The `update` method must be defined in child classes.")},n.prototype.isEnabled=function(){return!this.isDisabled()},n.prototype.isDisabled=function(){return this.options.get("disabled")},n})),e.define("select2/selection/single",["jquery","./base","../utils","../keys"],(function(t,e,r,n){function i(){i.__super__.constructor.apply(this,arguments)}return r.Extend(i,e),i.prototype.render=function(){var t=i.__super__.render.call(this);return t.addClass("select2-selection--single"),t.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),t},i.prototype.bind=function(t,e){var r=this;i.__super__.bind.apply(this,arguments);var n=t.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",n).attr("role","textbox").attr("aria-readonly","true"),this.$selection.attr("aria-labelledby",n),this.$selection.on("mousedown",(function(t){1===t.which&&r.trigger("toggle",{originalEvent:t})})),this.$selection.on("focus",(function(t){})),this.$selection.on("blur",(function(t){})),t.on("focus",(function(e){t.isOpen()||r.$selection.trigger("focus")}))},i.prototype.clear=function(){var t=this.$selection.find(".select2-selection__rendered");t.empty(),t.removeAttr("title")},i.prototype.display=function(t,e){var r=this.options.get("templateSelection"),n=this.options.get("escapeMarkup");return n(r(t,e))},i.prototype.selectionContainer=function(){return t("<span></span>")},i.prototype.update=function(t){if(0!==t.length){var e=t[0],r=this.$selection.find(".select2-selection__rendered"),n=this.display(e,r);r.empty().append(n);var i=e.title||e.text;i?r.attr("title",i):r.removeAttr("title")}else this.clear()},i})),e.define("select2/selection/multiple",["jquery","./base","../utils"],(function(t,e,r){function n(t,e){n.__super__.constructor.apply(this,arguments)}return r.Extend(n,e),n.prototype.render=function(){var t=n.__super__.render.call(this);return t.addClass("select2-selection--multiple"),t.html('<ul class="select2-selection__rendered"></ul>'),t},n.prototype.bind=function(e,i){var o=this;n.__super__.bind.apply(this,arguments),this.$selection.on("click",(function(t){o.trigger("toggle",{originalEvent:t})})),this.$selection.on("click",".select2-selection__choice__remove",(function(e){if(!o.isDisabled()){var n=t(this),i=n.parent(),s=r.GetData(i[0],"data");o.trigger("unselect",{originalEvent:e,data:s})}}))},n.prototype.clear=function(){var t=this.$selection.find(".select2-selection__rendered");t.empty(),t.removeAttr("title")},n.prototype.display=function(t,e){var r=this.options.get("templateSelection"),n=this.options.get("escapeMarkup");return n(r(t,e))},n.prototype.selectionContainer=function(){var e=t('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>');return e},n.prototype.update=function(t){if(this.clear(),0!==t.length){for(var e=[],n=0;n<t.length;n++){var i=t[n],o=this.selectionContainer(),s=this.display(i,o);o.append(s);var a=i.title||i.text;a&&o.attr("title",a),r.StoreData(o[0],"data",i),e.push(o)}var u=this.$selection.find(".select2-selection__rendered");r.appendMany(u,e)}},n})),e.define("select2/selection/placeholder",["../utils"],(function(t){function e(t,e,r){this.placeholder=this.normalizePlaceholder(r.get("placeholder")),t.call(this,e,r)}return e.prototype.normalizePlaceholder=function(t,e){return"string"===typeof e&&(e={id:"",text:e}),e},e.prototype.createPlaceholder=function(t,e){var r=this.selectionContainer();return r.html(this.display(e)),r.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),r},e.prototype.update=function(t,e){var r=1==e.length&&e[0].id!=this.placeholder.id,n=e.length>1;if(n||r)return t.call(this,e);this.clear();var i=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(i)},e})),e.define("select2/selection/allowClear",["jquery","../keys","../utils"],(function(t,e,r){function n(){}return n.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),null==this.placeholder&&this.options.get("debug")&&window.console&&console.error&&console.error("Select2: The `allowClear` option should be used in combination with the `placeholder` option."),this.$selection.on("mousedown",".select2-selection__clear",(function(t){n._handleClear(t)})),e.on("keypress",(function(t){n._handleKeyboardClear(t,e)}))},n.prototype._handleClear=function(t,e){if(!this.isDisabled()){var n=this.$selection.find(".select2-selection__clear");if(0!==n.length){e.stopPropagation();var i=r.GetData(n[0],"data"),o=this.$element.val();this.$element.val(this.placeholder.id);var s={data:i};if(this.trigger("clear",s),s.prevented)this.$element.val(o);else{for(var a=0;a<i.length;a++)if(s={data:i[a]},this.trigger("unselect",s),s.prevented)return void this.$element.val(o);this.$element.trigger("input").trigger("change"),this.trigger("toggle",{})}}}},n.prototype._handleKeyboardClear=function(t,r,n){n.isOpen()||r.which!=e.DELETE&&r.which!=e.BACKSPACE||this._handleClear(r)},n.prototype.update=function(e,n){if(e.call(this,n),!(this.$selection.find(".select2-selection__placeholder").length>0||0===n.length)){var i=this.options.get("translations").get("removeAllItems"),o=t('<span class="select2-selection__clear" title="'+i()+'">&times;</span>');r.StoreData(o[0],"data",n),this.$selection.find(".select2-selection__rendered").prepend(o)}},n})),e.define("select2/selection/search",["jquery","../utils","../keys"],(function(t,e,r){function n(t,e,r){t.call(this,e,r)}return n.prototype.render=function(e){var r=t('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></li>');this.$searchContainer=r,this.$search=r.find("input");var n=e.call(this);return this._transferTabIndex(),n},n.prototype.bind=function(t,n,i){var o=this,s=n.id+"-results";t.call(this,n,i),n.on("open",(function(){o.$search.attr("aria-controls",s),o.$search.trigger("focus")})),n.on("close",(function(){o.$search.val(""),o.$search.removeAttr("aria-controls"),o.$search.removeAttr("aria-activedescendant"),o.$search.trigger("focus")})),n.on("enable",(function(){o.$search.prop("disabled",!1),o._transferTabIndex()})),n.on("disable",(function(){o.$search.prop("disabled",!0)})),n.on("focus",(function(t){o.$search.trigger("focus")})),n.on("results:focus",(function(t){t.data._resultId?o.$search.attr("aria-activedescendant",t.data._resultId):o.$search.removeAttr("aria-activedescendant")})),this.$selection.on("focusin",".select2-search--inline",(function(t){o.trigger("focus",t)})),this.$selection.on("focusout",".select2-search--inline",(function(t){o._handleBlur(t)})),this.$selection.on("keydown",".select2-search--inline",(function(t){t.stopPropagation(),o.trigger("keypress",t),o._keyUpPrevented=t.isDefaultPrevented();var n=t.which;if(n===r.BACKSPACE&&""===o.$search.val()){var i=o.$searchContainer.prev(".select2-selection__choice");if(i.length>0){var s=e.GetData(i[0],"data");o.searchRemoveChoice(s),t.preventDefault()}}})),this.$selection.on("click",".select2-search--inline",(function(t){o.$search.val()&&t.stopPropagation()}));var a=document.documentMode,u=a&&a<=11;this.$selection.on("input.searchcheck",".select2-search--inline",(function(t){u?o.$selection.off("input.search input.searchcheck"):o.$selection.off("keyup.search")})),this.$selection.on("keyup.search input.search",".select2-search--inline",(function(t){if(u&&"input"===t.type)o.$selection.off("input.search input.searchcheck");else{var e=t.which;e!=r.SHIFT&&e!=r.CTRL&&e!=r.ALT&&e!=r.TAB&&o.handleSearch(t)}}))},n.prototype._transferTabIndex=function(t){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},n.prototype.createPlaceholder=function(t,e){this.$search.attr("placeholder",e.text)},n.prototype.update=function(t,e){var r=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),t.call(this,e),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),r&&this.$search.trigger("focus")},n.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var t=this.$search.val();this.trigger("query",{term:t})}this._keyUpPrevented=!1},n.prototype.searchRemoveChoice=function(t,e){this.trigger("unselect",{data:e}),this.$search.val(e.text),this.handleSearch()},n.prototype.resizeSearch=function(){this.$search.css("width","25px");var t="";if(""!==this.$search.attr("placeholder"))t=this.$selection.find(".select2-selection__rendered").width();else{var e=this.$search.val().length+1;t=.75*e+"em"}this.$search.css("width",t)},n})),e.define("select2/selection/eventRelay",["jquery"],(function(t){function e(){}return e.prototype.bind=function(e,r,n){var i=this,o=["open","opening","close","closing","select","selecting","unselect","unselecting","clear","clearing"],s=["opening","closing","selecting","unselecting","clearing"];e.call(this,r,n),r.on("*",(function(e,r){if(-1!==t.inArray(e,o)){r=r||{};var n=t.Event("select2:"+e,{params:r});i.$element.trigger(n),-1!==t.inArray(e,s)&&(r.prevented=n.isDefaultPrevented())}}))},e})),e.define("select2/translation",["jquery","require"],(function(t,e){function r(t){this.dict=t||{}}return r.prototype.all=function(){return this.dict},r.prototype.get=function(t){return this.dict[t]},r.prototype.extend=function(e){this.dict=t.extend({},e.all(),this.dict)},r._cache={},r.loadPath=function(t){if(!(t in r._cache)){var n=e(t);r._cache[t]=n}return new r(r._cache[t])},r})),e.define("select2/diacritics",[],(function(){var t={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Œ":"OE","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","œ":"oe","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ώ":"ω","ς":"σ","’":"'"};return t})),e.define("select2/data/base",["../utils"],(function(t){function e(t,r){e.__super__.constructor.call(this)}return t.Extend(e,t.Observable),e.prototype.current=function(t){throw new Error("The `current` method must be defined in child classes.")},e.prototype.query=function(t,e){throw new Error("The `query` method must be defined in child classes.")},e.prototype.bind=function(t,e){},e.prototype.destroy=function(){},e.prototype.generateResultId=function(e,r){var n=e.id+"-result-";return n+=t.generateChars(4),null!=r.id?n+="-"+r.id.toString():n+="-"+t.generateChars(4),n},e})),e.define("select2/data/select",["./base","../utils","jquery"],(function(t,e,r){function n(t,e){this.$element=t,this.options=e,n.__super__.constructor.call(this)}return e.Extend(n,t),n.prototype.current=function(t){var e=[],n=this;this.$element.find(":selected").each((function(){var t=r(this),i=n.item(t);e.push(i)})),t(e)},n.prototype.select=function(t){var e=this;if(t.selected=!0,r(t.element).is("option"))return t.element.selected=!0,void this.$element.trigger("input").trigger("change");if(this.$element.prop("multiple"))this.current((function(n){var i=[];t=[t],t.push.apply(t,n);for(var o=0;o<t.length;o++){var s=t[o].id;-1===r.inArray(s,i)&&i.push(s)}e.$element.val(i),e.$element.trigger("input").trigger("change")}));else{var n=t.id;this.$element.val(n),this.$element.trigger("input").trigger("change")}},n.prototype.unselect=function(t){var e=this;if(this.$element.prop("multiple")){if(t.selected=!1,r(t.element).is("option"))return t.element.selected=!1,void this.$element.trigger("input").trigger("change");this.current((function(n){for(var i=[],o=0;o<n.length;o++){var s=n[o].id;s!==t.id&&-1===r.inArray(s,i)&&i.push(s)}e.$element.val(i),e.$element.trigger("input").trigger("change")}))}},n.prototype.bind=function(t,e){var r=this;this.container=t,t.on("select",(function(t){r.select(t.data)})),t.on("unselect",(function(t){r.unselect(t.data)}))},n.prototype.destroy=function(){this.$element.find("*").each((function(){e.RemoveData(this)}))},n.prototype.query=function(t,e){var n=[],i=this,o=this.$element.children();o.each((function(){var e=r(this);if(e.is("option")||e.is("optgroup")){var o=i.item(e),s=i.matches(t,o);null!==s&&n.push(s)}})),e({results:n})},n.prototype.addOptions=function(t){e.appendMany(this.$element,t)},n.prototype.option=function(t){var n;t.children?(n=document.createElement("optgroup"),n.label=t.text):(n=document.createElement("option"),void 0!==n.textContent?n.textContent=t.text:n.innerText=t.text),void 0!==t.id&&(n.value=t.id),t.disabled&&(n.disabled=!0),t.selected&&(n.selected=!0),t.title&&(n.title=t.title);var i=r(n),o=this._normalizeItem(t);return o.element=n,e.StoreData(n,"data",o),i},n.prototype.item=function(t){var n={};if(n=e.GetData(t[0],"data"),null!=n)return n;if(t.is("option"))n={id:t.val(),text:t.text(),disabled:t.prop("disabled"),selected:t.prop("selected"),title:t.prop("title")};else if(t.is("optgroup")){n={text:t.prop("label"),children:[],title:t.prop("title")};for(var i=t.children("option"),o=[],s=0;s<i.length;s++){var a=r(i[s]),u=this.item(a);o.push(u)}n.children=o}return n=this._normalizeItem(n),n.element=t[0],e.StoreData(t[0],"data",n),n},n.prototype._normalizeItem=function(t){t!==Object(t)&&(t={id:t,text:t}),t=r.extend({},{text:""},t);var e={selected:!1,disabled:!1};return null!=t.id&&(t.id=t.id.toString()),null!=t.text&&(t.text=t.text.toString()),null==t._resultId&&t.id&&null!=this.container&&(t._resultId=this.generateResultId(this.container,t)),r.extend({},e,t)},n.prototype.matches=function(t,e){var r=this.options.get("matcher");return r(t,e)},n})),e.define("select2/data/array",["./select","../utils","jquery"],(function(t,e,r){function n(t,e){this._dataToConvert=e.get("data")||[],n.__super__.constructor.call(this,t,e)}return e.Extend(n,t),n.prototype.bind=function(t,e){n.__super__.bind.call(this,t,e),this.addOptions(this.convertToOptions(this._dataToConvert))},n.prototype.select=function(t){var e=this.$element.find("option").filter((function(e,r){return r.value==t.id.toString()}));0===e.length&&(e=this.option(t),this.addOptions(e)),n.__super__.select.call(this,t)},n.prototype.convertToOptions=function(t){var n=this,i=this.$element.find("option"),o=i.map((function(){return n.item(r(this)).id})).get(),s=[];function a(t){return function(){return r(this).val()==t.id}}for(var u=0;u<t.length;u++){var l=this._normalizeItem(t[u]);if(r.inArray(l.id,o)>=0){var c=i.filter(a(l)),h=this.item(c),d=r.extend(!0,{},l,h),p=this.option(d);c.replaceWith(p)}else{var f=this.option(l);if(l.children){var m=this.convertToOptions(l.children);e.appendMany(f,m)}s.push(f)}}return s},n})),e.define("select2/data/ajax",["./array","../utils","jquery"],(function(t,e,r){function n(t,e){this.ajaxOptions=this._applyDefaults(e.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),n.__super__.constructor.call(this,t,e)}return e.Extend(n,t),n.prototype._applyDefaults=function(t){var e={data:function(t){return r.extend({},t,{q:t.term})},transport:function(t,e,n){var i=r.ajax(t);return i.then(e),i.fail(n),i}};return r.extend({},e,t,!0)},n.prototype.processResults=function(t){return t},n.prototype.query=function(t,e){var n=this;null!=this._request&&(r.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var i=r.extend({type:"GET"},this.ajaxOptions);function o(){var o=i.transport(i,(function(i){var o=n.processResults(i,t);n.options.get("debug")&&window.console&&console.error&&(o&&o.results&&r.isArray(o.results)||console.error("Select2: The AJAX results did not return an array in the `results` key of the response.")),e(o)}),(function(){(!("status"in o)||0!==o.status&&"0"!==o.status)&&n.trigger("results:message",{message:"errorLoading"})}));n._request=o}"function"===typeof i.url&&(i.url=i.url.call(this.$element,t)),"function"===typeof i.data&&(i.data=i.data.call(this.$element,t)),this.ajaxOptions.delay&&null!=t.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(o,this.ajaxOptions.delay)):o()},n})),e.define("select2/data/tags",["jquery"],(function(t){function e(e,r,n){var i=n.get("tags"),o=n.get("createTag");void 0!==o&&(this.createTag=o);var s=n.get("insertTag");if(void 0!==s&&(this.insertTag=s),e.call(this,r,n),t.isArray(i))for(var a=0;a<i.length;a++){var u=i[a],l=this._normalizeItem(u),c=this.option(l);this.$element.append(c)}}return e.prototype.query=function(t,e,r){var n=this;function i(t,o){for(var s=t.results,a=0;a<s.length;a++){var u=s[a],l=null!=u.children&&!i({results:u.children},!0),c=(u.text||"").toUpperCase(),h=(e.term||"").toUpperCase(),d=c===h;if(d||l)return!o&&(t.data=s,void r(t))}if(o)return!0;var p=n.createTag(e);if(null!=p){var f=n.option(p);f.attr("data-select2-tag",!0),n.addOptions([f]),n.insertTag(s,p)}t.results=s,r(t)}this._removeOldTags(),null!=e.term&&null==e.page?t.call(this,e,i):t.call(this,e,r)},e.prototype.createTag=function(e,r){var n=t.trim(r.term);return""===n?null:{id:n,text:n}},e.prototype.insertTag=function(t,e,r){e.unshift(r)},e.prototype._removeOldTags=function(e){var r=this.$element.find("option[data-select2-tag]");r.each((function(){this.selected||t(this).remove()}))},e})),e.define("select2/data/tokenizer",["jquery"],(function(t){function e(t,e,r){var n=r.get("tokenizer");void 0!==n&&(this.tokenizer=n),t.call(this,e,r)}return e.prototype.bind=function(t,e,r){t.call(this,e,r),this.$search=e.dropdown.$search||e.selection.$search||r.find(".select2-search__field")},e.prototype.query=function(e,r,n){var i=this;function o(e){var r=i._normalizeItem(e),n=i.$element.find("option").filter((function(){return t(this).val()===r.id}));if(!n.length){var o=i.option(r);o.attr("data-select2-tag",!0),i._removeOldTags(),i.addOptions([o])}s(r)}function s(t){i.trigger("select",{data:t})}r.term=r.term||"";var a=this.tokenizer(r,this.options,o);a.term!==r.term&&(this.$search.length&&(this.$search.val(a.term),this.$search.trigger("focus")),r.term=a.term),e.call(this,r,n)},e.prototype.tokenizer=function(e,r,n,i){var o=n.get("tokenSeparators")||[],s=r.term,a=0,u=this.createTag||function(t){return{id:t.term,text:t.term}};while(a<s.length){var l=s[a];if(-1!==t.inArray(l,o)){var c=s.substr(0,a),h=t.extend({},r,{term:c}),d=u(h);null!=d?(i(d),s=s.substr(a+1)||"",a=0):a++}else a++}return{term:s}},e})),e.define("select2/data/minimumInputLength",[],(function(){function t(t,e,r){this.minimumInputLength=r.get("minimumInputLength"),t.call(this,e,r)}return t.prototype.query=function(t,e,r){e.term=e.term||"",e.term.length<this.minimumInputLength?this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:e.term,params:e}}):t.call(this,e,r)},t})),e.define("select2/data/maximumInputLength",[],(function(){function t(t,e,r){this.maximumInputLength=r.get("maximumInputLength"),t.call(this,e,r)}return t.prototype.query=function(t,e,r){e.term=e.term||"",this.maximumInputLength>0&&e.term.length>this.maximumInputLength?this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:e.term,params:e}}):t.call(this,e,r)},t})),e.define("select2/data/maximumSelectionLength",[],(function(){function t(t,e,r){this.maximumSelectionLength=r.get("maximumSelectionLength"),t.call(this,e,r)}return t.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),e.on("select",(function(){n._checkIfMaximumSelected()}))},t.prototype.query=function(t,e,r){var n=this;this._checkIfMaximumSelected((function(){t.call(n,e,r)}))},t.prototype._checkIfMaximumSelected=function(t,e){var r=this;this.current((function(t){var n=null!=t?t.length:0;r.maximumSelectionLength>0&&n>=r.maximumSelectionLength?r.trigger("results:message",{message:"maximumSelected",args:{maximum:r.maximumSelectionLength}}):e&&e()}))},t})),e.define("select2/dropdown",["jquery","./utils"],(function(t,e){function r(t,e){this.$element=t,this.options=e,r.__super__.constructor.call(this)}return e.Extend(r,e.Observable),r.prototype.render=function(){var e=t('<span class="select2-dropdown"><span class="select2-results"></span></span>');return e.attr("dir",this.options.get("dir")),this.$dropdown=e,e},r.prototype.bind=function(){},r.prototype.position=function(t,e){},r.prototype.destroy=function(){this.$dropdown.remove()},r})),e.define("select2/dropdown/search",["jquery","../utils"],(function(t,e){function r(){}return r.prototype.render=function(e){var r=e.call(this),n=t('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="none" spellcheck="false" role="searchbox" aria-autocomplete="list" /></span>');return this.$searchContainer=n,this.$search=n.find("input"),r.prepend(n),r},r.prototype.bind=function(e,r,n){var i=this,o=r.id+"-results";e.call(this,r,n),this.$search.on("keydown",(function(t){i.trigger("keypress",t),i._keyUpPrevented=t.isDefaultPrevented()})),this.$search.on("input",(function(e){t(this).off("keyup")})),this.$search.on("keyup input",(function(t){i.handleSearch(t)})),r.on("open",(function(){i.$search.attr("tabindex",0),i.$search.attr("aria-controls",o),i.$search.trigger("focus"),window.setTimeout((function(){i.$search.trigger("focus")}),0)})),r.on("close",(function(){i.$search.attr("tabindex",-1),i.$search.removeAttr("aria-controls"),i.$search.removeAttr("aria-activedescendant"),i.$search.val(""),i.$search.trigger("blur")})),r.on("focus",(function(){r.isOpen()||i.$search.trigger("focus")})),r.on("results:all",(function(t){if(null==t.query.term||""===t.query.term){var e=i.showSearch(t);e?i.$searchContainer.removeClass("select2-search--hide"):i.$searchContainer.addClass("select2-search--hide")}})),r.on("results:focus",(function(t){t.data._resultId?i.$search.attr("aria-activedescendant",t.data._resultId):i.$search.removeAttr("aria-activedescendant")}))},r.prototype.handleSearch=function(t){if(!this._keyUpPrevented){var e=this.$search.val();this.trigger("query",{term:e})}this._keyUpPrevented=!1},r.prototype.showSearch=function(t,e){return!0},r})),e.define("select2/dropdown/hidePlaceholder",[],(function(){function t(t,e,r,n){this.placeholder=this.normalizePlaceholder(r.get("placeholder")),t.call(this,e,r,n)}return t.prototype.append=function(t,e){e.results=this.removePlaceholder(e.results),t.call(this,e)},t.prototype.normalizePlaceholder=function(t,e){return"string"===typeof e&&(e={id:"",text:e}),e},t.prototype.removePlaceholder=function(t,e){for(var r=e.slice(0),n=e.length-1;n>=0;n--){var i=e[n];this.placeholder.id===i.id&&r.splice(n,1)}return r},t})),e.define("select2/dropdown/infiniteScroll",["jquery"],(function(t){function e(t,e,r,n){this.lastParams={},t.call(this,e,r,n),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return e.prototype.append=function(t,e){this.$loadingMore.remove(),this.loading=!1,t.call(this,e),this.showLoadingMore(e)&&(this.$results.append(this.$loadingMore),this.loadMoreIfNeeded())},e.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),e.on("query",(function(t){n.lastParams=t,n.loading=!0})),e.on("query:append",(function(t){n.lastParams=t,n.loading=!0})),this.$results.on("scroll",this.loadMoreIfNeeded.bind(this))},e.prototype.loadMoreIfNeeded=function(){var e=t.contains(document.documentElement,this.$loadingMore[0]);if(!this.loading&&e){var r=this.$results.offset().top+this.$results.outerHeight(!1),n=this.$loadingMore.offset().top+this.$loadingMore.outerHeight(!1);r+50>=n&&this.loadMore()}},e.prototype.loadMore=function(){this.loading=!0;var e=t.extend({},{page:1},this.lastParams);e.page++,this.trigger("query:append",e)},e.prototype.showLoadingMore=function(t,e){return e.pagination&&e.pagination.more},e.prototype.createLoadingMore=function(){var e=t('<li class="select2-results__option select2-results__option--load-more"role="option" aria-disabled="true"></li>'),r=this.options.get("translations").get("loadingMore");return e.html(r(this.lastParams)),e},e})),e.define("select2/dropdown/attachBody",["jquery","../utils"],(function(t,e){function r(e,r,n){this.$dropdownParent=t(n.get("dropdownParent")||document.body),e.call(this,r,n)}return r.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),e.on("open",(function(){n._showDropdown(),n._attachPositioningHandler(e),n._bindContainerResultHandlers(e)})),e.on("close",(function(){n._hideDropdown(),n._detachPositioningHandler(e)})),this.$dropdownContainer.on("mousedown",(function(t){t.stopPropagation()}))},r.prototype.destroy=function(t){t.call(this),this.$dropdownContainer.remove()},r.prototype.position=function(t,e,r){e.attr("class",r.attr("class")),e.removeClass("select2"),e.addClass("select2-container--open"),e.css({position:"absolute",top:-999999}),this.$container=r},r.prototype.render=function(e){var r=t("<span></span>"),n=e.call(this);return r.append(n),this.$dropdownContainer=r,r},r.prototype._hideDropdown=function(t){this.$dropdownContainer.detach()},r.prototype._bindContainerResultHandlers=function(t,e){if(!this._containerResultsHandlersBound){var r=this;e.on("results:all",(function(){r._positionDropdown(),r._resizeDropdown()})),e.on("results:append",(function(){r._positionDropdown(),r._resizeDropdown()})),e.on("results:message",(function(){r._positionDropdown(),r._resizeDropdown()})),e.on("select",(function(){r._positionDropdown(),r._resizeDropdown()})),e.on("unselect",(function(){r._positionDropdown(),r._resizeDropdown()})),this._containerResultsHandlersBound=!0}},r.prototype._attachPositioningHandler=function(r,n){var i=this,o="scroll.select2."+n.id,s="resize.select2."+n.id,a="orientationchange.select2."+n.id,u=this.$container.parents().filter(e.hasScroll);u.each((function(){e.StoreData(this,"select2-scroll-position",{x:t(this).scrollLeft(),y:t(this).scrollTop()})})),u.on(o,(function(r){var n=e.GetData(this,"select2-scroll-position");t(this).scrollTop(n.y)})),t(window).on(o+" "+s+" "+a,(function(t){i._positionDropdown(),i._resizeDropdown()}))},r.prototype._detachPositioningHandler=function(r,n){var i="scroll.select2."+n.id,o="resize.select2."+n.id,s="orientationchange.select2."+n.id,a=this.$container.parents().filter(e.hasScroll);a.off(i),t(window).off(i+" "+o+" "+s)},r.prototype._positionDropdown=function(){var e=t(window),r=this.$dropdown.hasClass("select2-dropdown--above"),n=this.$dropdown.hasClass("select2-dropdown--below"),i=null,o=this.$container.offset();o.bottom=o.top+this.$container.outerHeight(!1);var s={height:this.$container.outerHeight(!1)};s.top=o.top,s.bottom=o.top+s.height;var a={height:this.$dropdown.outerHeight(!1)},u={top:e.scrollTop(),bottom:e.scrollTop()+e.height()},l=u.top<o.top-a.height,c=u.bottom>o.bottom+a.height,h={left:o.left,top:s.bottom},d=this.$dropdownParent;"static"===d.css("position")&&(d=d.offsetParent());var p={top:0,left:0};(t.contains(document.body,d[0])||d[0].isConnected)&&(p=d.offset()),h.top-=p.top,h.left-=p.left,r||n||(i="below"),c||!l||r?!l&&c&&r&&(i="below"):i="above",("above"==i||r&&"below"!==i)&&(h.top=s.top-p.top-a.height),null!=i&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+i),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+i)),this.$dropdownContainer.css(h)},r.prototype._resizeDropdown=function(){var t={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(t.minWidth=t.width,t.position="relative",t.width="auto"),this.$dropdown.css(t)},r.prototype._showDropdown=function(t){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},r})),e.define("select2/dropdown/minimumResultsForSearch",[],(function(){function t(e){for(var r=0,n=0;n<e.length;n++){var i=e[n];i.children?r+=t(i.children):r++}return r}function e(t,e,r,n){this.minimumResultsForSearch=r.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),t.call(this,e,r,n)}return e.prototype.showSearch=function(e,r){return!(t(r.data.results)<this.minimumResultsForSearch)&&e.call(this,r)},e})),e.define("select2/dropdown/selectOnClose",["../utils"],(function(t){function e(){}return e.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),e.on("close",(function(t){n._handleSelectOnClose(t)}))},e.prototype._handleSelectOnClose=function(e,r){if(r&&null!=r.originalSelect2Event){var n=r.originalSelect2Event;if("select"===n._type||"unselect"===n._type)return}var i=this.getHighlightedResults();if(!(i.length<1)){var o=t.GetData(i[0],"data");null!=o.element&&o.element.selected||null==o.element&&o.selected||this.trigger("select",{data:o})}},e})),e.define("select2/dropdown/closeOnSelect",[],(function(){function t(){}return t.prototype.bind=function(t,e,r){var n=this;t.call(this,e,r),e.on("select",(function(t){n._selectTriggered(t)})),e.on("unselect",(function(t){n._selectTriggered(t)}))},t.prototype._selectTriggered=function(t,e){var r=e.originalEvent;r&&(r.ctrlKey||r.metaKey)||this.trigger("close",{originalEvent:r,originalSelect2Event:e})},t})),e.define("select2/i18n/en",[],(function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(t){var e=t.input.length-t.maximum,r="Please delete "+e+" character";return 1!=e&&(r+="s"),r},inputTooShort:function(t){var e=t.minimum-t.input.length,r="Please enter "+e+" or more characters";return r},loadingMore:function(){return"Loading more results…"},maximumSelected:function(t){var e="You can only select "+t.maximum+" item";return 1!=t.maximum&&(e+="s"),e},noResults:function(){return"No results found"},searching:function(){return"Searching…"},removeAllItems:function(){return"Remove all items"}}})),e.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],(function(t,e,r,n,i,o,s,a,u,l,c,h,d,p,f,m,g,v,y,w,b,x,_,S,M,E,T,A,P){function C(){this.reset()}C.prototype.apply=function(c){if(c=t.extend(!0,{},this.defaults,c),null==c.dataAdapter){if(null!=c.ajax?c.dataAdapter=f:null!=c.data?c.dataAdapter=p:c.dataAdapter=d,c.minimumInputLength>0&&(c.dataAdapter=l.Decorate(c.dataAdapter,v)),c.maximumInputLength>0&&(c.dataAdapter=l.Decorate(c.dataAdapter,y)),c.maximumSelectionLength>0&&(c.dataAdapter=l.Decorate(c.dataAdapter,w)),c.tags&&(c.dataAdapter=l.Decorate(c.dataAdapter,m)),null==c.tokenSeparators&&null==c.tokenizer||(c.dataAdapter=l.Decorate(c.dataAdapter,g)),null!=c.query){var h=e(c.amdBase+"compat/query");c.dataAdapter=l.Decorate(c.dataAdapter,h)}if(null!=c.initSelection){var P=e(c.amdBase+"compat/initSelection");c.dataAdapter=l.Decorate(c.dataAdapter,P)}}if(null==c.resultsAdapter&&(c.resultsAdapter=r,null!=c.ajax&&(c.resultsAdapter=l.Decorate(c.resultsAdapter,S)),null!=c.placeholder&&(c.resultsAdapter=l.Decorate(c.resultsAdapter,_)),c.selectOnClose&&(c.resultsAdapter=l.Decorate(c.resultsAdapter,T))),null==c.dropdownAdapter){if(c.multiple)c.dropdownAdapter=b;else{var C=l.Decorate(b,x);c.dropdownAdapter=C}if(0!==c.minimumResultsForSearch&&(c.dropdownAdapter=l.Decorate(c.dropdownAdapter,E)),c.closeOnSelect&&(c.dropdownAdapter=l.Decorate(c.dropdownAdapter,A)),null!=c.dropdownCssClass||null!=c.dropdownCss||null!=c.adaptDropdownCssClass){var R=e(c.amdBase+"compat/dropdownCss");c.dropdownAdapter=l.Decorate(c.dropdownAdapter,R)}c.dropdownAdapter=l.Decorate(c.dropdownAdapter,M)}if(null==c.selectionAdapter){if(c.multiple?c.selectionAdapter=i:c.selectionAdapter=n,null!=c.placeholder&&(c.selectionAdapter=l.Decorate(c.selectionAdapter,o)),c.allowClear&&(c.selectionAdapter=l.Decorate(c.selectionAdapter,s)),c.multiple&&(c.selectionAdapter=l.Decorate(c.selectionAdapter,a)),null!=c.containerCssClass||null!=c.containerCss||null!=c.adaptContainerCssClass){var L=e(c.amdBase+"compat/containerCss");c.selectionAdapter=l.Decorate(c.selectionAdapter,L)}c.selectionAdapter=l.Decorate(c.selectionAdapter,u)}c.language=this._resolveLanguage(c.language),c.language.push("en");for(var O=[],I=0;I<c.language.length;I++){var D=c.language[I];-1===O.indexOf(D)&&O.push(D)}return c.language=O,c.translations=this._processTranslations(c.language,c.debug),c},C.prototype.reset=function(){function e(t){function e(t){return h[t]||t}return t.replace(/[^\u0000-\u007E]/g,e)}function r(n,i){if(""===t.trim(n.term))return i;if(i.children&&i.children.length>0){for(var o=t.extend(!0,{},i),s=i.children.length-1;s>=0;s--){var a=i.children[s],u=r(n,a);null==u&&o.children.splice(s,1)}return o.children.length>0?o:r(n,o)}var l=e(i.text).toUpperCase(),c=e(n.term).toUpperCase();return l.indexOf(c)>-1?i:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:l.escapeMarkup,language:{},matcher:r,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,scrollAfterSelect:!1,sorter:function(t){return t},templateResult:function(t){return t.text},templateSelection:function(t){return t.text},theme:"default",width:"resolve"}},C.prototype.applyFromElement=function(t,e){var r=t.language,n=this.defaults.language,i=e.prop("lang"),o=e.closest("[lang]").prop("lang"),s=Array.prototype.concat.call(this._resolveLanguage(i),this._resolveLanguage(r),this._resolveLanguage(n),this._resolveLanguage(o));return t.language=s,t},C.prototype._resolveLanguage=function(e){if(!e)return[];if(t.isEmptyObject(e))return[];if(t.isPlainObject(e))return[e];var r;r=t.isArray(e)?e:[e];for(var n=[],i=0;i<r.length;i++)if(n.push(r[i]),"string"===typeof r[i]&&r[i].indexOf("-")>0){var o=r[i].split("-"),s=o[0];n.push(s)}return n},C.prototype._processTranslations=function(e,r){for(var n=new c,i=0;i<e.length;i++){var o=new c,s=e[i];if("string"===typeof s)try{o=c.loadPath(s)}catch(a){try{s=this.defaults.amdLanguageBase+s,o=c.loadPath(s)}catch(u){r&&window.console&&console.warn&&console.warn('Select2: The language file for "'+s+'" could not be automatically loaded. A fallback will be used instead.')}}else o=t.isPlainObject(s)?new c(s):s;n.extend(o)}return n},C.prototype.set=function(e,r){var n=t.camelCase(e),i={};i[n]=r;var o=l._convertData(i);t.extend(!0,this.defaults,o)};var R=new C;return R})),e.define("select2/options",["require","jquery","./defaults","./utils"],(function(t,e,r,n){function i(e,i){if(this.options=e,null!=i&&this.fromElement(i),null!=i&&(this.options=r.applyFromElement(this.options,i)),this.options=r.apply(this.options),i&&i.is("input")){var o=t(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=n.Decorate(this.options.dataAdapter,o)}}return i.prototype.fromElement=function(t){var r=["select2"];null==this.options.multiple&&(this.options.multiple=t.prop("multiple")),null==this.options.disabled&&(this.options.disabled=t.prop("disabled")),null==this.options.dir&&(t.prop("dir")?this.options.dir=t.prop("dir"):t.closest("[dir]").prop("dir")?this.options.dir=t.closest("[dir]").prop("dir"):this.options.dir="ltr"),t.prop("disabled",this.options.disabled),t.prop("multiple",this.options.multiple),n.GetData(t[0],"select2Tags")&&(this.options.debug&&window.console&&console.warn&&console.warn('Select2: The `data-select2-tags` attribute has been changed to use the `data-data` and `data-tags="true"` attributes and will be removed in future versions of Select2.'),n.StoreData(t[0],"data",n.GetData(t[0],"select2Tags")),n.StoreData(t[0],"tags",!0)),n.GetData(t[0],"ajaxUrl")&&(this.options.debug&&window.console&&console.warn&&console.warn("Select2: The `data-ajax-url` attribute has been changed to `data-ajax--url` and support for the old attribute will be removed in future versions of Select2."),t.attr("ajax--url",n.GetData(t[0],"ajaxUrl")),n.StoreData(t[0],"ajax-Url",n.GetData(t[0],"ajaxUrl")));var i={};function o(t,e){return e.toUpperCase()}for(var s=0;s<t[0].attributes.length;s++){var a=t[0].attributes[s].name,u="data-";if(a.substr(0,u.length)==u){var l=a.substring(u.length),c=n.GetData(t[0],l),h=l.replace(/-([a-z])/g,o);i[h]=c}}e.fn.jquery&&"1."==e.fn.jquery.substr(0,2)&&t[0].dataset&&(i=e.extend(!0,{},t[0].dataset,i));var d=e.extend(!0,{},n.GetData(t[0]),i);for(var p in d=n._convertData(d),d)e.inArray(p,r)>-1||(e.isPlainObject(this.options[p])?e.extend(this.options[p],d[p]):this.options[p]=d[p]);return this},i.prototype.get=function(t){return this.options[t]},i.prototype.set=function(t,e){this.options[t]=e},i})),e.define("select2/core",["jquery","./options","./utils","./keys"],(function(t,e,r,n){var i=function(t,n){null!=r.GetData(t[0],"select2")&&r.GetData(t[0],"select2").destroy(),this.$element=t,this.id=this._generateId(t),n=n||{},this.options=new e(n,t),i.__super__.constructor.call(this);var o=t.attr("tabindex")||0;r.StoreData(t[0],"old-tabindex",o),t.attr("tabindex","-1");var s=this.options.get("dataAdapter");this.dataAdapter=new s(t,this.options);var a=this.render();this._placeContainer(a);var u=this.options.get("selectionAdapter");this.selection=new u(t,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,a);var l=this.options.get("dropdownAdapter");this.dropdown=new l(t,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,a);var c=this.options.get("resultsAdapter");this.results=new c(t,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var h=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current((function(t){h.trigger("selection:update",{data:t})})),t.addClass("select2-hidden-accessible"),t.attr("aria-hidden","true"),this._syncAttributes(),r.StoreData(t[0],"select2",this),t.data("select2",this)};return r.Extend(i,r.Observable),i.prototype._generateId=function(t){var e="";return e=null!=t.attr("id")?t.attr("id"):null!=t.attr("name")?t.attr("name")+"-"+r.generateChars(2):r.generateChars(4),e=e.replace(/(:|\.|\[|\]|,)/g,""),e="select2-"+e,e},i.prototype._placeContainer=function(t){t.insertAfter(this.$element);var e=this._resolveWidth(this.$element,this.options.get("width"));null!=e&&t.css("width",e)},i.prototype._resolveWidth=function(t,e){var r=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==e){var n=this._resolveWidth(t,"style");return null!=n?n:this._resolveWidth(t,"element")}if("element"==e){var i=t.outerWidth(!1);return i<=0?"auto":i+"px"}if("style"==e){var o=t.attr("style");if("string"!==typeof o)return null;for(var s=o.split(";"),a=0,u=s.length;a<u;a+=1){var l=s[a].replace(/\s/g,""),c=l.match(r);if(null!==c&&c.length>=1)return c[1]}return null}if("computedstyle"==e){var h=window.getComputedStyle(t[0]);return h.width}return e},i.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},i.prototype._registerDomEvents=function(){var t=this;this.$element.on("change.select2",(function(){t.dataAdapter.current((function(e){t.trigger("selection:update",{data:e})}))})),this.$element.on("focus.select2",(function(e){t.trigger("focus",e)})),this._syncA=r.bind(this._syncAttributes,this),this._syncS=r.bind(this._syncSubtree,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._syncA);var e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=e?(this._observer=new e((function(e){t._syncA(),t._syncS(null,e)})),this._observer.observe(this.$element[0],{attributes:!0,childList:!0,subtree:!1})):this.$element[0].addEventListener&&(this.$element[0].addEventListener("DOMAttrModified",t._syncA,!1),this.$element[0].addEventListener("DOMNodeInserted",t._syncS,!1),this.$element[0].addEventListener("DOMNodeRemoved",t._syncS,!1))},i.prototype._registerDataEvents=function(){var t=this;this.dataAdapter.on("*",(function(e,r){t.trigger(e,r)}))},i.prototype._registerSelectionEvents=function(){var e=this,r=["toggle","focus"];this.selection.on("toggle",(function(){e.toggleDropdown()})),this.selection.on("focus",(function(t){e.focus(t)})),this.selection.on("*",(function(n,i){-1===t.inArray(n,r)&&e.trigger(n,i)}))},i.prototype._registerDropdownEvents=function(){var t=this;this.dropdown.on("*",(function(e,r){t.trigger(e,r)}))},i.prototype._registerResultsEvents=function(){var t=this;this.results.on("*",(function(e,r){t.trigger(e,r)}))},i.prototype._registerEvents=function(){var t=this;this.on("open",(function(){t.$container.addClass("select2-container--open")})),this.on("close",(function(){t.$container.removeClass("select2-container--open")})),this.on("enable",(function(){t.$container.removeClass("select2-container--disabled")})),this.on("disable",(function(){t.$container.addClass("select2-container--disabled")})),this.on("blur",(function(){t.$container.removeClass("select2-container--focus")})),this.on("query",(function(e){t.isOpen()||t.trigger("open",{}),this.dataAdapter.query(e,(function(r){t.trigger("results:all",{data:r,query:e})}))})),this.on("query:append",(function(e){this.dataAdapter.query(e,(function(r){t.trigger("results:append",{data:r,query:e})}))})),this.on("keypress",(function(e){var r=e.which;t.isOpen()?r===n.ESC||r===n.TAB||r===n.UP&&e.altKey?(t.close(e),e.preventDefault()):r===n.ENTER?(t.trigger("results:select",{}),e.preventDefault()):r===n.SPACE&&e.ctrlKey?(t.trigger("results:toggle",{}),e.preventDefault()):r===n.UP?(t.trigger("results:previous",{}),e.preventDefault()):r===n.DOWN&&(t.trigger("results:next",{}),e.preventDefault()):(r===n.ENTER||r===n.SPACE||r===n.DOWN&&e.altKey)&&(t.open(),e.preventDefault())}))},i.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.isDisabled()?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},i.prototype._isChangeMutation=function(e,r){var n=!1,i=this;if(!e||!e.target||"OPTION"===e.target.nodeName||"OPTGROUP"===e.target.nodeName){if(r)if(r.addedNodes&&r.addedNodes.length>0)for(var o=0;o<r.addedNodes.length;o++){var s=r.addedNodes[o];s.selected&&(n=!0)}else r.removedNodes&&r.removedNodes.length>0?n=!0:t.isArray(r)&&t.each(r,(function(t,e){if(i._isChangeMutation(t,e))return n=!0,!1}));else n=!0;return n}},i.prototype._syncSubtree=function(t,e){var r=this._isChangeMutation(t,e),n=this;r&&this.dataAdapter.current((function(t){n.trigger("selection:update",{data:t})}))},i.prototype.trigger=function(t,e){var r=i.__super__.trigger,n={open:"opening",close:"closing",select:"selecting",unselect:"unselecting",clear:"clearing"};if(void 0===e&&(e={}),t in n){var o=n[t],s={prevented:!1,name:t,args:e};if(r.call(this,o,s),s.prevented)return void(e.prevented=!0)}r.call(this,t,e)},i.prototype.toggleDropdown=function(){this.isDisabled()||(this.isOpen()?this.close():this.open())},i.prototype.open=function(){this.isOpen()||this.isDisabled()||this.trigger("query",{})},i.prototype.close=function(t){this.isOpen()&&this.trigger("close",{originalEvent:t})},i.prototype.isEnabled=function(){return!this.isDisabled()},i.prototype.isDisabled=function(){return this.options.get("disabled")},i.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},i.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},i.prototype.focus=function(t){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},i.prototype.enable=function(t){this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("enable")` method has been deprecated and will be removed in later Select2 versions. Use $element.prop("disabled") instead.'),null!=t&&0!==t.length||(t=[!0]);var e=!t[0];this.$element.prop("disabled",e)},i.prototype.data=function(){this.options.get("debug")&&arguments.length>0&&window.console&&console.warn&&console.warn('Select2: Data can no longer be set using `select2("data")`. You should consider setting the value instead using `$element.val()`.');var t=[];return this.dataAdapter.current((function(e){t=e})),t},i.prototype.val=function(e){if(this.options.get("debug")&&window.console&&console.warn&&console.warn('Select2: The `select2("val")` method has been deprecated and will be removed in later Select2 versions. Use $element.val() instead.'),null==e||0===e.length)return this.$element.val();var r=e[0];t.isArray(r)&&(r=t.map(r,(function(t){return t.toString()}))),this.$element.val(r).trigger("input").trigger("change")},i.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._syncA),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&(this.$element[0].removeEventListener("DOMAttrModified",this._syncA,!1),this.$element[0].removeEventListener("DOMNodeInserted",this._syncS,!1),this.$element[0].removeEventListener("DOMNodeRemoved",this._syncS,!1)),this._syncA=null,this._syncS=null,this.$element.off(".select2"),this.$element.attr("tabindex",r.GetData(this.$element[0],"old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),r.RemoveData(this.$element[0]),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},i.prototype.render=function(){var e=t('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return e.attr("dir",this.options.get("dir")),this.$container=e,this.$container.addClass("select2-container--"+this.options.get("theme")),r.StoreData(e[0],"element",this.$element),e},i})),e.define("jquery-mousewheel",["jquery"],(function(t){return t})),e.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults","./select2/utils"],(function(t,e,r,n,i){if(null==t.fn.select2){var o=["open","close","destroy"];t.fn.select2=function(e){if(e=e||{},"object"===typeof e)return this.each((function(){var n=t.extend(!0,{},e);new r(t(this),n)})),this;if("string"===typeof e){var n,s=Array.prototype.slice.call(arguments,1);return this.each((function(){var t=i.GetData(this,"select2");null==t&&window.console&&console.error&&console.error("The select2('"+e+"') method was called on an element that is not using Select2."),n=t[e].apply(t,s)})),t.inArray(e,o)>-1?this:n}throw new Error("Invalid arguments for Select2: "+e)}}return null==t.fn.select2.defaults&&(t.fn.select2.defaults=n),r})),{define:e.define,require:e.require}}(),r=e.require("jquery.select2");return t.fn.select2.amd=e,r}))}).call(this,r("1157"))},1212:function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this,r=l();e.next=function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)},e.c=1,e.s0=r(" "),e.s1=r(" "),e.s2=r(" "),e.s0-=r(t),e.s0<0&&(e.s0+=1),e.s1-=r(t),e.s1<0&&(e.s1+=1),e.s2-=r(t),e.s2<0&&(e.s2+=1),r=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function u(t,e){var r=new s(t),n=e&&e.state,i=r.next;return i.int32=function(){return 4294967296*r.next()|0},i.double=function(){return i()+11102230246251565e-32*(2097152*i()|0)},i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}function l(){var t=4022871197,e=function(e){e=String(e);for(var r=0;r<e.length;r++){t+=e.charCodeAt(r);var n=.02519603282416938*t;t=n>>>0,n-=t,n*=t,t=n>>>0,n-=t,t+=4294967296*n}return 2.3283064365386963e-10*(t>>>0)};return e}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.alea=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},"131a":function(t,e,r){var n=r("23e7"),i=r("d2bb");n({target:"Object",stat:!0},{setPrototypeOf:i})},"13d5":function(t,e,r){"use strict";var n=r("23e7"),i=r("d58f").left,o=r("a640"),s=r("ae40"),a=o("reduce"),u=s("reduce",{1:0});n({target:"Array",proto:!0,forced:!a||!u},{reduce:function(t){return i(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"143c":function(t,e,r){var n=r("74e8");n("Int32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},"145e":function(t,e,r){"use strict";var n=r("7b0b"),i=r("23cb"),o=r("50c4"),s=Math.min;t.exports=[].copyWithin||function(t,e){var r=n(this),a=o(r.length),u=i(t,a),l=i(e,a),c=arguments.length>2?arguments[2]:void 0,h=s((void 0===c?a:i(c,a))-l,a-u),d=1;l<u&&u<l+h&&(d=-1,l+=h-1,u+=h-1);while(h-- >0)l in r?r[u]=r[l]:delete r[u],u+=d,l+=d;return r}},"16c3":function(t,e,r){var n=r("1f8f"),i=r("74d0"),o=r("9052"),s=o.mat3,a=o.vec3,u=r("17fb"),l=t.exports=function(t){this.id=t.id,this.palmPosition=t.palmPosition,this.direction=t.direction,this.palmVelocity=t.palmVelocity,this.palmNormal=t.palmNormal,this.sphereCenter=t.sphereCenter,this.sphereRadius=t.sphereRadius,this.valid=!0,this.pointables=[],this.fingers=[],t.armBasis?this.arm=new i(this,{type:4,width:t.armWidth,prevJoint:t.elbow,nextJoint:t.wrist,basis:t.armBasis}):this.arm=null,this.tools=[],this._translation=t.t,this._rotation=u.flatten(t.r),this._scaleFactor=t.s,this.timeVisible=t.timeVisible,this.stabilizedPalmPosition=t.stabilizedPalmPosition,this.type=t.type,this.grabStrength=t.grabStrength,this.pinchStrength=t.pinchStrength,this.confidence=t.confidence};l.prototype.finger=function(t){var e=this.frame.finger(t);return e&&e.handId==this.id?e:n.Invalid},l.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var r=t.hand(this.id);if(!r.valid)return 0;var n=this.rotationMatrix(t),i=.5*(n[0]+n[4]+n[8]-1),o=Math.acos(i);if(o=isNaN(o)?0:o,void 0!==e){var s=this.rotationAxis(t);o*=a.dot(s,a.normalize(a.create(),e))}return o},l.prototype.rotationAxis=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?a.normalize(a.create(),[this._rotation[7]-e._rotation[5],this._rotation[2]-e._rotation[6],this._rotation[3]-e._rotation[1]]):a.create()},l.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return s.create();var e=t.hand(this.id);if(!e.valid)return s.create();var r=s.transpose(s.create(),this._rotation),n=s.multiply(s.create(),e._rotation,r);return n},l.prototype.scaleFactor=function(t){if(!this.valid||!t.valid)return 1;var e=t.hand(this.id);return e.valid?Math.exp(this._scaleFactor-e._scaleFactor):1},l.prototype.translation=function(t){if(!this.valid||!t.valid)return a.create();var e=t.hand(this.id);return e.valid?[this._translation[0]-e._translation[0],this._translation[1]-e._translation[1],this._translation[2]-e._translation[2]]:a.create()},l.prototype.toString=function(){return"Hand ("+this.type+") [ id: "+this.id+" | palm velocity:"+this.palmVelocity+" | sphere center:"+this.sphereCenter+" ] "},l.prototype.pitch=function(){return Math.atan2(this.direction[1],-this.direction[2])},l.prototype.yaw=function(){return Math.atan2(this.direction[0],-this.direction[2])},l.prototype.roll=function(){return Math.atan2(this.palmNormal[0],-this.palmNormal[1])},l.Invalid={valid:!1,fingers:[],tools:[],pointables:[],left:!1,pointable:function(){return n.Invalid},finger:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return s.create()},rotationAxis:function(){return a.create()},scaleFactor:function(){return 1},translation:function(){return a.create()}}},"170b":function(t,e,r){"use strict";var n=r("ebb5"),i=r("50c4"),o=r("23cb"),s=r("4840"),a=n.aTypedArray,u=n.exportTypedArrayMethod;u("subarray",(function(t,e){var r=a(this),n=r.length,u=o(t,n);return new(s(r,r.constructor))(r.buffer,r.byteOffset+u*r.BYTES_PER_ELEMENT,i((void 0===e?n:o(e,n))-u))}))},1739:function(t,e){var r=function(){this.functionType="atan",this.power={division:300,divisionRange:[1,1e4],power:1,powerRange:[0,3]},this.atan={division1:660,division1Range:[0,1e4],division2:.5,division2Range:[0,1]},this.asymp1={max:.5,maxRange:[0,1],min:.001,minRange:[0,.1],Vo:200,VoRange:[1,1e4]},this.asymp2={max:.001,maxRange:[0,.01],min:.001,minRange:[0,.01],Vo:1500,VoRange:[0,3e3]},this.mouseSize=10,this.frameOpacity=800,this.gainGraphFrames=200,this.resetPosition=function(){i.x=window.innerWidth/2,i.y=window.innerHeight/2}},n=new r,i={x:window.innerWidth/2,y:window.innerHeight/2},o=function(t){var e=s(t.tipVelocity[0],t.tipVelocity[1],n.functionType),r={x:i.x+e.x,y:i.y+e.y};return r.x>=window.innerWidth&&(r.x=window.innerWidth),r.x<=0&&(r.x=0),r.y>=window.innerHeight&&(r.y=window.innerHeight),r.y<=0&&(r.y=0),i=r,r};function s(t,e,r){var i=Math.sqrt(t*t+e*e),o=1;return"power"==r?o=Math.pow(i,n.power.power)/Math.pow(n.power.division,n.power.power):"atan"==r?o=Math.atan(i/n.atan.division1)/n.atan.division2:"asymp1"==r?o=n.asymp1.max*(1-Math.exp(-i/n.asymp1.Vo))+n.asymp1.min:"asymp2"==r&&(o=n.asymp2.max*i*Math.exp(-i/n.asymp2.Vo)+n.asymp2.min),toReturn={x:o*t,y:-o*e},toReturn}t.exports=o,t.exports.reset=n.resetPosition},"17fb":function(t,e,r){(function(){var r=this,n=r._,i={},o=Array.prototype,s=Object.prototype,a=Function.prototype,u=o.push,l=o.slice,c=o.concat,h=s.toString,d=s.hasOwnProperty,p=o.forEach,f=o.map,m=o.reduce,g=o.reduceRight,v=o.filter,y=o.every,w=o.some,b=o.indexOf,x=o.lastIndexOf,_=Array.isArray,S=Object.keys,M=a.bind,E=function(t){return t instanceof E?t:this instanceof E?void(this._wrapped=t):new E(t)};t.exports&&(e=t.exports=E),e._=E,E.VERSION="1.4.4";var T=E.each=E.forEach=function(t,e,r){if(null!=t)if(p&&t.forEach===p)t.forEach(e,r);else if(t.length===+t.length){for(var n=0,o=t.length;n<o;n++)if(e.call(r,t[n],n,t)===i)return}else for(var s in t)if(E.has(t,s)&&e.call(r,t[s],s,t)===i)return};E.map=E.collect=function(t,e,r){var n=[];return null==t?n:f&&t.map===f?t.map(e,r):(T(t,(function(t,i,o){n[n.length]=e.call(r,t,i,o)})),n)};var A="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),m&&t.reduce===m)return n&&(e=E.bind(e,n)),i?t.reduce(e,r):t.reduce(e);if(T(t,(function(t,o,s){i?r=e.call(n,r,t,o,s):(r=t,i=!0)})),!i)throw new TypeError(A);return r},E.reduceRight=E.foldr=function(t,e,r,n){var i=arguments.length>2;if(null==t&&(t=[]),g&&t.reduceRight===g)return n&&(e=E.bind(e,n)),i?t.reduceRight(e,r):t.reduceRight(e);var o=t.length;if(o!==+o){var s=E.keys(t);o=s.length}if(T(t,(function(a,u,l){u=s?s[--o]:--o,i?r=e.call(n,r,t[u],u,l):(r=t[u],i=!0)})),!i)throw new TypeError(A);return r},E.find=E.detect=function(t,e,r){var n;return P(t,(function(t,i,o){if(e.call(r,t,i,o))return n=t,!0})),n},E.filter=E.select=function(t,e,r){var n=[];return null==t?n:v&&t.filter===v?t.filter(e,r):(T(t,(function(t,i,o){e.call(r,t,i,o)&&(n[n.length]=t)})),n)},E.reject=function(t,e,r){return E.filter(t,(function(t,n,i){return!e.call(r,t,n,i)}),r)},E.every=E.all=function(t,e,r){e||(e=E.identity);var n=!0;return null==t?n:y&&t.every===y?t.every(e,r):(T(t,(function(t,o,s){if(!(n=n&&e.call(r,t,o,s)))return i})),!!n)};var P=E.some=E.any=function(t,e,r){e||(e=E.identity);var n=!1;return null==t?n:w&&t.some===w?t.some(e,r):(T(t,(function(t,o,s){if(n||(n=e.call(r,t,o,s)))return i})),!!n)};E.contains=E.include=function(t,e){return null!=t&&(b&&t.indexOf===b?-1!=t.indexOf(e):P(t,(function(t){return t===e})))},E.invoke=function(t,e){var r=l.call(arguments,2),n=E.isFunction(e);return E.map(t,(function(t){return(n?e:t[e]).apply(t,r)}))},E.pluck=function(t,e){return E.map(t,(function(t){return t[e]}))},E.where=function(t,e,r){return E.isEmpty(e)?r?null:[]:E[r?"find":"filter"](t,(function(t){for(var r in e)if(e[r]!==t[r])return!1;return!0}))},E.findWhere=function(t,e){return E.where(t,e,!0)},E.max=function(t,e,r){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);if(!e&&E.isEmpty(t))return-1/0;var n={computed:-1/0,value:-1/0};return T(t,(function(t,i,o){var s=e?e.call(r,t,i,o):t;s>=n.computed&&(n={value:t,computed:s})})),n.value},E.min=function(t,e,r){if(!e&&E.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);if(!e&&E.isEmpty(t))return 1/0;var n={computed:1/0,value:1/0};return T(t,(function(t,i,o){var s=e?e.call(r,t,i,o):t;s<n.computed&&(n={value:t,computed:s})})),n.value},E.shuffle=function(t){var e,r=0,n=[];return T(t,(function(t){e=E.random(r++),n[r-1]=n[e],n[e]=t})),n};var C=function(t){return E.isFunction(t)?t:function(e){return e[t]}};E.sortBy=function(t,e,r){var n=C(e);return E.pluck(E.map(t,(function(t,e,i){return{value:t,index:e,criteria:n.call(r,t,e,i)}})).sort((function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index<e.index?-1:1})),"value")};var R=function(t,e,r,n){var i={},o=C(e||E.identity);return T(t,(function(e,s){var a=o.call(r,e,s,t);n(i,a,e)})),i};E.groupBy=function(t,e,r){return R(t,e,r,(function(t,e,r){(E.has(t,e)?t[e]:t[e]=[]).push(r)}))},E.countBy=function(t,e,r){return R(t,e,r,(function(t,e){E.has(t,e)||(t[e]=0),t[e]++}))},E.sortedIndex=function(t,e,r,n){r=null==r?E.identity:C(r);var i=r.call(n,e),o=0,s=t.length;while(o<s){var a=o+s>>>1;r.call(n,t[a])<i?o=a+1:s=a}return o},E.toArray=function(t){return t?E.isArray(t)?l.call(t):t.length===+t.length?E.map(t,E.identity):E.values(t):[]},E.size=function(t){return null==t?0:t.length===+t.length?t.length:E.keys(t).length},E.first=E.head=E.take=function(t,e,r){if(null!=t)return null==e||r?t[0]:l.call(t,0,e)},E.initial=function(t,e,r){return l.call(t,0,t.length-(null==e||r?1:e))},E.last=function(t,e,r){if(null!=t)return null==e||r?t[t.length-1]:l.call(t,Math.max(t.length-e,0))},E.rest=E.tail=E.drop=function(t,e,r){return l.call(t,null==e||r?1:e)},E.compact=function(t){return E.filter(t,E.identity)};var L=function(t,e,r){return T(t,(function(t){E.isArray(t)?e?u.apply(r,t):L(t,e,r):r.push(t)})),r};E.flatten=function(t,e){return L(t,e,[])},E.without=function(t){return E.difference(t,l.call(arguments,1))},E.uniq=E.unique=function(t,e,r,n){E.isFunction(e)&&(n=r,r=e,e=!1);var i=r?E.map(t,r,n):t,o=[],s=[];return T(i,(function(r,n){(e?n&&s[s.length-1]===r:E.contains(s,r))||(s.push(r),o.push(t[n]))})),o},E.union=function(){return E.uniq(c.apply(o,arguments))},E.intersection=function(t){var e=l.call(arguments,1);return E.filter(E.uniq(t),(function(t){return E.every(e,(function(e){return E.indexOf(e,t)>=0}))}))},E.difference=function(t){var e=c.apply(o,l.call(arguments,1));return E.filter(t,(function(t){return!E.contains(e,t)}))},E.zip=function(){for(var t=l.call(arguments),e=E.max(E.pluck(t,"length")),r=new Array(e),n=0;n<e;n++)r[n]=E.pluck(t,""+n);return r},E.object=function(t,e){if(null==t)return{};for(var r={},n=0,i=t.length;n<i;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r},E.indexOf=function(t,e,r){if(null==t)return-1;var n=0,i=t.length;if(r){if("number"!=typeof r)return n=E.sortedIndex(t,e),t[n]===e?n:-1;n=r<0?Math.max(0,i+r):r}if(b&&t.indexOf===b)return t.indexOf(e,r);for(;n<i;n++)if(t[n]===e)return n;return-1},E.lastIndexOf=function(t,e,r){if(null==t)return-1;var n=null!=r;if(x&&t.lastIndexOf===x)return n?t.lastIndexOf(e,r):t.lastIndexOf(e);var i=n?r:t.length;while(i--)if(t[i]===e)return i;return-1},E.range=function(t,e,r){arguments.length<=1&&(e=t||0,t=0),r=arguments[2]||1;var n=Math.max(Math.ceil((e-t)/r),0),i=0,o=new Array(n);while(i<n)o[i++]=t,t+=r;return o},E.bind=function(t,e){if(t.bind===M&&M)return M.apply(t,l.call(arguments,1));var r=l.call(arguments,2);return function(){return t.apply(e,r.concat(l.call(arguments)))}},E.partial=function(t){var e=l.call(arguments,1);return function(){return t.apply(this,e.concat(l.call(arguments)))}},E.bindAll=function(t){var e=l.call(arguments,1);return 0===e.length&&(e=E.functions(t)),T(e,(function(e){t[e]=E.bind(t[e],t)})),t},E.memoize=function(t,e){var r={};return e||(e=E.identity),function(){var n=e.apply(this,arguments);return E.has(r,n)?r[n]:r[n]=t.apply(this,arguments)}},E.delay=function(t,e){var r=l.call(arguments,2);return setTimeout((function(){return t.apply(null,r)}),e)},E.defer=function(t){return E.delay.apply(E,[t,1].concat(l.call(arguments,1)))},E.throttle=function(t,e){var r,n,i,o,s=0,a=function(){s=new Date,i=null,o=t.apply(r,n)};return function(){var u=new Date,l=e-(u-s);return r=this,n=arguments,l<=0?(clearTimeout(i),i=null,s=u,o=t.apply(r,n)):i||(i=setTimeout(a,l)),o}},E.debounce=function(t,e,r){var n,i;return function(){var o=this,s=arguments,a=function(){n=null,r||(i=t.apply(o,s))},u=r&&!n;return clearTimeout(n),n=setTimeout(a,e),u&&(i=t.apply(o,s)),i}},E.once=function(t){var e,r=!1;return function(){return r||(r=!0,e=t.apply(this,arguments),t=null),e}},E.wrap=function(t,e){return function(){var r=[t];return u.apply(r,arguments),e.apply(this,r)}},E.compose=function(){var t=arguments;return function(){for(var e=arguments,r=t.length-1;r>=0;r--)e=[t[r].apply(this,e)];return e[0]}},E.after=function(t,e){return t<=0?e():function(){if(--t<1)return e.apply(this,arguments)}},E.keys=S||function(t){if(t!==Object(t))throw new TypeError("Invalid object");var e=[];for(var r in t)E.has(t,r)&&(e[e.length]=r);return e},E.values=function(t){var e=[];for(var r in t)E.has(t,r)&&e.push(t[r]);return e},E.pairs=function(t){var e=[];for(var r in t)E.has(t,r)&&e.push([r,t[r]]);return e},E.invert=function(t){var e={};for(var r in t)E.has(t,r)&&(e[t[r]]=r);return e},E.functions=E.methods=function(t){var e=[];for(var r in t)E.isFunction(t[r])&&e.push(r);return e.sort()},E.extend=function(t){return T(l.call(arguments,1),(function(e){if(e)for(var r in e)t[r]=e[r]})),t},E.pick=function(t){var e={},r=c.apply(o,l.call(arguments,1));return T(r,(function(r){r in t&&(e[r]=t[r])})),e},E.omit=function(t){var e={},r=c.apply(o,l.call(arguments,1));for(var n in t)E.contains(r,n)||(e[n]=t[n]);return e},E.defaults=function(t){return T(l.call(arguments,1),(function(e){if(e)for(var r in e)null==t[r]&&(t[r]=e[r])})),t},E.clone=function(t){return E.isObject(t)?E.isArray(t)?t.slice():E.extend({},t):t},E.tap=function(t,e){return e(t),t};var O=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof E&&(t=t._wrapped),e instanceof E&&(e=e._wrapped);var i=h.call(t);if(i!=h.call(e))return!1;switch(i){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;var o=r.length;while(o--)if(r[o]==t)return n[o]==e;r.push(t),n.push(e);var s=0,a=!0;if("[object Array]"==i){if(s=t.length,a=s==e.length,a)while(s--)if(!(a=O(t[s],e[s],r,n)))break}else{var u=t.constructor,l=e.constructor;if(u!==l&&!(E.isFunction(u)&&u instanceof u&&E.isFunction(l)&&l instanceof l))return!1;for(var c in t)if(E.has(t,c)&&(s++,!(a=E.has(e,c)&&O(t[c],e[c],r,n))))break;if(a){for(c in e)if(E.has(e,c)&&!s--)break;a=!s}}return r.pop(),n.pop(),a};E.isEqual=function(t,e){return O(t,e,[],[])},E.isEmpty=function(t){if(null==t)return!0;if(E.isArray(t)||E.isString(t))return 0===t.length;for(var e in t)if(E.has(t,e))return!1;return!0},E.isElement=function(t){return!(!t||1!==t.nodeType)},E.isArray=_||function(t){return"[object Array]"==h.call(t)},E.isObject=function(t){return t===Object(t)},T(["Arguments","Function","String","Number","Date","RegExp"],(function(t){E["is"+t]=function(e){return h.call(e)=="[object "+t+"]"}})),E.isArguments(arguments)||(E.isArguments=function(t){return!(!t||!E.has(t,"callee"))}),E.isFunction=function(t){return"function"===typeof t},E.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},E.isNaN=function(t){return E.isNumber(t)&&t!=+t},E.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"==h.call(t)},E.isNull=function(t){return null===t},E.isUndefined=function(t){return void 0===t},E.has=function(t,e){return d.call(t,e)},E.noConflict=function(){return r._=n,this},E.identity=function(t){return t},E.times=function(t,e,r){for(var n=Array(t),i=0;i<t;i++)n[i]=e.call(r,i);return n},E.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))};var I={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};I.unescape=E.invert(I.escape);var D={escape:new RegExp("["+E.keys(I.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(I.unescape).join("|")+")","g")};E.each(["escape","unescape"],(function(t){E[t]=function(e){return null==e?"":(""+e).replace(D[t],(function(e){return I[t][e]}))}})),E.result=function(t,e){if(null==t)return null;var r=t[e];return E.isFunction(r)?r.call(t):r},E.mixin=function(t){T(E.functions(t),(function(e){var r=E[e]=t[e];E.prototype[e]=function(){var t=[this._wrapped];return u.apply(t,arguments),z.call(this,r.apply(E,t))}}))};var N=0;E.uniqueId=function(t){var e=++N+"";return t?t+e:e},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var k=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},V=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(t,e,r){var n;r=E.defaults({},r,E.templateSettings);var i=new RegExp([(r.escape||k).source,(r.interpolate||k).source,(r.evaluate||k).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,(function(e,r,n,i,a){return s+=t.slice(o,a).replace(V,(function(t){return"\\"+F[t]})),r&&(s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'"),n&&(s+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),i&&(s+="';\n"+i+"\n__p+='"),o=a+e.length,e})),s+="';\n",r.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(r.variable||"obj","_",s)}catch(u){throw u.source=s,u}if(e)return n(e,E);var a=function(t){return n.call(this,t,E)};return a.source="function("+(r.variable||"obj")+"){\n"+s+"}",a},E.chain=function(t){return E(t).chain()};var z=function(t){return this._chain?E(t).chain():t};E.mixin(E),T(["pop","push","reverse","shift","sort","splice","unshift"],(function(t){var e=o[t];E.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!=t&&"splice"!=t||0!==r.length||delete r[0],z.call(this,r)}})),T(["concat","join","slice"],(function(t){var e=o[t];E.prototype[t]=function(){return z.call(this,e.apply(this._wrapped,arguments))}})),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this)},"182d":function(t,e,r){var n=r("f8cd");t.exports=function(t,e){var r=n(t);if(r%e)throw RangeError("Wrong offset");return r}},1985:function(t,e,r){(function(t,n){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */(function(o){e&&e.nodeType,t&&t.nodeType;var s="object"==typeof n&&n;s.global!==s&&s.window!==s&&s.self;var a,u=2147483647,l=36,c=1,h=26,d=38,p=700,f=72,m=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,w=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},x=l-c,_=Math.floor,S=String.fromCharCode;function M(t){throw new RangeError(b[t])}function E(t,e){var r=t.length,n=[];while(r--)n[r]=e(t[r]);return n}function T(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(w,".");var i=t.split("."),o=E(i,e).join(".");return n+o}function A(t){var e,r,n=[],i=0,o=t.length;while(i<o)e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<o?(r=t.charCodeAt(i++),56320==(64512&r)?n.push(((1023&e)<<10)+(1023&r)+65536):(n.push(e),i--)):n.push(e);return n}function P(t){return E(t,(function(t){var e="";return t>65535&&(t-=65536,e+=S(t>>>10&1023|55296),t=56320|1023&t),e+=S(t),e})).join("")}function C(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:l}function R(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function L(t,e,r){var n=0;for(t=r?_(t/p):t>>1,t+=_(t/e);t>x*h>>1;n+=l)t=_(t/x);return _(n+(x+1)*t/(t+d))}function O(t){var e,r,n,i,o,s,a,d,p,v,y=[],w=t.length,b=0,x=m,S=f;for(r=t.lastIndexOf(g),r<0&&(r=0),n=0;n<r;++n)t.charCodeAt(n)>=128&&M("not-basic"),y.push(t.charCodeAt(n));for(i=r>0?r+1:0;i<w;){for(o=b,s=1,a=l;;a+=l){if(i>=w&&M("invalid-input"),d=C(t.charCodeAt(i++)),(d>=l||d>_((u-b)/s))&&M("overflow"),b+=d*s,p=a<=S?c:a>=S+h?h:a-S,d<p)break;v=l-p,s>_(u/v)&&M("overflow"),s*=v}e=y.length+1,S=L(b-o,e,0==o),_(b/e)>u-x&&M("overflow"),x+=_(b/e),b%=e,y.splice(b++,0,x)}return P(y)}function I(t){var e,r,n,i,o,s,a,d,p,v,y,w,b,x,E,T=[];for(t=A(t),w=t.length,e=m,r=0,o=f,s=0;s<w;++s)y=t[s],y<128&&T.push(S(y));n=i=T.length,i&&T.push(g);while(n<w){for(a=u,s=0;s<w;++s)y=t[s],y>=e&&y<a&&(a=y);for(b=n+1,a-e>_((u-r)/b)&&M("overflow"),r+=(a-e)*b,e=a,s=0;s<w;++s)if(y=t[s],y<e&&++r>u&&M("overflow"),y==e){for(d=r,p=l;;p+=l){if(v=p<=o?c:p>=o+h?h:p-o,d<v)break;E=d-v,x=l-v,T.push(S(R(v+E%x,0))),d=_(E/x)}T.push(S(R(d,0))),o=L(r,b,n==i),r=0,++n}++r,++e}return T.join("")}function D(t){return T(t,(function(t){return v.test(t)?O(t.slice(4).toLowerCase()):t}))}function N(t){return T(t,(function(t){return y.test(t)?"xn--"+I(t):t}))}a={version:"1.4.1",ucs2:{decode:A,encode:P},decode:O,encode:I,toASCII:N,toUnicode:D},i=function(){return a}.call(e,r,e,t),void 0===i||(t.exports=i)})()}).call(this,r("62e4")(t),r("c8ba"))},"1f03":function(t,e,r){"use strict";t.exports=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}},"1f25":function(t,e,r){"use strict";const n=r("5cf7"),i=Symbol("max"),o=Symbol("length"),s=Symbol("lengthCalculator"),a=Symbol("allowStale"),u=Symbol("maxAge"),l=Symbol("dispose"),c=Symbol("noDisposeOnSet"),h=Symbol("lruList"),d=Symbol("cache"),p=Symbol("updateAgeOnGet"),f=()=>1;class m{constructor(t){if("number"===typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!==typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;const e=t.length||f;if(this[s]="function"!==typeof e?f:e,this[a]=t.stale||!1,t.maxAge&&"number"!==typeof t.maxAge)throw new TypeError("maxAge must be a number");this[u]=t.maxAge||0,this[l]=t.dispose,this[c]=t.noDisposeOnSet||!1,this[p]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!==typeof t||t<0)throw new TypeError("max must be a non-negative number");this[i]=t||1/0,y(this)}get max(){return this[i]}set allowStale(t){this[a]=!!t}get allowStale(){return this[a]}set maxAge(t){if("number"!==typeof t)throw new TypeError("maxAge must be a non-negative number");this[u]=t,y(this)}get maxAge(){return this[u]}set lengthCalculator(t){"function"!==typeof t&&(t=f),t!==this[s]&&(this[s]=t,this[o]=0,this[h].forEach(t=>{t.length=this[s](t.value,t.key),this[o]+=t.length})),y(this)}get lengthCalculator(){return this[s]}get length(){return this[o]}get itemCount(){return this[h].length}rforEach(t,e){e=e||this;for(let r=this[h].tail;null!==r;){const n=r.prev;x(this,t,r,e),r=n}}forEach(t,e){e=e||this;for(let r=this[h].head;null!==r;){const n=r.next;x(this,t,r,e),r=n}}keys(){return this[h].toArray().map(t=>t.key)}values(){return this[h].toArray().map(t=>t.value)}reset(){this[l]&&this[h]&&this[h].length&&this[h].forEach(t=>this[l](t.key,t.value)),this[d]=new Map,this[h]=new n,this[o]=0}dump(){return this[h].map(t=>!v(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[h]}set(t,e,r){if(r=r||this[u],r&&"number"!==typeof r)throw new TypeError("maxAge must be a number");const n=r?Date.now():0,a=this[s](e,t);if(this[d].has(t)){if(a>this[i])return w(this,this[d].get(t)),!1;const s=this[d].get(t),u=s.value;return this[l]&&(this[c]||this[l](t,u.value)),u.now=n,u.maxAge=r,u.value=e,this[o]+=a-u.length,u.length=a,this.get(t),y(this),!0}const p=new b(t,e,a,n,r);return p.length>this[i]?(this[l]&&this[l](t,e),!1):(this[o]+=p.length,this[h].unshift(p),this[d].set(t,this[h].head),y(this),!0)}has(t){if(!this[d].has(t))return!1;const e=this[d].get(t).value;return!v(this,e)}get(t){return g(this,t,!0)}peek(t){return g(this,t,!1)}pop(){const t=this[h].tail;return t?(w(this,t),t.value):null}del(t){w(this,this[d].get(t))}load(t){this.reset();const e=Date.now();for(let r=t.length-1;r>=0;r--){const n=t[r],i=n.e||0;if(0===i)this.set(n.k,n.v);else{const t=i-e;t>0&&this.set(n.k,n.v,t)}}}prune(){this[d].forEach((t,e)=>g(this,e,!1))}}const g=(t,e,r)=>{const n=t[d].get(e);if(n){const e=n.value;if(v(t,e)){if(w(t,n),!t[a])return}else r&&(t[p]&&(n.value.now=Date.now()),t[h].unshiftNode(n));return e.value}},v=(t,e)=>{if(!e||!e.maxAge&&!t[u])return!1;const r=Date.now()-e.now;return e.maxAge?r>e.maxAge:t[u]&&r>t[u]},y=t=>{if(t[o]>t[i])for(let e=t[h].tail;t[o]>t[i]&&null!==e;){const r=e.prev;w(t,e),e=r}},w=(t,e)=>{if(e){const r=e.value;t[l]&&t[l](r.key,r.value),t[o]-=r.length,t[d].delete(r.key),t[h].removeNode(e)}};class b{constructor(t,e,r,n,i){this.key=t,this.value=e,this.length=r,this.now=n,this.maxAge=i||0}}const x=(t,e,r,n)=>{let i=r.value;v(t,i)&&(w(t,r),t[a]||(i=void 0)),i&&e.call(n,i.value,i.key,t)};t.exports=m},"1f8f":function(t,e,r){var n=r("9052"),i=(n.vec3,t.exports=function(t){this.valid=!0,this.id=t.id,this.handId=t.handId,this.length=t.length,this.tool=t.tool,this.width=t.width,this.direction=t.direction,this.stabilizedTipPosition=t.stabilizedTipPosition,this.tipPosition=t.tipPosition,this.tipVelocity=t.tipVelocity,this.touchZone=t.touchZone,this.touchDistance=t.touchDistance,this.timeVisible=t.timeVisible});i.prototype.toString=function(){return"Pointable [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},i.prototype.hand=function(){return this.frame.hand(this.handId)},i.Invalid={valid:!1}},"219c":function(t,e,r){"use strict";var n=r("ebb5"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=[].sort;o("sort",(function(t){return s.call(i(this),t)}))},"25a1":function(t,e,r){"use strict";var n=r("ebb5"),i=r("d58f").right,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduceRight",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},2954:function(t,e,r){"use strict";var n=r("ebb5"),i=r("4840"),o=r("d039"),s=n.aTypedArray,a=n.aTypedArrayConstructor,u=n.exportTypedArrayMethod,l=[].slice,c=o((function(){new Int8Array(1).slice()}));u("slice",(function(t,e){var r=l.call(s(this),t,e),n=i(this,this.constructor),o=0,u=r.length,c=new(a(n))(u);while(u>o)c[o]=r[o++];return c}),c)},"2ca0":function(t,e,r){"use strict";var n=r("23e7"),i=r("06cf").f,o=r("50c4"),s=r("5a34"),a=r("1d80"),u=r("ab13"),l=r("c430"),c="".startsWith,h=Math.min,d=u("startsWith"),p=!l&&!d&&!!function(){var t=i(String.prototype,"startsWith");return t&&!t.writable}();n({target:"String",proto:!0,forced:!p&&!d},{startsWith:function(t){var e=String(a(this));s(t);var r=o(h(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return c?c.call(e,n,r):e.slice(r,r+n.length)===n}})},"2ef0":function(t,e,r){(function(t,n){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var o,s="4.17.19",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",c="__lodash_hash_undefined__",h=500,d="__lodash_placeholder__",p=1,f=2,m=4,g=1,v=2,y=1,w=2,b=4,x=8,_=16,S=32,M=64,E=128,T=256,A=512,P=30,C="...",R=800,L=16,O=1,I=2,D=3,N=1/0,k=9007199254740991,F=17976931348623157e292,V=NaN,z=4294967295,U=z-1,j=z>>>1,B=[["ary",E],["bind",y],["bindKey",w],["curry",x],["curryRight",_],["flip",A],["partial",S],["partialRight",M],["rearg",T]],H="[object Arguments]",G="[object Array]",q="[object AsyncFunction]",W="[object Boolean]",$="[object Date]",X="[object DOMException]",Y="[object Error]",Z="[object Function]",J="[object GeneratorFunction]",Q="[object Map]",K="[object Number]",tt="[object Null]",et="[object Object]",rt="[object Promise]",nt="[object Proxy]",it="[object RegExp]",ot="[object Set]",st="[object String]",at="[object Symbol]",ut="[object Undefined]",lt="[object WeakMap]",ct="[object WeakSet]",ht="[object ArrayBuffer]",dt="[object DataView]",pt="[object Float32Array]",ft="[object Float64Array]",mt="[object Int8Array]",gt="[object Int16Array]",vt="[object Int32Array]",yt="[object Uint8Array]",wt="[object Uint8ClampedArray]",bt="[object Uint16Array]",xt="[object Uint32Array]",_t=/\b__p \+= '';/g,St=/\b(__p \+=) '' \+/g,Mt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Et=/&(?:amp|lt|gt|quot|#39);/g,Tt=/[&<>"']/g,At=RegExp(Et.source),Pt=RegExp(Tt.source),Ct=/<%-([\s\S]+?)%>/g,Rt=/<%([\s\S]+?)%>/g,Lt=/<%=([\s\S]+?)%>/g,Ot=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,It=/^\w*$/,Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Nt=/[\\^$.*+?()[\]{}|]/g,kt=RegExp(Nt.source),Ft=/^\s+|\s+$/g,Vt=/^\s+/,zt=/\s+$/,Ut=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,jt=/\{\n\/\* \[wrapped with (.+)\] \*/,Bt=/,? & /,Ht=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Gt=/\\(\\)?/g,qt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Wt=/\w*$/,$t=/^[-+]0x[0-9a-f]+$/i,Xt=/^0b[01]+$/i,Yt=/^\[object .+?Constructor\]$/,Zt=/^0o[0-7]+$/i,Jt=/^(?:0|[1-9]\d*)$/,Qt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Kt=/($^)/,te=/['\n\r\u2028\u2029\\]/g,ee="\\ud800-\\udfff",re="\\u0300-\\u036f",ne="\\ufe20-\\ufe2f",ie="\\u20d0-\\u20ff",oe=re+ne+ie,se="\\u2700-\\u27bf",ae="a-z\\xdf-\\xf6\\xf8-\\xff",ue="\\xac\\xb1\\xd7\\xf7",le="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ce="\\u2000-\\u206f",he=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",de="A-Z\\xc0-\\xd6\\xd8-\\xde",pe="\\ufe0e\\ufe0f",fe=ue+le+ce+he,me="['’]",ge="["+ee+"]",ve="["+fe+"]",ye="["+oe+"]",we="\\d+",be="["+se+"]",xe="["+ae+"]",_e="[^"+ee+fe+we+se+ae+de+"]",Se="\\ud83c[\\udffb-\\udfff]",Me="(?:"+ye+"|"+Se+")",Ee="[^"+ee+"]",Te="(?:\\ud83c[\\udde6-\\uddff]){2}",Ae="[\\ud800-\\udbff][\\udc00-\\udfff]",Pe="["+de+"]",Ce="\\u200d",Re="(?:"+xe+"|"+_e+")",Le="(?:"+Pe+"|"+_e+")",Oe="(?:"+me+"(?:d|ll|m|re|s|t|ve))?",Ie="(?:"+me+"(?:D|LL|M|RE|S|T|VE))?",De=Me+"?",Ne="["+pe+"]?",ke="(?:"+Ce+"(?:"+[Ee,Te,Ae].join("|")+")"+Ne+De+")*",Fe="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ve="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ze=Ne+De+ke,Ue="(?:"+[be,Te,Ae].join("|")+")"+ze,je="(?:"+[Ee+ye+"?",ye,Te,Ae,ge].join("|")+")",Be=RegExp(me,"g"),He=RegExp(ye,"g"),Ge=RegExp(Se+"(?="+Se+")|"+je+ze,"g"),qe=RegExp([Pe+"?"+xe+"+"+Oe+"(?="+[ve,Pe,"$"].join("|")+")",Le+"+"+Ie+"(?="+[ve,Pe+Re,"$"].join("|")+")",Pe+"?"+Re+"+"+Oe,Pe+"+"+Ie,Ve,Fe,we,Ue].join("|"),"g"),We=RegExp("["+Ce+ee+oe+pe+"]"),$e=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Xe=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ye=-1,Ze={};Ze[pt]=Ze[ft]=Ze[mt]=Ze[gt]=Ze[vt]=Ze[yt]=Ze[wt]=Ze[bt]=Ze[xt]=!0,Ze[H]=Ze[G]=Ze[ht]=Ze[W]=Ze[dt]=Ze[$]=Ze[Y]=Ze[Z]=Ze[Q]=Ze[K]=Ze[et]=Ze[it]=Ze[ot]=Ze[st]=Ze[lt]=!1;var Je={};Je[H]=Je[G]=Je[ht]=Je[dt]=Je[W]=Je[$]=Je[pt]=Je[ft]=Je[mt]=Je[gt]=Je[vt]=Je[Q]=Je[K]=Je[et]=Je[it]=Je[ot]=Je[st]=Je[at]=Je[yt]=Je[wt]=Je[bt]=Je[xt]=!0,Je[Y]=Je[Z]=Je[lt]=!1;var Qe={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"},Ke={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tr={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},er={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},rr=parseFloat,nr=parseInt,ir="object"==typeof t&&t&&t.Object===Object&&t,or="object"==typeof self&&self&&self.Object===Object&&self,sr=ir||or||Function("return this")(),ar=e&&!e.nodeType&&e,ur=ar&&"object"==typeof n&&n&&!n.nodeType&&n,lr=ur&&ur.exports===ar,cr=lr&&ir.process,hr=function(){try{var t=ur&&ur.require&&ur.require("util").types;return t||cr&&cr.binding&&cr.binding("util")}catch(e){}}(),dr=hr&&hr.isArrayBuffer,pr=hr&&hr.isDate,fr=hr&&hr.isMap,mr=hr&&hr.isRegExp,gr=hr&&hr.isSet,vr=hr&&hr.isTypedArray;function yr(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function wr(t,e,r,n){var i=-1,o=null==t?0:t.length;while(++i<o){var s=t[i];e(n,s,r(s),t)}return n}function br(t,e){var r=-1,n=null==t?0:t.length;while(++r<n)if(!1===e(t[r],r,t))break;return t}function xr(t,e){var r=null==t?0:t.length;while(r--)if(!1===e(t[r],r,t))break;return t}function _r(t,e){var r=-1,n=null==t?0:t.length;while(++r<n)if(!e(t[r],r,t))return!1;return!0}function Sr(t,e){var r=-1,n=null==t?0:t.length,i=0,o=[];while(++r<n){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}function Mr(t,e){var r=null==t?0:t.length;return!!r&&kr(t,e,0)>-1}function Er(t,e,r){var n=-1,i=null==t?0:t.length;while(++n<i)if(r(e,t[n]))return!0;return!1}function Tr(t,e){var r=-1,n=null==t?0:t.length,i=Array(n);while(++r<n)i[r]=e(t[r],r,t);return i}function Ar(t,e){var r=-1,n=e.length,i=t.length;while(++r<n)t[i+r]=e[r];return t}function Pr(t,e,r,n){var i=-1,o=null==t?0:t.length;n&&o&&(r=t[++i]);while(++i<o)r=e(r,t[i],i,t);return r}function Cr(t,e,r,n){var i=null==t?0:t.length;n&&i&&(r=t[--i]);while(i--)r=e(r,t[i],i,t);return r}function Rr(t,e){var r=-1,n=null==t?0:t.length;while(++r<n)if(e(t[r],r,t))return!0;return!1}var Lr=Ur("length");function Or(t){return t.split("")}function Ir(t){return t.match(Ht)||[]}function Dr(t,e,r){var n;return r(t,(function(t,r,i){if(e(t,r,i))return n=r,!1})),n}function Nr(t,e,r,n){var i=t.length,o=r+(n?1:-1);while(n?o--:++o<i)if(e(t[o],o,t))return o;return-1}function kr(t,e,r){return e===e?dn(t,e,r):Nr(t,Vr,r)}function Fr(t,e,r,n){var i=r-1,o=t.length;while(++i<o)if(n(t[i],e))return i;return-1}function Vr(t){return t!==t}function zr(t,e){var r=null==t?0:t.length;return r?Gr(t,e)/r:V}function Ur(t){return function(e){return null==e?o:e[t]}}function jr(t){return function(e){return null==t?o:t[e]}}function Br(t,e,r,n,i){return i(t,(function(t,i,o){r=n?(n=!1,t):e(r,t,i,o)})),r}function Hr(t,e){var r=t.length;t.sort(e);while(r--)t[r]=t[r].value;return t}function Gr(t,e){var r,n=-1,i=t.length;while(++n<i){var s=e(t[n]);s!==o&&(r=r===o?s:r+s)}return r}function qr(t,e){var r=-1,n=Array(t);while(++r<t)n[r]=e(r);return n}function Wr(t,e){return Tr(e,(function(e){return[e,t[e]]}))}function $r(t){return function(e){return t(e)}}function Xr(t,e){return Tr(e,(function(e){return t[e]}))}function Yr(t,e){return t.has(e)}function Zr(t,e){var r=-1,n=t.length;while(++r<n&&kr(e,t[r],0)>-1);return r}function Jr(t,e){var r=t.length;while(r--&&kr(e,t[r],0)>-1);return r}function Qr(t,e){var r=t.length,n=0;while(r--)t[r]===e&&++n;return n}var Kr=jr(Qe),tn=jr(Ke);function en(t){return"\\"+er[t]}function rn(t,e){return null==t?o:t[e]}function nn(t){return We.test(t)}function on(t){return $e.test(t)}function sn(t){var e,r=[];while(!(e=t.next()).done)r.push(e.value);return r}function an(t){var e=-1,r=Array(t.size);return t.forEach((function(t,n){r[++e]=[n,t]})),r}function un(t,e){return function(r){return t(e(r))}}function ln(t,e){var r=-1,n=t.length,i=0,o=[];while(++r<n){var s=t[r];s!==e&&s!==d||(t[r]=d,o[i++]=r)}return o}function cn(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=t})),r}function hn(t){var e=-1,r=Array(t.size);return t.forEach((function(t){r[++e]=[t,t]})),r}function dn(t,e,r){var n=r-1,i=t.length;while(++n<i)if(t[n]===e)return n;return-1}function pn(t,e,r){var n=r+1;while(n--)if(t[n]===e)return n;return n}function fn(t){return nn(t)?vn(t):Lr(t)}function mn(t){return nn(t)?yn(t):Or(t)}var gn=jr(tr);function vn(t){var e=Ge.lastIndex=0;while(Ge.test(t))++e;return e}function yn(t){return t.match(Ge)||[]}function wn(t){return t.match(qe)||[]}var bn=function t(e){e=null==e?sr:xn.defaults(sr.Object(),e,xn.pick(sr,Xe));var r=e.Array,n=e.Date,i=e.Error,Ht=e.Function,ee=e.Math,re=e.Object,ne=e.RegExp,ie=e.String,oe=e.TypeError,se=r.prototype,ae=Ht.prototype,ue=re.prototype,le=e["__core-js_shared__"],ce=ae.toString,he=ue.hasOwnProperty,de=0,pe=function(){var t=/[^.]+$/.exec(le&&le.keys&&le.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),fe=ue.toString,me=ce.call(re),ge=sr._,ve=ne("^"+ce.call(he).replace(Nt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ye=lr?e.Buffer:o,we=e.Symbol,be=e.Uint8Array,xe=ye?ye.allocUnsafe:o,_e=un(re.getPrototypeOf,re),Se=re.create,Me=ue.propertyIsEnumerable,Ee=se.splice,Te=we?we.isConcatSpreadable:o,Ae=we?we.iterator:o,Pe=we?we.toStringTag:o,Ce=function(){try{var t=qs(re,"defineProperty");return t({},"",{}),t}catch(e){}}(),Re=e.clearTimeout!==sr.clearTimeout&&e.clearTimeout,Le=n&&n.now!==sr.Date.now&&n.now,Oe=e.setTimeout!==sr.setTimeout&&e.setTimeout,Ie=ee.ceil,De=ee.floor,Ne=re.getOwnPropertySymbols,ke=ye?ye.isBuffer:o,Fe=e.isFinite,Ve=se.join,ze=un(re.keys,re),Ue=ee.max,je=ee.min,Ge=n.now,qe=e.parseInt,We=ee.random,$e=se.reverse,Qe=qs(e,"DataView"),Ke=qs(e,"Map"),tr=qs(e,"Promise"),er=qs(e,"Set"),ir=qs(e,"WeakMap"),or=qs(re,"create"),ar=ir&&new ir,ur={},cr=Ra(Qe),hr=Ra(Ke),Lr=Ra(tr),Or=Ra(er),jr=Ra(ir),dn=we?we.prototype:o,vn=dn?dn.valueOf:o,yn=dn?dn.toString:o;function bn(t){if(Sc(t)&&!sc(t)&&!(t instanceof En)){if(t instanceof Mn)return t;if(he.call(t,"__wrapped__"))return Oa(t)}return new Mn(t)}var _n=function(){function t(){}return function(e){if(!_c(e))return{};if(Se)return Se(e);t.prototype=e;var r=new t;return t.prototype=o,r}}();function Sn(){}function Mn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=o}function En(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=z,this.__views__=[]}function Tn(){var t=new En(this.__wrapped__);return t.__actions__=rs(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=rs(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=rs(this.__views__),t}function An(){if(this.__filtered__){var t=new En(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function Pn(){var t=this.__wrapped__.value(),e=this.__dir__,r=sc(t),n=e<0,i=r?t.length:0,o=Zs(0,i,this.__views__),s=o.start,a=o.end,u=a-s,l=n?a:s-1,c=this.__iteratees__,h=c.length,d=0,p=je(u,this.__takeCount__);if(!r||!n&&i==u&&p==u)return Fo(t,this.__actions__);var f=[];t:while(u--&&d<p){l+=e;var m=-1,g=t[l];while(++m<h){var v=c[m],y=v.iteratee,w=v.type,b=y(g);if(w==I)g=b;else if(!b){if(w==O)continue t;break t}}f[d++]=g}return f}function Cn(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}function Rn(){this.__data__=or?or(null):{},this.size=0}function Ln(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function On(t){var e=this.__data__;if(or){var r=e[t];return r===c?o:r}return he.call(e,t)?e[t]:o}function In(t){var e=this.__data__;return or?e[t]!==o:he.call(e,t)}function Dn(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=or&&e===o?c:e,this}function Nn(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}function kn(){this.__data__=[],this.size=0}function Fn(t){var e=this.__data__,r=ui(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Ee.call(e,r,1),--this.size,!0}function Vn(t){var e=this.__data__,r=ui(e,t);return r<0?o:e[r][1]}function zn(t){return ui(this.__data__,t)>-1}function Un(t,e){var r=this.__data__,n=ui(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function jn(t){var e=-1,r=null==t?0:t.length;this.clear();while(++e<r){var n=t[e];this.set(n[0],n[1])}}function Bn(){this.size=0,this.__data__={hash:new Cn,map:new(Ke||Nn),string:new Cn}}function Hn(t){var e=Hs(this,t)["delete"](t);return this.size-=e?1:0,e}function Gn(t){return Hs(this,t).get(t)}function qn(t){return Hs(this,t).has(t)}function Wn(t,e){var r=Hs(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function $n(t){var e=-1,r=null==t?0:t.length;this.__data__=new jn;while(++e<r)this.add(t[e])}function Xn(t){return this.__data__.set(t,c),this}function Yn(t){return this.__data__.has(t)}function Zn(t){var e=this.__data__=new Nn(t);this.size=e.size}function Jn(){this.__data__=new Nn,this.size=0}function Qn(t){var e=this.__data__,r=e["delete"](t);return this.size=e.size,r}function Kn(t){return this.__data__.get(t)}function ti(t){return this.__data__.has(t)}function ei(t,e){var r=this.__data__;if(r instanceof Nn){var n=r.__data__;if(!Ke||n.length<a-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new jn(n)}return r.set(t,e),this.size=r.size,this}function ri(t,e){var r=sc(t),n=!r&&oc(t),i=!r&&!n&&hc(t),o=!r&&!n&&!i&&Vc(t),s=r||n||i||o,a=s?qr(t.length,ie):[],u=a.length;for(var l in t)!e&&!he.call(t,l)||s&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ia(l,u))||a.push(l);return a}function ni(t){var e=t.length;return e?t[go(0,e-1)]:o}function ii(t,e){return Aa(rs(t),fi(e,0,t.length))}function oi(t){return Aa(rs(t))}function si(t,e,r){(r!==o&&!rc(t[e],r)||r===o&&!(e in t))&&di(t,e,r)}function ai(t,e,r){var n=t[e];he.call(t,e)&&rc(n,r)&&(r!==o||e in t)||di(t,e,r)}function ui(t,e){var r=t.length;while(r--)if(rc(t[r][0],e))return r;return-1}function li(t,e,r,n){return bi(t,(function(t,i,o){e(n,t,r(t),o)})),n}function ci(t,e){return t&&ns(e,bh(e),t)}function hi(t,e){return t&&ns(e,xh(e),t)}function di(t,e,r){"__proto__"==e&&Ce?Ce(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function pi(t,e){var n=-1,i=e.length,s=r(i),a=null==t;while(++n<i)s[n]=a?o:fh(t,e[n]);return s}function fi(t,e,r){return t===t&&(r!==o&&(t=t<=r?t:r),e!==o&&(t=t>=e?t:e)),t}function mi(t,e,r,n,i,s){var a,u=e&p,l=e&f,c=e&m;if(r&&(a=i?r(t,n,i,s):r(t)),a!==o)return a;if(!_c(t))return t;var h=sc(t);if(h){if(a=Ks(t),!u)return rs(t,a)}else{var d=Ys(t),g=d==Z||d==J;if(hc(t))return Wo(t,u);if(d==et||d==H||g&&!i){if(a=l||g?{}:ta(t),!u)return l?os(t,hi(a,t)):is(t,ci(a,t))}else{if(!Je[d])return i?t:{};a=ea(t,d,u)}}s||(s=new Zn);var v=s.get(t);if(v)return v;s.set(t,a),Nc(t)?t.forEach((function(n){a.add(mi(n,e,r,n,t,s))})):Mc(t)&&t.forEach((function(n,i){a.set(i,mi(n,e,r,i,t,s))}));var y=c?l?Vs:Fs:l?xh:bh,w=h?o:y(t);return br(w||t,(function(n,i){w&&(i=n,n=t[i]),ai(a,i,mi(n,e,r,i,t,s))})),a}function gi(t){var e=bh(t);return function(r){return vi(r,t,e)}}function vi(t,e,r){var n=r.length;if(null==t)return!n;t=re(t);while(n--){var i=r[n],s=e[i],a=t[i];if(a===o&&!(i in t)||!s(a))return!1}return!0}function yi(t,e,r){if("function"!=typeof t)throw new oe(l);return Sa((function(){t.apply(o,r)}),e)}function wi(t,e,r,n){var i=-1,o=Mr,s=!0,u=t.length,l=[],c=e.length;if(!u)return l;r&&(e=Tr(e,$r(r))),n?(o=Er,s=!1):e.length>=a&&(o=Yr,s=!1,e=new $n(e));t:while(++i<u){var h=t[i],d=null==r?h:r(h);if(h=n||0!==h?h:0,s&&d===d){var p=c;while(p--)if(e[p]===d)continue t;l.push(h)}else o(e,d,n)||l.push(h)}return l}bn.templateSettings={escape:Ct,evaluate:Rt,interpolate:Lt,variable:"",imports:{_:bn}},bn.prototype=Sn.prototype,bn.prototype.constructor=bn,Mn.prototype=_n(Sn.prototype),Mn.prototype.constructor=Mn,En.prototype=_n(Sn.prototype),En.prototype.constructor=En,Cn.prototype.clear=Rn,Cn.prototype["delete"]=Ln,Cn.prototype.get=On,Cn.prototype.has=In,Cn.prototype.set=Dn,Nn.prototype.clear=kn,Nn.prototype["delete"]=Fn,Nn.prototype.get=Vn,Nn.prototype.has=zn,Nn.prototype.set=Un,jn.prototype.clear=Bn,jn.prototype["delete"]=Hn,jn.prototype.get=Gn,jn.prototype.has=qn,jn.prototype.set=Wn,$n.prototype.add=$n.prototype.push=Xn,$n.prototype.has=Yn,Zn.prototype.clear=Jn,Zn.prototype["delete"]=Qn,Zn.prototype.get=Kn,Zn.prototype.has=ti,Zn.prototype.set=ei;var bi=us(Ci),xi=us(Ri,!0);function _i(t,e){var r=!0;return bi(t,(function(t,n,i){return r=!!e(t,n,i),r})),r}function Si(t,e,r){var n=-1,i=t.length;while(++n<i){var s=t[n],a=e(s);if(null!=a&&(u===o?a===a&&!Fc(a):r(a,u)))var u=a,l=s}return l}function Mi(t,e,r,n){var i=t.length;r=Wc(r),r<0&&(r=-r>i?0:i+r),n=n===o||n>i?i:Wc(n),n<0&&(n+=i),n=r>n?0:$c(n);while(r<n)t[r++]=e;return t}function Ei(t,e){var r=[];return bi(t,(function(t,n,i){e(t,n,i)&&r.push(t)})),r}function Ti(t,e,r,n,i){var o=-1,s=t.length;r||(r=na),i||(i=[]);while(++o<s){var a=t[o];e>0&&r(a)?e>1?Ti(a,e-1,r,n,i):Ar(i,a):n||(i[i.length]=a)}return i}var Ai=ls(),Pi=ls(!0);function Ci(t,e){return t&&Ai(t,e,bh)}function Ri(t,e){return t&&Pi(t,e,bh)}function Li(t,e){return Sr(e,(function(e){return wc(t[e])}))}function Oi(t,e){e=Bo(e,t);var r=0,n=e.length;while(null!=t&&r<n)t=t[Ca(e[r++])];return r&&r==n?t:o}function Ii(t,e,r){var n=e(t);return sc(t)?n:Ar(n,r(t))}function Di(t){return null==t?t===o?ut:tt:Pe&&Pe in re(t)?Ws(t):va(t)}function Ni(t,e){return t>e}function ki(t,e){return null!=t&&he.call(t,e)}function Fi(t,e){return null!=t&&e in re(t)}function Vi(t,e,r){return t>=je(e,r)&&t<Ue(e,r)}function zi(t,e,n){var i=n?Er:Mr,s=t[0].length,a=t.length,u=a,l=r(a),c=1/0,h=[];while(u--){var d=t[u];u&&e&&(d=Tr(d,$r(e))),c=je(d.length,c),l[u]=!n&&(e||s>=120&&d.length>=120)?new $n(u&&d):o}d=t[0];var p=-1,f=l[0];t:while(++p<s&&h.length<c){var m=d[p],g=e?e(m):m;if(m=n||0!==m?m:0,!(f?Yr(f,g):i(h,g,n))){u=a;while(--u){var v=l[u];if(!(v?Yr(v,g):i(t[u],g,n)))continue t}f&&f.push(g),h.push(m)}}return h}function Ui(t,e,r,n){return Ci(t,(function(t,i,o){e(n,r(t),i,o)})),n}function ji(t,e,r){e=Bo(e,t),t=wa(t,e);var n=null==t?t:t[Ca(nu(e))];return null==n?o:yr(n,t,r)}function Bi(t){return Sc(t)&&Di(t)==H}function Hi(t){return Sc(t)&&Di(t)==ht}function Gi(t){return Sc(t)&&Di(t)==$}function qi(t,e,r,n,i){return t===e||(null==t||null==e||!Sc(t)&&!Sc(e)?t!==t&&e!==e:Wi(t,e,r,n,qi,i))}function Wi(t,e,r,n,i,o){var s=sc(t),a=sc(e),u=s?G:Ys(t),l=a?G:Ys(e);u=u==H?et:u,l=l==H?et:l;var c=u==et,h=l==et,d=u==l;if(d&&hc(t)){if(!hc(e))return!1;s=!0,c=!1}if(d&&!c)return o||(o=new Zn),s||Vc(t)?Is(t,e,r,n,i,o):Ds(t,e,u,r,n,i,o);if(!(r&g)){var p=c&&he.call(t,"__wrapped__"),f=h&&he.call(e,"__wrapped__");if(p||f){var m=p?t.value():t,v=f?e.value():e;return o||(o=new Zn),i(m,v,r,n,o)}}return!!d&&(o||(o=new Zn),Ns(t,e,r,n,i,o))}function $i(t){return Sc(t)&&Ys(t)==Q}function Xi(t,e,r,n){var i=r.length,s=i,a=!n;if(null==t)return!s;t=re(t);while(i--){var u=r[i];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}while(++i<s){u=r[i];var l=u[0],c=t[l],h=u[1];if(a&&u[2]){if(c===o&&!(l in t))return!1}else{var d=new Zn;if(n)var p=n(c,h,l,t,e,d);if(!(p===o?qi(h,c,g|v,n,d):p))return!1}}return!0}function Yi(t){if(!_c(t)||la(t))return!1;var e=wc(t)?ve:Yt;return e.test(Ra(t))}function Zi(t){return Sc(t)&&Di(t)==it}function Ji(t){return Sc(t)&&Ys(t)==ot}function Qi(t){return Sc(t)&&xc(t.length)&&!!Ze[Di(t)]}function Ki(t){return"function"==typeof t?t:null==t?Pd:"object"==typeof t?sc(t)?oo(t[0],t[1]):io(t):jd(t)}function to(t){if(!ha(t))return ze(t);var e=[];for(var r in re(t))he.call(t,r)&&"constructor"!=r&&e.push(r);return e}function eo(t){if(!_c(t))return ga(t);var e=ha(t),r=[];for(var n in t)("constructor"!=n||!e&&he.call(t,n))&&r.push(n);return r}function ro(t,e){return t<e}function no(t,e){var n=-1,i=uc(t)?r(t.length):[];return bi(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function io(t){var e=Gs(t);return 1==e.length&&e[0][2]?pa(e[0][0],e[0][1]):function(r){return r===t||Xi(r,t,e)}}function oo(t,e){return sa(t)&&da(e)?pa(Ca(t),e):function(r){var n=fh(r,t);return n===o&&n===e?gh(r,t):qi(e,n,g|v)}}function so(t,e,r,n,i){t!==e&&Ai(e,(function(s,a){if(i||(i=new Zn),_c(s))ao(t,e,a,r,so,n,i);else{var u=n?n(xa(t,a),s,a+"",t,e,i):o;u===o&&(u=s),si(t,a,u)}}),xh)}function ao(t,e,r,n,i,s,a){var u=xa(t,r),l=xa(e,r),c=a.get(l);if(c)si(t,r,c);else{var h=s?s(u,l,r+"",t,e,a):o,d=h===o;if(d){var p=sc(l),f=!p&&hc(l),m=!p&&!f&&Vc(l);h=l,p||f||m?sc(u)?h=u:lc(u)?h=rs(u):f?(d=!1,h=Wo(l,!0)):m?(d=!1,h=Jo(l,!0)):h=[]:Oc(l)||oc(l)?(h=u,oc(u)?h=Yc(u):_c(u)&&!wc(u)||(h=ta(l))):d=!1}d&&(a.set(l,h),i(h,l,n,s,a),a["delete"](l)),si(t,r,h)}}function uo(t,e){var r=t.length;if(r)return e+=e<0?r:0,ia(e,r)?t[e]:o}function lo(t,e,r){e=e.length?Tr(e,(function(t){return sc(t)?function(e){return Oi(e,1===t.length?t[0]:t)}:t})):[Pd];var n=-1;e=Tr(e,$r(Bs()));var i=no(t,(function(t,r,i){var o=Tr(e,(function(e){return e(t)}));return{criteria:o,index:++n,value:t}}));return Hr(i,(function(t,e){return Ko(t,e,r)}))}function co(t,e){return ho(t,e,(function(e,r){return gh(t,r)}))}function ho(t,e,r){var n=-1,i=e.length,o={};while(++n<i){var s=e[n],a=Oi(t,s);r(a,s)&&_o(o,Bo(s,t),a)}return o}function po(t){return function(e){return Oi(e,t)}}function fo(t,e,r,n){var i=n?Fr:kr,o=-1,s=e.length,a=t;t===e&&(e=rs(e)),r&&(a=Tr(t,$r(r)));while(++o<s){var u=0,l=e[o],c=r?r(l):l;while((u=i(a,c,u,n))>-1)a!==t&&Ee.call(a,u,1),Ee.call(t,u,1)}return t}function mo(t,e){var r=t?e.length:0,n=r-1;while(r--){var i=e[r];if(r==n||i!==o){var o=i;ia(i)?Ee.call(t,i,1):Do(t,i)}}return t}function go(t,e){return t+De(We()*(e-t+1))}function vo(t,e,n,i){var o=-1,s=Ue(Ie((e-t)/(n||1)),0),a=r(s);while(s--)a[i?s:++o]=t,t+=n;return a}function yo(t,e){var r="";if(!t||e<1||e>k)return r;do{e%2&&(r+=t),e=De(e/2),e&&(t+=t)}while(e);return r}function wo(t,e){return Ma(ya(t,e,Pd),t+"")}function bo(t){return ni(zh(t))}function xo(t,e){var r=zh(t);return Aa(r,fi(e,0,r.length))}function _o(t,e,r,n){if(!_c(t))return t;e=Bo(e,t);var i=-1,s=e.length,a=s-1,u=t;while(null!=u&&++i<s){var l=Ca(e[i]),c=r;if("__proto__"===l||"constructor"===l||"prototype"===l)return t;if(i!=a){var h=u[l];c=n?n(h,l,u):o,c===o&&(c=_c(h)?h:ia(e[i+1])?[]:{})}ai(u,l,c),u=u[l]}return t}var So=ar?function(t,e){return ar.set(t,e),t}:Pd,Mo=Ce?function(t,e){return Ce(t,"toString",{configurable:!0,enumerable:!1,value:Md(e),writable:!0})}:Pd;function Eo(t){return Aa(zh(t))}function To(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),n=n>o?o:n,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;var s=r(o);while(++i<o)s[i]=t[i+e];return s}function Ao(t,e){var r;return bi(t,(function(t,n,i){return r=e(t,n,i),!r})),!!r}function Po(t,e,r){var n=0,i=null==t?n:t.length;if("number"==typeof e&&e===e&&i<=j){while(n<i){var o=n+i>>>1,s=t[o];null!==s&&!Fc(s)&&(r?s<=e:s<e)?n=o+1:i=o}return i}return Co(t,e,Pd,r)}function Co(t,e,r,n){var i=0,s=null==t?0:t.length;if(0===s)return 0;e=r(e);var a=e!==e,u=null===e,l=Fc(e),c=e===o;while(i<s){var h=De((i+s)/2),d=r(t[h]),p=d!==o,f=null===d,m=d===d,g=Fc(d);if(a)var v=n||m;else v=c?m&&(n||p):u?m&&p&&(n||!f):l?m&&p&&!f&&(n||!g):!f&&!g&&(n?d<=e:d<e);v?i=h+1:s=h}return je(s,U)}function Ro(t,e){var r=-1,n=t.length,i=0,o=[];while(++r<n){var s=t[r],a=e?e(s):s;if(!r||!rc(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function Lo(t){return"number"==typeof t?t:Fc(t)?V:+t}function Oo(t){if("string"==typeof t)return t;if(sc(t))return Tr(t,Oo)+"";if(Fc(t))return yn?yn.call(t):"";var e=t+"";return"0"==e&&1/t==-N?"-0":e}function Io(t,e,r){var n=-1,i=Mr,o=t.length,s=!0,u=[],l=u;if(r)s=!1,i=Er;else if(o>=a){var c=e?null:As(t);if(c)return cn(c);s=!1,i=Yr,l=new $n}else l=e?[]:u;t:while(++n<o){var h=t[n],d=e?e(h):h;if(h=r||0!==h?h:0,s&&d===d){var p=l.length;while(p--)if(l[p]===d)continue t;e&&l.push(d),u.push(h)}else i(l,d,r)||(l!==u&&l.push(d),u.push(h))}return u}function Do(t,e){return e=Bo(e,t),t=wa(t,e),null==t||delete t[Ca(nu(e))]}function No(t,e,r,n){return _o(t,e,r(Oi(t,e)),n)}function ko(t,e,r,n){var i=t.length,o=n?i:-1;while((n?o--:++o<i)&&e(t[o],o,t));return r?To(t,n?0:o,n?o+1:i):To(t,n?o+1:0,n?i:o)}function Fo(t,e){var r=t;return r instanceof En&&(r=r.value()),Pr(e,(function(t,e){return e.func.apply(e.thisArg,Ar([t],e.args))}),r)}function Vo(t,e,n){var i=t.length;if(i<2)return i?Io(t[0]):[];var o=-1,s=r(i);while(++o<i){var a=t[o],u=-1;while(++u<i)u!=o&&(s[o]=wi(s[o]||a,t[u],e,n))}return Io(Ti(s,1),e,n)}function zo(t,e,r){var n=-1,i=t.length,s=e.length,a={};while(++n<i){var u=n<s?e[n]:o;r(a,t[n],u)}return a}function Uo(t){return lc(t)?t:[]}function jo(t){return"function"==typeof t?t:Pd}function Bo(t,e){return sc(t)?t:sa(t,e)?[t]:Pa(Jc(t))}var Ho=wo;function Go(t,e,r){var n=t.length;return r=r===o?n:r,!e&&r>=n?t:To(t,e,r)}var qo=Re||function(t){return sr.clearTimeout(t)};function Wo(t,e){if(e)return t.slice();var r=t.length,n=xe?xe(r):new t.constructor(r);return t.copy(n),n}function $o(t){var e=new t.constructor(t.byteLength);return new be(e).set(new be(t)),e}function Xo(t,e){var r=e?$o(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}function Yo(t){var e=new t.constructor(t.source,Wt.exec(t));return e.lastIndex=t.lastIndex,e}function Zo(t){return vn?re(vn.call(t)):{}}function Jo(t,e){var r=e?$o(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function Qo(t,e){if(t!==e){var r=t!==o,n=null===t,i=t===t,s=Fc(t),a=e!==o,u=null===e,l=e===e,c=Fc(e);if(!u&&!c&&!s&&t>e||s&&a&&l&&!u&&!c||n&&a&&l||!r&&l||!i)return 1;if(!n&&!s&&!c&&t<e||c&&r&&i&&!n&&!s||u&&r&&i||!a&&i||!l)return-1}return 0}function Ko(t,e,r){var n=-1,i=t.criteria,o=e.criteria,s=i.length,a=r.length;while(++n<s){var u=Qo(i[n],o[n]);if(u){if(n>=a)return u;var l=r[n];return u*("desc"==l?-1:1)}}return t.index-e.index}function ts(t,e,n,i){var o=-1,s=t.length,a=n.length,u=-1,l=e.length,c=Ue(s-a,0),h=r(l+c),d=!i;while(++u<l)h[u]=e[u];while(++o<a)(d||o<s)&&(h[n[o]]=t[o]);while(c--)h[u++]=t[o++];return h}function es(t,e,n,i){var o=-1,s=t.length,a=-1,u=n.length,l=-1,c=e.length,h=Ue(s-u,0),d=r(h+c),p=!i;while(++o<h)d[o]=t[o];var f=o;while(++l<c)d[f+l]=e[l];while(++a<u)(p||o<s)&&(d[f+n[a]]=t[o++]);return d}function rs(t,e){var n=-1,i=t.length;e||(e=r(i));while(++n<i)e[n]=t[n];return e}function ns(t,e,r,n){var i=!r;r||(r={});var s=-1,a=e.length;while(++s<a){var u=e[s],l=n?n(r[u],t[u],u,r,t):o;l===o&&(l=t[u]),i?di(r,u,l):ai(r,u,l)}return r}function is(t,e){return ns(t,$s(t),e)}function os(t,e){return ns(t,Xs(t),e)}function ss(t,e){return function(r,n){var i=sc(r)?wr:li,o=e?e():{};return i(r,t,Bs(n,2),o)}}function as(t){return wo((function(e,r){var n=-1,i=r.length,s=i>1?r[i-1]:o,a=i>2?r[2]:o;s=t.length>3&&"function"==typeof s?(i--,s):o,a&&oa(r[0],r[1],a)&&(s=i<3?o:s,i=1),e=re(e);while(++n<i){var u=r[n];u&&t(e,u,n,s)}return e}))}function us(t,e){return function(r,n){if(null==r)return r;if(!uc(r))return t(r,n);var i=r.length,o=e?i:-1,s=re(r);while(e?o--:++o<i)if(!1===n(s[o],o,s))break;return r}}function ls(t){return function(e,r,n){var i=-1,o=re(e),s=n(e),a=s.length;while(a--){var u=s[t?a:++i];if(!1===r(o[u],u,o))break}return e}}function cs(t,e,r){var n=e&y,i=ps(t);function o(){var e=this&&this!==sr&&this instanceof o?i:t;return e.apply(n?r:this,arguments)}return o}function hs(t){return function(e){e=Jc(e);var r=nn(e)?mn(e):o,n=r?r[0]:e.charAt(0),i=r?Go(r,1).join(""):e.slice(1);return n[t]()+i}}function ds(t){return function(e){return Pr(wd(Wh(e).replace(Be,"")),t,"")}}function ps(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=_n(t.prototype),n=t.apply(r,e);return _c(n)?n:r}}function fs(t,e,n){var i=ps(t);function s(){var a=arguments.length,u=r(a),l=a,c=js(s);while(l--)u[l]=arguments[l];var h=a<3&&u[0]!==c&&u[a-1]!==c?[]:ln(u,c);if(a-=h.length,a<n)return Es(t,e,vs,s.placeholder,o,u,h,o,o,n-a);var d=this&&this!==sr&&this instanceof s?i:t;return yr(d,this,u)}return s}function ms(t){return function(e,r,n){var i=re(e);if(!uc(e)){var s=Bs(r,3);e=bh(e),r=function(t){return s(i[t],t,i)}}var a=t(e,r,n);return a>-1?i[s?e[a]:a]:o}}function gs(t){return ks((function(e){var r=e.length,n=r,i=Mn.prototype.thru;t&&e.reverse();while(n--){var s=e[n];if("function"!=typeof s)throw new oe(l);if(i&&!a&&"wrapper"==Us(s))var a=new Mn([],!0)}n=a?n:r;while(++n<r){s=e[n];var u=Us(s),c="wrapper"==u?zs(s):o;a=c&&ua(c[0])&&c[1]==(E|x|S|T)&&!c[4].length&&1==c[9]?a[Us(c[0])].apply(a,c[3]):1==s.length&&ua(s)?a[u]():a.thru(s)}return function(){var t=arguments,n=t[0];if(a&&1==t.length&&sc(n))return a.plant(n).value();var i=0,o=r?e[i].apply(this,t):n;while(++i<r)o=e[i].call(this,o);return o}}))}function vs(t,e,n,i,s,a,u,l,c,h){var d=e&E,p=e&y,f=e&w,m=e&(x|_),g=e&A,v=f?o:ps(t);function b(){var o=arguments.length,y=r(o),w=o;while(w--)y[w]=arguments[w];if(m)var x=js(b),_=Qr(y,x);if(i&&(y=ts(y,i,s,m)),a&&(y=es(y,a,u,m)),o-=_,m&&o<h){var S=ln(y,x);return Es(t,e,vs,b.placeholder,n,y,S,l,c,h-o)}var M=p?n:this,E=f?M[t]:t;return o=y.length,l?y=ba(y,l):g&&o>1&&y.reverse(),d&&c<o&&(y.length=c),this&&this!==sr&&this instanceof b&&(E=v||ps(E)),E.apply(M,y)}return b}function ys(t,e){return function(r,n){return Ui(r,t,e(n),{})}}function ws(t,e){return function(r,n){var i;if(r===o&&n===o)return e;if(r!==o&&(i=r),n!==o){if(i===o)return n;"string"==typeof r||"string"==typeof n?(r=Oo(r),n=Oo(n)):(r=Lo(r),n=Lo(n)),i=t(r,n)}return i}}function bs(t){return ks((function(e){return e=Tr(e,$r(Bs())),wo((function(r){var n=this;return t(e,(function(t){return yr(t,n,r)}))}))}))}function xs(t,e){e=e===o?" ":Oo(e);var r=e.length;if(r<2)return r?yo(e,t):e;var n=yo(e,Ie(t/fn(e)));return nn(e)?Go(mn(n),0,t).join(""):n.slice(0,t)}function _s(t,e,n,i){var o=e&y,s=ps(t);function a(){var e=-1,u=arguments.length,l=-1,c=i.length,h=r(c+u),d=this&&this!==sr&&this instanceof a?s:t;while(++l<c)h[l]=i[l];while(u--)h[l++]=arguments[++e];return yr(d,o?n:this,h)}return a}function Ss(t){return function(e,r,n){return n&&"number"!=typeof n&&oa(e,r,n)&&(r=n=o),e=qc(e),r===o?(r=e,e=0):r=qc(r),n=n===o?e<r?1:-1:qc(n),vo(e,r,n,t)}}function Ms(t){return function(e,r){return"string"==typeof e&&"string"==typeof r||(e=Xc(e),r=Xc(r)),t(e,r)}}function Es(t,e,r,n,i,s,a,u,l,c){var h=e&x,d=h?a:o,p=h?o:a,f=h?s:o,m=h?o:s;e|=h?S:M,e&=~(h?M:S),e&b||(e&=~(y|w));var g=[t,e,i,f,d,m,p,u,l,c],v=r.apply(o,g);return ua(t)&&_a(v,g),v.placeholder=n,Ea(v,t,e)}function Ts(t){var e=ee[t];return function(t,r){if(t=Xc(t),r=null==r?0:je(Wc(r),292),r&&Fe(t)){var n=(Jc(t)+"e").split("e"),i=e(n[0]+"e"+(+n[1]+r));return n=(Jc(i)+"e").split("e"),+(n[0]+"e"+(+n[1]-r))}return e(t)}}var As=er&&1/cn(new er([,-0]))[1]==N?function(t){return new er(t)}:kd;function Ps(t){return function(e){var r=Ys(e);return r==Q?an(e):r==ot?hn(e):Wr(e,t(e))}}function Cs(t,e,r,n,i,s,a,u){var c=e&w;if(!c&&"function"!=typeof t)throw new oe(l);var h=n?n.length:0;if(h||(e&=~(S|M),n=i=o),a=a===o?a:Ue(Wc(a),0),u=u===o?u:Wc(u),h-=i?i.length:0,e&M){var d=n,p=i;n=i=o}var f=c?o:zs(t),m=[t,e,r,n,i,d,p,s,a,u];if(f&&ma(m,f),t=m[0],e=m[1],r=m[2],n=m[3],i=m[4],u=m[9]=m[9]===o?c?0:t.length:Ue(m[9]-h,0),!u&&e&(x|_)&&(e&=~(x|_)),e&&e!=y)g=e==x||e==_?fs(t,e,u):e!=S&&e!=(y|S)||i.length?vs.apply(o,m):_s(t,e,r,n);else var g=cs(t,e,r);var v=f?So:_a;return Ea(v(g,m),t,e)}function Rs(t,e,r,n){return t===o||rc(t,ue[r])&&!he.call(n,r)?e:t}function Ls(t,e,r,n,i,s){return _c(t)&&_c(e)&&(s.set(e,t),so(t,e,o,Ls,s),s["delete"](e)),t}function Os(t){return Oc(t)?o:t}function Is(t,e,r,n,i,s){var a=r&g,u=t.length,l=e.length;if(u!=l&&!(a&&l>u))return!1;var c=s.get(t),h=s.get(e);if(c&&h)return c==e&&h==t;var d=-1,p=!0,f=r&v?new $n:o;s.set(t,e),s.set(e,t);while(++d<u){var m=t[d],y=e[d];if(n)var w=a?n(y,m,d,e,t,s):n(m,y,d,t,e,s);if(w!==o){if(w)continue;p=!1;break}if(f){if(!Rr(e,(function(t,e){if(!Yr(f,e)&&(m===t||i(m,t,r,n,s)))return f.push(e)}))){p=!1;break}}else if(m!==y&&!i(m,y,r,n,s)){p=!1;break}}return s["delete"](t),s["delete"](e),p}function Ds(t,e,r,n,i,o,s){switch(r){case dt:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case ht:return!(t.byteLength!=e.byteLength||!o(new be(t),new be(e)));case W:case $:case K:return rc(+t,+e);case Y:return t.name==e.name&&t.message==e.message;case it:case st:return t==e+"";case Q:var a=an;case ot:var u=n&g;if(a||(a=cn),t.size!=e.size&&!u)return!1;var l=s.get(t);if(l)return l==e;n|=v,s.set(t,e);var c=Is(a(t),a(e),n,i,o,s);return s["delete"](t),c;case at:if(vn)return vn.call(t)==vn.call(e)}return!1}function Ns(t,e,r,n,i,s){var a=r&g,u=Fs(t),l=u.length,c=Fs(e),h=c.length;if(l!=h&&!a)return!1;var d=l;while(d--){var p=u[d];if(!(a?p in e:he.call(e,p)))return!1}var f=s.get(t),m=s.get(e);if(f&&m)return f==e&&m==t;var v=!0;s.set(t,e),s.set(e,t);var y=a;while(++d<l){p=u[d];var w=t[p],b=e[p];if(n)var x=a?n(b,w,p,e,t,s):n(w,b,p,t,e,s);if(!(x===o?w===b||i(w,b,r,n,s):x)){v=!1;break}y||(y="constructor"==p)}if(v&&!y){var _=t.constructor,S=e.constructor;_==S||!("constructor"in t)||!("constructor"in e)||"function"==typeof _&&_ instanceof _&&"function"==typeof S&&S instanceof S||(v=!1)}return s["delete"](t),s["delete"](e),v}function ks(t){return Ma(ya(t,o,Wa),t+"")}function Fs(t){return Ii(t,bh,$s)}function Vs(t){return Ii(t,xh,Xs)}var zs=ar?function(t){return ar.get(t)}:kd;function Us(t){var e=t.name+"",r=ur[e],n=he.call(ur,e)?r.length:0;while(n--){var i=r[n],o=i.func;if(null==o||o==t)return i.name}return e}function js(t){var e=he.call(bn,"placeholder")?bn:t;return e.placeholder}function Bs(){var t=bn.iteratee||Cd;return t=t===Cd?Ki:t,arguments.length?t(arguments[0],arguments[1]):t}function Hs(t,e){var r=t.__data__;return aa(e)?r["string"==typeof e?"string":"hash"]:r.map}function Gs(t){var e=bh(t),r=e.length;while(r--){var n=e[r],i=t[n];e[r]=[n,i,da(i)]}return e}function qs(t,e){var r=rn(t,e);return Yi(r)?r:o}function Ws(t){var e=he.call(t,Pe),r=t[Pe];try{t[Pe]=o;var n=!0}catch(s){}var i=fe.call(t);return n&&(e?t[Pe]=r:delete t[Pe]),i}var $s=Ne?function(t){return null==t?[]:(t=re(t),Sr(Ne(t),(function(e){return Me.call(t,e)})))}:qd,Xs=Ne?function(t){var e=[];while(t)Ar(e,$s(t)),t=_e(t);return e}:qd,Ys=Di;function Zs(t,e,r){var n=-1,i=r.length;while(++n<i){var o=r[n],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=je(e,t+s);break;case"takeRight":t=Ue(t,e-s);break}}return{start:t,end:e}}function Js(t){var e=t.match(jt);return e?e[1].split(Bt):[]}function Qs(t,e,r){e=Bo(e,t);var n=-1,i=e.length,o=!1;while(++n<i){var s=Ca(e[n]);if(!(o=null!=t&&r(t,s)))break;t=t[s]}return o||++n!=i?o:(i=null==t?0:t.length,!!i&&xc(i)&&ia(s,i)&&(sc(t)||oc(t)))}function Ks(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&he.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function ta(t){return"function"!=typeof t.constructor||ha(t)?{}:_n(_e(t))}function ea(t,e,r){var n=t.constructor;switch(e){case ht:return $o(t);case W:case $:return new n(+t);case dt:return Xo(t,r);case pt:case ft:case mt:case gt:case vt:case yt:case wt:case bt:case xt:return Jo(t,r);case Q:return new n;case K:case st:return new n(t);case it:return Yo(t);case ot:return new n;case at:return Zo(t)}}function ra(t,e){var r=e.length;if(!r)return t;var n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(Ut,"{\n/* [wrapped with "+e+"] */\n")}function na(t){return sc(t)||oc(t)||!!(Te&&t&&t[Te])}function ia(t,e){var r=typeof t;return e=null==e?k:e,!!e&&("number"==r||"symbol"!=r&&Jt.test(t))&&t>-1&&t%1==0&&t<e}function oa(t,e,r){if(!_c(r))return!1;var n=typeof e;return!!("number"==n?uc(r)&&ia(e,r.length):"string"==n&&e in r)&&rc(r[e],t)}function sa(t,e){if(sc(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!Fc(t))||(It.test(t)||!Ot.test(t)||null!=e&&t in re(e))}function aa(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function ua(t){var e=Us(t),r=bn[e];if("function"!=typeof r||!(e in En.prototype))return!1;if(t===r)return!0;var n=zs(r);return!!n&&t===n[0]}function la(t){return!!pe&&pe in t}(Qe&&Ys(new Qe(new ArrayBuffer(1)))!=dt||Ke&&Ys(new Ke)!=Q||tr&&Ys(tr.resolve())!=rt||er&&Ys(new er)!=ot||ir&&Ys(new ir)!=lt)&&(Ys=function(t){var e=Di(t),r=e==et?t.constructor:o,n=r?Ra(r):"";if(n)switch(n){case cr:return dt;case hr:return Q;case Lr:return rt;case Or:return ot;case jr:return lt}return e});var ca=le?wc:Wd;function ha(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||ue;return t===r}function da(t){return t===t&&!_c(t)}function pa(t,e){return function(r){return null!=r&&(r[t]===e&&(e!==o||t in re(r)))}}function fa(t){var e=Vl(t,(function(t){return r.size===h&&r.clear(),t})),r=e.cache;return e}function ma(t,e){var r=t[1],n=e[1],i=r|n,o=i<(y|w|E),s=n==E&&r==x||n==E&&r==T&&t[7].length<=e[8]||n==(E|T)&&e[7].length<=e[8]&&r==x;if(!o&&!s)return t;n&y&&(t[2]=e[2],i|=r&y?0:b);var a=e[3];if(a){var u=t[3];t[3]=u?ts(u,a,e[4]):a,t[4]=u?ln(t[3],d):e[4]}return a=e[5],a&&(u=t[5],t[5]=u?es(u,a,e[6]):a,t[6]=u?ln(t[5],d):e[6]),a=e[7],a&&(t[7]=a),n&E&&(t[8]=null==t[8]?e[8]:je(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i,t}function ga(t){var e=[];if(null!=t)for(var r in re(t))e.push(r);return e}function va(t){return fe.call(t)}function ya(t,e,n){return e=Ue(e===o?t.length-1:e,0),function(){var i=arguments,o=-1,s=Ue(i.length-e,0),a=r(s);while(++o<s)a[o]=i[e+o];o=-1;var u=r(e+1);while(++o<e)u[o]=i[o];return u[e]=n(a),yr(t,this,u)}}function wa(t,e){return e.length<2?t:Oi(t,To(e,0,-1))}function ba(t,e){var r=t.length,n=je(e.length,r),i=rs(t);while(n--){var s=e[n];t[n]=ia(s,r)?i[s]:o}return t}function xa(t,e){if(("constructor"!==e||"function"!==typeof t[e])&&"__proto__"!=e)return t[e]}var _a=Ta(So),Sa=Oe||function(t,e){return sr.setTimeout(t,e)},Ma=Ta(Mo);function Ea(t,e,r){var n=e+"";return Ma(t,ra(n,La(Js(n),r)))}function Ta(t){var e=0,r=0;return function(){var n=Ge(),i=L-(n-r);if(r=n,i>0){if(++e>=R)return arguments[0]}else e=0;return t.apply(o,arguments)}}function Aa(t,e){var r=-1,n=t.length,i=n-1;e=e===o?n:e;while(++r<e){var s=go(r,i),a=t[s];t[s]=t[r],t[r]=a}return t.length=e,t}var Pa=fa((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(Dt,(function(t,r,n,i){e.push(n?i.replace(Gt,"$1"):r||t)})),e}));function Ca(t){if("string"==typeof t||Fc(t))return t;var e=t+"";return"0"==e&&1/t==-N?"-0":e}function Ra(t){if(null!=t){try{return ce.call(t)}catch(e){}try{return t+""}catch(e){}}return""}function La(t,e){return br(B,(function(r){var n="_."+r[0];e&r[1]&&!Mr(t,n)&&t.push(n)})),t.sort()}function Oa(t){if(t instanceof En)return t.clone();var e=new Mn(t.__wrapped__,t.__chain__);return e.__actions__=rs(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Ia(t,e,n){e=(n?oa(t,e,n):e===o)?1:Ue(Wc(e),0);var i=null==t?0:t.length;if(!i||e<1)return[];var s=0,a=0,u=r(Ie(i/e));while(s<i)u[a++]=To(t,s,s+=e);return u}function Da(t){var e=-1,r=null==t?0:t.length,n=0,i=[];while(++e<r){var o=t[e];o&&(i[n++]=o)}return i}function Na(){var t=arguments.length;if(!t)return[];var e=r(t-1),n=arguments[0],i=t;while(i--)e[i-1]=arguments[i];return Ar(sc(n)?rs(n):[n],Ti(e,1))}var ka=wo((function(t,e){return lc(t)?wi(t,Ti(e,1,lc,!0)):[]})),Fa=wo((function(t,e){var r=nu(e);return lc(r)&&(r=o),lc(t)?wi(t,Ti(e,1,lc,!0),Bs(r,2)):[]})),Va=wo((function(t,e){var r=nu(e);return lc(r)&&(r=o),lc(t)?wi(t,Ti(e,1,lc,!0),o,r):[]}));function za(t,e,r){var n=null==t?0:t.length;return n?(e=r||e===o?1:Wc(e),To(t,e<0?0:e,n)):[]}function Ua(t,e,r){var n=null==t?0:t.length;return n?(e=r||e===o?1:Wc(e),e=n-e,To(t,0,e<0?0:e)):[]}function ja(t,e){return t&&t.length?ko(t,Bs(e,3),!0,!0):[]}function Ba(t,e){return t&&t.length?ko(t,Bs(e,3),!0):[]}function Ha(t,e,r,n){var i=null==t?0:t.length;return i?(r&&"number"!=typeof r&&oa(t,e,r)&&(r=0,n=i),Mi(t,e,r,n)):[]}function Ga(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:Wc(r);return i<0&&(i=Ue(n+i,0)),Nr(t,Bs(e,3),i)}function qa(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n-1;return r!==o&&(i=Wc(r),i=r<0?Ue(n+i,0):je(i,n-1)),Nr(t,Bs(e,3),i,!0)}function Wa(t){var e=null==t?0:t.length;return e?Ti(t,1):[]}function $a(t){var e=null==t?0:t.length;return e?Ti(t,N):[]}function Xa(t,e){var r=null==t?0:t.length;return r?(e=e===o?1:Wc(e),Ti(t,e)):[]}function Ya(t){var e=-1,r=null==t?0:t.length,n={};while(++e<r){var i=t[e];n[i[0]]=i[1]}return n}function Za(t){return t&&t.length?t[0]:o}function Ja(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=null==r?0:Wc(r);return i<0&&(i=Ue(n+i,0)),kr(t,e,i)}function Qa(t){var e=null==t?0:t.length;return e?To(t,0,-1):[]}var Ka=wo((function(t){var e=Tr(t,Uo);return e.length&&e[0]===t[0]?zi(e):[]})),tu=wo((function(t){var e=nu(t),r=Tr(t,Uo);return e===nu(r)?e=o:r.pop(),r.length&&r[0]===t[0]?zi(r,Bs(e,2)):[]})),eu=wo((function(t){var e=nu(t),r=Tr(t,Uo);return e="function"==typeof e?e:o,e&&r.pop(),r.length&&r[0]===t[0]?zi(r,o,e):[]}));function ru(t,e){return null==t?"":Ve.call(t,e)}function nu(t){var e=null==t?0:t.length;return e?t[e-1]:o}function iu(t,e,r){var n=null==t?0:t.length;if(!n)return-1;var i=n;return r!==o&&(i=Wc(r),i=i<0?Ue(n+i,0):je(i,n-1)),e===e?pn(t,e,i):Nr(t,Vr,i,!0)}function ou(t,e){return t&&t.length?uo(t,Wc(e)):o}var su=wo(au);function au(t,e){return t&&t.length&&e&&e.length?fo(t,e):t}function uu(t,e,r){return t&&t.length&&e&&e.length?fo(t,e,Bs(r,2)):t}function lu(t,e,r){return t&&t.length&&e&&e.length?fo(t,e,o,r):t}var cu=ks((function(t,e){var r=null==t?0:t.length,n=pi(t,e);return mo(t,Tr(e,(function(t){return ia(t,r)?+t:t})).sort(Qo)),n}));function hu(t,e){var r=[];if(!t||!t.length)return r;var n=-1,i=[],o=t.length;e=Bs(e,3);while(++n<o){var s=t[n];e(s,n,t)&&(r.push(s),i.push(n))}return mo(t,i),r}function du(t){return null==t?t:$e.call(t)}function pu(t,e,r){var n=null==t?0:t.length;return n?(r&&"number"!=typeof r&&oa(t,e,r)?(e=0,r=n):(e=null==e?0:Wc(e),r=r===o?n:Wc(r)),To(t,e,r)):[]}function fu(t,e){return Po(t,e)}function mu(t,e,r){return Co(t,e,Bs(r,2))}function gu(t,e){var r=null==t?0:t.length;if(r){var n=Po(t,e);if(n<r&&rc(t[n],e))return n}return-1}function vu(t,e){return Po(t,e,!0)}function yu(t,e,r){return Co(t,e,Bs(r,2),!0)}function wu(t,e){var r=null==t?0:t.length;if(r){var n=Po(t,e,!0)-1;if(rc(t[n],e))return n}return-1}function bu(t){return t&&t.length?Ro(t):[]}function xu(t,e){return t&&t.length?Ro(t,Bs(e,2)):[]}function _u(t){var e=null==t?0:t.length;return e?To(t,1,e):[]}function Su(t,e,r){return t&&t.length?(e=r||e===o?1:Wc(e),To(t,0,e<0?0:e)):[]}function Mu(t,e,r){var n=null==t?0:t.length;return n?(e=r||e===o?1:Wc(e),e=n-e,To(t,e<0?0:e,n)):[]}function Eu(t,e){return t&&t.length?ko(t,Bs(e,3),!1,!0):[]}function Tu(t,e){return t&&t.length?ko(t,Bs(e,3)):[]}var Au=wo((function(t){return Io(Ti(t,1,lc,!0))})),Pu=wo((function(t){var e=nu(t);return lc(e)&&(e=o),Io(Ti(t,1,lc,!0),Bs(e,2))})),Cu=wo((function(t){var e=nu(t);return e="function"==typeof e?e:o,Io(Ti(t,1,lc,!0),o,e)}));function Ru(t){return t&&t.length?Io(t):[]}function Lu(t,e){return t&&t.length?Io(t,Bs(e,2)):[]}function Ou(t,e){return e="function"==typeof e?e:o,t&&t.length?Io(t,o,e):[]}function Iu(t){if(!t||!t.length)return[];var e=0;return t=Sr(t,(function(t){if(lc(t))return e=Ue(t.length,e),!0})),qr(e,(function(e){return Tr(t,Ur(e))}))}function Du(t,e){if(!t||!t.length)return[];var r=Iu(t);return null==e?r:Tr(r,(function(t){return yr(e,o,t)}))}var Nu=wo((function(t,e){return lc(t)?wi(t,e):[]})),ku=wo((function(t){return Vo(Sr(t,lc))})),Fu=wo((function(t){var e=nu(t);return lc(e)&&(e=o),Vo(Sr(t,lc),Bs(e,2))})),Vu=wo((function(t){var e=nu(t);return e="function"==typeof e?e:o,Vo(Sr(t,lc),o,e)})),zu=wo(Iu);function Uu(t,e){return zo(t||[],e||[],ai)}function ju(t,e){return zo(t||[],e||[],_o)}var Bu=wo((function(t){var e=t.length,r=e>1?t[e-1]:o;return r="function"==typeof r?(t.pop(),r):o,Du(t,r)}));function Hu(t){var e=bn(t);return e.__chain__=!0,e}function Gu(t,e){return e(t),t}function qu(t,e){return e(t)}var Wu=ks((function(t){var e=t.length,r=e?t[0]:0,n=this.__wrapped__,i=function(e){return pi(e,t)};return!(e>1||this.__actions__.length)&&n instanceof En&&ia(r)?(n=n.slice(r,+r+(e?1:0)),n.__actions__.push({func:qu,args:[i],thisArg:o}),new Mn(n,this.__chain__).thru((function(t){return e&&!t.length&&t.push(o),t}))):this.thru(i)}));function $u(){return Hu(this)}function Xu(){return new Mn(this.value(),this.__chain__)}function Yu(){this.__values__===o&&(this.__values__=Gc(this.value()));var t=this.__index__>=this.__values__.length,e=t?o:this.__values__[this.__index__++];return{done:t,value:e}}function Zu(){return this}function Ju(t){var e,r=this;while(r instanceof Sn){var n=Oa(r);n.__index__=0,n.__values__=o,e?i.__wrapped__=n:e=n;var i=n;r=r.__wrapped__}return i.__wrapped__=t,e}function Qu(){var t=this.__wrapped__;if(t instanceof En){var e=t;return this.__actions__.length&&(e=new En(this)),e=e.reverse(),e.__actions__.push({func:qu,args:[du],thisArg:o}),new Mn(e,this.__chain__)}return this.thru(du)}function Ku(){return Fo(this.__wrapped__,this.__actions__)}var tl=ss((function(t,e,r){he.call(t,r)?++t[r]:di(t,r,1)}));function el(t,e,r){var n=sc(t)?_r:_i;return r&&oa(t,e,r)&&(e=o),n(t,Bs(e,3))}function rl(t,e){var r=sc(t)?Sr:Ei;return r(t,Bs(e,3))}var nl=ms(Ga),il=ms(qa);function ol(t,e){return Ti(fl(t,e),1)}function sl(t,e){return Ti(fl(t,e),N)}function al(t,e,r){return r=r===o?1:Wc(r),Ti(fl(t,e),r)}function ul(t,e){var r=sc(t)?br:bi;return r(t,Bs(e,3))}function ll(t,e){var r=sc(t)?xr:xi;return r(t,Bs(e,3))}var cl=ss((function(t,e,r){he.call(t,r)?t[r].push(e):di(t,r,[e])}));function hl(t,e,r,n){t=uc(t)?t:zh(t),r=r&&!n?Wc(r):0;var i=t.length;return r<0&&(r=Ue(i+r,0)),kc(t)?r<=i&&t.indexOf(e,r)>-1:!!i&&kr(t,e,r)>-1}var dl=wo((function(t,e,n){var i=-1,o="function"==typeof e,s=uc(t)?r(t.length):[];return bi(t,(function(t){s[++i]=o?yr(e,t,n):ji(t,e,n)})),s})),pl=ss((function(t,e,r){di(t,r,e)}));function fl(t,e){var r=sc(t)?Tr:no;return r(t,Bs(e,3))}function ml(t,e,r,n){return null==t?[]:(sc(e)||(e=null==e?[]:[e]),r=n?o:r,sc(r)||(r=null==r?[]:[r]),lo(t,e,r))}var gl=ss((function(t,e,r){t[r?0:1].push(e)}),(function(){return[[],[]]}));function vl(t,e,r){var n=sc(t)?Pr:Br,i=arguments.length<3;return n(t,Bs(e,4),r,i,bi)}function yl(t,e,r){var n=sc(t)?Cr:Br,i=arguments.length<3;return n(t,Bs(e,4),r,i,xi)}function wl(t,e){var r=sc(t)?Sr:Ei;return r(t,zl(Bs(e,3)))}function bl(t){var e=sc(t)?ni:bo;return e(t)}function xl(t,e,r){e=(r?oa(t,e,r):e===o)?1:Wc(e);var n=sc(t)?ii:xo;return n(t,e)}function _l(t){var e=sc(t)?oi:Eo;return e(t)}function Sl(t){if(null==t)return 0;if(uc(t))return kc(t)?fn(t):t.length;var e=Ys(t);return e==Q||e==ot?t.size:to(t).length}function Ml(t,e,r){var n=sc(t)?Rr:Ao;return r&&oa(t,e,r)&&(e=o),n(t,Bs(e,3))}var El=wo((function(t,e){if(null==t)return[];var r=e.length;return r>1&&oa(t,e[0],e[1])?e=[]:r>2&&oa(e[0],e[1],e[2])&&(e=[e[0]]),lo(t,Ti(e,1),[])})),Tl=Le||function(){return sr.Date.now()};function Al(t,e){if("function"!=typeof e)throw new oe(l);return t=Wc(t),function(){if(--t<1)return e.apply(this,arguments)}}function Pl(t,e,r){return e=r?o:e,e=t&&null==e?t.length:e,Cs(t,E,o,o,o,o,e)}function Cl(t,e){var r;if("function"!=typeof e)throw new oe(l);return t=Wc(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=o),r}}var Rl=wo((function(t,e,r){var n=y;if(r.length){var i=ln(r,js(Rl));n|=S}return Cs(t,n,e,r,i)})),Ll=wo((function(t,e,r){var n=y|w;if(r.length){var i=ln(r,js(Ll));n|=S}return Cs(e,n,t,r,i)}));function Ol(t,e,r){e=r?o:e;var n=Cs(t,x,o,o,o,o,o,e);return n.placeholder=Ol.placeholder,n}function Il(t,e,r){e=r?o:e;var n=Cs(t,_,o,o,o,o,o,e);return n.placeholder=Il.placeholder,n}function Dl(t,e,r){var n,i,s,a,u,c,h=0,d=!1,p=!1,f=!0;if("function"!=typeof t)throw new oe(l);function m(e){var r=n,s=i;return n=i=o,h=e,a=t.apply(s,r),a}function g(t){return h=t,u=Sa(w,e),d?m(t):a}function v(t){var r=t-c,n=t-h,i=e-r;return p?je(i,s-n):i}function y(t){var r=t-c,n=t-h;return c===o||r>=e||r<0||p&&n>=s}function w(){var t=Tl();if(y(t))return b(t);u=Sa(w,v(t))}function b(t){return u=o,f&&n?m(t):(n=i=o,a)}function x(){u!==o&&qo(u),h=0,n=c=i=u=o}function _(){return u===o?a:b(Tl())}function S(){var t=Tl(),r=y(t);if(n=arguments,i=this,c=t,r){if(u===o)return g(c);if(p)return qo(u),u=Sa(w,e),m(c)}return u===o&&(u=Sa(w,e)),a}return e=Xc(e)||0,_c(r)&&(d=!!r.leading,p="maxWait"in r,s=p?Ue(Xc(r.maxWait)||0,e):s,f="trailing"in r?!!r.trailing:f),S.cancel=x,S.flush=_,S}var Nl=wo((function(t,e){return yi(t,1,e)})),kl=wo((function(t,e,r){return yi(t,Xc(e)||0,r)}));function Fl(t){return Cs(t,A)}function Vl(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new oe(l);var r=function(){var n=arguments,i=e?e.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var s=t.apply(this,n);return r.cache=o.set(i,s)||o,s};return r.cache=new(Vl.Cache||jn),r}function zl(t){if("function"!=typeof t)throw new oe(l);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Ul(t){return Cl(2,t)}Vl.Cache=jn;var jl=Ho((function(t,e){e=1==e.length&&sc(e[0])?Tr(e[0],$r(Bs())):Tr(Ti(e,1),$r(Bs()));var r=e.length;return wo((function(n){var i=-1,o=je(n.length,r);while(++i<o)n[i]=e[i].call(this,n[i]);return yr(t,this,n)}))})),Bl=wo((function(t,e){var r=ln(e,js(Bl));return Cs(t,S,o,e,r)})),Hl=wo((function(t,e){var r=ln(e,js(Hl));return Cs(t,M,o,e,r)})),Gl=ks((function(t,e){return Cs(t,T,o,o,o,e)}));function ql(t,e){if("function"!=typeof t)throw new oe(l);return e=e===o?e:Wc(e),wo(t,e)}function Wl(t,e){if("function"!=typeof t)throw new oe(l);return e=null==e?0:Ue(Wc(e),0),wo((function(r){var n=r[e],i=Go(r,0,e);return n&&Ar(i,n),yr(t,this,i)}))}function $l(t,e,r){var n=!0,i=!0;if("function"!=typeof t)throw new oe(l);return _c(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),Dl(t,e,{leading:n,maxWait:e,trailing:i})}function Xl(t){return Pl(t,1)}function Yl(t,e){return Bl(jo(e),t)}function Zl(){if(!arguments.length)return[];var t=arguments[0];return sc(t)?t:[t]}function Jl(t){return mi(t,m)}function Ql(t,e){return e="function"==typeof e?e:o,mi(t,m,e)}function Kl(t){return mi(t,p|m)}function tc(t,e){return e="function"==typeof e?e:o,mi(t,p|m,e)}function ec(t,e){return null==e||vi(t,e,bh(e))}function rc(t,e){return t===e||t!==t&&e!==e}var nc=Ms(Ni),ic=Ms((function(t,e){return t>=e})),oc=Bi(function(){return arguments}())?Bi:function(t){return Sc(t)&&he.call(t,"callee")&&!Me.call(t,"callee")},sc=r.isArray,ac=dr?$r(dr):Hi;function uc(t){return null!=t&&xc(t.length)&&!wc(t)}function lc(t){return Sc(t)&&uc(t)}function cc(t){return!0===t||!1===t||Sc(t)&&Di(t)==W}var hc=ke||Wd,dc=pr?$r(pr):Gi;function pc(t){return Sc(t)&&1===t.nodeType&&!Oc(t)}function fc(t){if(null==t)return!0;if(uc(t)&&(sc(t)||"string"==typeof t||"function"==typeof t.splice||hc(t)||Vc(t)||oc(t)))return!t.length;var e=Ys(t);if(e==Q||e==ot)return!t.size;if(ha(t))return!to(t).length;for(var r in t)if(he.call(t,r))return!1;return!0}function mc(t,e){return qi(t,e)}function gc(t,e,r){r="function"==typeof r?r:o;var n=r?r(t,e):o;return n===o?qi(t,e,o,r):!!n}function vc(t){if(!Sc(t))return!1;var e=Di(t);return e==Y||e==X||"string"==typeof t.message&&"string"==typeof t.name&&!Oc(t)}function yc(t){return"number"==typeof t&&Fe(t)}function wc(t){if(!_c(t))return!1;var e=Di(t);return e==Z||e==J||e==q||e==nt}function bc(t){return"number"==typeof t&&t==Wc(t)}function xc(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=k}function _c(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Sc(t){return null!=t&&"object"==typeof t}var Mc=fr?$r(fr):$i;function Ec(t,e){return t===e||Xi(t,e,Gs(e))}function Tc(t,e,r){return r="function"==typeof r?r:o,Xi(t,e,Gs(e),r)}function Ac(t){return Lc(t)&&t!=+t}function Pc(t){if(ca(t))throw new i(u);return Yi(t)}function Cc(t){return null===t}function Rc(t){return null==t}function Lc(t){return"number"==typeof t||Sc(t)&&Di(t)==K}function Oc(t){if(!Sc(t)||Di(t)!=et)return!1;var e=_e(t);if(null===e)return!0;var r=he.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&ce.call(r)==me}var Ic=mr?$r(mr):Zi;function Dc(t){return bc(t)&&t>=-k&&t<=k}var Nc=gr?$r(gr):Ji;function kc(t){return"string"==typeof t||!sc(t)&&Sc(t)&&Di(t)==st}function Fc(t){return"symbol"==typeof t||Sc(t)&&Di(t)==at}var Vc=vr?$r(vr):Qi;function zc(t){return t===o}function Uc(t){return Sc(t)&&Ys(t)==lt}function jc(t){return Sc(t)&&Di(t)==ct}var Bc=Ms(ro),Hc=Ms((function(t,e){return t<=e}));function Gc(t){if(!t)return[];if(uc(t))return kc(t)?mn(t):rs(t);if(Ae&&t[Ae])return sn(t[Ae]());var e=Ys(t),r=e==Q?an:e==ot?cn:zh;return r(t)}function qc(t){if(!t)return 0===t?t:0;if(t=Xc(t),t===N||t===-N){var e=t<0?-1:1;return e*F}return t===t?t:0}function Wc(t){var e=qc(t),r=e%1;return e===e?r?e-r:e:0}function $c(t){return t?fi(Wc(t),0,z):0}function Xc(t){if("number"==typeof t)return t;if(Fc(t))return V;if(_c(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=_c(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Ft,"");var r=Xt.test(t);return r||Zt.test(t)?nr(t.slice(2),r?2:8):$t.test(t)?V:+t}function Yc(t){return ns(t,xh(t))}function Zc(t){return t?fi(Wc(t),-k,k):0===t?t:0}function Jc(t){return null==t?"":Oo(t)}var Qc=as((function(t,e){if(ha(e)||uc(e))ns(e,bh(e),t);else for(var r in e)he.call(e,r)&&ai(t,r,e[r])})),Kc=as((function(t,e){ns(e,xh(e),t)})),th=as((function(t,e,r,n){ns(e,xh(e),t,n)})),eh=as((function(t,e,r,n){ns(e,bh(e),t,n)})),rh=ks(pi);function nh(t,e){var r=_n(t);return null==e?r:ci(r,e)}var ih=wo((function(t,e){t=re(t);var r=-1,n=e.length,i=n>2?e[2]:o;i&&oa(e[0],e[1],i)&&(n=1);while(++r<n){var s=e[r],a=xh(s),u=-1,l=a.length;while(++u<l){var c=a[u],h=t[c];(h===o||rc(h,ue[c])&&!he.call(t,c))&&(t[c]=s[c])}}return t})),oh=wo((function(t){return t.push(o,Ls),yr(Eh,o,t)}));function sh(t,e){return Dr(t,Bs(e,3),Ci)}function ah(t,e){return Dr(t,Bs(e,3),Ri)}function uh(t,e){return null==t?t:Ai(t,Bs(e,3),xh)}function lh(t,e){return null==t?t:Pi(t,Bs(e,3),xh)}function ch(t,e){return t&&Ci(t,Bs(e,3))}function hh(t,e){return t&&Ri(t,Bs(e,3))}function dh(t){return null==t?[]:Li(t,bh(t))}function ph(t){return null==t?[]:Li(t,xh(t))}function fh(t,e,r){var n=null==t?o:Oi(t,e);return n===o?r:n}function mh(t,e){return null!=t&&Qs(t,e,ki)}function gh(t,e){return null!=t&&Qs(t,e,Fi)}var vh=ys((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),t[e]=r}),Md(Pd)),yh=ys((function(t,e,r){null!=e&&"function"!=typeof e.toString&&(e=fe.call(e)),he.call(t,e)?t[e].push(r):t[e]=[r]}),Bs),wh=wo(ji);function bh(t){return uc(t)?ri(t):to(t)}function xh(t){return uc(t)?ri(t,!0):eo(t)}function _h(t,e){var r={};return e=Bs(e,3),Ci(t,(function(t,n,i){di(r,e(t,n,i),t)})),r}function Sh(t,e){var r={};return e=Bs(e,3),Ci(t,(function(t,n,i){di(r,n,e(t,n,i))})),r}var Mh=as((function(t,e,r){so(t,e,r)})),Eh=as((function(t,e,r,n){so(t,e,r,n)})),Th=ks((function(t,e){var r={};if(null==t)return r;var n=!1;e=Tr(e,(function(e){return e=Bo(e,t),n||(n=e.length>1),e})),ns(t,Vs(t),r),n&&(r=mi(r,p|f|m,Os));var i=e.length;while(i--)Do(r,e[i]);return r}));function Ah(t,e){return Ch(t,zl(Bs(e)))}var Ph=ks((function(t,e){return null==t?{}:co(t,e)}));function Ch(t,e){if(null==t)return{};var r=Tr(Vs(t),(function(t){return[t]}));return e=Bs(e),ho(t,r,(function(t,r){return e(t,r[0])}))}function Rh(t,e,r){e=Bo(e,t);var n=-1,i=e.length;i||(i=1,t=o);while(++n<i){var s=null==t?o:t[Ca(e[n])];s===o&&(n=i,s=r),t=wc(s)?s.call(t):s}return t}function Lh(t,e,r){return null==t?t:_o(t,e,r)}function Oh(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:_o(t,e,r,n)}var Ih=Ps(bh),Dh=Ps(xh);function Nh(t,e,r){var n=sc(t),i=n||hc(t)||Vc(t);if(e=Bs(e,4),null==r){var o=t&&t.constructor;r=i?n?new o:[]:_c(t)&&wc(o)?_n(_e(t)):{}}return(i?br:Ci)(t,(function(t,n,i){return e(r,t,n,i)})),r}function kh(t,e){return null==t||Do(t,e)}function Fh(t,e,r){return null==t?t:No(t,e,jo(r))}function Vh(t,e,r,n){return n="function"==typeof n?n:o,null==t?t:No(t,e,jo(r),n)}function zh(t){return null==t?[]:Xr(t,bh(t))}function Uh(t){return null==t?[]:Xr(t,xh(t))}function jh(t,e,r){return r===o&&(r=e,e=o),r!==o&&(r=Xc(r),r=r===r?r:0),e!==o&&(e=Xc(e),e=e===e?e:0),fi(Xc(t),e,r)}function Bh(t,e,r){return e=qc(e),r===o?(r=e,e=0):r=qc(r),t=Xc(t),Vi(t,e,r)}function Hh(t,e,r){if(r&&"boolean"!=typeof r&&oa(t,e,r)&&(e=r=o),r===o&&("boolean"==typeof e?(r=e,e=o):"boolean"==typeof t&&(r=t,t=o)),t===o&&e===o?(t=0,e=1):(t=qc(t),e===o?(e=t,t=0):e=qc(e)),t>e){var n=t;t=e,e=n}if(r||t%1||e%1){var i=We();return je(t+i*(e-t+rr("1e-"+((i+"").length-1))),e)}return go(t,e)}var Gh=ds((function(t,e,r){return e=e.toLowerCase(),t+(r?qh(e):e)}));function qh(t){return yd(Jc(t).toLowerCase())}function Wh(t){return t=Jc(t),t&&t.replace(Qt,Kr).replace(He,"")}function $h(t,e,r){t=Jc(t),e=Oo(e);var n=t.length;r=r===o?n:fi(Wc(r),0,n);var i=r;return r-=e.length,r>=0&&t.slice(r,i)==e}function Xh(t){return t=Jc(t),t&&Pt.test(t)?t.replace(Tt,tn):t}function Yh(t){return t=Jc(t),t&&kt.test(t)?t.replace(Nt,"\\$&"):t}var Zh=ds((function(t,e,r){return t+(r?"-":"")+e.toLowerCase()})),Jh=ds((function(t,e,r){return t+(r?" ":"")+e.toLowerCase()})),Qh=hs("toLowerCase");function Kh(t,e,r){t=Jc(t),e=Wc(e);var n=e?fn(t):0;if(!e||n>=e)return t;var i=(e-n)/2;return xs(De(i),r)+t+xs(Ie(i),r)}function td(t,e,r){t=Jc(t),e=Wc(e);var n=e?fn(t):0;return e&&n<e?t+xs(e-n,r):t}function ed(t,e,r){t=Jc(t),e=Wc(e);var n=e?fn(t):0;return e&&n<e?xs(e-n,r)+t:t}function rd(t,e,r){return r||null==e?e=0:e&&(e=+e),qe(Jc(t).replace(Vt,""),e||0)}function nd(t,e,r){return e=(r?oa(t,e,r):e===o)?1:Wc(e),yo(Jc(t),e)}function id(){var t=arguments,e=Jc(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var od=ds((function(t,e,r){return t+(r?"_":"")+e.toLowerCase()}));function sd(t,e,r){return r&&"number"!=typeof r&&oa(t,e,r)&&(e=r=o),r=r===o?z:r>>>0,r?(t=Jc(t),t&&("string"==typeof e||null!=e&&!Ic(e))&&(e=Oo(e),!e&&nn(t))?Go(mn(t),0,r):t.split(e,r)):[]}var ad=ds((function(t,e,r){return t+(r?" ":"")+yd(e)}));function ud(t,e,r){return t=Jc(t),r=null==r?0:fi(Wc(r),0,t.length),e=Oo(e),t.slice(r,r+e.length)==e}function ld(t,e,r){var n=bn.templateSettings;r&&oa(t,e,r)&&(e=o),t=Jc(t),e=th({},e,n,Rs);var i,s,a=th({},e.imports,n.imports,Rs),u=bh(a),l=Xr(a,u),c=0,h=e.interpolate||Kt,d="__p += '",p=ne((e.escape||Kt).source+"|"+h.source+"|"+(h===Lt?qt:Kt).source+"|"+(e.evaluate||Kt).source+"|$","g"),f="//# sourceURL="+(he.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ye+"]")+"\n";t.replace(p,(function(e,r,n,o,a,u){return n||(n=o),d+=t.slice(c,u).replace(te,en),r&&(i=!0,d+="' +\n__e("+r+") +\n'"),a&&(s=!0,d+="';\n"+a+";\n__p += '"),n&&(d+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),c=u+e.length,e})),d+="';\n";var m=he.call(e,"variable")&&e.variable;m||(d="with (obj) {\n"+d+"\n}\n"),d=(s?d.replace(_t,""):d).replace(St,"$1").replace(Mt,"$1;"),d="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=bd((function(){return Ht(u,f+"return "+d).apply(o,l)}));if(g.source=d,vc(g))throw g;return g}function cd(t){return Jc(t).toLowerCase()}function hd(t){return Jc(t).toUpperCase()}function dd(t,e,r){if(t=Jc(t),t&&(r||e===o))return t.replace(Ft,"");if(!t||!(e=Oo(e)))return t;var n=mn(t),i=mn(e),s=Zr(n,i),a=Jr(n,i)+1;return Go(n,s,a).join("")}function pd(t,e,r){if(t=Jc(t),t&&(r||e===o))return t.replace(zt,"");if(!t||!(e=Oo(e)))return t;var n=mn(t),i=Jr(n,mn(e))+1;return Go(n,0,i).join("")}function fd(t,e,r){if(t=Jc(t),t&&(r||e===o))return t.replace(Vt,"");if(!t||!(e=Oo(e)))return t;var n=mn(t),i=Zr(n,mn(e));return Go(n,i).join("")}function md(t,e){var r=P,n=C;if(_c(e)){var i="separator"in e?e.separator:i;r="length"in e?Wc(e.length):r,n="omission"in e?Oo(e.omission):n}t=Jc(t);var s=t.length;if(nn(t)){var a=mn(t);s=a.length}if(r>=s)return t;var u=r-fn(n);if(u<1)return n;var l=a?Go(a,0,u).join(""):t.slice(0,u);if(i===o)return l+n;if(a&&(u+=l.length-u),Ic(i)){if(t.slice(u).search(i)){var c,h=l;i.global||(i=ne(i.source,Jc(Wt.exec(i))+"g")),i.lastIndex=0;while(c=i.exec(h))var d=c.index;l=l.slice(0,d===o?u:d)}}else if(t.indexOf(Oo(i),u)!=u){var p=l.lastIndexOf(i);p>-1&&(l=l.slice(0,p))}return l+n}function gd(t){return t=Jc(t),t&&At.test(t)?t.replace(Et,gn):t}var vd=ds((function(t,e,r){return t+(r?" ":"")+e.toUpperCase()})),yd=hs("toUpperCase");function wd(t,e,r){return t=Jc(t),e=r?o:e,e===o?on(t)?wn(t):Ir(t):t.match(e)||[]}var bd=wo((function(t,e){try{return yr(t,o,e)}catch(r){return vc(r)?r:new i(r)}})),xd=ks((function(t,e){return br(e,(function(e){e=Ca(e),di(t,e,Rl(t[e],t))})),t}));function _d(t){var e=null==t?0:t.length,r=Bs();return t=e?Tr(t,(function(t){if("function"!=typeof t[1])throw new oe(l);return[r(t[0]),t[1]]})):[],wo((function(r){var n=-1;while(++n<e){var i=t[n];if(yr(i[0],this,r))return yr(i[1],this,r)}}))}function Sd(t){return gi(mi(t,p))}function Md(t){return function(){return t}}function Ed(t,e){return null==t||t!==t?e:t}var Td=gs(),Ad=gs(!0);function Pd(t){return t}function Cd(t){return Ki("function"==typeof t?t:mi(t,p))}function Rd(t){return io(mi(t,p))}function Ld(t,e){return oo(t,mi(e,p))}var Od=wo((function(t,e){return function(r){return ji(r,t,e)}})),Id=wo((function(t,e){return function(r){return ji(t,r,e)}}));function Dd(t,e,r){var n=bh(e),i=Li(e,n);null!=r||_c(e)&&(i.length||!n.length)||(r=e,e=t,t=this,i=Li(e,bh(e)));var o=!(_c(r)&&"chain"in r)||!!r.chain,s=wc(t);return br(i,(function(r){var n=e[r];t[r]=n,s&&(t.prototype[r]=function(){var e=this.__chain__;if(o||e){var r=t(this.__wrapped__),i=r.__actions__=rs(this.__actions__);return i.push({func:n,args:arguments,thisArg:t}),r.__chain__=e,r}return n.apply(t,Ar([this.value()],arguments))})})),t}function Nd(){return sr._===this&&(sr._=ge),this}function kd(){}function Fd(t){return t=Wc(t),wo((function(e){return uo(e,t)}))}var Vd=bs(Tr),zd=bs(_r),Ud=bs(Rr);function jd(t){return sa(t)?Ur(Ca(t)):po(t)}function Bd(t){return function(e){return null==t?o:Oi(t,e)}}var Hd=Ss(),Gd=Ss(!0);function qd(){return[]}function Wd(){return!1}function $d(){return{}}function Xd(){return""}function Yd(){return!0}function Zd(t,e){if(t=Wc(t),t<1||t>k)return[];var r=z,n=je(t,z);e=Bs(e),t-=z;var i=qr(n,e);while(++r<t)e(r);return i}function Jd(t){return sc(t)?Tr(t,Ca):Fc(t)?[t]:rs(Pa(Jc(t)))}function Qd(t){var e=++de;return Jc(t)+e}var Kd=ws((function(t,e){return t+e}),0),tp=Ts("ceil"),ep=ws((function(t,e){return t/e}),1),rp=Ts("floor");function np(t){return t&&t.length?Si(t,Pd,Ni):o}function ip(t,e){return t&&t.length?Si(t,Bs(e,2),Ni):o}function op(t){return zr(t,Pd)}function sp(t,e){return zr(t,Bs(e,2))}function ap(t){return t&&t.length?Si(t,Pd,ro):o}function up(t,e){return t&&t.length?Si(t,Bs(e,2),ro):o}var lp=ws((function(t,e){return t*e}),1),cp=Ts("round"),hp=ws((function(t,e){return t-e}),0);function dp(t){return t&&t.length?Gr(t,Pd):0}function pp(t,e){return t&&t.length?Gr(t,Bs(e,2)):0}return bn.after=Al,bn.ary=Pl,bn.assign=Qc,bn.assignIn=Kc,bn.assignInWith=th,bn.assignWith=eh,bn.at=rh,bn.before=Cl,bn.bind=Rl,bn.bindAll=xd,bn.bindKey=Ll,bn.castArray=Zl,bn.chain=Hu,bn.chunk=Ia,bn.compact=Da,bn.concat=Na,bn.cond=_d,bn.conforms=Sd,bn.constant=Md,bn.countBy=tl,bn.create=nh,bn.curry=Ol,bn.curryRight=Il,bn.debounce=Dl,bn.defaults=ih,bn.defaultsDeep=oh,bn.defer=Nl,bn.delay=kl,bn.difference=ka,bn.differenceBy=Fa,bn.differenceWith=Va,bn.drop=za,bn.dropRight=Ua,bn.dropRightWhile=ja,bn.dropWhile=Ba,bn.fill=Ha,bn.filter=rl,bn.flatMap=ol,bn.flatMapDeep=sl,bn.flatMapDepth=al,bn.flatten=Wa,bn.flattenDeep=$a,bn.flattenDepth=Xa,bn.flip=Fl,bn.flow=Td,bn.flowRight=Ad,bn.fromPairs=Ya,bn.functions=dh,bn.functionsIn=ph,bn.groupBy=cl,bn.initial=Qa,bn.intersection=Ka,bn.intersectionBy=tu,bn.intersectionWith=eu,bn.invert=vh,bn.invertBy=yh,bn.invokeMap=dl,bn.iteratee=Cd,bn.keyBy=pl,bn.keys=bh,bn.keysIn=xh,bn.map=fl,bn.mapKeys=_h,bn.mapValues=Sh,bn.matches=Rd,bn.matchesProperty=Ld,bn.memoize=Vl,bn.merge=Mh,bn.mergeWith=Eh,bn.method=Od,bn.methodOf=Id,bn.mixin=Dd,bn.negate=zl,bn.nthArg=Fd,bn.omit=Th,bn.omitBy=Ah,bn.once=Ul,bn.orderBy=ml,bn.over=Vd,bn.overArgs=jl,bn.overEvery=zd,bn.overSome=Ud,bn.partial=Bl,bn.partialRight=Hl,bn.partition=gl,bn.pick=Ph,bn.pickBy=Ch,bn.property=jd,bn.propertyOf=Bd,bn.pull=su,bn.pullAll=au,bn.pullAllBy=uu,bn.pullAllWith=lu,bn.pullAt=cu,bn.range=Hd,bn.rangeRight=Gd,bn.rearg=Gl,bn.reject=wl,bn.remove=hu,bn.rest=ql,bn.reverse=du,bn.sampleSize=xl,bn.set=Lh,bn.setWith=Oh,bn.shuffle=_l,bn.slice=pu,bn.sortBy=El,bn.sortedUniq=bu,bn.sortedUniqBy=xu,bn.split=sd,bn.spread=Wl,bn.tail=_u,bn.take=Su,bn.takeRight=Mu,bn.takeRightWhile=Eu,bn.takeWhile=Tu,bn.tap=Gu,bn.throttle=$l,bn.thru=qu,bn.toArray=Gc,bn.toPairs=Ih,bn.toPairsIn=Dh,bn.toPath=Jd,bn.toPlainObject=Yc,bn.transform=Nh,bn.unary=Xl,bn.union=Au,bn.unionBy=Pu,bn.unionWith=Cu,bn.uniq=Ru,bn.uniqBy=Lu,bn.uniqWith=Ou,bn.unset=kh,bn.unzip=Iu,bn.unzipWith=Du,bn.update=Fh,bn.updateWith=Vh,bn.values=zh,bn.valuesIn=Uh,bn.without=Nu,bn.words=wd,bn.wrap=Yl,bn.xor=ku,bn.xorBy=Fu,bn.xorWith=Vu,bn.zip=zu,bn.zipObject=Uu,bn.zipObjectDeep=ju,bn.zipWith=Bu,bn.entries=Ih,bn.entriesIn=Dh,bn.extend=Kc,bn.extendWith=th,Dd(bn,bn),bn.add=Kd,bn.attempt=bd,bn.camelCase=Gh,bn.capitalize=qh,bn.ceil=tp,bn.clamp=jh,bn.clone=Jl,bn.cloneDeep=Kl,bn.cloneDeepWith=tc,bn.cloneWith=Ql,bn.conformsTo=ec,bn.deburr=Wh,bn.defaultTo=Ed,bn.divide=ep,bn.endsWith=$h,bn.eq=rc,bn.escape=Xh,bn.escapeRegExp=Yh,bn.every=el,bn.find=nl,bn.findIndex=Ga,bn.findKey=sh,bn.findLast=il,bn.findLastIndex=qa,bn.findLastKey=ah,bn.floor=rp,bn.forEach=ul,bn.forEachRight=ll,bn.forIn=uh,bn.forInRight=lh,bn.forOwn=ch,bn.forOwnRight=hh,bn.get=fh,bn.gt=nc,bn.gte=ic,bn.has=mh,bn.hasIn=gh,bn.head=Za,bn.identity=Pd,bn.includes=hl,bn.indexOf=Ja,bn.inRange=Bh,bn.invoke=wh,bn.isArguments=oc,bn.isArray=sc,bn.isArrayBuffer=ac,bn.isArrayLike=uc,bn.isArrayLikeObject=lc,bn.isBoolean=cc,bn.isBuffer=hc,bn.isDate=dc,bn.isElement=pc,bn.isEmpty=fc,bn.isEqual=mc,bn.isEqualWith=gc,bn.isError=vc,bn.isFinite=yc,bn.isFunction=wc,bn.isInteger=bc,bn.isLength=xc,bn.isMap=Mc,bn.isMatch=Ec,bn.isMatchWith=Tc,bn.isNaN=Ac,bn.isNative=Pc,bn.isNil=Rc,bn.isNull=Cc,bn.isNumber=Lc,bn.isObject=_c,bn.isObjectLike=Sc,bn.isPlainObject=Oc,bn.isRegExp=Ic,bn.isSafeInteger=Dc,bn.isSet=Nc,bn.isString=kc,bn.isSymbol=Fc,bn.isTypedArray=Vc,bn.isUndefined=zc,bn.isWeakMap=Uc,bn.isWeakSet=jc,bn.join=ru,bn.kebabCase=Zh,bn.last=nu,bn.lastIndexOf=iu,bn.lowerCase=Jh,bn.lowerFirst=Qh,bn.lt=Bc,bn.lte=Hc,bn.max=np,bn.maxBy=ip,bn.mean=op,bn.meanBy=sp,bn.min=ap,bn.minBy=up,bn.stubArray=qd,bn.stubFalse=Wd,bn.stubObject=$d,bn.stubString=Xd,bn.stubTrue=Yd,bn.multiply=lp,bn.nth=ou,bn.noConflict=Nd,bn.noop=kd,bn.now=Tl,bn.pad=Kh,bn.padEnd=td,bn.padStart=ed,bn.parseInt=rd,bn.random=Hh,bn.reduce=vl,bn.reduceRight=yl,bn.repeat=nd,bn.replace=id,bn.result=Rh,bn.round=cp,bn.runInContext=t,bn.sample=bl,bn.size=Sl,bn.snakeCase=od,bn.some=Ml,bn.sortedIndex=fu,bn.sortedIndexBy=mu,bn.sortedIndexOf=gu,bn.sortedLastIndex=vu,bn.sortedLastIndexBy=yu,bn.sortedLastIndexOf=wu,bn.startCase=ad,bn.startsWith=ud,bn.subtract=hp,bn.sum=dp,bn.sumBy=pp,bn.template=ld,bn.times=Zd,bn.toFinite=qc,bn.toInteger=Wc,bn.toLength=$c,bn.toLower=cd,bn.toNumber=Xc,bn.toSafeInteger=Zc,bn.toString=Jc,bn.toUpper=hd,bn.trim=dd,bn.trimEnd=pd,bn.trimStart=fd,bn.truncate=md,bn.unescape=gd,bn.uniqueId=Qd,bn.upperCase=vd,bn.upperFirst=yd,bn.each=ul,bn.eachRight=ll,bn.first=Za,Dd(bn,function(){var t={};return Ci(bn,(function(e,r){he.call(bn.prototype,r)||(t[r]=e)})),t}(),{chain:!1}),bn.VERSION=s,br(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){bn[t].placeholder=bn})),br(["drop","take"],(function(t,e){En.prototype[t]=function(r){r=r===o?1:Ue(Wc(r),0);var n=this.__filtered__&&!e?new En(this):this.clone();return n.__filtered__?n.__takeCount__=je(r,n.__takeCount__):n.__views__.push({size:je(r,z),type:t+(n.__dir__<0?"Right":"")}),n},En.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),br(["filter","map","takeWhile"],(function(t,e){var r=e+1,n=r==O||r==D;En.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:Bs(t,3),type:r}),e.__filtered__=e.__filtered__||n,e}})),br(["head","last"],(function(t,e){var r="take"+(e?"Right":"");En.prototype[t]=function(){return this[r](1).value()[0]}})),br(["initial","tail"],(function(t,e){var r="drop"+(e?"":"Right");En.prototype[t]=function(){return this.__filtered__?new En(this):this[r](1)}})),En.prototype.compact=function(){return this.filter(Pd)},En.prototype.find=function(t){return this.filter(t).head()},En.prototype.findLast=function(t){return this.reverse().find(t)},En.prototype.invokeMap=wo((function(t,e){return"function"==typeof t?new En(this):this.map((function(r){return ji(r,t,e)}))})),En.prototype.reject=function(t){return this.filter(zl(Bs(t)))},En.prototype.slice=function(t,e){t=Wc(t);var r=this;return r.__filtered__&&(t>0||e<0)?new En(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==o&&(e=Wc(e),r=e<0?r.dropRight(-e):r.take(e-t)),r)},En.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},En.prototype.toArray=function(){return this.take(z)},Ci(En.prototype,(function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),n=/^(?:head|last)$/.test(e),i=bn[n?"take"+("last"==e?"Right":""):e],s=n||/^find/.test(e);i&&(bn.prototype[e]=function(){var e=this.__wrapped__,a=n?[1]:arguments,u=e instanceof En,l=a[0],c=u||sc(e),h=function(t){var e=i.apply(bn,Ar([t],a));return n&&d?e[0]:e};c&&r&&"function"==typeof l&&1!=l.length&&(u=c=!1);var d=this.__chain__,p=!!this.__actions__.length,f=s&&!d,m=u&&!p;if(!s&&c){e=m?e:new En(this);var g=t.apply(e,a);return g.__actions__.push({func:qu,args:[h],thisArg:o}),new Mn(g,d)}return f&&m?t.apply(this,a):(g=this.thru(h),f?n?g.value()[0]:g.value():g)})})),br(["pop","push","shift","sort","splice","unshift"],(function(t){var e=se[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);bn.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var i=this.value();return e.apply(sc(i)?i:[],t)}return this[r]((function(r){return e.apply(sc(r)?r:[],t)}))}})),Ci(En.prototype,(function(t,e){var r=bn[e];if(r){var n=r.name+"";he.call(ur,n)||(ur[n]=[]),ur[n].push({name:e,func:r})}})),ur[vs(o,w).name]=[{name:"wrapper",func:o}],En.prototype.clone=Tn,En.prototype.reverse=An,En.prototype.value=Pn,bn.prototype.at=Wu,bn.prototype.chain=$u,bn.prototype.commit=Xu,bn.prototype.next=Yu,bn.prototype.plant=Ju,bn.prototype.reverse=Qu,bn.prototype.toJSON=bn.prototype.valueOf=bn.prototype.value=Ku,bn.prototype.first=bn.prototype.head,Ae&&(bn.prototype[Ae]=Zu),bn},xn=bn();sr._=xn,i=function(){return xn}.call(e,r,e,n),i===o||(n.exports=i)}).call(this)}).call(this,r("c8ba"),r("62e4")(t))},3280:function(t,e,r){"use strict";var n=r("ebb5"),i=r("e58c"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("lastIndexOf",(function(t){return i.apply(o(this),arguments)}))},"32ce":function(t,e,r){(function(e){var r=t.exports=function(t,e){this.options=e||{},this.message=t,this.createElement()};r.prototype.createElement=function(){this.element=document.createElement("div"),this.element.className="leapjs-dialog",this.element.style.position="fixed",this.element.style.top="8px",this.element.style.left=0,this.element.style.right=0,this.element.style.textAlign="center",this.element.style.zIndex=1e3;var t=document.createElement("div");this.element.appendChild(t),t.style.className="leapjs-dialog",t.style.display="inline-block",t.style.margin="auto",t.style.padding="8px",t.style.color="#222",t.style.background="#eee",t.style.borderRadius="4px",t.style.border="1px solid #999",t.style.textAlign="left",t.style.cursor="pointer",t.style.whiteSpace="nowrap",t.style.transition="box-shadow 1s linear",t.innerHTML=this.message,this.options.onclick&&t.addEventListener("click",this.options.onclick),this.options.onmouseover&&t.addEventListener("mouseover",this.options.onmouseover),this.options.onmouseout&&t.addEventListener("mouseout",this.options.onmouseout),this.options.onmousemove&&t.addEventListener("mousemove",this.options.onmousemove)},r.prototype.show=function(){return document.body.appendChild(this.element),this},r.prototype.hide=function(){return document.body.removeChild(this.element),this},r.warnOutOfDate=function(t){t||(t={});var e="http://developer.leapmotion.com?";for(var n in t.returnTo=window.location.href,t)e+=n+"="+encodeURIComponent(t[n])+"&";var i,o=function(t){if("leapjs-decline-upgrade"!=t.target.id){var r=window.open(e,"_blank","height=800,width=1000,location=1,menubar=1,resizable=1,status=1,toolbar=1,scrollbars=1");window.focus&&r.focus()}return i.hide(),!0},s="This site requires Leap Motion Tracking V2.<button id='leapjs-accept-upgrade'  style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 16px;'>Upgrade</button><button id='leapjs-decline-upgrade' style='color: #444; transition: box-shadow 100ms linear; cursor: pointer; vertical-align: baseline; margin-left: 8px; '>Not Now</button>";return i=new r(s,{onclick:o,onmousemove:function(t){t.target==document.getElementById("leapjs-decline-upgrade")?(document.getElementById("leapjs-decline-upgrade").style.color="#000",document.getElementById("leapjs-decline-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"):(document.getElementById("leapjs-accept-upgrade").style.color="#000",document.getElementById("leapjs-accept-upgrade").style.boxShadow="0px 0px 2px #5daa00",document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none")},onmouseout:function(){document.getElementById("leapjs-decline-upgrade").style.color="#444",document.getElementById("leapjs-decline-upgrade").style.boxShadow="none",document.getElementById("leapjs-accept-upgrade").style.color="#444",document.getElementById("leapjs-accept-upgrade").style.boxShadow="none"}}),i.show()},r.hasWarnedBones=!1,r.warnBones=function(){this.hasWarnedBones||(this.hasWarnedBones=!0,console.warn("Your Leap Service is out of date"),"undefined"!==typeof e&&e.versions&&e.versions.node||this.warnOutOfDate({reason:"bones"}))}}).call(this,r("4362"))},"35e8":function(t,e,r){"use strict";t.exports={isString:function(t){return"string"===typeof t},isObject:function(t){return"object"===typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},"38cf":function(t,e,r){var n=r("23e7"),i=r("1148");n({target:"String",proto:!0},{repeat:i})},"3a7b":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").findIndex,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("findIndex",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},"3c35":function(t,e){(function(e){t.exports=e}).call(this,{})},"3c5d":function(t,e,r){"use strict";var n=r("ebb5"),i=r("50c4"),o=r("182d"),s=r("7b0b"),a=r("d039"),u=n.aTypedArray,l=n.exportTypedArrayMethod,c=a((function(){new Int8Array(1).set({})}));l("set",(function(t){u(this);var e=o(arguments.length>1?arguments[1]:void 0,1),r=this.length,n=s(t),a=i(n.length),l=0;if(a+e>r)throw RangeError("Wrong length");while(l<a)this[e+l]=n[l++]}),c)},"3ce1":function(t,e,r){t.exports={Controller:r("aaad"),Frame:r("808a"),Gesture:r("a3b3"),Hand:r("16c3"),Pointable:r("1f8f"),Finger:r("5915"),InteractionBox:r("df2a"),CircularBuffer:r("9871"),UI:r("e91a"),JSONProtocol:r("d0ea").JSONProtocol,glMatrix:r("9052"),mat3:r("9052").mat3,vec3:r("9052").vec3,loopController:void 0,version:r("077a"),_:r("17fb"),EventEmitter:r("faa1").EventEmitter,loop:function(t,e){return t&&void 0===e&&"[object Function]"==={}.toString.call(t)&&(e=t,t={}),this.loopController?t&&this.loopController.setupFrameEvents(t):this.loopController=new this.Controller(t),this.loopController.loop(e),this.loopController},plugin:function(t,e){this.Controller.plugin(t,e)}}},"3fcc":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").map,o=r("4840"),s=n.aTypedArray,a=n.aTypedArrayConstructor,u=n.exportTypedArrayMethod;u("map",(function(t){return i(s(this),t,arguments.length>1?arguments[1]:void 0,(function(t,e){return new(a(o(t,t.constructor)))(e)}))}))},4511:function(t,e,r){var n=r("4f8a"),i=r("956e"),o=r("17fb"),s=t.exports=function(t){i.call(this,t);var e=this;this.on("ready",(function(){e.reportFocus(!0)}))};o.extend(s.prototype,i.prototype),s.__proto__=i,s.prototype.setupSocket=function(){var t=this,e=new n(this.getUrl());return e.on("open",(function(){t.handleOpen()})),e.on("message",(function(e){t.handleData(e)})),e.on("close",(function(e,r){t.handleClose(e,r)})),e.on("error",(function(){t.startReconnection()})),e}},"45fc":function(t,e,r){"use strict";var n=r("23e7"),i=r("b727").some,o=r("a640"),s=r("ae40"),a=o("some"),u=s("some");n({target:"Array",proto:!0,forced:!a||!u},{some:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"466d":function(t,e,r){"use strict";var n=r("d784"),i=r("825a"),o=r("50c4"),s=r("1d80"),a=r("8aa5"),u=r("14c3");n("match",1,(function(t,e,r){return[function(e){var r=s(this),n=void 0==e?void 0:e[t];return void 0!==n?n.call(e,r):new RegExp(e)[t](String(r))},function(t){var n=r(e,t,this);if(n.done)return n.value;var s=i(t),l=String(this);if(!s.global)return u(s,l);var c=s.unicode;s.lastIndex=0;var h,d=[],p=0;while(null!==(h=u(s,l))){var f=String(h[0]);d[p]=f,""===f&&(s.lastIndex=a(l,o(s.lastIndex),c)),p++}return 0===p?null:d}]}))},"46c0":function(t){t.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON Schema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},"47bb":function(t,e,r){
/*!
  * domready (c) Dustin Diaz 2014 - License MIT
  */
!function(e,r){t.exports=r()}(0,(function(){var t,e=[],r=document,n=r.documentElement.doScroll,i="DOMContentLoaded",o=(n?/^loaded|^c/:/^loaded|^i|^c/).test(r.readyState);return o||r.addEventListener(i,t=function(){r.removeEventListener(i,t),o=1;while(t=e.shift())t()}),function(t){o?setTimeout(t,0):e.push(t)}}))},4939:function(t,e,r){},"4a75":function(t,e,r){var n=r("faa1").EventEmitter,i=r("17fb"),o=t.exports=function(t,e){this.start=new Vector(t),this.end=new Vector(e),this.enteredFrame=null};o.prototype.hasPointables=function(t){for(var e=0;e!=t.pointables.length;e++){var r=t.pointables[e].tipPosition;if(r.x>=this.start.x&&r.x<=this.end.x&&r.y>=this.start.y&&r.y<=this.end.y&&r.z>=this.start.z&&r.z<=this.end.z)return!0}return!1},o.prototype.listener=function(t){var e=this;return t&&t.nearThreshold&&this.setupNearRegion(t.nearThreshold),function(t){return e.updatePosition(t)}},o.prototype.clipper=function(){var t=this;return function(e){return t.updatePosition(e),t.enteredFrame?e:null}},o.prototype.setupNearRegion=function(t){var e=this.nearRegion=new o([this.start.x-t,this.start.y-t,this.start.z-t],[this.end.x+t,this.end.y+t,this.end.z+t]),r=this;e.on("enter",(function(t){r.emit("near",t)})),e.on("exit",(function(t){r.emit("far",t)})),r.on("exit",(function(t){r.emit("near",t)}))},o.prototype.updatePosition=function(t){return this.nearRegion&&this.nearRegion.updatePosition(t),this.hasPointables(t)&&null==this.enteredFrame?(this.enteredFrame=t,this.emit("enter",this.enteredFrame)):this.hasPointables(t)||null==this.enteredFrame||(this.enteredFrame=null,this.emit("exit",this.enteredFrame)),t},o.prototype.normalize=function(t){return new Vector([(t.x-this.start.x)/(this.end.x-this.start.x),(t.y-this.start.y)/(this.end.y-this.start.y),(t.z-this.start.z)/(this.end.z-this.start.z)])},o.prototype.mapToXY=function(t,e,r){var n=this.normalize(t),i=n.x,o=n.y;return i>1?i=1:i<-1&&(i=-1),o>1?o=1:o<-1&&(o=-1),[(i+1)/2*e,(1-o)/2*r,n.z]},i.extend(o.prototype,n.prototype)},"4d63":function(t,e,r){var n=r("83ab"),i=r("da84"),o=r("94ca"),s=r("7156"),a=r("9bf2").f,u=r("241c").f,l=r("44e7"),c=r("ad6d"),h=r("9f7f"),d=r("6eeb"),p=r("d039"),f=r("69f3").set,m=r("2626"),g=r("b622"),v=g("match"),y=i.RegExp,w=y.prototype,b=/a/g,x=/a/g,_=new y(b)!==b,S=h.UNSUPPORTED_Y,M=n&&o("RegExp",!_||S||p((function(){return x[v]=!1,y(b)!=b||y(x)==x||"/a/i"!=y(b,"i")})));if(M){var E=function(t,e){var r,n=this instanceof E,i=l(t),o=void 0===e;if(!n&&i&&t.constructor===E&&o)return t;_?i&&!o&&(t=t.source):t instanceof E&&(o&&(e=c.call(t)),t=t.source),S&&(r=!!e&&e.indexOf("y")>-1,r&&(e=e.replace(/y/g,"")));var a=s(_?new y(t,e):y(t,e),n?this:w,E);return S&&r&&f(a,{sticky:r}),a},T=function(t){t in E||a(E,t,{configurable:!0,get:function(){return y[t]},set:function(e){y[t]=e}})},A=u(y),P=0;while(A.length>P)T(A[P++]);w.constructor=E,E.prototype=w,d(i,"RegExp",E)}m("RegExp")},"4db1":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d="errs__"+i,p=t.util.copy(t),f="";p.level++;var m="valid"+p.level,g=p.baseId,v="prevValid"+i,y="passingSchemas"+i;n+="var "+d+" = errors , "+v+" = false , "+h+" = false , "+y+" = null; ";var w=t.compositeRule;t.compositeRule=p.compositeRule=!0;var b=s;if(b){var x,_=-1,S=b.length-1;while(_<S)x=b[_+=1],(t.opts.strictKeywords?"object"==typeof x&&Object.keys(x).length>0:t.util.schemaHasRules(x,t.RULES.all))?(p.schema=x,p.schemaPath=a+"["+_+"]",p.errSchemaPath=u+"/"+_,n+="  "+t.validate(p)+" ",p.baseId=g):n+=" var "+m+" = true; ",_&&(n+=" if ("+m+" && "+v+") { "+h+" = false; "+y+" = ["+y+", "+_+"]; } else { ",f+="}"),n+=" if ("+m+") { "+h+" = "+v+" = true; "+y+" = "+_+"; }"}return t.compositeRule=p.compositeRule=w,n+=f+"if (!"+h+") {   var err =   ",!1!==t.createErrors?(n+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { passingSchemas: "+y+" } ",!1!==t.opts.messages&&(n+=" , message: 'should match exactly one schema in oneOf' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&l&&(t.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",t.opts.allErrors&&(n+=" } "),n}},"4de4":function(t,e,r){"use strict";var n=r("23e7"),i=r("b727").filter,o=r("1dde"),s=r("ae40"),a=o("filter"),u=s("filter");n({target:"Array",proto:!0,forced:!a||!u},{filter:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}})},"4e14":function(t,e,r){
/** @license URI.js v4.2.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */
(function(t,r){r(e)})(0,(function(t){"use strict";function e(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(e.length>1){e[0]=e[0].slice(0,-1);for(var n=e.length-1,i=1;i<n;++i)e[i]=e[i].slice(1,-1);return e[n]=e[n].slice(1),e.join("")}return e[0]}function r(t){return"(?:"+t+")"}function n(t){return void 0===t?"undefined":null===t?"null":Object.prototype.toString.call(t).split(" ").pop().split("]").shift().toLowerCase()}function i(t){return t.toUpperCase()}function o(t){return void 0!==t&&null!==t?t instanceof Array?t:"number"!==typeof t.length||t.split||t.setInterval||t.call?[t]:Array.prototype.slice.call(t):[]}function s(t,e){var r=t;if(e)for(var n in e)r[n]=e[n];return r}function a(t){var n="[A-Za-z]",i="[0-9]",o=e(i,"[A-Fa-f]"),s=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),a="[\\:\\/\\?\\#\\[\\]\\@]",u="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",l=e(a,u),c=t?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",h=t?"[\\uE000-\\uF8FF]":"[]",d=e(n,i,"[\\-\\.\\_\\~]",c),p=r(n+e(n,i,"[\\+\\-\\.]")+"*"),f=r(r(s+"|"+e(d,u,"[\\:]"))+"*"),m=(r(r("25[0-5]")+"|"+r("2[0-4]"+i)+"|"+r("1"+i+i)+"|"+r("[1-9]"+i)+"|"+i),r(r("25[0-5]")+"|"+r("2[0-4]"+i)+"|"+r("1"+i+i)+"|"+r("0?[1-9]"+i)+"|0?0?"+i)),g=r(m+"\\."+m+"\\."+m+"\\."+m),v=r(o+"{1,4}"),y=r(r(v+"\\:"+v)+"|"+g),w=r(r(v+"\\:")+"{6}"+y),b=r("\\:\\:"+r(v+"\\:")+"{5}"+y),x=r(r(v)+"?\\:\\:"+r(v+"\\:")+"{4}"+y),_=r(r(r(v+"\\:")+"{0,1}"+v)+"?\\:\\:"+r(v+"\\:")+"{3}"+y),S=r(r(r(v+"\\:")+"{0,2}"+v)+"?\\:\\:"+r(v+"\\:")+"{2}"+y),M=r(r(r(v+"\\:")+"{0,3}"+v)+"?\\:\\:"+v+"\\:"+y),E=r(r(r(v+"\\:")+"{0,4}"+v)+"?\\:\\:"+y),T=r(r(r(v+"\\:")+"{0,5}"+v)+"?\\:\\:"+v),A=r(r(r(v+"\\:")+"{0,6}"+v)+"?\\:\\:"),P=r([w,b,x,_,S,M,E,T,A].join("|")),C=r(r(d+"|"+s)+"+"),R=(r(P+"\\%25"+C),r(P+r("\\%25|\\%(?!"+o+"{2})")+C)),L=r("[vV]"+o+"+\\."+e(d,u,"[\\:]")+"+"),O=r("\\["+r(R+"|"+P+"|"+L)+"\\]"),I=r(r(s+"|"+e(d,u))+"*"),D=r(O+"|"+g+"(?!"+I+")|"+I),N=r(i+"*"),k=r(r(f+"@")+"?"+D+r("\\:"+N)+"?"),F=r(s+"|"+e(d,u,"[\\:\\@]")),V=r(F+"*"),z=r(F+"+"),U=r(r(s+"|"+e(d,u,"[\\@]"))+"+"),j=r(r("\\/"+V)+"*"),B=r("\\/"+r(z+j)+"?"),H=r(U+j),G=r(z+j),q="(?!"+F+")",W=(r(j+"|"+B+"|"+H+"|"+G+"|"+q),r(r(F+"|"+e("[\\/\\?]",h))+"*")),$=r(r(F+"|[\\/\\?]")+"*"),X=r(r("\\/\\/"+k+j)+"|"+B+"|"+G+"|"+q),Y=r(p+"\\:"+X+r("\\?"+W)+"?"+r("\\#"+$)+"?"),Z=r(r("\\/\\/"+k+j)+"|"+B+"|"+H+"|"+q),J=r(Z+r("\\?"+W)+"?"+r("\\#"+$)+"?");r(Y+"|"+J),r(p+"\\:"+X+r("\\?"+W)+"?"),r(r("\\/\\/("+r("("+f+")@")+"?("+D+")"+r("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+G+"|"+q+")"),r("\\?("+W+")"),r("\\#("+$+")"),r(r("\\/\\/("+r("("+f+")@")+"?("+D+")"+r("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+H+"|"+q+")"),r("\\?("+W+")"),r("\\#("+$+")"),r(r("\\/\\/("+r("("+f+")@")+"?("+D+")"+r("\\:("+N+")")+"?)")+"?("+j+"|"+B+"|"+G+"|"+q+")"),r("\\?("+W+")"),r("\\#("+$+")"),r("("+f+")@"),r("\\:("+N+")");return{NOT_SCHEME:new RegExp(e("[^]",n,i,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",d,u),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",d,u),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",d,u),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",d,u),"g"),NOT_QUERY:new RegExp(e("[^\\%]",d,u,"[\\:\\@\\/\\?]",h),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",d,u,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",d,u),"g"),UNRESERVED:new RegExp(d,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",d,l),"g"),PCT_ENCODED:new RegExp(s,"g"),IPV4ADDRESS:new RegExp("^("+g+")$"),IPV6ADDRESS:new RegExp("^\\[?("+P+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+C+")")+"?\\]?$")}}var u=a(!1),l=a(!0),c=function(){function t(t,e){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)if(r.push(s.value),e&&r.length===e)break}catch(u){i=!0,o=u}finally{try{!n&&a["return"]&&a["return"]()}finally{if(i)throw o}}return r}return function(e,r){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)},d=2147483647,p=36,f=1,m=26,g=38,v=700,y=72,w=128,b="-",x=/^xn--/,_=/[^\0-\x7E]/,S=/[\x2E\u3002\uFF0E\uFF61]/g,M={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=p-f,T=Math.floor,A=String.fromCharCode;function P(t){throw new RangeError(M[t])}function C(t,e){var r=[],n=t.length;while(n--)r[n]=e(t[n]);return r}function R(t,e){var r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(S,".");var i=t.split("."),o=C(i,e).join(".");return n+o}function L(t){var e=[],r=0,n=t.length;while(r<n){var i=t.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){var o=t.charCodeAt(r++);56320==(64512&o)?e.push(((1023&i)<<10)+(1023&o)+65536):(e.push(i),r--)}else e.push(i)}return e}var O=function(t){return String.fromCodePoint.apply(String,h(t))},I=function(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:p},D=function(t,e){return t+22+75*(t<26)-((0!=e)<<5)},N=function(t,e,r){var n=0;for(t=r?T(t/v):t>>1,t+=T(t/e);t>E*m>>1;n+=p)t=T(t/E);return T(n+(E+1)*t/(t+g))},k=function(t){var e=[],r=t.length,n=0,i=w,o=y,s=t.lastIndexOf(b);s<0&&(s=0);for(var a=0;a<s;++a)t.charCodeAt(a)>=128&&P("not-basic"),e.push(t.charCodeAt(a));for(var u=s>0?s+1:0;u<r;){for(var l=n,c=1,h=p;;h+=p){u>=r&&P("invalid-input");var g=I(t.charCodeAt(u++));(g>=p||g>T((d-n)/c))&&P("overflow"),n+=g*c;var v=h<=o?f:h>=o+m?m:h-o;if(g<v)break;var x=p-v;c>T(d/x)&&P("overflow"),c*=x}var _=e.length+1;o=N(n-l,_,0==l),T(n/_)>d-i&&P("overflow"),i+=T(n/_),n%=_,e.splice(n++,0,i)}return String.fromCodePoint.apply(String,e)},F=function(t){var e=[];t=L(t);var r=t.length,n=w,i=0,o=y,s=!0,a=!1,u=void 0;try{for(var l,c=t[Symbol.iterator]();!(s=(l=c.next()).done);s=!0){var h=l.value;h<128&&e.push(A(h))}}catch(W){a=!0,u=W}finally{try{!s&&c.return&&c.return()}finally{if(a)throw u}}var g=e.length,v=g;g&&e.push(b);while(v<r){var x=d,_=!0,S=!1,M=void 0;try{for(var E,C=t[Symbol.iterator]();!(_=(E=C.next()).done);_=!0){var R=E.value;R>=n&&R<x&&(x=R)}}catch(W){S=!0,M=W}finally{try{!_&&C.return&&C.return()}finally{if(S)throw M}}var O=v+1;x-n>T((d-i)/O)&&P("overflow"),i+=(x-n)*O,n=x;var I=!0,k=!1,F=void 0;try{for(var V,z=t[Symbol.iterator]();!(I=(V=z.next()).done);I=!0){var U=V.value;if(U<n&&++i>d&&P("overflow"),U==n){for(var j=i,B=p;;B+=p){var H=B<=o?f:B>=o+m?m:B-o;if(j<H)break;var G=j-H,q=p-H;e.push(A(D(H+G%q,0))),j=T(G/q)}e.push(A(D(j,0))),o=N(i,O,v==g),i=0,++v}}}catch(W){k=!0,F=W}finally{try{!I&&z.return&&z.return()}finally{if(k)throw F}}++i,++n}return e.join("")},V=function(t){return R(t,(function(t){return x.test(t)?k(t.slice(4).toLowerCase()):t}))},z=function(t){return R(t,(function(t){return _.test(t)?"xn--"+F(t):t}))},U={version:"2.1.0",ucs2:{decode:L,encode:O},decode:k,encode:F,toASCII:z,toUnicode:V},j={};function B(t){var e=t.charCodeAt(0),r=void 0;return r=e<16?"%0"+e.toString(16).toUpperCase():e<128?"%"+e.toString(16).toUpperCase():e<2048?"%"+(e>>6|192).toString(16).toUpperCase()+"%"+(63&e|128).toString(16).toUpperCase():"%"+(e>>12|224).toString(16).toUpperCase()+"%"+(e>>6&63|128).toString(16).toUpperCase()+"%"+(63&e|128).toString(16).toUpperCase(),r}function H(t){var e="",r=0,n=t.length;while(r<n){var i=parseInt(t.substr(r+1,2),16);if(i<128)e+=String.fromCharCode(i),r+=3;else if(i>=194&&i<224){if(n-r>=6){var o=parseInt(t.substr(r+4,2),16);e+=String.fromCharCode((31&i)<<6|63&o)}else e+=t.substr(r,6);r+=6}else if(i>=224){if(n-r>=9){var s=parseInt(t.substr(r+4,2),16),a=parseInt(t.substr(r+7,2),16);e+=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}else e+=t.substr(r,9);r+=9}else e+=t.substr(r,3),r+=3}return e}function G(t,e){function r(t){var r=H(t);return r.match(e.UNRESERVED)?r:t}return t.scheme&&(t.scheme=String(t.scheme).replace(e.PCT_ENCODED,r).toLowerCase().replace(e.NOT_SCHEME,"")),void 0!==t.userinfo&&(t.userinfo=String(t.userinfo).replace(e.PCT_ENCODED,r).replace(e.NOT_USERINFO,B).replace(e.PCT_ENCODED,i)),void 0!==t.host&&(t.host=String(t.host).replace(e.PCT_ENCODED,r).toLowerCase().replace(e.NOT_HOST,B).replace(e.PCT_ENCODED,i)),void 0!==t.path&&(t.path=String(t.path).replace(e.PCT_ENCODED,r).replace(t.scheme?e.NOT_PATH:e.NOT_PATH_NOSCHEME,B).replace(e.PCT_ENCODED,i)),void 0!==t.query&&(t.query=String(t.query).replace(e.PCT_ENCODED,r).replace(e.NOT_QUERY,B).replace(e.PCT_ENCODED,i)),void 0!==t.fragment&&(t.fragment=String(t.fragment).replace(e.PCT_ENCODED,r).replace(e.NOT_FRAGMENT,B).replace(e.PCT_ENCODED,i)),t}function q(t){return t.replace(/^0*(.*)/,"$1")||"0"}function W(t,e){var r=t.match(e.IPV4ADDRESS)||[],n=c(r,2),i=n[1];return i?i.split(".").map(q).join("."):t}function $(t,e){var r=t.match(e.IPV6ADDRESS)||[],n=c(r,3),i=n[1],o=n[2];if(i){for(var s=i.toLowerCase().split("::").reverse(),a=c(s,2),u=a[0],l=a[1],h=l?l.split(":").map(q):[],d=u.split(":").map(q),p=e.IPV4ADDRESS.test(d[d.length-1]),f=p?7:8,m=d.length-f,g=Array(f),v=0;v<f;++v)g[v]=h[v]||d[m+v]||"";p&&(g[f-1]=W(g[f-1],e));var y=g.reduce((function(t,e,r){if(!e||"0"===e){var n=t[t.length-1];n&&n.index+n.length===r?n.length++:t.push({index:r,length:1})}return t}),[]),w=y.sort((function(t,e){return e.length-t.length}))[0],b=void 0;if(w&&w.length>1){var x=g.slice(0,w.index),_=g.slice(w.index+w.length);b=x.join(":")+"::"+_.join(":")}else b=g.join(":");return o&&(b+="%"+o),b}return t}var X=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Y=void 0==="".match(/(){0}/)[1];function Z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==e.iri?l:u;"suffix"===e.reference&&(t=(e.scheme?e.scheme+":":"")+"//"+t);var i=t.match(X);if(i){Y?(r.scheme=i[1],r.userinfo=i[3],r.host=i[4],r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=i[7],r.fragment=i[8],isNaN(r.port)&&(r.port=i[5])):(r.scheme=i[1]||void 0,r.userinfo=-1!==t.indexOf("@")?i[3]:void 0,r.host=-1!==t.indexOf("//")?i[4]:void 0,r.port=parseInt(i[5],10),r.path=i[6]||"",r.query=-1!==t.indexOf("?")?i[7]:void 0,r.fragment=-1!==t.indexOf("#")?i[8]:void 0,isNaN(r.port)&&(r.port=t.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?i[4]:void 0)),r.host&&(r.host=$(W(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",e.reference&&"suffix"!==e.reference&&e.reference!==r.reference&&(r.error=r.error||"URI is not a "+e.reference+" reference.");var o=j[(e.scheme||r.scheme||"").toLowerCase()];if(e.unicodeSupport||o&&o.unicodeSupport)G(r,n);else{if(r.host&&(e.domainHost||o&&o.domainHost))try{r.host=U.toASCII(r.host.replace(n.PCT_ENCODED,H).toLowerCase())}catch(s){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+s}G(r,u)}o&&o.parse&&o.parse(r,e)}else r.error=r.error||"URI can not be parsed.";return r}function J(t,e){var r=!1!==e.iri?l:u,n=[];return void 0!==t.userinfo&&(n.push(t.userinfo),n.push("@")),void 0!==t.host&&n.push($(W(String(t.host),r),r).replace(r.IPV6ADDRESS,(function(t,e,r){return"["+e+(r?"%25"+r:"")+"]"}))),"number"===typeof t.port&&(n.push(":"),n.push(t.port.toString(10))),n.length?n.join(""):void 0}var Q=/^\.\.?\//,K=/^\/\.(\/|$)/,tt=/^\/\.\.(\/|$)/,et=/^\/?(?:.|\n)*?(?=\/|$)/;function rt(t){var e=[];while(t.length)if(t.match(Q))t=t.replace(Q,"");else if(t.match(K))t=t.replace(K,"/");else if(t.match(tt))t=t.replace(tt,"/"),e.pop();else if("."===t||".."===t)t="";else{var r=t.match(et);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];t=t.slice(n.length),e.push(n)}return e.join("")}function nt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.iri?l:u,n=[],i=j[(e.scheme||t.scheme||"").toLowerCase()];if(i&&i.serialize&&i.serialize(t,e),t.host)if(r.IPV6ADDRESS.test(t.host));else if(e.domainHost||i&&i.domainHost)try{t.host=e.iri?U.toUnicode(t.host):U.toASCII(t.host.replace(r.PCT_ENCODED,H).toLowerCase())}catch(a){t.error=t.error||"Host's domain name can not be converted to "+(e.iri?"Unicode":"ASCII")+" via punycode: "+a}G(t,r),"suffix"!==e.reference&&t.scheme&&(n.push(t.scheme),n.push(":"));var o=J(t,e);if(void 0!==o&&("suffix"!==e.reference&&n.push("//"),n.push(o),t.path&&"/"!==t.path.charAt(0)&&n.push("/")),void 0!==t.path){var s=t.path;e.absolutePath||i&&i.absolutePath||(s=rt(s)),void 0===o&&(s=s.replace(/^\/\//,"/%2F")),n.push(s)}return void 0!==t.query&&(n.push("?"),n.push(t.query)),void 0!==t.fragment&&(n.push("#"),n.push(t.fragment)),n.join("")}function it(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments[3],i={};return n||(t=Z(nt(t,r),r),e=Z(nt(e,r),r)),r=r||{},!r.tolerant&&e.scheme?(i.scheme=e.scheme,i.userinfo=e.userinfo,i.host=e.host,i.port=e.port,i.path=rt(e.path||""),i.query=e.query):(void 0!==e.userinfo||void 0!==e.host||void 0!==e.port?(i.userinfo=e.userinfo,i.host=e.host,i.port=e.port,i.path=rt(e.path||""),i.query=e.query):(e.path?("/"===e.path.charAt(0)?i.path=rt(e.path):(void 0===t.userinfo&&void 0===t.host&&void 0===t.port||t.path?t.path?i.path=t.path.slice(0,t.path.lastIndexOf("/")+1)+e.path:i.path=e.path:i.path="/"+e.path,i.path=rt(i.path)),i.query=e.query):(i.path=t.path,void 0!==e.query?i.query=e.query:i.query=t.query),i.userinfo=t.userinfo,i.host=t.host,i.port=t.port),i.scheme=t.scheme),i.fragment=e.fragment,i}function ot(t,e,r){var n=s({scheme:"null"},r);return nt(it(Z(t,n),Z(e,n),n,!0),n)}function st(t,e){return"string"===typeof t?t=nt(Z(t,e),e):"object"===n(t)&&(t=Z(nt(t,e),e)),t}function at(t,e,r){return"string"===typeof t?t=nt(Z(t,r),r):"object"===n(t)&&(t=nt(t,r)),"string"===typeof e?e=nt(Z(e,r),r):"object"===n(e)&&(e=nt(e,r)),t===e}function ut(t,e){return t&&t.toString().replace(e&&e.iri?l.ESCAPE:u.ESCAPE,B)}function lt(t,e){return t&&t.toString().replace(e&&e.iri?l.PCT_ENCODED:u.PCT_ENCODED,H)}var ct={scheme:"http",domainHost:!0,parse:function(t,e){return t.host||(t.error=t.error||"HTTP URIs must have a host."),t},serialize:function(t,e){return t.port!==("https"!==String(t.scheme).toLowerCase()?80:443)&&""!==t.port||(t.port=void 0),t.path||(t.path="/"),t}},ht={scheme:"https",domainHost:ct.domainHost,parse:ct.parse,serialize:ct.serialize},dt={},pt=!0,ft="[A-Za-z0-9\\-\\.\\_\\~"+(pt?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",mt="[0-9A-Fa-f]",gt=r(r("%[EFef]"+mt+"%"+mt+mt+"%"+mt+mt)+"|"+r("%[89A-Fa-f]"+mt+"%"+mt+mt)+"|"+r("%"+mt+mt)),vt="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",yt="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",wt=e(yt,'[\\"\\\\]'),bt="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",xt=new RegExp(ft,"g"),_t=new RegExp(gt,"g"),St=new RegExp(e("[^]",vt,"[\\.]",'[\\"]',wt),"g"),Mt=new RegExp(e("[^]",ft,bt),"g"),Et=Mt;function Tt(t){var e=H(t);return e.match(xt)?e:t}var At={scheme:"mailto",parse:function(t,e){var r=t,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var i=!1,o={},s=r.query.split("&"),a=0,u=s.length;a<u;++a){var l=s[a].split("=");switch(l[0]){case"to":for(var c=l[1].split(","),h=0,d=c.length;h<d;++h)n.push(c[h]);break;case"subject":r.subject=lt(l[1],e);break;case"body":r.body=lt(l[1],e);break;default:i=!0,o[lt(l[0],e)]=lt(l[1],e);break}}i&&(r.headers=o)}r.query=void 0;for(var p=0,f=n.length;p<f;++p){var m=n[p].split("@");if(m[0]=lt(m[0]),e.unicodeSupport)m[1]=lt(m[1],e).toLowerCase();else try{m[1]=U.toASCII(lt(m[1],e).toLowerCase())}catch(g){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+g}n[p]=m.join("@")}return r},serialize:function(t,e){var r=t,n=o(t.to);if(n){for(var s=0,a=n.length;s<a;++s){var u=String(n[s]),l=u.lastIndexOf("@"),c=u.slice(0,l).replace(_t,Tt).replace(_t,i).replace(St,B),h=u.slice(l+1);try{h=e.iri?U.toUnicode(h):U.toASCII(lt(h,e).toLowerCase())}catch(m){r.error=r.error||"Email address's domain name can not be converted to "+(e.iri?"Unicode":"ASCII")+" via punycode: "+m}n[s]=c+"@"+h}r.path=n.join(",")}var d=t.headers=t.headers||{};t.subject&&(d["subject"]=t.subject),t.body&&(d["body"]=t.body);var p=[];for(var f in d)d[f]!==dt[f]&&p.push(f.replace(_t,Tt).replace(_t,i).replace(Mt,B)+"="+d[f].replace(_t,Tt).replace(_t,i).replace(Et,B));return p.length&&(r.query=p.join("&")),r}},Pt=/^([^\:]+)\:(.*)/,Ct={scheme:"urn",parse:function(t,e){var r=t.path&&t.path.match(Pt),n=t;if(r){var i=e.scheme||n.scheme||"urn",o=r[1].toLowerCase(),s=r[2],a=i+":"+(e.nid||o),u=j[a];n.nid=o,n.nss=s,n.path=void 0,u&&(n=u.parse(n,e))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(t,e){var r=e.scheme||t.scheme||"urn",n=t.nid,i=r+":"+(e.nid||n),o=j[i];o&&(t=o.serialize(t,e));var s=t,a=t.nss;return s.path=(n||e.nid)+":"+a,s}},Rt=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Lt={scheme:"urn:uuid",parse:function(t,e){var r=t;return r.uuid=r.nss,r.nss=void 0,e.tolerant||r.uuid&&r.uuid.match(Rt)||(r.error=r.error||"UUID is not valid."),r},serialize:function(t,e){var r=t;return r.nss=(t.uuid||"").toLowerCase(),r}};j[ct.scheme]=ct,j[ht.scheme]=ht,j[At.scheme]=At,j[Ct.scheme]=Ct,j[Lt.scheme]=Lt,t.SCHEMES=j,t.pctEncChar=B,t.pctDecChars=H,t.parse=Z,t.removeDotSegments=rt,t.serialize=nt,t.resolveComponents=it,t.resolve=ot,t.normalize=st,t.equal=at,t.escapeComponent=ut,t.unescapeComponent=lt,Object.defineProperty(t,"__esModule",{value:!0})}))},"4f8a":function(t,e,r){(function(e){t.exports=function(){return e.WebSocket||e.MozWebSocket}}).call(this,r("c8ba"))},5377:function(t,e,r){var n=r("83ab"),i=r("9bf2"),o=r("ad6d"),s=r("9f7f").UNSUPPORTED_Y;n&&("g"!=/./g.flags||s)&&i.f(RegExp.prototype,"flags",{configurable:!0,get:o})},5698:function(t,e,r){var n=this,i=["document","window","navigator","CSSStyleDeclaration","d3","Sizzle"],o={};i.forEach((function(t){t in n&&(o[t]=n[t])})),navigator=window.navigator,CSSStyleDeclaration=window.CSSStyleDeclaration,Sizzle=r("9091"),r("e735"),t.exports=d3,i.forEach((function(t){t in o?n[t]=o[t]:delete n[t]}))},5915:function(t,e,r){var n=r("1f8f"),i=r("74d0"),o=r("32ce"),s=r("17fb"),a=t.exports=function(t){n.call(this,t),this.dipPosition=t.dipPosition,this.pipPosition=t.pipPosition,this.mcpPosition=t.mcpPosition,this.carpPosition=t.carpPosition,this.extended=t.extended,this.type=t.type,this.finger=!0,this.positions=[this.carpPosition,this.mcpPosition,this.pipPosition,this.dipPosition,this.tipPosition],t.bases?this.addBones(t):o.warnBones()};s.extend(a.prototype,n.prototype),a.prototype.addBones=function(t){this.metacarpal=new i(this,{type:0,width:this.width,prevJoint:this.carpPosition,nextJoint:this.mcpPosition,basis:t.bases[0]}),this.proximal=new i(this,{type:1,width:this.width,prevJoint:this.mcpPosition,nextJoint:this.pipPosition,basis:t.bases[1]}),this.medial=new i(this,{type:2,width:this.width,prevJoint:this.pipPosition,nextJoint:this.dipPosition,basis:t.bases[2]}),this.distal=new i(this,{type:3,width:this.width,prevJoint:this.dipPosition,nextJoint:t.btipPosition,basis:t.bases[3]}),this.bones=[this.metacarpal,this.proximal,this.medial,this.distal]},a.prototype.toString=function(){return"Finger [ id:"+this.id+" "+this.length+"mmx | width:"+this.width+"mm | direction:"+this.direction+" ]"},a.Invalid={valid:!1}},"5a43":function(t,e){function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}t.exports=r},"5c3d":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.schema[e],o=t.errSchemaPath+"/"+e,s=(t.opts.allErrors,t.util.toQuotedString(i));return!0===t.opts.$comment?n+=" console.log("+s+");":"function"==typeof t.opts.$comment&&(n+=" self._opts.$comment("+s+", "+t.util.toQuotedString(o)+", validate.root.schema);"),n}},"5c62":function(t,e,r){"use strict";r.r(e),r.d(e,"initEmbedJolecule",(function(){return Up})),r.d(e,"initFullPageJolecule",(function(){return jp})),r.d(e,"makePdbDataServer",(function(){return Hp})),r.d(e,"makeDataServer",(function(){return Gp})),r.d(e,"AquariaAlignment",(function(){return zp}));var n=r("1157"),i=r.n(n),o=r("2ef0"),s=r.n(o);function a(){}void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(void 0!==n&&null!==n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}}(),Object.assign(a.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var r=this._listeners,n=r[t];if(void 0!==n){var i=n.indexOf(e);-1!==i&&n.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,r=e[t.type];if(void 0!==r){t.target=this;for(var n=r.slice(0),i=0,o=n.length;i<o;i++)n[i].call(this,t)}}}});var u="92",l=0,c=1,h=2,d=1,p=2,f=0,m=1,g=2,v=1,y=0,w=1,b=2,x=0,_=1,S=2,M=3,E=4,T=5,A=100,P=101,C=102,R=103,L=104,O=200,I=201,D=202,N=203,k=204,F=205,V=206,z=207,U=208,j=209,B=210,H=0,G=1,q=2,W=3,$=4,X=5,Y=6,Z=7,J=0,Q=1,K=2,tt=0,et=1,rt=2,nt=3,it=4,ot=300,st=301,at=302,ut=303,lt=304,ct=305,ht=306,dt=307,pt=1e3,ft=1001,mt=1002,gt=1003,vt=1004,yt=1005,wt=1006,bt=1007,xt=1008,_t=1009,St=1010,Mt=1011,Et=1012,Tt=1013,At=1014,Pt=1015,Ct=1016,Rt=1017,Lt=1018,Ot=1019,It=1020,Dt=1021,Nt=1022,kt=1023,Ft=1024,Vt=1025,zt=1026,Ut=1027,jt=33776,Bt=33777,Ht=33778,Gt=33779,qt=35840,Wt=35841,$t=35842,Xt=35843,Yt=36196,Zt=37808,Jt=37809,Qt=37810,Kt=37811,te=37812,ee=37813,re=37814,ne=37815,ie=37816,oe=37817,se=37818,ae=37819,ue=37820,le=37821,ce=2200,he=2201,de=2202,pe=2300,fe=2301,me=2302,ge=2400,ve=2401,ye=2402,we=0,be=1,xe=2,_e=3e3,Se=3001,Me=3007,Ee=3002,Te=3004,Ae=3005,Pe=3006,Ce=3200,Re=3201,Le={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0,i=4294967295*Math.random()|0,o=t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&r]+t[r>>8&255]+"-"+t[r>>16&15|64]+t[r>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255];return o.toUpperCase()}}(),clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,n,i){return n+(t-e)*(i-n)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},smoothstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*(3-2*t))},smootherstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e),t*t*t*(t*(6*t-15)+10))},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Le.DEG2RAD},radToDeg:function(t){return t*Le.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Oe(t,e){this.x=t||0,this.y=e||0}function Ie(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function De(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._w=void 0!==n?n:1}function Ne(t,e,r){this.x=t||0,this.y=e||0,this.z=r||0}function ke(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Oe.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Oe.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,r=this.y,n=t.elements;return this.x=n[0]*e+n[3]*r+n[6],this.y=n[1]*e+n[4]*r+n[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new Oe,e=new Oe;return function(r,n){return t.set(r,r),e.set(n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y;return e*e+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*r-o*n+t.x,this.y=i*n+o*r+t.y,this}}),Object.assign(Ie.prototype,{isMatrix4:!0,set:function(t,e,r,n,i,o,s,a,u,l,c,h,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=r,g[12]=n,g[1]=i,g[5]=o,g[9]=s,g[13]=a,g[2]=u,g[6]=l,g[10]=c,g[14]=h,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ie).fromArray(this.elements)},copy:function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this},copyPosition:function(t){var e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this},extractBasis:function(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this},extractRotation:function(){var t=new Ne;return function(e){var r=this.elements,n=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),s=1/t.setFromMatrixColumn(e,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[4]=n[4]*o,r[5]=n[5]*o,r[6]=n[6]*o,r[8]=n[8]*s,r[9]=n[9]*s,r[10]=n[10]*s,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,r=t.x,n=t.y,i=t.z,o=Math.cos(r),s=Math.sin(r),a=Math.cos(n),u=Math.sin(n),l=Math.cos(i),c=Math.sin(i);if("XYZ"===t.order){var h=o*l,d=o*c,p=s*l,f=s*c;e[0]=a*l,e[4]=-a*c,e[8]=u,e[1]=d+p*u,e[5]=h-f*u,e[9]=-s*a,e[2]=f-h*u,e[6]=p+d*u,e[10]=o*a}else if("YXZ"===t.order){var m=a*l,g=a*c,v=u*l,y=u*c;e[0]=m+y*s,e[4]=v*s-g,e[8]=o*u,e[1]=o*c,e[5]=o*l,e[9]=-s,e[2]=g*s-v,e[6]=y+m*s,e[10]=o*a}else if("ZXY"===t.order){m=a*l,g=a*c,v=u*l,y=u*c;e[0]=m-y*s,e[4]=-o*c,e[8]=v+g*s,e[1]=g+v*s,e[5]=o*l,e[9]=y-m*s,e[2]=-o*u,e[6]=s,e[10]=o*a}else if("ZYX"===t.order){h=o*l,d=o*c,p=s*l,f=s*c;e[0]=a*l,e[4]=p*u-d,e[8]=h*u+f,e[1]=a*c,e[5]=f*u+h,e[9]=d*u-p,e[2]=-u,e[6]=s*a,e[10]=o*a}else if("YZX"===t.order){var w=o*a,b=o*u,x=s*a,_=s*u;e[0]=a*l,e[4]=_-w*c,e[8]=x*c+b,e[1]=c,e[5]=o*l,e[9]=-s*l,e[2]=-u*l,e[6]=b*c+x,e[10]=w-_*c}else if("XZY"===t.order){w=o*a,b=o*u,x=s*a,_=s*u;e[0]=a*l,e[4]=-c,e[8]=u*l,e[1]=w*c+_,e[5]=o*l,e[9]=b*c-x,e[2]=x*c-b,e[6]=s*l,e[10]=_*c+w}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,r=t._x,n=t._y,i=t._z,o=t._w,s=r+r,a=n+n,u=i+i,l=r*s,c=r*a,h=r*u,d=n*a,p=n*u,f=i*u,m=o*s,g=o*a,v=o*u;return e[0]=1-(d+f),e[4]=c-v,e[8]=h+g,e[1]=c+v,e[5]=1-(l+f),e[9]=p-m,e[2]=h-g,e[6]=p+m,e[10]=1-(l+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new Ne,e=new Ne,r=new Ne;return function(n,i,o){var s=this.elements;return r.subVectors(n,i),0===r.lengthSq()&&(r.z=1),r.normalize(),t.crossVectors(o,r),0===t.lengthSq()&&(1===Math.abs(o.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),t.crossVectors(o,r)),t.normalize(),e.crossVectors(r,t),s[0]=t.x,s[4]=e.x,s[8]=r.x,s[1]=t.y,s[5]=e.y,s[9]=r.y,s[2]=t.z,s[6]=e.z,s[10]=r.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],s=r[4],a=r[8],u=r[12],l=r[1],c=r[5],h=r[9],d=r[13],p=r[2],f=r[6],m=r[10],g=r[14],v=r[3],y=r[7],w=r[11],b=r[15],x=n[0],_=n[4],S=n[8],M=n[12],E=n[1],T=n[5],A=n[9],P=n[13],C=n[2],R=n[6],L=n[10],O=n[14],I=n[3],D=n[7],N=n[11],k=n[15];return i[0]=o*x+s*E+a*C+u*I,i[4]=o*_+s*T+a*R+u*D,i[8]=o*S+s*A+a*L+u*N,i[12]=o*M+s*P+a*O+u*k,i[1]=l*x+c*E+h*C+d*I,i[5]=l*_+c*T+h*R+d*D,i[9]=l*S+c*A+h*L+d*N,i[13]=l*M+c*P+h*O+d*k,i[2]=p*x+f*E+m*C+g*I,i[6]=p*_+f*T+m*R+g*D,i[10]=p*S+f*A+m*L+g*N,i[14]=p*M+f*P+m*O+g*k,i[3]=v*x+y*E+w*C+b*I,i[7]=v*_+y*T+w*R+b*D,i[11]=v*S+y*A+w*L+b*N,i[15]=v*M+y*P+w*O+b*k,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new Ne;return function(e){for(var r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix4(this),e.setXYZ(r,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],r=t[4],n=t[8],i=t[12],o=t[1],s=t[5],a=t[9],u=t[13],l=t[2],c=t[6],h=t[10],d=t[14],p=t[3],f=t[7],m=t[11],g=t[15];return p*(+i*a*c-n*u*c-i*s*h+r*u*h+n*s*d-r*a*d)+f*(+e*a*d-e*u*h+i*o*h-n*o*d+n*u*l-i*a*l)+m*(+e*u*c-e*s*d-i*o*c+r*o*d+i*s*l-r*u*l)+g*(-n*s*l-e*a*c+e*s*h+n*o*c-r*o*h+r*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var r=this.elements,n=t.elements,i=n[0],o=n[1],s=n[2],a=n[3],u=n[4],l=n[5],c=n[6],h=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],w=n[15],b=p*y*h-v*f*h+v*c*m-l*y*m-p*c*w+l*f*w,x=g*f*h-d*y*h-g*c*m+u*y*m+d*c*w-u*f*w,_=d*v*h-g*p*h+g*l*m-u*v*m-d*l*w+u*p*w,S=g*p*c-d*v*c-g*l*f+u*v*f+d*l*y-u*p*y,M=i*b+o*x+s*_+a*S;if(0===M){var E="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(E);return console.warn(E),this.identity()}var T=1/M;return r[0]=b*T,r[1]=(v*f*a-p*y*a-v*s*m+o*y*m+p*s*w-o*f*w)*T,r[2]=(l*y*a-v*c*a+v*s*h-o*y*h-l*s*w+o*c*w)*T,r[3]=(p*c*a-l*f*a-p*s*h+o*f*h+l*s*m-o*c*m)*T,r[4]=x*T,r[5]=(d*y*a-g*f*a+g*s*m-i*y*m-d*s*w+i*f*w)*T,r[6]=(g*c*a-u*y*a-g*s*h+i*y*h+u*s*w-i*c*w)*T,r[7]=(u*f*a-d*c*a+d*s*h-i*f*h-u*s*m+i*c*m)*T,r[8]=_*T,r[9]=(g*p*a-d*v*a-g*o*m+i*v*m+d*o*w-i*p*w)*T,r[10]=(u*v*a-g*l*a+g*o*h-i*v*h-u*o*w+i*l*w)*T,r[11]=(d*l*a-u*p*a-d*o*h+i*p*h+u*o*m-i*l*m)*T,r[12]=S*T,r[13]=(d*v*s-g*p*s+g*o*f-i*v*f-d*o*y+i*p*y)*T,r[14]=(g*l*s-u*v*s-g*o*c+i*v*c+u*o*y-i*l*y)*T,r[15]=(u*p*s-d*l*s+d*o*c-i*p*c-u*o*f+i*l*f)*T,this},scale:function(t){var e=this.elements,r=t.x,n=t.y,i=t.z;return e[0]*=r,e[4]*=n,e[8]*=i,e[1]*=r,e[5]*=n,e[9]*=i,e[2]*=r,e[6]*=n,e[10]*=i,e[3]*=r,e[7]*=n,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,n))},makeTranslation:function(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var r=Math.cos(e),n=Math.sin(e),i=1-r,o=t.x,s=t.y,a=t.z,u=i*o,l=i*s;return this.set(u*o+r,u*s-n*a,u*a+n*s,0,u*s+n*a,l*s+r,l*a-n*o,0,u*a-n*s,l*a+n*o,i*a*a+r,0,0,0,0,1),this},makeScale:function(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this},makeShear:function(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,r){return this.makeRotationFromQuaternion(e),this.scale(r),this.setPosition(t),this},decompose:function(){var t=new Ne,e=new Ie;return function(r,n,i){var o=this.elements,s=t.set(o[0],o[1],o[2]).length(),a=t.set(o[4],o[5],o[6]).length(),u=t.set(o[8],o[9],o[10]).length(),l=this.determinant();l<0&&(s=-s),r.x=o[12],r.y=o[13],r.z=o[14],e.copy(this);var c=1/s,h=1/a,d=1/u;return e.elements[0]*=c,e.elements[1]*=c,e.elements[2]*=c,e.elements[4]*=h,e.elements[5]*=h,e.elements[6]*=h,e.elements[8]*=d,e.elements[9]*=d,e.elements[10]*=d,n.setFromRotationMatrix(e),i.x=s,i.y=a,i.z=u,this}}(),makePerspective:function(t,e,r,n,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var s=this.elements,a=2*i/(e-t),u=2*i/(r-n),l=(e+t)/(e-t),c=(r+n)/(r-n),h=-(o+i)/(o-i),d=-2*o*i/(o-i);return s[0]=a,s[4]=0,s[8]=l,s[12]=0,s[1]=0,s[5]=u,s[9]=c,s[13]=0,s[2]=0,s[6]=0,s[10]=h,s[14]=d,s[3]=0,s[7]=0,s[11]=-1,s[15]=0,this},makeOrthographic:function(t,e,r,n,i,o){var s=this.elements,a=1/(e-t),u=1/(r-n),l=1/(o-i),c=(e+t)*a,h=(r+n)*u,d=(o+i)*l;return s[0]=2*a,s[4]=0,s[8]=0,s[12]=-c,s[1]=0,s[5]=2*u,s[9]=0,s[13]=-h,s[2]=0,s[6]=0,s[10]=-2*l,s[14]=-d,s[3]=0,s[7]=0,s[11]=0,s[15]=1,this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;n<16;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<16;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}),Object.assign(De,{slerp:function(t,e,r,n){return r.copy(t).slerp(e,n)},slerpFlat:function(t,e,r,n,i,o,s){var a=r[n+0],u=r[n+1],l=r[n+2],c=r[n+3],h=i[o+0],d=i[o+1],p=i[o+2],f=i[o+3];if(c!==f||a!==h||u!==d||l!==p){var m=1-s,g=a*h+u*d+l*p+c*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var w=Math.sqrt(y),b=Math.atan2(w,g*v);m=Math.sin(m*b)/w,s=Math.sin(s*b)/w}var x=s*v;if(a=a*m+h*x,u=u*m+d*x,l=l*m+p*x,c=c*m+f*x,m===1-s){var _=1/Math.sqrt(a*a+u*u+l*l+c*c);a*=_,u*=_,l*=_,c*=_}}t[e]=a,t[e+1]=u,t[e+2]=l,t[e+3]=c}}),Object.defineProperties(De.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(De.prototype,{set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var r=t._x,n=t._y,i=t._z,o=t.order,s=Math.cos,a=Math.sin,u=s(r/2),l=s(n/2),c=s(i/2),h=a(r/2),d=a(n/2),p=a(i/2);return"XYZ"===o?(this._x=h*l*c+u*d*p,this._y=u*d*c-h*l*p,this._z=u*l*p+h*d*c,this._w=u*l*c-h*d*p):"YXZ"===o?(this._x=h*l*c+u*d*p,this._y=u*d*c-h*l*p,this._z=u*l*p-h*d*c,this._w=u*l*c+h*d*p):"ZXY"===o?(this._x=h*l*c-u*d*p,this._y=u*d*c+h*l*p,this._z=u*l*p+h*d*c,this._w=u*l*c-h*d*p):"ZYX"===o?(this._x=h*l*c-u*d*p,this._y=u*d*c+h*l*p,this._z=u*l*p-h*d*c,this._w=u*l*c+h*d*p):"YZX"===o?(this._x=h*l*c+u*d*p,this._y=u*d*c+h*l*p,this._z=u*l*p-h*d*c,this._w=u*l*c-h*d*p):"XZY"===o&&(this._x=h*l*c-u*d*p,this._y=u*d*c-h*l*p,this._z=u*l*p+h*d*c,this._w=u*l*c+h*d*p),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var r=e/2,n=Math.sin(r);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(r),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,r=t.elements,n=r[0],i=r[4],o=r[8],s=r[1],a=r[5],u=r[9],l=r[2],c=r[6],h=r[10],d=n+a+h;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(c-u)*e,this._y=(o-l)*e,this._z=(s-i)*e):n>a&&n>h?(e=2*Math.sqrt(1+n-a-h),this._w=(c-u)/e,this._x=.25*e,this._y=(i+s)/e,this._z=(o+l)/e):a>h?(e=2*Math.sqrt(1+a-n-h),this._w=(o-l)/e,this._x=(i+s)/e,this._y=.25*e,this._z=(u+c)/e):(e=2*Math.sqrt(1+h-n-a),this._w=(s-i)/e,this._x=(o+l)/e,this._y=(u+c)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new Ne,r=1e-6;return function(n,i){return void 0===e&&(e=new Ne),t=n.dot(i)+1,t<r?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,i),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var r=t._x,n=t._y,i=t._z,o=t._w,s=e._x,a=e._y,u=e._z,l=e._w;return this._x=r*l+o*s+n*u-i*a,this._y=n*l+o*a+i*s-r*u,this._z=i*l+o*u+r*a-n*s,this._w=o*l-r*s-n*a-i*u,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var r=this._x,n=this._y,i=this._z,o=this._w,s=o*t._w+r*t._x+n*t._y+i*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=r,this._y=n,this._z=i,this;var a=Math.sqrt(1-s*s);if(Math.abs(a)<.001)return this._w=.5*(o+this._w),this._x=.5*(r+this._x),this._y=.5*(n+this._y),this._z=.5*(i+this._z),this;var u=Math.atan2(a,s),l=Math.sin((1-e)*u)/a,c=Math.sin(e*u)/a;return this._w=o*l+this._w*c,this._x=r*l+this._x*c,this._y=n*l+this._y*c,this._z=i*l+this._z*c,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Ne.prototype,{isVector3:!0,set:function(t,e,r){return this.x=t,this.y=e,this.z=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new De;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new De;return function(e,r){return this.applyQuaternion(t.setFromAxisAngle(e,r))}}(),applyMatrix3:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*n,this.y=i[1]*e+i[4]*r+i[7]*n,this.z=i[2]*e+i[5]*r+i[8]*n,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements,o=1/(i[3]*e+i[7]*r+i[11]*n+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*n+i[12])*o,this.y=(i[1]*e+i[5]*r+i[9]*n+i[13])*o,this.z=(i[2]*e+i[6]*r+i[10]*n+i[14])*o,this},applyQuaternion:function(t){var e=this.x,r=this.y,n=this.z,i=t.x,o=t.y,s=t.z,a=t.w,u=a*e+o*n-s*r,l=a*r+s*e-i*n,c=a*n+i*r-o*e,h=-i*e-o*r-s*n;return this.x=u*a+h*-i+l*-s-c*-o,this.y=l*a+h*-o+c*-i-u*-s,this.z=c*a+h*-s+u*-o-l*-i,this},project:function(){var t=new Ie;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new Ie;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,r=this.y,n=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*n,this.y=i[1]*e+i[5]*r+i[9]*n,this.z=i[2]*e+i[6]*r+i[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new Ne,e=new Ne;return function(r,n){return t.set(r,r,r),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var r=t.x,n=t.y,i=t.z,o=e.x,s=e.y,a=e.z;return this.x=n*a-i*s,this.y=i*o-r*a,this.z=r*s-n*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new Ne;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new Ne;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Le.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,r=this.y-t.y,n=this.z-t.z;return e*e+r*r+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=n,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(ke.prototype,{isMatrix3:!0,set:function(t,e,r,n,i,o,s,a,u){var l=this.elements;return l[0]=t,l[1]=n,l[2]=s,l[3]=e,l[4]=i,l[5]=a,l[6]=r,l[7]=o,l[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new Ne;return function(e){for(var r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.applyMatrix3(this),e.setXYZ(r,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var r=t.elements,n=e.elements,i=this.elements,o=r[0],s=r[3],a=r[6],u=r[1],l=r[4],c=r[7],h=r[2],d=r[5],p=r[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],w=n[7],b=n[2],x=n[5],_=n[8];return i[0]=o*f+s*v+a*b,i[3]=o*m+s*y+a*x,i[6]=o*g+s*w+a*_,i[1]=u*f+l*v+c*b,i[4]=u*m+l*y+c*x,i[7]=u*g+l*w+c*_,i[2]=h*f+d*v+p*b,i[5]=h*m+d*y+p*x,i[8]=h*g+d*w+p*_,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8];return e*o*l-e*s*u-r*i*l+r*s*a+n*i*u-n*o*a},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var r=t.elements,n=this.elements,i=r[0],o=r[1],s=r[2],a=r[3],u=r[4],l=r[5],c=r[6],h=r[7],d=r[8],p=d*u-l*h,f=l*c-d*a,m=h*a-u*c,g=i*p+o*f+s*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(s*h-d*o)*y,n[2]=(l*o-s*u)*y,n[3]=f*y,n[4]=(d*i-s*c)*y,n[5]=(s*a-l*i)*y,n[6]=m*y,n[7]=(o*c-h*i)*y,n[8]=(u*i-o*a)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,r,n,i,o,s){var a=Math.cos(i),u=Math.sin(i);this.set(r*a,r*u,-r*(a*o+u*s)+o+t,-n*u,n*a,-n*(-u*o+a*s)+s+e,0,0,1)},scale:function(t,e){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this},rotate:function(t){var e=Math.cos(t),r=Math.sin(t),n=this.elements,i=n[0],o=n[3],s=n[6],a=n[1],u=n[4],l=n[7];return n[0]=e*i+r*a,n[3]=e*o+r*u,n[6]=e*s+r*l,n[1]=-r*i+e*a,n[4]=-r*o+e*u,n[7]=-r*s+e*l,this},translate:function(t,e){var r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this},equals:function(t){for(var e=this.elements,r=t.elements,n=0;n<9;n++)if(e[n]!==r[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var r=0;r<9;r++)this.elements[r]=t[r+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}});var Fe=0;function Ve(t,e,r,n,i,o,s,a,u,l){Object.defineProperty(this,"id",{value:Fe++}),this.uuid=Le.generateUUID(),this.name="",this.image=void 0!==t?t:Ve.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Ve.DEFAULT_MAPPING,this.wrapS=void 0!==r?r:ft,this.wrapT=void 0!==n?n:ft,this.magFilter=void 0!==i?i:wt,this.minFilter=void 0!==o?o:xt,this.anisotropy=void 0!==u?u:1,this.format=void 0!==s?s:kt,this.type=void 0!==a?a:_t,this.offset=new Oe(0,0),this.repeat=new Oe(1,1),this.center=new Oe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ke,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==l?l:_e,this.version=0,this.onUpdate=null}function ze(t,e,r,n){this.x=t||0,this.y=e||0,this.z=r||0,this.w=void 0!==n?n:1}function Ue(t,e,r){this.width=t,this.height=e,this.scissor=new ze(0,0,t,e),this.scissorTest=!1,this.viewport=new ze(0,0,t,e),r=r||{},void 0===r.minFilter&&(r.minFilter=wt),this.texture=new Ve(void 0,void 0,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),this.depthBuffer=void 0===r.depthBuffer||r.depthBuffer,this.stencilBuffer=void 0===r.stencilBuffer||r.stencilBuffer,this.depthTexture=void 0!==r.depthTexture?r.depthTexture:null}function je(t,e,r){Ue.call(this,t,e,r),this.activeCubeFace=0,this.activeMipMapLevel=0}function Be(t,e,r,n,i,o,s,a,u,l,c,h){Ve.call(this,null,o,s,a,u,l,n,i,c,h),this.image={data:t,width:e,height:r},this.magFilter=void 0!==u?u:gt,this.minFilter=void 0!==l?l:gt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function He(t,e){this.min=void 0!==t?t:new Ne(1/0,1/0,1/0),this.max=void 0!==e?e:new Ne(-1/0,-1/0,-1/0)}function Ge(t,e){this.center=void 0!==t?t:new Ne,this.radius=void 0!==e?e:0}function qe(t,e){this.normal=void 0!==t?t:new Ne(1,0,0),this.constant=void 0!==e?e:0}function We(t,e,r,n,i,o){this.planes=[void 0!==t?t:new qe,void 0!==e?e:new qe,void 0!==r?r:new qe,void 0!==n?n:new qe,void 0!==i?i:new qe,void 0!==o?o:new qe]}Ve.DEFAULT_IMAGE=void 0,Ve.DEFAULT_MAPPING=ot,Ve.prototype=Object.assign(Object.create(a.prototype),{constructor:Ve,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];function r(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height;var r=e.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var i=this.image;void 0===i.uuid&&(i.uuid=Le.generateUUID()),e||void 0!==t.images[i.uuid]||(t.images[i.uuid]={uuid:i.uuid,url:r(i)}),n.image=i.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===ot){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case pt:t.x=t.x-Math.floor(t.x);break;case ft:t.x=t.x<0?0:1;break;case mt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case pt:t.y=t.y-Math.floor(t.y);break;case ft:t.y=t.y<0?0:1;break;case mt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(Ve.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ze.prototype,{isVector4:!0,set:function(t,e,r,n){return this.x=t,this.y=e,this.z=r,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,r=this.y,n=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*r+o[8]*n+o[12]*i,this.y=o[1]*e+o[5]*r+o[9]*n+o[13]*i,this.z=o[2]*e+o[6]*r+o[10]*n+o[14]*i,this.w=o[3]*e+o[7]*r+o[11]*n+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,r,n,i,o=.01,s=.1,a=t.elements,u=a[0],l=a[4],c=a[8],h=a[1],d=a[5],p=a[9],f=a[2],m=a[6],g=a[10];if(Math.abs(l-h)<o&&Math.abs(c-f)<o&&Math.abs(p-m)<o){if(Math.abs(l+h)<s&&Math.abs(c+f)<s&&Math.abs(p+m)<s&&Math.abs(u+d+g-3)<s)return this.set(1,0,0,0),this;e=Math.PI;var v=(u+1)/2,y=(d+1)/2,w=(g+1)/2,b=(l+h)/4,x=(c+f)/4,_=(p+m)/4;return v>y&&v>w?v<o?(r=0,n=.707106781,i=.707106781):(r=Math.sqrt(v),n=b/r,i=x/r):y>w?y<o?(r=.707106781,n=0,i=.707106781):(n=Math.sqrt(y),r=b/n,i=_/n):w<o?(r=.707106781,n=.707106781,i=0):(i=Math.sqrt(w),r=x/i,n=_/i),this.set(r,n,i,e),this}var S=Math.sqrt((m-p)*(m-p)+(c-f)*(c-f)+(h-l)*(h-l));return Math.abs(S)<.001&&(S=1),this.x=(m-p)/S,this.y=(c-f)/S,this.z=(h-l)/S,this.w=Math.acos((u+d+g-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(r,n){return void 0===t&&(t=new ze,e=new ze),t.set(r,r,r,r),e.set(n,n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,r){return this.subVectors(e,t).multiplyScalar(r).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Ue.prototype=Object.assign(Object.create(a.prototype),{constructor:Ue,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),je.prototype=Object.create(Ue.prototype),je.prototype.constructor=je,je.prototype.isWebGLRenderTargetCube=!0,Be.prototype=Object.create(Ve.prototype),Be.prototype.constructor=Be,Be.prototype.isDataTexture=!0,Object.assign(He.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,u=t.length;a<u;a+=3){var l=t[a],c=t[a+1],h=t[a+2];l<e&&(e=l),c<r&&(r=c),h<n&&(n=h),l>i&&(i=l),c>o&&(o=c),h>s&&(s=h)}return this.min.set(e,r,n),this.max.set(i,o,s),this},setFromBufferAttribute:function(t){for(var e=1/0,r=1/0,n=1/0,i=-1/0,o=-1/0,s=-1/0,a=0,u=t.count;a<u;a++){var l=t.getX(a),c=t.getY(a),h=t.getZ(a);l<e&&(e=l),c<r&&(r=c),h<n&&(n=h),l>i&&(i=l),c>o&&(o=c),h>s&&(s=h)}return this.min.set(e,r,n),this.max.set(i,o,s),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Ne;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new Ne),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new Ne),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,r,n=new Ne;function i(i){var o=i.geometry;if(void 0!==o)if(o.isGeometry){var s=o.vertices;for(e=0,r=s.length;e<r;e++)n.copy(s[e]),n.applyMatrix4(i.matrixWorld),t.expandByPoint(n)}else if(o.isBufferGeometry){var a=o.attributes.position;if(void 0!==a)for(e=0,r=a.count;e<r;e++)n.fromBufferAttribute(a,e).applyMatrix4(i.matrixWorld),t.expandByPoint(n)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(i),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new Ne),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new Ne;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=t.constant&&r>=t.constant},intersectsTriangle:function(){var t=new Ne,e=new Ne,r=new Ne,n=new Ne,i=new Ne,o=new Ne,s=new Ne,a=new Ne,u=new Ne,l=new Ne;function c(n){var i,o;for(i=0,o=n.length-3;i<=o;i+=3){s.fromArray(n,i);var a=u.x*Math.abs(s.x)+u.y*Math.abs(s.y)+u.z*Math.abs(s.z),l=t.dot(s),c=e.dot(s),h=r.dot(s);if(Math.max(-Math.max(l,c,h),Math.min(l,c,h))>a)return!1}return!0}return function(s){if(this.isEmpty())return!1;this.getCenter(a),u.subVectors(this.max,a),t.subVectors(s.a,a),e.subVectors(s.b,a),r.subVectors(s.c,a),n.subVectors(e,t),i.subVectors(r,e),o.subVectors(t,r);var h=[0,-n.z,n.y,0,-i.z,i.y,0,-o.z,o.y,n.z,0,-n.x,i.z,0,-i.x,o.z,0,-o.x,-n.y,n.x,0,-i.y,i.x,0,-o.y,o.x,0];return!!c(h)&&(h=[1,0,0,0,1,0,0,0,1],!!c(h)&&(l.crossVectors(n,i),h=[l.x,l.y,l.z],c(h)))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new Ne),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Ne;return function(e){var r=t.copy(e).clamp(this.min,this.max);return r.sub(e).length()}}(),getBoundingSphere:function(){var t=new Ne;return function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new Ge),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new Ne,new Ne,new Ne,new Ne,new Ne,new Ne,new Ne,new Ne];return function(e){return this.isEmpty()||(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t)),this}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(Ge.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new He;return function(e,r){var n=this.center;void 0!==r?n.copy(r):t.setFromPoints(e).getCenter(n);for(var i=0,o=0,s=e.length;o<s;o++)i=Math.max(i,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new Ne),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new He),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(qe.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,r,n){return this.normal.set(t,e,r),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new Ne,e=new Ne;return function(r,n,i){var o=t.subVectors(i,n).cross(e.subVectors(r,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new Ne),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new Ne;return function(e,r){void 0===r&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new Ne);var n=e.delta(t),i=this.normal.dot(n);if(0===i)return 0===this.distanceToPoint(e.start)?r.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/i;return o<0||o>1?void 0:r.copy(n).multiplyScalar(o).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),r=this.distanceToPoint(t.end);return e<0&&r>0||r<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new Ne),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new Ne,e=new ke;return function(r,n){var i=n||e.getNormalMatrix(r),o=this.coplanarPoint(t).applyMatrix4(r),s=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(s),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(We.prototype,{set:function(t,e,r,n,i,o){var s=this.planes;return s[0].copy(t),s[1].copy(e),s[2].copy(r),s[3].copy(n),s[4].copy(i),s[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,r=0;r<6;r++)e[r].copy(t.planes[r]);return this},setFromMatrix:function(t){var e=this.planes,r=t.elements,n=r[0],i=r[1],o=r[2],s=r[3],a=r[4],u=r[5],l=r[6],c=r[7],h=r[8],d=r[9],p=r[10],f=r[11],m=r[12],g=r[13],v=r[14],y=r[15];return e[0].setComponents(s-n,c-a,f-h,y-m).normalize(),e[1].setComponents(s+n,c+a,f+h,y+m).normalize(),e[2].setComponents(s+i,c+u,f+d,y+g).normalize(),e[3].setComponents(s-i,c-u,f-d,y-g).normalize(),e[4].setComponents(s-o,c-l,f-p,y-v).normalize(),e[5].setComponents(s+o,c+l,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new Ge;return function(e){var r=e.geometry;return null===r.boundingSphere&&r.computeBoundingSphere(),t.copy(r.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new Ge;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,r=t.center,n=-t.radius,i=0;i<6;i++){var o=e[i].distanceToPoint(r);if(o<n)return!1}return!0},intersectsBox:function(){var t=new Ne,e=new Ne;return function(r){for(var n=this.planes,i=0;i<6;i++){var o=n[i];t.x=o.normal.x>0?r.min.x:r.max.x,e.x=o.normal.x>0?r.max.x:r.min.x,t.y=o.normal.y>0?r.min.y:r.max.y,e.y=o.normal.y>0?r.max.y:r.min.y,t.z=o.normal.z>0?r.min.z:r.max.z,e.z=o.normal.z>0?r.max.z:r.min.z;var s=o.distanceToPoint(t),a=o.distanceToPoint(e);if(s<0&&a<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,r=0;r<6;r++)if(e[r].distanceToPoint(t)<0)return!1;return!0}});var $e="#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",Xe="#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",Ye="#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",Ze="#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",Je="#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",Qe="\nvec3 transformed = vec3( position );\n",Ke="\nvec3 objectNormal = vec3( normal );\n",tr="float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",er="#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",rr="#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",nr="#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",ir="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",or="#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",sr="#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",ar="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",ur="#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",lr="#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",cr="#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",hr="#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",dr="vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",pr="#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",fr="#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",mr="#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",gr="#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",vr="  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",yr="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",wr="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",br="#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",xr="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",_r="#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",Sr="\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",Mr="#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",Er="#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",Tr="#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",Ar="#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",Pr="#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",Cr="#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",Rr="vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",Lr="uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",Or="#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",Ir="BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",Dr="varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",Nr="PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",kr="struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",Fr="\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",Vr="#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",zr="#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",Ur="#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",jr="#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",Br="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",Hr="#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",Gr="#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",qr="#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",Wr="#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",$r="#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",Xr="float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",Yr="#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",Zr="#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",Jr="#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",Qr="#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",Kr="#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",tn="#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",en="#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\t\tscale *= float( gl_FrontFacing ) * 2.0 - 1.0;\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",rn="vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",nn="#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",on="vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",sn="#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",an="#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",un="float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",ln="#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",cn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",hn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",dn="#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",pn="float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",fn="#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",mn="#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",gn="#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",vn="#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",yn="float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",wn="#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",bn="#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",xn="#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",_n="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",Sn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",Mn="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",En="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",Tn="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",An="#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",Pn="#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",Cn="uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",Rn="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",Ln="#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",On="#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",In="#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",Dn="#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",Nn="uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",kn="varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",Fn="uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Vn="uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",zn="uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Un="#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",jn="uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Bn="#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Hn="#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Gn="#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",qn="#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",Wn="#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",$n="#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",Xn="#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",Yn="uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",Zn="uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Jn="uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",Qn="#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",Kn={alphamap_fragment:$e,alphamap_pars_fragment:Xe,alphatest_fragment:Ye,aomap_fragment:Ze,aomap_pars_fragment:Je,begin_vertex:Qe,beginnormal_vertex:Ke,bsdfs:tr,bumpmap_pars_fragment:er,clipping_planes_fragment:rr,clipping_planes_pars_fragment:nr,clipping_planes_pars_vertex:ir,clipping_planes_vertex:or,color_fragment:sr,color_pars_fragment:ar,color_pars_vertex:ur,color_vertex:lr,common:cr,cube_uv_reflection_fragment:hr,defaultnormal_vertex:dr,displacementmap_pars_vertex:pr,displacementmap_vertex:fr,emissivemap_fragment:mr,emissivemap_pars_fragment:gr,encodings_fragment:vr,encodings_pars_fragment:yr,envmap_fragment:wr,envmap_pars_fragment:br,envmap_pars_vertex:xr,envmap_vertex:_r,fog_vertex:Sr,fog_pars_vertex:Mr,fog_fragment:Er,fog_pars_fragment:Tr,gradientmap_pars_fragment:Ar,lightmap_fragment:Pr,lightmap_pars_fragment:Cr,lights_lambert_vertex:Rr,lights_pars_begin:Lr,lights_pars_maps:Or,lights_phong_fragment:Ir,lights_phong_pars_fragment:Dr,lights_physical_fragment:Nr,lights_physical_pars_fragment:kr,lights_fragment_begin:Fr,lights_fragment_maps:Vr,lights_fragment_end:zr,logdepthbuf_fragment:Ur,logdepthbuf_pars_fragment:jr,logdepthbuf_pars_vertex:Br,logdepthbuf_vertex:Hr,map_fragment:Gr,map_pars_fragment:qr,map_particle_fragment:Wr,map_particle_pars_fragment:$r,metalnessmap_fragment:Xr,metalnessmap_pars_fragment:Yr,morphnormal_vertex:Zr,morphtarget_pars_vertex:Jr,morphtarget_vertex:Qr,normal_fragment_begin:Kr,normal_fragment_maps:tn,normalmap_pars_fragment:en,packing:rn,premultiplied_alpha_fragment:nn,project_vertex:on,dithering_fragment:sn,dithering_pars_fragment:an,roughnessmap_fragment:un,roughnessmap_pars_fragment:ln,shadowmap_pars_fragment:cn,shadowmap_pars_vertex:hn,shadowmap_vertex:dn,shadowmask_pars_fragment:pn,skinbase_vertex:fn,skinning_pars_vertex:mn,skinning_vertex:gn,skinnormal_vertex:vn,specularmap_fragment:yn,specularmap_pars_fragment:wn,tonemapping_fragment:bn,tonemapping_pars_fragment:xn,uv_pars_fragment:_n,uv_pars_vertex:Sn,uv_vertex:Mn,uv2_pars_fragment:En,uv2_pars_vertex:Tn,uv2_vertex:An,worldpos_vertex:Pn,cube_frag:Cn,cube_vert:Rn,depth_frag:Ln,depth_vert:On,distanceRGBA_frag:In,distanceRGBA_vert:Dn,equirect_frag:Nn,equirect_vert:kn,linedashed_frag:Fn,linedashed_vert:Vn,meshbasic_frag:zn,meshbasic_vert:Un,meshlambert_frag:jn,meshlambert_vert:Bn,meshphong_frag:Hn,meshphong_vert:Gn,meshphysical_frag:qn,meshphysical_vert:Wn,normal_frag:$n,normal_vert:Xn,points_frag:Yn,points_vert:Zn,shadow_frag:Jn,shadow_vert:Qn},ti={merge:function(t){for(var e={},r=0;r<t.length;r++){var n=this.clone(t[r]);for(var i in n)e[i]=n[i]}return e},clone:function(t){var e={};for(var r in t)for(var n in e[r]={},t[r]){var i=t[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[r][n]=i.clone():Array.isArray(i)?e[r][n]=i.slice():e[r][n]=i}return e}},ei={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function ri(t,e,r){return void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}Object.assign(ri.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,r){return this.r=t,this.g=e,this.b=r,this},setHSL:function(){function t(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}return function(e,r,n){if(e=Le.euclideanModulo(e,1),r=Le.clamp(r,0,1),n=Le.clamp(n,0,1),0===r)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+r):n+r-n*r,o=2*n-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,i=r[1],o=r[2];switch(i){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var s=parseFloat(n[1])/360,a=parseInt(n[2],10)/100,u=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(s,a,u)}break}}else if(r=/^\#([A-Fa-f0-9]+)$/.exec(t)){var l=r[1],c=l.length;if(3===c)return this.r=parseInt(l.charAt(0)+l.charAt(0),16)/255,this.g=parseInt(l.charAt(1)+l.charAt(1),16)/255,this.b=parseInt(l.charAt(2)+l.charAt(2),16)/255,this;if(6===c)return this.r=parseInt(l.charAt(0)+l.charAt(1),16)/255,this.g=parseInt(l.charAt(2)+l.charAt(3),16)/255,this.b=parseInt(l.charAt(4)+l.charAt(5),16)/255,this}if(t&&t.length>0){l=ei[t];void 0!==l?this.setHex(l):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var r=e>0?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(){var t=this.r,e=this.g,r=this.b;return this.r=t*t,this.g=e*e,this.b=r*r,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,r,n=this.r,i=this.g,o=this.b,s=Math.max(n,i,o),a=Math.min(n,i,o),u=(a+s)/2;if(a===s)e=0,r=0;else{var l=s-a;switch(r=u<=.5?l/(s+a):l/(2-s-a),s){case n:e=(i-o)/l+(i<o?6:0);break;case i:e=(o-n)/l+2;break;case o:e=(n-i)/l+4;break}e/=6}return t.h=e,t.s=r,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,r,n){return this.getHSL(t),t.h+=e,t.s+=r,t.l+=n,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var ni={common:{diffuse:{value:new ri(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ke},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Oe(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ri(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ri(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ke}}},ii={basic:{uniforms:ti.merge([ni.common,ni.specularmap,ni.envmap,ni.aomap,ni.lightmap,ni.fog]),vertexShader:Kn.meshbasic_vert,fragmentShader:Kn.meshbasic_frag},lambert:{uniforms:ti.merge([ni.common,ni.specularmap,ni.envmap,ni.aomap,ni.lightmap,ni.emissivemap,ni.fog,ni.lights,{emissive:{value:new ri(0)}}]),vertexShader:Kn.meshlambert_vert,fragmentShader:Kn.meshlambert_frag},phong:{uniforms:ti.merge([ni.common,ni.specularmap,ni.envmap,ni.aomap,ni.lightmap,ni.emissivemap,ni.bumpmap,ni.normalmap,ni.displacementmap,ni.gradientmap,ni.fog,ni.lights,{emissive:{value:new ri(0)},specular:{value:new ri(1118481)},shininess:{value:30}}]),vertexShader:Kn.meshphong_vert,fragmentShader:Kn.meshphong_frag},standard:{uniforms:ti.merge([ni.common,ni.envmap,ni.aomap,ni.lightmap,ni.emissivemap,ni.bumpmap,ni.normalmap,ni.displacementmap,ni.roughnessmap,ni.metalnessmap,ni.fog,ni.lights,{emissive:{value:new ri(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},points:{uniforms:ti.merge([ni.points,ni.fog]),vertexShader:Kn.points_vert,fragmentShader:Kn.points_frag},dashed:{uniforms:ti.merge([ni.common,ni.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Kn.linedashed_vert,fragmentShader:Kn.linedashed_frag},depth:{uniforms:ti.merge([ni.common,ni.displacementmap]),vertexShader:Kn.depth_vert,fragmentShader:Kn.depth_frag},normal:{uniforms:ti.merge([ni.common,ni.bumpmap,ni.normalmap,ni.displacementmap,{opacity:{value:1}}]),vertexShader:Kn.normal_vert,fragmentShader:Kn.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Kn.cube_vert,fragmentShader:Kn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Kn.equirect_vert,fragmentShader:Kn.equirect_frag},distanceRGBA:{uniforms:ti.merge([ni.common,ni.displacementmap,{referencePosition:{value:new Ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Kn.distanceRGBA_vert,fragmentShader:Kn.distanceRGBA_frag},shadow:{uniforms:ti.merge([ni.lights,ni.fog,{color:{value:new ri(0)},opacity:{value:1}}]),vertexShader:Kn.shadow_vert,fragmentShader:Kn.shadow_frag}};function oi(t){var e=new WeakMap;function r(e,r){var n=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(r,o),t.bufferData(r,n,i),e.onUploadCallback();var s=t.FLOAT;return n instanceof Float32Array?s=t.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?s=t.UNSIGNED_SHORT:n instanceof Int16Array?s=t.SHORT:n instanceof Uint32Array?s=t.UNSIGNED_INT:n instanceof Int32Array?s=t.INT:n instanceof Int8Array?s=t.BYTE:n instanceof Uint8Array&&(s=t.UNSIGNED_BYTE),{buffer:o,type:s,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}function n(e,r,n){var i=r.array,o=r.updateRange;t.bindBuffer(n,e),!1===r.dynamic?t.bufferData(n,i,t.STATIC_DRAW):-1===o.count?t.bufferSubData(n,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}function i(t){return t.isInterleavedBufferAttribute&&(t=t.data),e.get(t)}function o(r){r.isInterleavedBufferAttribute&&(r=r.data);var n=e.get(r);n&&(t.deleteBuffer(n.buffer),e.delete(r))}function s(t,i){t.isInterleavedBufferAttribute&&(t=t.data);var o=e.get(t);void 0===o?e.set(t,r(t,i)):o.version<t.version&&(n(o.buffer,t,i),o.version=t.version)}return{get:i,remove:o,update:s}}function si(t,e,r,n){this._x=t||0,this._y=e||0,this._z=r||0,this._order=n||si.DefaultOrder}function ai(){this.mask=1}ii.physical={uniforms:ti.merge([ii.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Kn.meshphysical_vert,fragmentShader:Kn.meshphysical_frag},si.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],si.DefaultOrder="XYZ",Object.defineProperties(si.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(si.prototype,{isEuler:!0,set:function(t,e,r,n){return this._x=t,this._y=e,this._z=r,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,r){var n=Le.clamp,i=t.elements,o=i[0],s=i[4],a=i[8],u=i[1],l=i[5],c=i[9],h=i[2],d=i[6],p=i[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(n(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(-c,p),this._z=Math.atan2(-s,o)):(this._x=Math.atan2(d,l),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(c,-1,1)),Math.abs(c)<.99999?(this._y=Math.atan2(a,p),this._z=Math.atan2(u,l)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-n(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-s,l))):"YZX"===e?(this._z=Math.asin(n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(a,p))):"XZY"===e?(this._z=Math.asin(-n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(d,l),this._y=Math.atan2(a,o)):(this._x=Math.atan2(-c,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==r&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new Ie;return function(e,r,n){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,r,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new De;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new Ne(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(ai.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!==(this.mask&t.mask)}});var ui=0;function li(){Object.defineProperty(this,"id",{value:ui++}),this.uuid=Le.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=li.DefaultUp.clone();var t=new Ne,e=new si,r=new De,n=new Ne(1,1,1);function i(){r.setFromEuler(e,!1)}function o(){e.setFromQuaternion(r,void 0,!1)}e.onChange(i),r.onChange(o),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:r},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new Ie},normalMatrix:{value:new ke}}),this.matrix=new Ie,this.matrixWorld=new Ie,this.matrixAutoUpdate=li.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ai,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function ci(){li.call(this),this.type="Camera",this.matrixWorldInverse=new Ie,this.projectionMatrix=new Ie}function hi(t,e,r,n,i,o){ci.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=r,this.bottom=n,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function di(t,e,r,n,i,o){this.a=t,this.b=e,this.c=r,this.normal=n&&n.isVector3?n:new Ne,this.vertexNormals=Array.isArray(n)?n:[],this.color=i&&i.isColor?i:new ri,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}li.DefaultUp=new Ne(0,1,0),li.DefaultMatrixAutoUpdate=!0,li.prototype=Object.assign(Object.create(a.prototype),{constructor:li,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new De;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new De;return function(e,r){return t.setFromAxisAngle(e,r),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new Ne(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new Ne(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new Ne(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new Ne;return function(e,r){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(r)),this}}(),translateX:function(){var t=new Ne(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new Ne(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new Ne(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new Ie;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new Ie,e=new Ne;return function(r,n,i){r.isVector3?e.copy(r):e.set(r,n,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var r=this.children.indexOf(t);return-1!==r&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(r,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var r=0,n=this.children.length;r<n;r++){var i=this.children[r],o=i.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new Ne),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new Ne,e=new Ne;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new De),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,r,e),r}}(),getWorldScale:function(){var t=new Ne,e=new De;return function(r){return void 0===r&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new Ne),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,r),r}}(),getWorldDirection:function(){var t=new De;return function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Ne),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,r=0,n=e.length;r<n;r++)e[r].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"===typeof t,r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function i(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),void 0!==this.geometry){n.geometry=i(t.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var s=o.shapes;if(Array.isArray(s))for(var a=0,u=s.length;a<u;a++){var l=s[a];i(t.shapes,l)}else i(t.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){var c=[];for(a=0,u=this.material.length;a<u;a++)c.push(i(t.materials,this.material[a]));n.material=c}else n.material=i(t.materials,this.material);if(this.children.length>0){n.children=[];for(a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(t).object)}if(e){var h=m(t.geometries),d=m(t.materials),p=m(t.textures),f=m(t.images);s=m(t.shapes);h.length>0&&(r.geometries=h),d.length>0&&(r.materials=d),p.length>0&&(r.textures=p),f.length>0&&(r.images=f),s.length>0&&(r.shapes=s)}return r.object=n,r;function m(t){var e=[];for(var r in t){var n=t[r];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var r=0;r<t.children.length;r++){var n=t.children[r];this.add(n.clone())}return this}}),ci.prototype=Object.assign(Object.create(li.prototype),{constructor:ci,isCamera:!0,copy:function(t,e){return li.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new De;return function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Ne),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){li.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),hi.prototype=Object.assign(Object.create(ci.prototype),{constructor:hi,isOrthographicCamera:!0,copy:function(t,e){return ci.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,r,n,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,i=r-t,o=r+t,s=n+e,a=n-e;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),l=this.zoom/(this.view.height/this.view.fullHeight),c=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;i+=c*(this.view.offsetX/u),o=i+c*(this.view.width/u),s-=h*(this.view.offsetY/l),a=s-h*(this.view.height/l)}this.projectionMatrix.makeOrthographic(i,o,s,a,this.near,this.far)},toJSON:function(t){var e=li.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(di.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var pi=0;function fi(){Object.defineProperty(this,"id",{value:pi+=2}),this.uuid=Le.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function mi(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function gi(t,e,r){mi.call(this,new Int8Array(t),e,r)}function vi(t,e,r){mi.call(this,new Uint8Array(t),e,r)}function yi(t,e,r){mi.call(this,new Uint8ClampedArray(t),e,r)}function wi(t,e,r){mi.call(this,new Int16Array(t),e,r)}function bi(t,e,r){mi.call(this,new Uint16Array(t),e,r)}function xi(t,e,r){mi.call(this,new Int32Array(t),e,r)}function _i(t,e,r){mi.call(this,new Uint32Array(t),e,r)}function Si(t,e,r){mi.call(this,new Float32Array(t),e,r)}function Mi(t,e,r){mi.call(this,new Float64Array(t),e,r)}function Ei(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Ti(t){if(0===t.length)return-1/0;for(var e=t[0],r=1,n=t.length;r<n;++r)t[r]>e&&(e=t[r]);return e}fi.prototype=Object.assign(Object.create(a.prototype),{constructor:fi,isGeometry:!0,applyMatrix:function(t){for(var e=(new ke).getNormalMatrix(t),r=0,n=this.vertices.length;r<n;r++){var i=this.vertices[r];i.applyMatrix4(t)}for(r=0,n=this.faces.length;r<n;r++){var o=this.faces[r];o.normal.applyMatrix3(e).normalize();for(var s=0,a=o.vertexNormals.length;s<a;s++)o.vertexNormals[s].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new Ie;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ie;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ie;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ie;return function(e,r,n){return t.makeTranslation(e,r,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ie;return function(e,r,n){return t.makeScale(e,r,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new li;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,r=null!==t.index?t.index.array:void 0,n=t.attributes,i=n.position.array,o=void 0!==n.normal?n.normal.array:void 0,s=void 0!==n.color?n.color.array:void 0,a=void 0!==n.uv?n.uv.array:void 0,u=void 0!==n.uv2?n.uv2.array:void 0;void 0!==u&&(this.faceVertexUvs[1]=[]);for(var l=[],c=[],h=[],d=0,p=0;d<i.length;d+=3,p+=2)e.vertices.push(new Ne(i[d],i[d+1],i[d+2])),void 0!==o&&l.push(new Ne(o[d],o[d+1],o[d+2])),void 0!==s&&e.colors.push(new ri(s[d],s[d+1],s[d+2])),void 0!==a&&c.push(new Oe(a[p],a[p+1])),void 0!==u&&h.push(new Oe(u[p],u[p+1]));function f(t,r,n,i){var d=void 0!==o?[l[t].clone(),l[r].clone(),l[n].clone()]:[],p=void 0!==s?[e.colors[t].clone(),e.colors[r].clone(),e.colors[n].clone()]:[],f=new di(t,r,n,d,p,i);e.faces.push(f),void 0!==a&&e.faceVertexUvs[0].push([c[t].clone(),c[r].clone(),c[n].clone()]),void 0!==u&&e.faceVertexUvs[1].push([h[t].clone(),h[r].clone(),h[n].clone()])}var m=t.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=g.count,w=(p=v,v+y);p<w;p+=3)void 0!==r?f(r[p],r[p+1],r[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==r)for(d=0;d<r.length;d+=3)f(r[d],r[d+1],r[d+2]);else for(d=0;d<i.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new Ne;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,r=0===e?1:1/e,n=new Ie;return n.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new Ne,e=new Ne,r=0,n=this.faces.length;r<n;r++){var i=this.faces[r],o=this.vertices[i.a],s=this.vertices[i.b],a=this.vertices[i.c];t.subVectors(a,s),e.subVectors(o,s),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){var e,r,n,i,o,s;for(void 0===t&&(t=!0),s=new Array(this.vertices.length),e=0,r=this.vertices.length;e<r;e++)s[e]=new Ne;if(t){var a,u,l,c=new Ne,h=new Ne;for(n=0,i=this.faces.length;n<i;n++)o=this.faces[n],a=this.vertices[o.a],u=this.vertices[o.b],l=this.vertices[o.c],c.subVectors(l,u),h.subVectors(a,u),c.cross(h),s[o.a].add(c),s[o.b].add(c),s[o.c].add(c)}else for(this.computeFaceNormals(),n=0,i=this.faces.length;n<i;n++)o=this.faces[n],s[o.a].add(o.normal),s[o.b].add(o.normal),s[o.c].add(o.normal);for(e=0,r=this.vertices.length;e<r;e++)s[e].normalize();for(n=0,i=this.faces.length;n<i;n++){o=this.faces[n];var d=o.vertexNormals;3===d.length?(d[0].copy(s[o.a]),d[1].copy(s[o.b]),d[2].copy(s[o.c])):(d[0]=s[o.a].clone(),d[1]=s[o.b].clone(),d[2]=s[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,r;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){r=this.faces[t];var n=r.vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,r,n,i;for(r=0,n=this.faces.length;r<n;r++)for(i=this.faces[r],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new fi;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var s=this.morphNormals[t].faceNormals,a=this.morphNormals[t].vertexNormals;for(r=0,n=this.faces.length;r<n;r++)u=new Ne,l={a:new Ne,b:new Ne,c:new Ne},s.push(u),a.push(l)}var u,l,c=this.morphNormals[t];for(o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals(),r=0,n=this.faces.length;r<n;r++)i=this.faces[r],u=c.faceNormals[r],l=c.vertexNormals[r],u.copy(i.normal),l.a.copy(i.vertexNormals[0]),l.b.copy(i.vertexNormals[1]),l.c.copy(i.vertexNormals[2])}for(r=0,n=this.faces.length;r<n;r++)i=this.faces[r],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new He),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Ge),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,r){if(t&&t.isGeometry){var n,i=this.vertices.length,o=this.vertices,s=t.vertices,a=this.faces,u=t.faces,l=this.faceVertexUvs[0],c=t.faceVertexUvs[0],h=this.colors,d=t.colors;void 0===r&&(r=0),void 0!==e&&(n=(new ke).getNormalMatrix(e));for(var p=0,f=s.length;p<f;p++){var m=s[p],g=m.clone();void 0!==e&&g.applyMatrix4(e),o.push(g)}for(p=0,f=d.length;p<f;p++)h.push(d[p].clone());for(p=0,f=u.length;p<f;p++){var v,y,w,b=u[p],x=b.vertexNormals,_=b.vertexColors;v=new di(b.a+i,b.b+i,b.c+i),v.normal.copy(b.normal),void 0!==n&&v.normal.applyMatrix3(n).normalize();for(var S=0,M=x.length;S<M;S++)y=x[S].clone(),void 0!==n&&y.applyMatrix3(n).normalize(),v.vertexNormals.push(y);v.color.copy(b.color);for(S=0,M=_.length;S<M;S++)w=_[S],v.vertexColors.push(w.clone());v.materialIndex=b.materialIndex+r,a.push(v)}for(p=0,f=c.length;p<f;p++){var E=c[p],T=[];if(void 0!==E){for(S=0,M=E.length;S<M;S++)T.push(E[S].clone());l.push(T)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,r,n,i,o,s,a,u={},l=[],c=[],h=4,d=Math.pow(10,h);for(r=0,n=this.vertices.length;r<n;r++)t=this.vertices[r],e=Math.round(t.x*d)+"_"+Math.round(t.y*d)+"_"+Math.round(t.z*d),void 0===u[e]?(u[e]=r,l.push(this.vertices[r]),c[r]=l.length-1):c[r]=c[u[e]];var p=[];for(r=0,n=this.faces.length;r<n;r++){i=this.faces[r],i.a=c[i.a],i.b=c[i.b],i.c=c[i.c],o=[i.a,i.b,i.c];for(var f=0;f<3;f++)if(o[f]===o[(f+1)%3]){p.push(r);break}}for(r=p.length-1;r>=0;r--){var m=p[r];for(this.faces.splice(m,1),s=0,a=this.faceVertexUvs.length;s<a;s++)this.faceVertexUvs[s].splice(m,1)}var g=this.vertices.length-l.length;return this.vertices=l,g},setFromPoints:function(t){this.vertices=[];for(var e=0,r=t.length;e<r;e++){var n=t[e];this.vertices.push(new Ne(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,r=0;r<e;r++)t[r]._id=r;function n(t,e){return t.materialIndex-e.materialIndex}t.sort(n);var i,o,s=this.faceVertexUvs[0],a=this.faceVertexUvs[1];s&&s.length===e&&(i=[]),a&&a.length===e&&(o=[]);for(r=0;r<e;r++){var u=t[r]._id;i&&i.push(s[u]),o&&o.push(a[u])}i&&(this.faceVertexUvs[0]=i),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}for(var n=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];n.push(o.x,o.y,o.z)}var s=[],a=[],u={},l=[],c={},h=[],d={};for(i=0;i<this.faces.length;i++){var p=this.faces[i],f=!0,m=!1,g=void 0!==this.faceVertexUvs[0][i],v=p.normal.length()>0,y=p.vertexNormals.length>0,w=1!==p.color.r||1!==p.color.g||1!==p.color.b,b=p.vertexColors.length>0,x=0;if(x=E(x,0,0),x=E(x,1,f),x=E(x,2,m),x=E(x,3,g),x=E(x,4,v),x=E(x,5,y),x=E(x,6,w),x=E(x,7,b),s.push(x),s.push(p.a,p.b,p.c),s.push(p.materialIndex),g){var _=this.faceVertexUvs[0][i];s.push(P(_[0]),P(_[1]),P(_[2]))}if(v&&s.push(T(p.normal)),y){var S=p.vertexNormals;s.push(T(S[0]),T(S[1]),T(S[2]))}if(w&&s.push(A(p.color)),b){var M=p.vertexColors;s.push(A(M[0]),A(M[1]),A(M[2]))}}function E(t,e,r){return r?t|1<<e:t&~(1<<e)}function T(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==u[e]||(u[e]=a.length/3,a.push(t.x,t.y,t.z)),u[e]}function A(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==c[e]||(c[e]=l.length,l.push(t.getHex())),c[e]}function P(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]||(d[e]=h.length/2,h.push(t.x,t.y)),d[e]}return t.data={},t.data.vertices=n,t.data.normals=a,l.length>0&&(t.data.colors=l),h.length>0&&(t.data.uvs=[h]),t.data.faces=s,t},clone:function(){return(new fi).copy(this)},copy:function(t){var e,r,n,i,o,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var a=t.vertices;for(e=0,r=a.length;e<r;e++)this.vertices.push(a[e].clone());var u=t.colors;for(e=0,r=u.length;e<r;e++)this.colors.push(u[e].clone());var l=t.faces;for(e=0,r=l.length;e<r;e++)this.faces.push(l[e].clone());for(e=0,r=t.faceVertexUvs.length;e<r;e++){var c=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,i=c.length;n<i;n++){var h=c[n],d=[];for(o=0,s=h.length;o<s;o++){var p=h[o];d.push(p.clone())}this.faceVertexUvs[e].push(d)}}var f=t.morphTargets;for(e=0,r=f.length;e<r;e++){var m={};if(m.name=f[e].name,void 0!==f[e].vertices)for(m.vertices=[],n=0,i=f[e].vertices.length;n<i;n++)m.vertices.push(f[e].vertices[n].clone());if(void 0!==f[e].normals)for(m.normals=[],n=0,i=f[e].normals.length;n<i;n++)m.normals.push(f[e].normals[n].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,r=g.length;e<r;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],n=0,i=g[e].vertexNormals.length;n<i;n++){var y=g[e].vertexNormals[n],w={};w.a=y.a.clone(),w.b=y.b.clone(),w.c=y.c.clone(),v.vertexNormals.push(w)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],n=0,i=g[e].faceNormals.length;n<i;n++)v.faceNormals.push(g[e].faceNormals[n].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,r=b.length;e<r;e++)this.skinWeights.push(b[e].clone());var x=t.skinIndices;for(e=0,r=x.length;e<r;e++)this.skinIndices.push(x[e].clone());var _=t.lineDistances;for(e=0,r=_.length;e<r;e++)this.lineDistances.push(_[e]);var S=t.boundingBox;null!==S&&(this.boundingBox=S.clone());var M=t.boundingSphere;return null!==M&&(this.boundingSphere=M.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(mi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(mi.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(var n=0,i=this.itemSize;n<i;n++)this.array[t+n]=e.array[r+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),o=new ri),e[r++]=o.r,e[r++]=o.g,e[r++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),o=new Oe),e[r++]=o.x,e[r++]=o.y}return this},copyVector3sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),o=new Ne),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,r=0,n=0,i=t.length;n<i;n++){var o=t[n];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),o=new ze),e[r++]=o.x,e[r++]=o.y,e[r++]=o.z,e[r++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=n,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),gi.prototype=Object.create(mi.prototype),gi.prototype.constructor=gi,vi.prototype=Object.create(mi.prototype),vi.prototype.constructor=vi,yi.prototype=Object.create(mi.prototype),yi.prototype.constructor=yi,wi.prototype=Object.create(mi.prototype),wi.prototype.constructor=wi,bi.prototype=Object.create(mi.prototype),bi.prototype.constructor=bi,xi.prototype=Object.create(mi.prototype),xi.prototype.constructor=xi,_i.prototype=Object.create(mi.prototype),_i.prototype.constructor=_i,Si.prototype=Object.create(mi.prototype),Si.prototype.constructor=Si,Mi.prototype=Object.create(mi.prototype),Mi.prototype.constructor=Mi,Object.assign(Ei.prototype,{computeGroups:function(t){for(var e,r=[],n=void 0,i=t.faces,o=0;o<i.length;o++){var s=i[o];s.materialIndex!==n&&(n=s.materialIndex,void 0!==e&&(e.count=3*o-e.start,r.push(e)),e={start:3*o,materialIndex:n})}void 0!==e&&(e.count=3*o-e.start,r.push(e)),this.groups=r},fromGeometry:function(t){var e,r=t.faces,n=t.vertices,i=t.faceVertexUvs,o=i[0]&&i[0].length>0,s=i[1]&&i[1].length>0,a=t.morphTargets,u=a.length;if(u>0){e=[];for(var l=0;l<u;l++)e[l]=[];this.morphTargets.position=e}var c,h=t.morphNormals,d=h.length;if(d>0){c=[];for(l=0;l<d;l++)c[l]=[];this.morphTargets.normal=c}var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,g=f.length===n.length;for(l=0;l<r.length;l++){var v=r[l];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var w=v.normal;this.normals.push(w,w,w)}var b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var x=v.color;this.colors.push(x,x,x)}if(!0===o){var _=i[0][l];void 0!==_?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new Oe,new Oe,new Oe))}if(!0===s){_=i[1][l];void 0!==_?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new Oe,new Oe,new Oe))}for(var S=0;S<u;S++){var M=a[S].vertices;e[S].push(M[v.a],M[v.b],M[v.c])}for(S=0;S<d;S++){var E=h[S].vertexNormals[l];c[S].push(E.a,E.b,E.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Ai=1;function Pi(){Object.defineProperty(this,"id",{value:Ai+=2}),this.uuid=Le.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Ci(t,e,r,n,i,o){fi.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new Ri(t,e,r,n,i,o)),this.mergeVertices()}function Ri(t,e,r,n,i,o){Pi.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:r,widthSegments:n,heightSegments:i,depthSegments:o};var s=this;t=t||1,e=e||1,r=r||1,n=Math.floor(n)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var a=[],u=[],l=[],c=[],h=0,d=0;function p(t,e,r,n,i,o,p,f,m,g,v){var y,w,b=o/m,x=p/g,_=o/2,S=p/2,M=f/2,E=m+1,T=g+1,A=0,P=0,C=new Ne;for(w=0;w<T;w++){var R=w*x-S;for(y=0;y<E;y++){var L=y*b-_;C[t]=L*n,C[e]=R*i,C[r]=M,u.push(C.x,C.y,C.z),C[t]=0,C[e]=0,C[r]=f>0?1:-1,l.push(C.x,C.y,C.z),c.push(y/m),c.push(1-w/g),A+=1}}for(w=0;w<g;w++)for(y=0;y<m;y++){var O=h+y+E*w,I=h+y+E*(w+1),D=h+(y+1)+E*(w+1),N=h+(y+1)+E*w;a.push(O,I,N),a.push(I,D,N),P+=6}s.addGroup(d,P,v),d+=P,h+=A}p("z","y","x",-1,-1,r,e,t,o,i,0),p("z","y","x",1,-1,r,e,-t,o,i,1),p("x","z","y",1,1,t,r,e,n,o,2),p("x","z","y",1,-1,t,r,-e,n,o,3),p("x","y","z",1,-1,t,e,r,n,i,4),p("x","y","z",-1,-1,t,e,-r,n,i,5),this.setIndex(a),this.addAttribute("position",new Si(u,3)),this.addAttribute("normal",new Si(l,3)),this.addAttribute("uv",new Si(c,2))}function Li(t,e,r,n){fi.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n},this.fromBufferGeometry(new Oi(t,e,r,n)),this.mergeVertices()}function Oi(t,e,r,n){Pi.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:n},t=t||1,e=e||1;var i,o,s=t/2,a=e/2,u=Math.floor(r)||1,l=Math.floor(n)||1,c=u+1,h=l+1,d=t/u,p=e/l,f=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*p-a;for(i=0;i<c;i++){var w=i*d-s;m.push(w,-y,0),g.push(0,0,1),v.push(i/u),v.push(1-o/l)}}for(o=0;o<l;o++)for(i=0;i<u;i++){var b=i+c*o,x=i+c*(o+1),_=i+1+c*(o+1),S=i+1+c*o;f.push(b,x,S),f.push(x,_,S)}this.setIndex(f),this.addAttribute("position",new Si(m,3)),this.addAttribute("normal",new Si(g,3)),this.addAttribute("uv",new Si(v,2))}Pi.prototype=Object.assign(Object.create(a.prototype),{constructor:Pi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(Ti(t)>65535?_i:bi)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new mi(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,r){this.groups.push({start:t,count:e,materialIndex:void 0!==r?r:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var r=this.attributes.normal;if(void 0!==r){var n=(new ke).getNormalMatrix(t);n.applyToBufferAttribute(r),r.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new Ie;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ie;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ie;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ie;return function(e,r,n){return t.makeTranslation(e,r,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ie;return function(e,r,n){return t.makeScale(e,r,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new li;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new Ne;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var r=new Si(3*e.vertices.length,3),n=new Si(3*e.colors.length,3);if(this.addAttribute("position",r.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new Si(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new Si(e,3)),this},updateFromObject:function(t){var e,r=t.geometry;if(t.isMesh){var n=r.__directGeometry;if(!0===r.elementsNeedUpdate&&(n=void 0,r.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(r);n.verticesNeedUpdate=r.verticesNeedUpdate,n.normalsNeedUpdate=r.normalsNeedUpdate,n.colorsNeedUpdate=r.colorsNeedUpdate,n.uvsNeedUpdate=r.uvsNeedUpdate,n.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=n}return!0===r.verticesNeedUpdate&&(e=this.attributes.position,void 0!==e&&(e.copyVector3sArray(r.vertices),e.needsUpdate=!0),r.verticesNeedUpdate=!1),!0===r.normalsNeedUpdate&&(e=this.attributes.normal,void 0!==e&&(e.copyVector3sArray(r.normals),e.needsUpdate=!0),r.normalsNeedUpdate=!1),!0===r.colorsNeedUpdate&&(e=this.attributes.color,void 0!==e&&(e.copyColorsArray(r.colors),e.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(e=this.attributes.uv,void 0!==e&&(e.copyVector2sArray(r.uvs),e.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(e=this.attributes.lineDistance,void 0!==e&&(e.copyArray(r.lineDistances),e.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new Ei).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new mi(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var r=new Float32Array(3*t.normals.length);this.addAttribute("normal",new mi(r,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new mi(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new mi(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new mi(o,2).copyVector2sArray(t.uvs2))}for(var s in this.groups=t.groups,t.morphTargets){for(var a=[],u=t.morphTargets[s],l=0,c=u.length;l<c;l++){var h=u[l],d=new Si(3*h.length,3);a.push(d.copyVector3sArray(h))}this.morphAttributes[s]=a}if(t.skinIndices.length>0){var p=new Si(4*t.skinIndices.length,4);this.addAttribute("skinIndex",p.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var f=new Si(4*t.skinWeights.length,4);this.addAttribute("skinWeight",f.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new He);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new He,e=new Ne;return function(){null===this.boundingSphere&&(this.boundingSphere=new Ge);var r=this.attributes.position;if(r){var n=this.boundingSphere.center;t.setFromBufferAttribute(r),t.getCenter(n);for(var i=0,o=0,s=r.count;o<s;o++)e.x=r.getX(o),e.y=r.getY(o),e.z=r.getZ(o),i=Math.max(i,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,r=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new mi(new Float32Array(n.length),3));else for(var i=e.normal.array,o=0,s=i.length;o<s;o++)i[o]=0;var a,u,l,c=e.normal.array,h=new Ne,d=new Ne,p=new Ne,f=new Ne,m=new Ne;if(t){var g=t.array;0===r.length&&this.addGroup(0,g.length);for(var v=0,y=r.length;v<y;++v){var w=r[v],b=w.start,x=w.count;for(o=b,s=b+x;o<s;o+=3)a=3*g[o+0],u=3*g[o+1],l=3*g[o+2],h.fromArray(n,a),d.fromArray(n,u),p.fromArray(n,l),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[a]+=f.x,c[a+1]+=f.y,c[a+2]+=f.z,c[u]+=f.x,c[u+1]+=f.y,c[u+2]+=f.z,c[l]+=f.x,c[l+1]+=f.y,c[l+2]+=f.z}}else for(o=0,s=n.length;o<s;o+=9)h.fromArray(n,o),d.fromArray(n,o+3),p.fromArray(n,o+6),f.subVectors(p,d),m.subVectors(h,d),f.cross(m),c[o]=f.x,c[o+1]=f.y,c[o+2]=f.z,c[o+3]=f.x,c[o+4]=f.y,c[o+5]=f.z,c[o+6]=f.x,c[o+7]=f.y,c[o+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var r=this.attributes;for(var n in r)if(void 0!==t.attributes[n])for(var i=r[n],o=i.array,s=t.attributes[n],a=s.array,u=s.itemSize,l=0,c=u*e;l<a.length;l++,c++)o[c]=a[l];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new Ne;return function(){for(var e=this.attributes.normal,r=0,n=e.count;r<n;r++)t.x=e.getX(r),t.y=e.getY(r),t.z=e.getZ(r),t.normalize(),e.setXYZ(r,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Pi,e=this.index.array,r=this.attributes;for(var n in r){for(var i=r[n],o=i.array,s=i.itemSize,a=new o.constructor(e.length*s),u=0,l=0,c=0,h=e.length;c<h;c++){u=e[c]*s;for(var d=0;d<s;d++)a[l++]=o[u++]}t.addAttribute(n,new mi(a,s))}var p=this.groups;for(c=0,h=p.length;c<h;c++){var f=p[c];t.addGroup(f.start,f.count,f.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var i=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:i}}var o=this.attributes;for(var r in o){var s=o[r];i=Array.prototype.slice.call(s.array);t.data.attributes[r]={itemSize:s.itemSize,type:s.array.constructor.name,array:i,normalized:s.normalized}}var a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));var u=this.boundingSphere;return null!==u&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new Pi).copy(this)},copy:function(t){var e,r,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var s=o[e];this.addAttribute(e,s.clone())}var a=t.morphAttributes;for(e in a){var u=[],l=a[e];for(r=0,n=l.length;r<n;r++)u.push(l[r].clone());this.morphAttributes[e]=u}var c=t.groups;for(r=0,n=c.length;r<n;r++){var h=c[r];this.addGroup(h.start,h.count,h.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ci.prototype=Object.create(fi.prototype),Ci.prototype.constructor=Ci,Ri.prototype=Object.create(Pi.prototype),Ri.prototype.constructor=Ri,Li.prototype=Object.create(fi.prototype),Li.prototype.constructor=Li,Oi.prototype=Object.create(Pi.prototype),Oi.prototype.constructor=Oi;var Ii=0;function Di(){Object.defineProperty(this,"id",{value:Ii++}),this.uuid=Le.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=_,this.side=f,this.flatShading=!1,this.vertexColors=y,this.opacity=1,this.transparent=!1,this.blendSrc=k,this.blendDst=F,this.blendEquation=A,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=W,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Ni(t){Di.call(this),this.type="MeshBasicMaterial",this.color=new ri(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function ki(t){Di.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Fi(t,e){this.origin=void 0!==t?t:new Ne,this.direction=void 0!==e?e:new Ne}function Vi(t,e){this.start=void 0!==t?t:new Ne,this.end=void 0!==e?e:new Ne}function zi(t,e,r){this.a=void 0!==t?t:new Ne,this.b=void 0!==e?e:new Ne,this.c=void 0!==r?r:new Ne}function Ui(t,e){li.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new Ni({color:16777215*Math.random()}),this.drawMode=we,this.updateMorphTargets()}function ji(t,e,r,n){var i,o,s,a=new ri(0),u=0;function l(e,n,l,h){var d=n.background;null===d?c(a,u):d&&d.isColor&&(c(d,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&d.isCubeTexture?(void 0===s&&(s=new Ui(new Ri(1,1,1),new ki({uniforms:ii.cube.uniforms,vertexShader:ii.cube.vertexShader,fragmentShader:ii.cube.fragmentShader,side:m,depthTest:!0,depthWrite:!1,fog:!1})),s.geometry.removeAttribute("normal"),s.geometry.removeAttribute("uv"),s.onBeforeRender=function(t,e,r){this.matrixWorld.copyPosition(r.matrixWorld)},r.update(s.geometry)),s.material.uniforms.tCube.value=d,e.push(s,s.geometry,s.material,0,null)):d&&d.isTexture&&(void 0===i&&(i=new hi(-1,1,1,-1,0,1),o=new Ui(new Oi(2,2),new Ni({depthTest:!1,depthWrite:!1,fog:!1})),r.update(o.geometry)),o.material.map=d,t.renderBufferDirect(i,null,o.geometry,o.material,o,null))}function c(t,r){e.buffers.color.setClear(t.r,t.g,t.b,r,n)}return{getClearColor:function(){return a},setClearColor:function(t,e){a.set(t),u=void 0!==e?e:1,c(a,u)},getClearAlpha:function(){return u},setClearAlpha:function(t){u=t,c(a,u)},render:l}}function Bi(t,e,r){var n;function i(t){n=t}function o(e,i){t.drawArrays(n,e,i),r.update(i,n)}function s(t,i,o){var s=e.get("ANGLE_instanced_arrays");if(null!==s){var a=t.attributes.position;a.isInterleavedBufferAttribute?(o=a.data.count,s.drawArraysInstancedANGLE(n,0,o,t.maxInstancedCount)):s.drawArraysInstancedANGLE(n,i,o,t.maxInstancedCount),r.update(o,n,t.maxInstancedCount)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}this.setMode=i,this.render=o,this.renderInstances=s}function Hi(t,e,r){var n;function i(){if(void 0!==n)return n;var r=e.get("EXT_texture_filter_anisotropic");return n=null!==r?t.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,n}function o(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var s=void 0!==r.precision?r.precision:"highp",a=o(s);a!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",a,"instead."),s=a);var u=!0===r.logarithmicDepthBuffer,l=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),c=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_TEXTURE_SIZE),d=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),p=t.getParameter(t.MAX_VERTEX_ATTRIBS),f=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),g=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=c>0,y=!!e.get("OES_texture_float"),w=v&&y;return{getMaxAnisotropy:i,getMaxPrecision:o,precision:s,logarithmicDepthBuffer:u,maxTextures:l,maxVertexTextures:c,maxTextureSize:h,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:f,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:w}}function Gi(){var t=this,e=null,r=0,n=!1,i=!1,o=new qe,s=new ke,a={value:null,needsUpdate:!1};function u(){a.value!==e&&(a.value=e,a.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,r,n,i){var u=null!==e?e.length:0,l=null;if(0!==u){if(l=a.value,!0!==i||null===l){var c=n+4*u,h=r.matrixWorldInverse;s.getNormalMatrix(h),(null===l||l.length<c)&&(l=new Float32Array(c));for(var d=0,p=n;d!==u;++d,p+=4)o.copy(e[d]).applyMatrix4(h,s),o.normal.toArray(l,p),l[p+3]=o.constant}a.value=l,a.needsUpdate=!0}return t.numPlanes=u,l}this.uniform=a,this.numPlanes=0,this.numIntersection=0,this.init=function(t,i,o){var s=0!==t.length||i||0!==r||n;return n=i,e=l(t,o,0),r=t.length,s},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,s,c,h,d){if(!n||null===t||0===t.length||i&&!s)i?l(null):u();else{var p=i?0:r,f=4*p,m=h.clippingState||null;a.value=m,m=l(t,c,f,d);for(var g=0;g!==f;++g)m[g]=e[g];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=p}}}function qi(t){var e={};return{get:function(r){if(void 0!==e[r])return e[r];var n;switch(r){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=t.getExtension(r)}return null===n&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),e[r]=n,n}}}function Wi(t,e,r){var n={},i={};function o(t){var s=t.target,a=n[s.id];for(var u in null!==a.index&&e.remove(a.index),a.attributes)e.remove(a.attributes[u]);s.removeEventListener("dispose",o),delete n[s.id];var l=i[s.id];l&&(e.remove(l),delete i[s.id]),l=i[a.id],l&&(e.remove(l),delete i[a.id]),r.memory.geometries--}function s(t,e){var i=n[e.id];return i||(e.addEventListener("dispose",o),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new Pi).setFromObject(t)),i=e._bufferGeometry),n[e.id]=i,r.memory.geometries++,i)}function a(r){var n=r.index,i=r.attributes;for(var o in null!==n&&e.update(n,t.ELEMENT_ARRAY_BUFFER),i)e.update(i[o],t.ARRAY_BUFFER);var s=r.morphAttributes;for(var o in s)for(var a=s[o],u=0,l=a.length;u<l;u++)e.update(a[u],t.ARRAY_BUFFER)}function u(r){var n=i[r.id];if(n)return n;var o=[],s=r.index,a=r.attributes;if(null!==s)for(var u=s.array,l=0,c=u.length;l<c;l+=3){var h=u[l+0],d=u[l+1],p=u[l+2];o.push(h,d,d,p,p,h)}else for(u=a.position.array,l=0,c=u.length/3-1;l<c;l+=3){h=l+0,d=l+1,p=l+2;o.push(h,d,d,p,p,h)}return n=new(Ti(o)>65535?_i:bi)(o,1),e.update(n,t.ELEMENT_ARRAY_BUFFER),i[r.id]=n,n}return{get:s,update:a,getWireframeAttribute:u}}function $i(t,e,r){var n,i,o;function s(t){n=t}function a(t){i=t.type,o=t.bytesPerElement}function u(e,s){t.drawElements(n,s,i,e*o),r.update(s,n)}function l(t,s,a){var u=e.get("ANGLE_instanced_arrays");null!==u?(u.drawElementsInstancedANGLE(n,a,i,s*o,t.maxInstancedCount),r.update(a,n,t.maxInstancedCount)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}this.setMode=s,this.setIndex=a,this.render=u,this.renderInstances=l}function Xi(t){var e={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function n(e,n,i){switch(i=i||1,r.calls++,n){case t.TRIANGLES:r.triangles+=i*(e/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:r.triangles+=i*(e-2);break;case t.LINES:r.lines+=i*(e/2);break;case t.LINE_STRIP:r.lines+=i*(e-1);break;case t.LINE_LOOP:r.lines+=i*e;break;case t.POINTS:r.points+=i*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n);break}}function i(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:e,render:r,programs:null,autoReset:!0,reset:i,update:n}}function Yi(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Zi(t){var e={},r=new Float32Array(8);function n(n,i,o,s){var a=n.morphTargetInfluences,u=a.length,l=e[i.id];if(void 0===l){l=[];for(var c=0;c<u;c++)l[c]=[c,0];e[i.id]=l}var h=o.morphTargets&&i.morphAttributes.position,d=o.morphNormals&&i.morphAttributes.normal;for(c=0;c<u;c++){var p=l[c];0!==p[1]&&(h&&i.removeAttribute("morphTarget"+c),d&&i.removeAttribute("morphNormal"+c))}for(c=0;c<u;c++){p=l[c];p[0]=c,p[1]=a[c]}l.sort(Yi);for(c=0;c<8;c++){p=l[c];if(p){var f=p[0],m=p[1];if(m){h&&i.addAttribute("morphTarget"+c,h[f]),d&&i.addAttribute("morphNormal"+c,d[f]),r[c]=m;continue}}r[c]=0}s.getUniforms().setValue(t,"morphTargetInfluences",r)}return{update:n}}function Ji(t,e){var r={};function n(n){var i=e.render.frame,o=n.geometry,s=t.get(n,o);return r[s.id]!==i&&(o.isGeometry&&s.updateFromObject(n),t.update(s),r[s.id]=i),s}function i(){r={}}return{update:n,dispose:i}}function Qi(t,e,r,n,i,o,s,a,u,l){t=void 0!==t?t:[],e=void 0!==e?e:st,Ve.call(this,t,e,r,n,i,o,s,a,u,l),this.flipY=!1}Di.prototype=Object.assign(Object.create(a.prototype),{constructor:Di,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var r=t[e];if(void 0!==r)if("shading"!==e){var n=this[e];void 0!==n?n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[e]="overdraw"===e?Number(r):r:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===v;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"===typeof t;e&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var r in t){var n=t[r];delete n.metadata,e.push(n)}return e}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==f&&(r.side=this.side),this.vertexColors!==y&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),e){var i=n(t.textures),o=n(t.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,r=null;if(null!==e){var n=e.length;r=new Array(n);for(var i=0;i!==n;++i)r[i]=e[i].clone()}return this.clippingPlanes=r,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Ni.prototype=Object.create(Di.prototype),Ni.prototype.constructor=Ni,Ni.prototype.isMeshBasicMaterial=!0,Ni.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},ki.prototype=Object.create(Di.prototype),ki.prototype.constructor=ki,ki.prototype.isShaderMaterial=!0,ki.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ti.clone(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},ki.prototype.toJSON=function(t){var e=Di.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(Fi.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new Ne),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new Ne;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new Ne),e.subVectors(t,this.origin);var r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(r).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new Ne;return function(e){var r=t.subVectors(e,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(r).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new Ne,e=new Ne,r=new Ne;return function(n,i,o,s){t.copy(n).add(i).multiplyScalar(.5),e.copy(i).sub(n).normalize(),r.copy(this.origin).sub(t);var a,u,l,c,h=.5*n.distanceTo(i),d=-this.direction.dot(e),p=r.dot(this.direction),f=-r.dot(e),m=r.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(a=d*f-p,u=d*p-f,c=h*g,a>=0)if(u>=-c)if(u<=c){var v=1/g;a*=v,u*=v,l=a*(a+d*u+2*p)+u*(d*a+u+2*f)+m}else u=h,a=Math.max(0,-(d*u+p)),l=-a*a+u*(u+2*f)+m;else u=-h,a=Math.max(0,-(d*u+p)),l=-a*a+u*(u+2*f)+m;else u<=-c?(a=Math.max(0,-(-d*h+p)),u=a>0?-h:Math.min(Math.max(-h,-f),h),l=-a*a+u*(u+2*f)+m):u<=c?(a=0,u=Math.min(Math.max(-h,-f),h),l=u*(u+2*f)+m):(a=Math.max(0,-(d*h+p)),u=a>0?h:Math.min(Math.max(-h,-f),h),l=-a*a+u*(u+2*f)+m);else u=d>0?-h:h,a=Math.max(0,-(d*u+p)),l=-a*a+u*(u+2*f)+m;return o&&o.copy(this.direction).multiplyScalar(a).add(this.origin),s&&s.copy(e).multiplyScalar(u).add(t),l}}(),intersectSphere:function(){var t=new Ne;return function(e,r){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),i=t.dot(t)-n*n,o=e.radius*e.radius;if(i>o)return null;var s=Math.sqrt(o-i),a=n-s,u=n+s;return a<0&&u<0?null:a<0?this.at(u,r):this.at(a,r)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null},intersectPlane:function(t,e){var r=this.distanceToPlane(t);return null===r?null:this.at(r,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);if(0===e)return!0;var r=t.normal.dot(this.direction);return r*e<0},intersectBox:function(t,e){var r,n,i,o,s,a,u=1/this.direction.x,l=1/this.direction.y,c=1/this.direction.z,h=this.origin;return u>=0?(r=(t.min.x-h.x)*u,n=(t.max.x-h.x)*u):(r=(t.max.x-h.x)*u,n=(t.min.x-h.x)*u),l>=0?(i=(t.min.y-h.y)*l,o=(t.max.y-h.y)*l):(i=(t.max.y-h.y)*l,o=(t.min.y-h.y)*l),r>o||i>n?null:((i>r||r!==r)&&(r=i),(o<n||n!==n)&&(n=o),c>=0?(s=(t.min.z-h.z)*c,a=(t.max.z-h.z)*c):(s=(t.max.z-h.z)*c,a=(t.min.z-h.z)*c),r>a||s>n?null:((s>r||r!==r)&&(r=s),(a<n||n!==n)&&(n=a),n<0?null:this.at(r>=0?r:n,e)))},intersectsBox:function(){var t=new Ne;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new Ne,e=new Ne,r=new Ne,n=new Ne;return function(i,o,s,a,u){e.subVectors(o,i),r.subVectors(s,i),n.crossVectors(e,r);var l,c=this.direction.dot(n);if(c>0){if(a)return null;l=1}else{if(!(c<0))return null;l=-1,c=-c}t.subVectors(this.origin,i);var h=l*this.direction.dot(r.crossVectors(t,r));if(h<0)return null;var d=l*this.direction.dot(e.cross(t));if(d<0)return null;if(h+d>c)return null;var p=-l*t.dot(n);return p<0?null:this.at(p/c,u)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(Vi.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new Ne),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new Ne),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new Ne),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new Ne,e=new Ne;return function(r,n){t.subVectors(r,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),o=e.dot(t),s=o/i;return n&&(s=Le.clamp(s,0,1)),s}}(),closestPointToPoint:function(t,e,r){var n=this.closestPointToPointParameter(t,e);return void 0===r&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),r=new Ne),this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(zi,{getNormal:function(){var t=new Ne;return function(e,r,n,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new Ne),i.subVectors(n,r),t.subVectors(e,r),i.cross(t);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var t=new Ne,e=new Ne,r=new Ne;return function(n,i,o,s,a){t.subVectors(s,i),e.subVectors(o,i),r.subVectors(n,i);var u=t.dot(t),l=t.dot(e),c=t.dot(r),h=e.dot(e),d=e.dot(r),p=u*h-l*l;if(void 0===a&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new Ne),0===p)return a.set(-2,-1,-1);var f=1/p,m=(h*c-l*d)*f,g=(u*d-l*c)*f;return a.set(1-m-g,g,m)}}(),containsPoint:function(){var t=new Ne;return function(e,r,n,i){return zi.getBarycoord(e,r,n,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(zi.prototype,{set:function(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this},setFromPointsAndIndices:function(t,e,r,n){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new Ne,e=new Ne;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new Ne),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return zi.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Ne),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return zi.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return zi.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new qe,e=[new Vi,new Vi,new Vi],r=new Ne,n=new Ne;return function(i,o){void 0===o&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new Ne);var s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,r),!0===this.containsPoint(r))o.copy(r);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var a=0;a<e.length;a++){e[a].closestPointToPoint(r,!0,n);var u=r.distanceToSquared(n);u<s&&(s=u,o.copy(n))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Ui.prototype=Object.assign(Object.create(li.prototype),{constructor:Ui,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return li.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,r,n=this.geometry;if(n.isBufferGeometry){var i=n.morphAttributes,o=Object.keys(i);if(o.length>0){var s=i[o[0]];if(void 0!==s)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)r=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}}else{var a=n.morphTargets;if(void 0!==a&&a.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)r=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[r]=t}},raycast:function(){var t=new Ie,e=new Fi,r=new Ge,n=new Ne,i=new Ne,o=new Ne,s=new Ne,a=new Ne,u=new Ne,l=new Oe,c=new Oe,h=new Oe,d=new Ne,p=new Ne,f=new Ne;function v(t,e,r,n,i,o,s){return zi.getBarycoord(t,e,r,n,d),i.multiplyScalar(d.x),o.multiplyScalar(d.y),s.multiplyScalar(d.z),i.add(o).add(s),i.clone()}function y(t,e,r,n,i,o,s,a){var u;if(u=e.side===m?n.intersectTriangle(s,o,i,!0,a):n.intersectTriangle(i,o,s,e.side!==g,a),null===u)return null;f.copy(a),f.applyMatrix4(t.matrixWorld);var l=r.ray.origin.distanceTo(f);return l<r.near||l>r.far?null:{distance:l,point:f.clone(),object:t}}function w(t,e,r,s,a,u,d,f){n.fromBufferAttribute(s,u),i.fromBufferAttribute(s,d),o.fromBufferAttribute(s,f);var m=y(t,t.material,e,r,n,i,o,p);if(m){a&&(l.fromBufferAttribute(a,u),c.fromBufferAttribute(a,d),h.fromBufferAttribute(a,f),m.uv=v(p,n,i,o,l,c,h));var g=new di(u,d,f);zi.getNormal(n,i,o,g.normal),m.face=g,m.faceIndex=u}return m}return function(d,f){var m,g=this.geometry,b=this.material,x=this.matrixWorld;if(void 0!==b&&(null===g.boundingSphere&&g.computeBoundingSphere(),r.copy(g.boundingSphere),r.applyMatrix4(x),!1!==d.ray.intersectsSphere(r)&&(t.getInverse(x),e.copy(d.ray).applyMatrix4(t),null===g.boundingBox||!1!==e.intersectsBox(g.boundingBox))))if(g.isBufferGeometry){var _,S,M,E,T,A=g.index,P=g.attributes.position,C=g.attributes.uv;if(null!==A)for(E=0,T=A.count;E<T;E+=3)_=A.getX(E),S=A.getX(E+1),M=A.getX(E+2),m=w(this,d,e,P,C,_,S,M),m&&(m.faceIndex=Math.floor(E/3),f.push(m));else if(void 0!==P)for(E=0,T=P.count;E<T;E+=3)_=E,S=E+1,M=E+2,m=w(this,d,e,P,C,_,S,M),m&&f.push(m)}else if(g.isGeometry){var R,L,O,I,D=Array.isArray(b),N=g.vertices,k=g.faces,F=g.faceVertexUvs[0];F.length>0&&(I=F);for(var V=0,z=k.length;V<z;V++){var U=k[V],j=D?b[U.materialIndex]:b;if(void 0!==j){if(R=N[U.a],L=N[U.b],O=N[U.c],!0===j.morphTargets){var B=g.morphTargets,H=this.morphTargetInfluences;n.set(0,0,0),i.set(0,0,0),o.set(0,0,0);for(var G=0,q=B.length;G<q;G++){var W=H[G];if(0!==W){var $=B[G].vertices;n.addScaledVector(s.subVectors($[U.a],R),W),i.addScaledVector(a.subVectors($[U.b],L),W),o.addScaledVector(u.subVectors($[U.c],O),W)}}n.add(R),i.add(L),o.add(O),R=n,L=i,O=o}if(m=y(this,j,d,e,R,L,O,p),m){if(I&&I[V]){var X=I[V];l.copy(X[0]),c.copy(X[1]),h.copy(X[2]),m.uv=v(p,R,L,O,l,c,h)}m.face=U,m.faceIndex=V,f.push(m)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Qi.prototype=Object.create(Ve.prototype),Qi.prototype.constructor=Qi,Qi.prototype.isCubeTexture=!0,Object.defineProperty(Qi.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Ki=new Ve,to=new Qi;function eo(){this.seq=[],this.map={}}var ro=[],no=[],io=new Float32Array(16),oo=new Float32Array(9);function so(t,e,r){var n=t[0];if(n<=0||n>0)return t;var i=e*r,o=ro[i];if(void 0===o&&(o=new Float32Array(i),ro[i]=o),0!==e){n.toArray(o,0);for(var s=1,a=0;s!==e;++s)a+=r,t[s].toArray(o,a)}return o}function ao(t,e){var r=no[e];void 0===r&&(r=new Int32Array(e),no[e]=r);for(var n=0;n!==e;++n)r[n]=t.allocTextureUnit();return r}function uo(t,e){t.uniform1f(this.addr,e)}function lo(t,e){t.uniform1i(this.addr,e)}function co(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function ho(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function po(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function fo(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function mo(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(oo.set(e.elements),t.uniformMatrix3fv(this.addr,!1,oo))}function go(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(io.set(e.elements),t.uniformMatrix4fv(this.addr,!1,io))}function vo(t,e,r){var n=r.allocTextureUnit();t.uniform1i(this.addr,n),r.setTexture2D(e||Ki,n)}function yo(t,e,r){var n=r.allocTextureUnit();t.uniform1i(this.addr,n),r.setTextureCube(e||to,n)}function wo(t,e){t.uniform2iv(this.addr,e)}function bo(t,e){t.uniform3iv(this.addr,e)}function xo(t,e){t.uniform4iv(this.addr,e)}function _o(t){switch(t){case 5126:return uo;case 35664:return co;case 35665:return ho;case 35666:return po;case 35674:return fo;case 35675:return mo;case 35676:return go;case 35678:case 36198:return vo;case 35680:return yo;case 5124:case 35670:return lo;case 35667:case 35671:return wo;case 35668:case 35672:return bo;case 35669:case 35673:return xo}}function So(t,e){t.uniform1fv(this.addr,e)}function Mo(t,e){t.uniform1iv(this.addr,e)}function Eo(t,e){t.uniform2fv(this.addr,so(e,this.size,2))}function To(t,e){t.uniform3fv(this.addr,so(e,this.size,3))}function Ao(t,e){t.uniform4fv(this.addr,so(e,this.size,4))}function Po(t,e){t.uniformMatrix2fv(this.addr,!1,so(e,this.size,4))}function Co(t,e){t.uniformMatrix3fv(this.addr,!1,so(e,this.size,9))}function Ro(t,e){t.uniformMatrix4fv(this.addr,!1,so(e,this.size,16))}function Lo(t,e,r){var n=e.length,i=ao(r,n);t.uniform1iv(this.addr,i);for(var o=0;o!==n;++o)r.setTexture2D(e[o]||Ki,i[o])}function Oo(t,e,r){var n=e.length,i=ao(r,n);t.uniform1iv(this.addr,i);for(var o=0;o!==n;++o)r.setTextureCube(e[o]||to,i[o])}function Io(t){switch(t){case 5126:return So;case 35664:return Eo;case 35665:return To;case 35666:return Ao;case 35674:return Po;case 35675:return Co;case 35676:return Ro;case 35678:return Lo;case 35680:return Oo;case 5124:case 35670:return Mo;case 35667:case 35671:return wo;case 35668:case 35672:return bo;case 35669:case 35673:return xo}}function Do(t,e,r){this.id=t,this.addr=r,this.setValue=_o(e.type)}function No(t,e,r){this.id=t,this.addr=r,this.size=e.size,this.setValue=Io(e.type)}function ko(t){this.id=t,eo.call(this)}ko.prototype.setValue=function(t,e){for(var r=this.seq,n=0,i=r.length;n!==i;++n){var o=r[n];o.setValue(t,e[o.id])}};var Fo=/([\w\d_]+)(\])?(\[|\.)?/g;function Vo(t,e){t.seq.push(e),t.map[e.id]=e}function zo(t,e,r){var n=t.name,i=n.length;for(Fo.lastIndex=0;;){var o=Fo.exec(n),s=Fo.lastIndex,a=o[1],u="]"===o[2],l=o[3];if(u&&(a|=0),void 0===l||"["===l&&s+2===i){Vo(r,void 0===l?new Do(a,t,e):new No(a,t,e));break}var c=r.map,h=c[a];void 0===h&&(h=new ko(a),Vo(r,h)),r=h}}function Uo(t,e,r){eo.call(this),this.renderer=r;for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<n;++i){var o=t.getActiveUniform(e,i),s=t.getUniformLocation(e,o.name);zo(o,s,this)}}function jo(t){for(var e=t.split("\n"),r=0;r<e.length;r++)e[r]=r+1+": "+e[r];return e.join("\n")}function Bo(t,e,r){var n=t.createShader(e);return t.shaderSource(n,r),t.compileShader(n),!1===t.getShaderParameter(n,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),jo(r)),n}Uo.prototype.setValue=function(t,e,r){var n=this.map[e];void 0!==n&&n.setValue(t,r,this.renderer)},Uo.prototype.setOptional=function(t,e,r){var n=e[r];void 0!==n&&this.setValue(t,r,n)},Uo.upload=function(t,e,r,n){for(var i=0,o=e.length;i!==o;++i){var s=e[i],a=r[s.id];!1!==a.needsUpdate&&s.setValue(t,a.value,n)}},Uo.seqWithValue=function(t,e){for(var r=[],n=0,i=t.length;n!==i;++n){var o=t[n];o.id in e&&r.push(o)}return r};var Ho=0;function Go(t){switch(t){case _e:return["Linear","( value )"];case Se:return["sRGB","( value )"];case Ee:return["RGBE","( value )"];case Te:return["RGBM","( value, 7.0 )"];case Ae:return["RGBM","( value, 16.0 )"];case Pe:return["RGBD","( value, 256.0 )"];case Me:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function qo(t,e){var r=Go(e);return"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function Wo(t,e){var r=Go(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function $o(t,e){var r;switch(e){case et:r="Linear";break;case rt:r="Reinhard";break;case nt:r="Uncharted2";break;case it:r="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Xo(t,e,r){t=t||{};var n=[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&r.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&r.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&r.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""];return n.filter(Jo).join("\n")}function Yo(t){var e=[];for(var r in t){var n=t[r];!1!==n&&e.push("#define "+r+" "+n)}return e.join("\n")}function Zo(t,e){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;i++){var o=t.getActiveAttrib(e,i),s=o.name;r[s]=t.getAttribLocation(e,s)}return r}function Jo(t){return""!==t}function Qo(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Ko(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function ts(t){var e=/^[ \t]*#include +<([\w\d.]+)>/gm;function r(t,e){var r=Kn[e];if(void 0===r)throw new Error("Can not resolve #include <"+e+">");return ts(r)}return t.replace(e,r)}function es(t){var e=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function r(t,e,r,n){for(var i="",o=parseInt(e);o<parseInt(r);o++)i+=n.replace(/\[ i \]/g,"[ "+o+" ]");return i}return t.replace(e,r)}function rs(t,e,r,n,i,o){var s=t.context,a=n.defines,u=i.vertexShader,l=i.fragmentShader,c="SHADOWMAP_TYPE_BASIC";o.shadowMapType===d?c="SHADOWMAP_TYPE_PCF":o.shadowMapType===p&&(c="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(n.envMap.mapping){case st:case at:h="ENVMAP_TYPE_CUBE";break;case ht:case dt:h="ENVMAP_TYPE_CUBE_UV";break;case ut:case lt:h="ENVMAP_TYPE_EQUIREC";break;case ct:h="ENVMAP_TYPE_SPHERE";break}switch(n.envMap.mapping){case at:case lt:f="ENVMAP_MODE_REFRACTION";break}switch(n.combine){case J:m="ENVMAP_BLENDING_MULTIPLY";break;case Q:m="ENVMAP_BLENDING_MIX";break;case K:m="ENVMAP_BLENDING_ADD";break}}var g,v,y=t.gammaFactor>0?t.gammaFactor:1,w=Xo(n.extensions,o,e),b=Yo(a),x=s.createProgram();n.isRawShaderMaterial?(g=[b].filter(Jo).join("\n"),g.length>0&&(g+="\n"),v=[w,b].filter(Jo).join("\n"),v.length>0&&(v+="\n")):(g=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Jo).join("\n"),v=[w,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,b,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+y,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+f:"",o.envMap?"#define "+m:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+c:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==tt?"#define TONE_MAPPING":"",o.toneMapping!==tt?Kn["tonemapping_pars_fragment"]:"",o.toneMapping!==tt?$o("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Kn["encodings_pars_fragment"]:"",o.mapEncoding?qo("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?qo("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?qo("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?Wo("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Jo).join("\n")),u=ts(u),u=Qo(u,o),u=Ko(u,o),l=ts(l),l=Qo(l,o),l=Ko(l,o),u=es(u),l=es(l);var _=g+u,S=v+l,M=Bo(s,s.VERTEX_SHADER,_),E=Bo(s,s.FRAGMENT_SHADER,S);s.attachShader(x,M),s.attachShader(x,E),void 0!==n.index0AttributeName?s.bindAttribLocation(x,0,n.index0AttributeName):!0===o.morphTargets&&s.bindAttribLocation(x,0,"position"),s.linkProgram(x);var T,A,P=s.getProgramInfoLog(x).trim(),C=s.getShaderInfoLog(M).trim(),R=s.getShaderInfoLog(E).trim(),L=!0,O=!0;return!1===s.getProgramParameter(x,s.LINK_STATUS)?(L=!1,console.error("THREE.WebGLProgram: shader error: ",s.getError(),"gl.VALIDATE_STATUS",s.getProgramParameter(x,s.VALIDATE_STATUS),"gl.getProgramInfoLog",P,C,R)):""!==P?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",P):""!==C&&""!==R||(O=!1),O&&(this.diagnostics={runnable:L,material:n,programLog:P,vertexShader:{log:C,prefix:g},fragmentShader:{log:R,prefix:v}}),s.deleteShader(M),s.deleteShader(E),this.getUniforms=function(){return void 0===T&&(T=new Uo(s,x,t)),T},this.getAttributes=function(){return void 0===A&&(A=Zo(s,x)),A},this.destroy=function(){s.deleteProgram(x),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=Ho++,this.code=r,this.usedTimes=1,this.program=x,this.vertexShader=M,this.fragmentShader=E,this}function ns(t,e,r){var n=[],i={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},o=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function s(t){var e=t.skeleton,n=e.bones;if(r.floatVertexTextures)return 1024;var i=r.maxVertexUniforms,o=Math.floor((i-20)/4),s=Math.min(o,n.length);return s<n.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+n.length+" bones. This GPU supports "+s+"."),0):s}function a(t,e){var r;return t?t.isTexture?r=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),r=t.texture.encoding):r=_e,r===_e&&e&&(r=Me),r}this.getParameters=function(e,n,o,u,l,c,h){var d=i[e.type],p=h.isSkinnedMesh?s(h):0,f=r.precision;null!==e.precision&&(f=r.getMaxPrecision(e.precision),f!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",f,"instead."));var v=t.getRenderTarget(),y={shaderID:d,precision:f,supportsVertexTextures:r.vertexTextures,outputEncoding:a(v?v.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:a(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:a(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===ht||e.envMap.mapping===dt),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:a(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!u,useFog:e.fog,fogExp:u&&u.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:r.logarithmicDepthBuffer,skinning:e.skinning&&p>0,maxBones:p,useVertexTexture:r.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:l,numClipIntersection:c,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.receiveShadow&&o.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===g,flipSided:e.side===m,depthPacking:void 0!==e.depthPacking&&e.depthPacking};return y},this.getProgramCode=function(e,r){var n=[];if(r.shaderID?n.push(r.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)n.push(i),n.push(e.defines[i]);for(var s=0;s<o.length;s++)n.push(r[o[s]]);return n.push(e.onBeforeCompile.toString()),n.push(t.gammaOutput),n.join()},this.acquireProgram=function(r,i,o,s){for(var a,u=0,l=n.length;u<l;u++){var c=n[u];if(c.code===s){a=c,++a.usedTimes;break}}return void 0===a&&(a=new rs(t,e,s,r,i,o),n.push(a)),a},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n}function is(){var t=new WeakMap;function e(e){var r=t.get(e);return void 0===r&&(r={},t.set(e,r)),r}function r(e){t.delete(e)}function n(e,r,n){t.get(e)[r]=n}function i(){t=new WeakMap}return{get:e,remove:r,update:n,dispose:i}}function os(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function ss(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function as(){var t=[],e=0,r=[],n=[];function i(){e=0,r.length=0,n.length=0}function o(i,o,s,a,u){var l=t[e];void 0===l?(l={id:i.id,object:i,geometry:o,material:s,program:s.program,renderOrder:i.renderOrder,z:a,group:u},t[e]=l):(l.id=i.id,l.object=i,l.geometry=o,l.material=s,l.program=s.program,l.renderOrder=i.renderOrder,l.z=a,l.group=u),(!0===s.transparent?n:r).push(l),e++}function s(){r.length>1&&r.sort(os),n.length>1&&n.sort(ss)}return{opaque:r,transparent:n,init:i,push:o,sort:s}}function us(){var t={};function e(e,r){var n=e.id+","+r.id,i=t[n];return void 0===i&&(i=new as,t[n]=i),i}function r(){t={}}return{get:e,dispose:r}}function ls(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var r;switch(e.type){case"DirectionalLight":r={direction:new Ne,color:new ri,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"SpotLight":r={position:new Ne,direction:new Ne,color:new ri,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Oe};break;case"PointLight":r={position:new Ne,color:new ri,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Oe,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":r={direction:new Ne,skyColor:new ri,groundColor:new ri};break;case"RectAreaLight":r={color:new ri,position:new Ne,halfWidth:new Ne,halfHeight:new Ne};break}return t[e.id]=r,r}}}var cs=0;function hs(){var t=new ls,e={id:cs++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new Ne,n=new Ie,i=new Ie;function o(o,s,a){for(var u=0,l=0,c=0,h=0,d=0,p=0,f=0,m=0,g=a.matrixWorldInverse,v=0,y=o.length;v<y;v++){var w=o[v],b=w.color,x=w.intensity,_=w.distance,S=w.shadow&&w.shadow.map?w.shadow.map.texture:null;if(w.isAmbientLight)u+=b.r*x,l+=b.g*x,c+=b.b*x;else if(w.isDirectionalLight){var M=t.get(w);if(M.color.copy(w.color).multiplyScalar(w.intensity),M.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(g),M.shadow=w.castShadow,w.castShadow){var E=w.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize}e.directionalShadowMap[h]=S,e.directionalShadowMatrix[h]=w.shadow.matrix,e.directional[h]=M,h++}else if(w.isSpotLight){M=t.get(w);if(M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.color.copy(b).multiplyScalar(x),M.distance=_,M.direction.setFromMatrixPosition(w.matrixWorld),r.setFromMatrixPosition(w.target.matrixWorld),M.direction.sub(r),M.direction.transformDirection(g),M.coneCos=Math.cos(w.angle),M.penumbraCos=Math.cos(w.angle*(1-w.penumbra)),M.decay=0===w.distance?0:w.decay,M.shadow=w.castShadow,w.castShadow){E=w.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize}e.spotShadowMap[p]=S,e.spotShadowMatrix[p]=w.shadow.matrix,e.spot[p]=M,p++}else if(w.isRectAreaLight){M=t.get(w);M.color.copy(b).multiplyScalar(x),M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),i.identity(),n.copy(w.matrixWorld),n.premultiply(g),i.extractRotation(n),M.halfWidth.set(.5*w.width,0,0),M.halfHeight.set(0,.5*w.height,0),M.halfWidth.applyMatrix4(i),M.halfHeight.applyMatrix4(i),e.rectArea[f]=M,f++}else if(w.isPointLight){M=t.get(w);if(M.position.setFromMatrixPosition(w.matrixWorld),M.position.applyMatrix4(g),M.color.copy(w.color).multiplyScalar(w.intensity),M.distance=w.distance,M.decay=0===w.distance?0:w.decay,M.shadow=w.castShadow,w.castShadow){E=w.shadow;M.shadowBias=E.bias,M.shadowRadius=E.radius,M.shadowMapSize=E.mapSize,M.shadowCameraNear=E.camera.near,M.shadowCameraFar=E.camera.far}e.pointShadowMap[d]=S,e.pointShadowMatrix[d]=w.shadow.matrix,e.point[d]=M,d++}else if(w.isHemisphereLight){M=t.get(w);M.direction.setFromMatrixPosition(w.matrixWorld),M.direction.transformDirection(g),M.direction.normalize(),M.skyColor.copy(w.color).multiplyScalar(x),M.groundColor.copy(w.groundColor).multiplyScalar(x),e.hemi[m]=M,m++}}e.ambient[0]=u,e.ambient[1]=l,e.ambient[2]=c,e.directional.length=h,e.spot.length=p,e.rectArea.length=f,e.point.length=d,e.hemi.length=m,e.hash=e.id+","+h+","+d+","+p+","+f+","+m+","+s.length}return{setup:o,state:e}}function ds(){var t=new hs,e=[],r=[],n=[];function i(){e.length=0,r.length=0,n.length=0}function o(t){e.push(t)}function s(t){r.push(t)}function a(t){n.push(t)}function u(n){t.setup(e,r,n)}var l={lightsArray:e,shadowsArray:r,spritesArray:n,lights:t};return{init:i,state:l,setupLights:u,pushLight:o,pushShadow:s,pushSprite:a}}function ps(){var t={};function e(e,r){var n=e.id+","+r.id,i=t[n];return void 0===i&&(i=new ds,t[n]=i),i}function r(){t={}}return{get:e,dispose:r}}function fs(t){Di.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ce,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function ms(t){Di.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Ne,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function gs(t,e,r){for(var n=new We,i=new Ie,o=new Oe,s=new Oe(r,r),a=new Ne,u=new Ne,l=1,c=2,h=1+(l|c),p=new Array(h),v=new Array(h),y={},w={0:m,1:f,2:g},b=[new Ne(1,0,0),new Ne(-1,0,0),new Ne(0,0,1),new Ne(0,0,-1),new Ne(0,1,0),new Ne(0,-1,0)],x=[new Ne(0,1,0),new Ne(0,1,0),new Ne(0,1,0),new Ne(0,1,0),new Ne(0,0,1),new Ne(0,0,-1)],_=[new ze,new ze,new ze,new ze,new ze,new ze],S=0;S!==h;++S){var M=0!==(S&l),E=0!==(S&c),T=new fs({depthPacking:Re,morphTargets:M,skinning:E});p[S]=T;var A=new ms({morphTargets:M,skinning:E});v[S]=A}var P=this;function C(e,r,n,i,o,s){var a=e.geometry,u=null,h=p,d=e.customDepthMaterial;if(n&&(h=v,d=e.customDistanceMaterial),d)u=d;else{var f=!1;r.morphTargets&&(a&&a.isBufferGeometry?f=a.morphAttributes&&a.morphAttributes.position&&a.morphAttributes.position.length>0:a&&a.isGeometry&&(f=a.morphTargets&&a.morphTargets.length>0)),e.isSkinnedMesh&&!1===r.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var m=e.isSkinnedMesh&&r.skinning,g=0;f&&(g|=l),m&&(g|=c),u=h[g]}if(t.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var b=u.uuid,x=r.uuid,_=y[b];void 0===_&&(_={},y[b]=_);var S=_[x];void 0===S&&(S=u.clone(),_[x]=S),u=S}return u.visible=r.visible,u.wireframe=r.wireframe,u.side=null!=r.shadowSide?r.shadowSide:w[r.side],u.clipShadows=r.clipShadows,u.clippingPlanes=r.clippingPlanes,u.clipIntersection=r.clipIntersection,u.wireframeLinewidth=r.wireframeLinewidth,u.linewidth=r.linewidth,n&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=o,u.farDistance=s),u}function R(r,i,o,s){if(!1!==r.visible){var a=r.layers.test(i.layers);if(a&&(r.isMesh||r.isLine||r.isPoints)&&r.castShadow&&(!r.frustumCulled||n.intersectsObject(r))){r.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,r.matrixWorld);var l=e.update(r),c=r.material;if(Array.isArray(c))for(var h=l.groups,d=0,p=h.length;d<p;d++){var f=h[d],m=c[f.materialIndex];if(m&&m.visible){var g=C(r,m,s,u,o.near,o.far);t.renderBufferDirect(o,null,l,g,r,f)}}else if(c.visible){g=C(r,c,s,u,o.near,o.far);t.renderBufferDirect(o,null,l,g,r,null)}}for(var v=r.children,y=0,w=v.length;y<w;y++)R(v[y],i,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=d,this.render=function(e,r,l){if(!1!==P.enabled&&(!1!==P.autoUpdate||!1!==P.needsUpdate)&&0!==e.length){var c,h=t.context,d=t.state;d.disable(h.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,f=e.length;p<f;p++){var m=e[p],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(o.copy(g.mapSize),o.min(s),v){var w=o.x,S=o.y;_[0].set(2*w,S,w,S),_[1].set(0,S,w,S),_[2].set(3*w,S,w,S),_[3].set(w,S,w,S),_[4].set(3*w,0,w,S),_[5].set(w,0,w,S),o.x*=4,o.y*=2}if(null===g.map){var M={minFilter:gt,magFilter:gt,format:kt};g.map=new Ue(o.x,o.y,M),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var E=g.map,T=g.matrix;u.setFromMatrixPosition(m.matrixWorld),y.position.copy(u),v?(c=6,T.makeTranslation(-u.x,-u.y,-u.z)):(c=1,a.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(a),y.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(y.projectionMatrix),T.multiply(y.matrixWorldInverse)),t.setRenderTarget(E),t.clear();for(var A=0;A<c;A++){if(v){a.copy(y.position),a.add(b[A]),y.up.copy(x[A]),y.lookAt(a),y.updateMatrixWorld();var C=_[A];d.viewport(C)}i.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),n.setFromMatrix(i),R(r,l,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}P.needsUpdate=!1}}}function vs(t,e,r,n,i,o,s,a,u){Ve.call(this,t,e,r,n,i,o,s,a,u),this.needsUpdate=!0}function ys(t,e,r,n,i){var o,s,a,u,l,c,h=new Ne,d=new De,p=new Ne;function f(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),r=new Uint16Array([0,1,2,0,2,3]);o=e.createBuffer(),s=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.bufferData(e.ELEMENT_ARRAY_BUFFER,r,e.STATIC_DRAW),a=m(),u={position:e.getAttribLocation(a,"position"),uv:e.getAttribLocation(a,"uv")},l={uvOffset:e.getUniformLocation(a,"uvOffset"),uvScale:e.getUniformLocation(a,"uvScale"),rotation:e.getUniformLocation(a,"rotation"),center:e.getUniformLocation(a,"center"),scale:e.getUniformLocation(a,"scale"),color:e.getUniformLocation(a,"color"),map:e.getUniformLocation(a,"map"),opacity:e.getUniformLocation(a,"opacity"),modelViewMatrix:e.getUniformLocation(a,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(a,"projectionMatrix"),fogType:e.getUniformLocation(a,"fogType"),fogDensity:e.getUniformLocation(a,"fogDensity"),fogNear:e.getUniformLocation(a,"fogNear"),fogFar:e.getUniformLocation(a,"fogFar"),fogColor:e.getUniformLocation(a,"fogColor"),fogDepth:e.getUniformLocation(a,"fogDepth"),alphaTest:e.getUniformLocation(a,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var i=n.getContext("2d");i.fillStyle="white",i.fillRect(0,0,8,8),c=new vs(n)}function m(){var t=e.createProgram(),r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(r),e.compileShader(n),e.attachShader(t,r),e.attachShader(t,n),e.linkProgram(t),t}function g(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(i,m,v){if(0!==i.length){void 0===a&&f(),r.useProgram(a),r.initAttributes(),r.enableAttribute(u.position),r.enableAttribute(u.uv),r.disableUnusedAttributes(),r.disable(e.CULL_FACE),r.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(u.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(u.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,s),e.uniformMatrix4fv(l.projectionMatrix,!1,v.projectionMatrix.elements),r.activeTexture(e.TEXTURE0),e.uniform1i(l.map,0);var y=0,w=0,b=m.fog;b?(e.uniform3f(l.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(e.uniform1f(l.fogNear,b.near),e.uniform1f(l.fogFar,b.far),e.uniform1i(l.fogType,1),y=1,w=1):b.isFogExp2&&(e.uniform1f(l.fogDensity,b.density),e.uniform1i(l.fogType,2),y=2,w=2)):(e.uniform1i(l.fogType,0),y=0,w=0);for(var x=0,_=i.length;x<_;x++){var S=i[x];S.modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,S.matrixWorld),S.z=-S.modelViewMatrix.elements[14]}i.sort(g);var M=[],E=[];for(x=0,_=i.length;x<_;x++){S=i[x];var T=S.material;if(!1!==T.visible){S.onBeforeRender(t,m,v,void 0,T,void 0),e.uniform1f(l.alphaTest,T.alphaTest),e.uniformMatrix4fv(l.modelViewMatrix,!1,S.modelViewMatrix.elements),S.matrixWorld.decompose(h,d,p),M[0]=p.x,M[1]=p.y,E[0]=S.center.x-.5,E[1]=S.center.y-.5;var A=0;m.fog&&T.fog&&(A=w),y!==A&&(e.uniform1i(l.fogType,A),y=A),null!==T.map?(e.uniform2f(l.uvOffset,T.map.offset.x,T.map.offset.y),e.uniform2f(l.uvScale,T.map.repeat.x,T.map.repeat.y)):(e.uniform2f(l.uvOffset,0,0),e.uniform2f(l.uvScale,1,1)),e.uniform1f(l.opacity,T.opacity),e.uniform3f(l.color,T.color.r,T.color.g,T.color.b),e.uniform1f(l.rotation,T.rotation),e.uniform2fv(l.center,E),e.uniform2fv(l.scale,M),r.setBlending(T.blending,T.blendEquation,T.blendSrc,T.blendDst,T.blendEquationAlpha,T.blendSrcAlpha,T.blendDstAlpha,T.premultipliedAlpha),r.buffers.depth.setTest(T.depthTest),r.buffers.depth.setMask(T.depthWrite),r.buffers.color.setMask(T.colorWrite),n.setTexture2D(T.map||c,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),S.onAfterRender(t,m,v,void 0,T,void 0)}}r.enable(e.CULL_FACE),r.reset()}}}function ws(t,e,r){function n(){var e=!1,r=new ze,n=null,i=new ze(0,0,0,0);return{setMask:function(r){n===r||e||(t.colorMask(r,r,r,r),n=r)},setLocked:function(t){e=t},setClear:function(e,n,o,s,a){!0===a&&(e*=s,n*=s,o*=s),r.set(e,n,o,s),!1===i.equals(r)&&(t.clearColor(e,n,o,s),i.copy(r))},reset:function(){e=!1,n=null,i.set(-1,0,0,0)}}}function i(){var e=!1,r=null,n=null,i=null;return{setTest:function(e){e?ut(t.DEPTH_TEST):lt(t.DEPTH_TEST)},setMask:function(n){r===n||e||(t.depthMask(n),r=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case H:t.depthFunc(t.NEVER);break;case G:t.depthFunc(t.ALWAYS);break;case q:t.depthFunc(t.LESS);break;case W:t.depthFunc(t.LEQUAL);break;case $:t.depthFunc(t.EQUAL);break;case X:t.depthFunc(t.GEQUAL);break;case Y:t.depthFunc(t.GREATER);break;case Z:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,r=null,n=null,i=null}}}function o(){var e=!1,r=null,n=null,i=null,o=null,s=null,a=null,u=null,l=null;return{setTest:function(e){e?ut(t.STENCIL_TEST):lt(t.STENCIL_TEST)},setMask:function(n){r===n||e||(t.stencilMask(n),r=n)},setFunc:function(e,r,s){n===e&&i===r&&o===s||(t.stencilFunc(e,r,s),n=e,i=r,o=s)},setOp:function(e,r,n){s===e&&a===r&&u===n||(t.stencilOp(e,r,n),s=e,a=r,u=n)},setLocked:function(t){e=t},setClear:function(e){l!==e&&(t.clearStencil(e),l=e)},reset:function(){e=!1,r=null,n=null,i=null,o=null,s=null,a=null,u=null,l=null}}}var s=new n,a=new i,u=new o,d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=new Uint8Array(d),f=new Uint8Array(d),v=new Uint8Array(d),y={},w=null,b=null,A=null,P=null,C=null,R=null,L=null,O=null,I=null,D=!1,N=null,k=null,F=null,V=null,z=null,U=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),j=!1,B=0,J=t.getParameter(t.VERSION);-1!==J.indexOf("WebGL")?(B=parseFloat(/^WebGL\ ([0-9])/.exec(J)[1]),j=B>=1):-1!==J.indexOf("OpenGL ES")&&(B=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(J)[1]),j=B>=2);var Q=null,K={},tt=new ze,et=new ze;function rt(e,r,n){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var s=0;s<n;s++)t.texImage2D(r+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}var nt={};function it(){for(var t=0,e=p.length;t<e;t++)p[t]=0}function ot(r){if(p[r]=1,0===f[r]&&(t.enableVertexAttribArray(r),f[r]=1),0!==v[r]){var n=e.get("ANGLE_instanced_arrays");n.vertexAttribDivisorANGLE(r,0),v[r]=0}}function st(r,n){if(p[r]=1,0===f[r]&&(t.enableVertexAttribArray(r),f[r]=1),v[r]!==n){var i=e.get("ANGLE_instanced_arrays");i.vertexAttribDivisorANGLE(r,n),v[r]=n}}function at(){for(var e=0,r=f.length;e!==r;++e)f[e]!==p[e]&&(t.disableVertexAttribArray(e),f[e]=0)}function ut(e){!0!==y[e]&&(t.enable(e),y[e]=!0)}function lt(e){!1!==y[e]&&(t.disable(e),y[e]=!1)}function ct(){if(null===w&&(w=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var r=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<r.length;n++)w.push(r[n]);return w}function ht(e){return b!==e&&(t.useProgram(e),b=e,!0)}function dt(e,n,i,o,s,a,u,l){if(e!==x?ut(t.BLEND):lt(t.BLEND),e!==T){if(e!==A||l!==D)switch(e){case S:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case M:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case E:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:l?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}P=null,C=null,R=null,L=null,O=null,I=null}else s=s||n,a=a||i,u=u||o,n===P&&s===L||(t.blendEquationSeparate(r.convert(n),r.convert(s)),P=n,L=s),i===C&&o===R&&a===O&&u===I||(t.blendFuncSeparate(r.convert(i),r.convert(o),r.convert(a),r.convert(u)),C=i,R=o,O=a,I=u);A=e,D=l}function pt(e,r){e.side===g?lt(t.CULL_FACE):ut(t.CULL_FACE);var n=e.side===m;r&&(n=!n),ft(n),!0===e.transparent?dt(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):dt(x),a.setFunc(e.depthFunc),a.setTest(e.depthTest),a.setMask(e.depthWrite),s.setMask(e.colorWrite),vt(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function ft(e){N!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),N=e)}function mt(e){e!==l?(ut(t.CULL_FACE),e!==k&&(e===c?t.cullFace(t.BACK):e===h?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):lt(t.CULL_FACE),k=e}function gt(e){e!==F&&(j&&t.lineWidth(e),F=e)}function vt(e,r,n){e?(ut(t.POLYGON_OFFSET_FILL),V===r&&z===n||(t.polygonOffset(r,n),V=r,z=n)):lt(t.POLYGON_OFFSET_FILL)}function yt(e){e?ut(t.SCISSOR_TEST):lt(t.SCISSOR_TEST)}function wt(e){void 0===e&&(e=t.TEXTURE0+U-1),Q!==e&&(t.activeTexture(e),Q=e)}function bt(e,r){null===Q&&wt();var n=K[Q];void 0===n&&(n={type:void 0,texture:void 0},K[Q]=n),n.type===e&&n.texture===r||(t.bindTexture(e,r||nt[e]),n.type=e,n.texture=r)}function xt(){try{t.compressedTexImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function _t(){try{t.texImage2D.apply(t,arguments)}catch(e){console.error("THREE.WebGLState:",e)}}function St(e){!1===tt.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),tt.copy(e))}function Mt(e){!1===et.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),et.copy(e))}function Et(){for(var e=0;e<f.length;e++)1===f[e]&&(t.disableVertexAttribArray(e),f[e]=0);y={},w=null,Q=null,K={},b=null,A=null,N=null,k=null,s.reset(),a.reset(),u.reset()}return nt[t.TEXTURE_2D]=rt(t.TEXTURE_2D,t.TEXTURE_2D,1),nt[t.TEXTURE_CUBE_MAP]=rt(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),s.setClear(0,0,0,1),a.setClear(1),u.setClear(0),ut(t.DEPTH_TEST),a.setFunc(W),ft(!1),mt(c),ut(t.CULL_FACE),ut(t.BLEND),dt(_),{buffers:{color:s,depth:a,stencil:u},initAttributes:it,enableAttribute:ot,enableAttributeAndDivisor:st,disableUnusedAttributes:at,enable:ut,disable:lt,getCompressedTextureFormats:ct,useProgram:ht,setBlending:dt,setMaterial:pt,setFlipSided:ft,setCullFace:mt,setLineWidth:gt,setPolygonOffset:vt,setScissorTest:yt,activeTexture:wt,bindTexture:bt,compressedTexImage2D:xt,texImage2D:_t,scissor:St,viewport:Mt,reset:Et}}function bs(t,e,r,n,i,o,s){var a,u="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,l={};function c(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var r=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=Math.floor(t.width*r),n.height=Math.floor(t.height*r);var i=n.getContext("2d");return i.drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function h(t){return Le.isPowerOfTwo(t.width)&&Le.isPowerOfTwo(t.height)}function d(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap){void 0===a&&(a=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),a.width=Le.floorPowerOfTwo(t.width),a.height=Le.floorPowerOfTwo(t.height);var e=a.getContext("2d");return e.drawImage(t,0,0,a.width,a.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+a.width+"x"+a.height,t),a}return t}function p(t){return t.wrapS!==ft||t.wrapT!==ft||t.minFilter!==gt&&t.minFilter!==wt}function f(t,e){return t.generateMipmaps&&e&&t.minFilter!==gt&&t.minFilter!==wt}function m(e,r,i,o){t.generateMipmap(e);var s=n.get(r);s.__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function g(e){return e===gt||e===vt||e===yt?t.NEAREST:t.LINEAR}function v(t){var e=t.target;e.removeEventListener("dispose",v),w(e),e.isVideoTexture&&delete l[e.id],s.memory.textures--}function y(t){var e=t.target;e.removeEventListener("dispose",y),b(e),s.memory.textures--}function w(e){var r=n.get(e);if(e.image&&r.__image__webglTextureCube)t.deleteTexture(r.__image__webglTextureCube);else{if(void 0===r.__webglInit)return;t.deleteTexture(r.__webglTexture)}n.remove(e)}function b(e){var r=n.get(e),i=n.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(r.__webglFramebuffer[o]),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer[o]);else t.deleteFramebuffer(r.__webglFramebuffer),r.__webglDepthbuffer&&t.deleteRenderbuffer(r.__webglDepthbuffer);n.remove(e.texture),n.remove(e)}}function x(e,i){var o=n.get(e);if(e.isVideoTexture&&O(e),e.version>0&&o.__version!==e.version){var s=e.image;if(void 0===s)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==s.complete)return void E(o,e,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}r.activeTexture(t.TEXTURE0+i),r.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function _(e,a){var u=n.get(e);if(6===e.image.length)if(e.version>0&&u.__version!==e.version){u.__image__webglTextureCube||(e.addEventListener("dispose",v),u.__image__webglTextureCube=t.createTexture(),s.memory.textures++),r.activeTexture(t.TEXTURE0+a),r.bindTexture(t.TEXTURE_CUBE_MAP,u.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var l=e&&e.isCompressedTexture,d=e.image[0]&&e.image[0].isDataTexture,p=[],g=0;g<6;g++)p[g]=l||d?d?e.image[g].image:e.image[g]:c(e.image[g],i.maxCubemapSize);var y=p[0],w=h(y),b=o.convert(e.format),x=o.convert(e.type);M(t.TEXTURE_CUBE_MAP,e,w);for(g=0;g<6;g++)if(l)for(var _,S=p[g].mipmaps,E=0,T=S.length;E<T;E++)_=S[E],e.format!==kt&&e.format!==Nt?r.getCompressedTextureFormats().indexOf(b)>-1?r.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,b,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,E,b,_.width,_.height,0,b,x,_.data);else d?r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,p[g].width,p[g].height,0,b,x,p[g].data):r.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,b,b,x,p[g]);u.__maxMipLevel=l?S.length-1:0,f(e,w)&&m(t.TEXTURE_CUBE_MAP,e,y.width,y.height),u.__version=e.version,e.onUpdate&&e.onUpdate(e)}else r.activeTexture(t.TEXTURE0+a),r.bindTexture(t.TEXTURE_CUBE_MAP,u.__image__webglTextureCube)}function S(e,i){r.activeTexture(t.TEXTURE0+i),r.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)}function M(r,s,a){var u;if(a?(t.texParameteri(r,t.TEXTURE_WRAP_S,o.convert(s.wrapS)),t.texParameteri(r,t.TEXTURE_WRAP_T,o.convert(s.wrapT)),t.texParameteri(r,t.TEXTURE_MAG_FILTER,o.convert(s.magFilter)),t.texParameteri(r,t.TEXTURE_MIN_FILTER,o.convert(s.minFilter))):(t.texParameteri(r,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(r,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),s.wrapS===ft&&s.wrapT===ft||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",s),t.texParameteri(r,t.TEXTURE_MAG_FILTER,g(s.magFilter)),t.texParameteri(r,t.TEXTURE_MIN_FILTER,g(s.minFilter)),s.minFilter!==gt&&s.minFilter!==wt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",s)),u=e.get("EXT_texture_filter_anisotropic"),u){if(s.type===Pt&&null===e.get("OES_texture_float_linear"))return;if(s.type===Ct&&null===e.get("OES_texture_half_float_linear"))return;(s.anisotropy>1||n.get(s).__currentAnisotropy)&&(t.texParameterf(r,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(s.anisotropy,i.getMaxAnisotropy())),n.get(s).__currentAnisotropy=s.anisotropy)}}function E(e,n,a){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",v),e.__webglTexture=t.createTexture(),s.memory.textures++),r.activeTexture(t.TEXTURE0+a),r.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,n.unpackAlignment);var l=c(n.image,i.maxTextureSize);p(n)&&!1===h(l)&&(l=d(l));var g=h(l),y=o.convert(n.format),w=o.convert(n.type);M(t.TEXTURE_2D,n,g);var b,x=n.mipmaps;if(n.isDepthTexture){var _=t.DEPTH_COMPONENT;if(n.type===Pt){if(!u)throw new Error("Float Depth Texture only supported in WebGL2.0");_=t.DEPTH_COMPONENT32F}else u&&(_=t.DEPTH_COMPONENT16);n.format===zt&&_===t.DEPTH_COMPONENT&&n.type!==Et&&n.type!==At&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=Et,w=o.convert(n.type)),n.format===Ut&&(_=t.DEPTH_STENCIL,n.type!==It&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=It,w=o.convert(n.type))),r.texImage2D(t.TEXTURE_2D,0,_,l.width,l.height,0,y,w,null)}else if(n.isDataTexture)if(x.length>0&&g){for(var S=0,E=x.length;S<E;S++)b=x[S],r.texImage2D(t.TEXTURE_2D,S,y,b.width,b.height,0,y,w,b.data);n.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else r.texImage2D(t.TEXTURE_2D,0,y,l.width,l.height,0,y,w,l.data),e.__maxMipLevel=0;else if(n.isCompressedTexture){for(S=0,E=x.length;S<E;S++)b=x[S],n.format!==kt&&n.format!==Nt?r.getCompressedTextureFormats().indexOf(y)>-1?r.compressedTexImage2D(t.TEXTURE_2D,S,y,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):r.texImage2D(t.TEXTURE_2D,S,y,b.width,b.height,0,y,w,b.data);e.__maxMipLevel=x.length-1}else if(x.length>0&&g){for(S=0,E=x.length;S<E;S++)b=x[S],r.texImage2D(t.TEXTURE_2D,S,y,y,w,b);n.generateMipmaps=!1,e.__maxMipLevel=x.length-1}else r.texImage2D(t.TEXTURE_2D,0,y,y,w,l),e.__maxMipLevel=0;f(n,g)&&m(t.TEXTURE_2D,n,l.width,l.height),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}function T(e,i,s,a){var u=o.convert(i.texture.format),l=o.convert(i.texture.type);r.texImage2D(a,0,u,i.width,i.height,0,u,l,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,s,a,n.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function A(e,r){t.bindRenderbuffer(t.RENDERBUFFER,e),r.depthBuffer&&!r.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):r.depthBuffer&&r.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,r.width,r.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,r.width,r.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function P(e,r){var i=r&&r.isWebGLRenderTargetCube;if(i)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!r.depthTexture||!r.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(r.depthTexture).__webglTexture&&r.depthTexture.image.width===r.width&&r.depthTexture.image.height===r.height||(r.depthTexture.image.width=r.width,r.depthTexture.image.height=r.height,r.depthTexture.needsUpdate=!0),x(r.depthTexture,0);var o=n.get(r.depthTexture).__webglTexture;if(r.depthTexture.format===zt)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,o,0);else{if(r.depthTexture.format!==Ut)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,o,0)}}function C(e){var r=n.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");P(r.__webglFramebuffer,e)}else if(i){r.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer[o]),r.__webglDepthbuffer[o]=t.createRenderbuffer(),A(r.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,r.__webglFramebuffer),r.__webglDepthbuffer=t.createRenderbuffer(),A(r.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function R(e){var i=n.get(e),o=n.get(e.texture);e.addEventListener("dispose",y),o.__webglTexture=t.createTexture(),s.memory.textures++;var a=!0===e.isWebGLRenderTargetCube,u=h(e);if(a){i.__webglFramebuffer=[];for(var l=0;l<6;l++)i.__webglFramebuffer[l]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(a){r.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),M(t.TEXTURE_CUBE_MAP,e.texture,u);for(l=0;l<6;l++)T(i.__webglFramebuffer[l],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+l);f(e.texture,u)&&m(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),r.bindTexture(t.TEXTURE_CUBE_MAP,null)}else r.bindTexture(t.TEXTURE_2D,o.__webglTexture),M(t.TEXTURE_2D,e.texture,u),T(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),f(e.texture,u)&&m(t.TEXTURE_2D,e.texture,e.width,e.height),r.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&C(e)}function L(e){var i=e.texture,o=h(e);if(f(i,o)){var s=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=n.get(i).__webglTexture;r.bindTexture(s,a),m(s,i,e.width,e.height),r.bindTexture(s,null)}}function O(t){var e=t.id,r=s.render.frame;l[e]!==r&&(l[e]=r,t.update())}this.setTexture2D=x,this.setTextureCube=_,this.setTextureCubeDynamic=S,this.setupRenderTarget=R,this.updateRenderTargetMipmap=L}function xs(t,e){function r(r){var n;if(r===pt)return t.REPEAT;if(r===ft)return t.CLAMP_TO_EDGE;if(r===mt)return t.MIRRORED_REPEAT;if(r===gt)return t.NEAREST;if(r===vt)return t.NEAREST_MIPMAP_NEAREST;if(r===yt)return t.NEAREST_MIPMAP_LINEAR;if(r===wt)return t.LINEAR;if(r===bt)return t.LINEAR_MIPMAP_NEAREST;if(r===xt)return t.LINEAR_MIPMAP_LINEAR;if(r===_t)return t.UNSIGNED_BYTE;if(r===Rt)return t.UNSIGNED_SHORT_4_4_4_4;if(r===Lt)return t.UNSIGNED_SHORT_5_5_5_1;if(r===Ot)return t.UNSIGNED_SHORT_5_6_5;if(r===St)return t.BYTE;if(r===Mt)return t.SHORT;if(r===Et)return t.UNSIGNED_SHORT;if(r===Tt)return t.INT;if(r===At)return t.UNSIGNED_INT;if(r===Pt)return t.FLOAT;if(r===Ct&&(n=e.get("OES_texture_half_float"),null!==n))return n.HALF_FLOAT_OES;if(r===Dt)return t.ALPHA;if(r===Nt)return t.RGB;if(r===kt)return t.RGBA;if(r===Ft)return t.LUMINANCE;if(r===Vt)return t.LUMINANCE_ALPHA;if(r===zt)return t.DEPTH_COMPONENT;if(r===Ut)return t.DEPTH_STENCIL;if(r===A)return t.FUNC_ADD;if(r===P)return t.FUNC_SUBTRACT;if(r===C)return t.FUNC_REVERSE_SUBTRACT;if(r===O)return t.ZERO;if(r===I)return t.ONE;if(r===D)return t.SRC_COLOR;if(r===N)return t.ONE_MINUS_SRC_COLOR;if(r===k)return t.SRC_ALPHA;if(r===F)return t.ONE_MINUS_SRC_ALPHA;if(r===V)return t.DST_ALPHA;if(r===z)return t.ONE_MINUS_DST_ALPHA;if(r===U)return t.DST_COLOR;if(r===j)return t.ONE_MINUS_DST_COLOR;if(r===B)return t.SRC_ALPHA_SATURATE;if((r===jt||r===Bt||r===Ht||r===Gt)&&(n=e.get("WEBGL_compressed_texture_s3tc"),null!==n)){if(r===jt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Bt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===Ht)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Gt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((r===qt||r===Wt||r===$t||r===Xt)&&(n=e.get("WEBGL_compressed_texture_pvrtc"),null!==n)){if(r===qt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Wt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===$t)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Xt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===Yt&&(n=e.get("WEBGL_compressed_texture_etc1"),null!==n))return n.COMPRESSED_RGB_ETC1_WEBGL;if((r===Zt||r===Jt||r===Qt||r===Kt||r===te||r===ee||r===re||r===ne||r===ie||r===oe||r===se||r===ae||r===ue||r===le)&&(n=e.get("WEBGL_compressed_texture_astc"),null!==n))return r;if((r===R||r===L)&&(n=e.get("EXT_blend_minmax"),null!==n)){if(r===R)return n.MIN_EXT;if(r===L)return n.MAX_EXT}return r===It&&(n=e.get("WEBGL_depth_texture"),null!==n)?n.UNSIGNED_INT_24_8_WEBGL:0}return{convert:r}}function _s(t,e,r,n){ci.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==r?r:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Ss(t){_s.call(this),this.cameras=t||[]}function Ms(t){var e=this,r=null,n=null,i=null,o=new Ie,s=new Ie;"undefined"!==typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",g,!1));var a=new Ie,u=new De,l=new Ne,c=new _s;c.bounds=new ze(0,0,.5,1),c.layers.enable(1);var h=new _s;h.bounds=new ze(.5,0,.5,1),h.layers.enable(2);var d,p,f=new Ss([c,h]);function m(){return null!==r&&!0===r.isPresenting}function g(){if(m()){var n=r.getEyeParameters("left"),i=n.renderWidth,o=n.renderHeight;p=t.getPixelRatio(),d=t.getSize(),t.setDrawingBufferSize(2*i,o,1)}else e.enabled&&t.setDrawingBufferSize(d.width,d.height,p)}f.layers.enable(1),f.layers.enable(2),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return r},this.setDevice=function(t){void 0!==t&&(r=t)},this.setPoseTarget=function(t){void 0!==t&&(i=t)},this.getCamera=function(t){if(null===r)return t;r.depthNear=t.near,r.depthFar=t.far,r.getFrameData(n);var d=r.stageParameters;d?o.fromArray(d.sittingToStandingTransform):o.makeTranslation(0,e.userHeight,0);var p=n.pose,m=null!==i?i:t;if(m.matrix.copy(o),m.matrix.decompose(m.position,m.quaternion,m.scale),null!==p.orientation&&(u.fromArray(p.orientation),m.quaternion.multiply(u)),null!==p.position&&(u.setFromRotationMatrix(o),l.fromArray(p.position),l.applyQuaternion(u),m.position.add(l)),m.updateMatrixWorld(),!1===r.isPresenting)return t;c.near=t.near,h.near=t.near,c.far=t.far,h.far=t.far,f.matrixWorld.copy(t.matrixWorld),f.matrixWorldInverse.copy(t.matrixWorldInverse),c.matrixWorldInverse.fromArray(n.leftViewMatrix),h.matrixWorldInverse.fromArray(n.rightViewMatrix),s.getInverse(o),c.matrixWorldInverse.multiply(s),h.matrixWorldInverse.multiply(s);var g=m.parent;null!==g&&(a.getInverse(g.matrixWorld),c.matrixWorldInverse.multiply(a),h.matrixWorldInverse.multiply(a)),c.matrixWorld.getInverse(c.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),c.projectionMatrix.fromArray(n.leftProjectionMatrix),h.projectionMatrix.fromArray(n.rightProjectionMatrix),f.projectionMatrix.copy(c.projectionMatrix);var v=r.getLayers();if(v.length){var y=v[0];null!==y.leftBounds&&4===y.leftBounds.length&&c.bounds.fromArray(y.leftBounds),null!==y.rightBounds&&4===y.rightBounds.length&&h.bounds.fromArray(y.rightBounds)}return f},this.getStandingMatrix=function(){return o},this.submitFrame=function(){m()&&r.submitFrame()},this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",g)}}function Es(t){console.log("THREE.WebGLRenderer",u),t=t||{};var e=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),r=void 0!==t.context?t.context:null,n=void 0!==t.alpha&&t.alpha,i=void 0===t.depth||t.depth,o=void 0===t.stencil||t.stencil,s=void 0!==t.antialias&&t.antialias,a=void 0===t.premultipliedAlpha||t.premultipliedAlpha,l=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,c=void 0!==t.powerPreference?t.powerPreference:"default",h=null,d=null;this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=et,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var p,f,m,g,v,w,b,x,_,S,M,E,T,A,P,C,R,L,O,I=this,D=!1,N=null,k=null,F=-1,V="",z=null,U=null,j=new ze,B=new ze,H=null,G=0,q=e.width,W=e.height,$=1,X=new ze(0,0,q,W),Y=new ze(0,0,q,W),Z=!1,J=new We,Q=new Gi,K=!1,tt=!1,rt=new Ie,nt=new Ne;function it(){return null===N?$:1}try{var ot={alpha:n,depth:i,stencil:o,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:l,powerPreference:c};if(e.addEventListener("webglcontextlost",lt,!1),e.addEventListener("webglcontextrestored",ct,!1),p=r||e.getContext("webgl",ot)||e.getContext("experimental-webgl",ot),null===p)throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Wt){console.error("THREE.WebGLRenderer: "+Wt.message)}function st(){f=new qi(p),f.get("WEBGL_depth_texture"),f.get("OES_texture_float"),f.get("OES_texture_float_linear"),f.get("OES_texture_half_float"),f.get("OES_texture_half_float_linear"),f.get("OES_standard_derivatives"),f.get("OES_element_index_uint"),f.get("ANGLE_instanced_arrays"),O=new xs(p,f),m=new Hi(p,f,t),g=new ws(p,f,O),g.scissor(B.copy(Y).multiplyScalar($)),g.viewport(j.copy(X).multiplyScalar($)),v=new Xi(p),w=new is,b=new bs(p,f,g,w,m,O,v),x=new oi(p),_=new Wi(p,x,v),S=new Ji(_,v),P=new Zi(p),M=new ns(I,f,m),E=new us,T=new ps,A=new ji(I,g,_,a),C=new Bi(p,f,v),R=new $i(p,f,v),L=new ys(I,p,g,b,m),v.programs=M.programs,I.context=p,I.capabilities=m,I.extensions=f,I.properties=w,I.renderLists=E,I.state=g,I.info=v}st();var at=new Ms(I);this.vr=at;var ut=new gs(I,S,m.maxTextureSize);function lt(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),D=!0}function ct(){console.log("THREE.WebGLRenderer: Context Restored."),D=!1,st()}function ht(t){var e=t.target;e.removeEventListener("dispose",ht),dt(e)}function dt(t){pt(t),w.remove(t)}function pt(t){var e=w.get(t).program;t.program=void 0,void 0!==e&&M.releaseProgram(e)}function ft(t,e,r){t.render((function(t){I.renderBufferImmediate(t,e,r)}))}function mt(t,e,r){if(r&&r.isInstancedBufferGeometry&&null===f.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{g.initAttributes();var n=r.attributes,i=e.getAttributes(),o=t.defaultAttributeValues;for(var s in i){var a=i[s];if(a>=0){var u=n[s];if(void 0!==u){var l=u.normalized,c=u.itemSize,h=x.get(u);if(void 0===h)continue;var d=h.buffer,m=h.type,v=h.bytesPerElement;if(u.isInterleavedBufferAttribute){var y=u.data,w=y.stride,b=u.offset;y&&y.isInstancedInterleavedBuffer?(g.enableAttributeAndDivisor(a,y.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=y.meshPerAttribute*y.count)):g.enableAttribute(a),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(a,c,m,l,w*v,b*v)}else u.isInstancedBufferAttribute?(g.enableAttributeAndDivisor(a,u.meshPerAttribute),void 0===r.maxInstancedCount&&(r.maxInstancedCount=u.meshPerAttribute*u.count)):g.enableAttribute(a),p.bindBuffer(p.ARRAY_BUFFER,d),p.vertexAttribPointer(a,c,m,l,0,0)}else if(void 0!==o){var _=o[s];if(void 0!==_)switch(_.length){case 2:p.vertexAttrib2fv(a,_);break;case 3:p.vertexAttrib3fv(a,_);break;case 4:p.vertexAttrib4fv(a,_);break;default:p.vertexAttrib1fv(a,_)}}}}g.disableUnusedAttributes()}}this.shadowMap=ut,this.getContext=function(){return p},this.getContextAttributes=function(){return p.getContextAttributes()},this.forceContextLoss=function(){var t=f.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=f.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return $},this.setPixelRatio=function(t){void 0!==t&&($=t,this.setSize(q,W,!1))},this.getSize=function(){return{width:q,height:W}},this.setSize=function(t,r,n){var i=at.getDevice();i&&i.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(q=t,W=r,e.width=t*$,e.height=r*$,!1!==n&&(e.style.width=t+"px",e.style.height=r+"px"),this.setViewport(0,0,t,r))},this.getDrawingBufferSize=function(){return{width:q*$,height:W*$}},this.setDrawingBufferSize=function(t,r,n){q=t,W=r,$=n,e.width=t*n,e.height=r*n,this.setViewport(0,0,t,r)},this.getCurrentViewport=function(){return j},this.setViewport=function(t,e,r,n){X.set(t,W-e-n,r,n),g.viewport(j.copy(X).multiplyScalar($))},this.setScissor=function(t,e,r,n){Y.set(t,W-e-n,r,n),g.scissor(B.copy(Y).multiplyScalar($))},this.setScissorTest=function(t){g.setScissorTest(Z=t)},this.getClearColor=function(){return A.getClearColor()},this.setClearColor=function(){A.setClearColor.apply(A,arguments)},this.getClearAlpha=function(){return A.getClearAlpha()},this.setClearAlpha=function(){A.setClearAlpha.apply(A,arguments)},this.clear=function(t,e,r){var n=0;(void 0===t||t)&&(n|=p.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=p.DEPTH_BUFFER_BIT),(void 0===r||r)&&(n|=p.STENCIL_BUFFER_BIT),p.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,r,n){this.setRenderTarget(t),this.clear(e,r,n)},this.dispose=function(){e.removeEventListener("webglcontextlost",lt,!1),e.removeEventListener("webglcontextrestored",ct,!1),E.dispose(),T.dispose(),w.dispose(),S.dispose(),at.dispose(),wt()},this.renderBufferImmediate=function(t,e,r){g.initAttributes();var n=w.get(t);t.hasPositions&&!n.position&&(n.position=p.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=p.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=p.createBuffer()),t.hasColors&&!n.color&&(n.color=p.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(p.bindBuffer(p.ARRAY_BUFFER,n.position),p.bufferData(p.ARRAY_BUFFER,t.positionArray,p.DYNAMIC_DRAW),g.enableAttribute(i.position),p.vertexAttribPointer(i.position,3,p.FLOAT,!1,0,0)),t.hasNormals){if(p.bindBuffer(p.ARRAY_BUFFER,n.normal),!r.isMeshPhongMaterial&&!r.isMeshStandardMaterial&&!r.isMeshNormalMaterial&&!0===r.flatShading)for(var o=0,s=3*t.count;o<s;o+=9){var a=t.normalArray,u=(a[o+0]+a[o+3]+a[o+6])/3,l=(a[o+1]+a[o+4]+a[o+7])/3,c=(a[o+2]+a[o+5]+a[o+8])/3;a[o+0]=u,a[o+1]=l,a[o+2]=c,a[o+3]=u,a[o+4]=l,a[o+5]=c,a[o+6]=u,a[o+7]=l,a[o+8]=c}p.bufferData(p.ARRAY_BUFFER,t.normalArray,p.DYNAMIC_DRAW),g.enableAttribute(i.normal),p.vertexAttribPointer(i.normal,3,p.FLOAT,!1,0,0)}t.hasUvs&&r.map&&(p.bindBuffer(p.ARRAY_BUFFER,n.uv),p.bufferData(p.ARRAY_BUFFER,t.uvArray,p.DYNAMIC_DRAW),g.enableAttribute(i.uv),p.vertexAttribPointer(i.uv,2,p.FLOAT,!1,0,0)),t.hasColors&&r.vertexColors!==y&&(p.bindBuffer(p.ARRAY_BUFFER,n.color),p.bufferData(p.ARRAY_BUFFER,t.colorArray,p.DYNAMIC_DRAW),g.enableAttribute(i.color),p.vertexAttribPointer(i.color,3,p.FLOAT,!1,0,0)),g.disableUnusedAttributes(),p.drawArrays(p.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,r,n,i,o){var s=i.isMesh&&i.matrixWorld.determinant()<0;g.setMaterial(n,s);var a=At(t,e,n,i),u=r.id+"_"+a.id+"_"+(!0===n.wireframe),l=!1;u!==V&&(V=u,l=!0),i.morphTargetInfluences&&(P.update(i,r,n,a),l=!0);var c,h=r.index,d=r.attributes.position,f=1;!0===n.wireframe&&(h=_.getWireframeAttribute(r),f=2);var m=C;null!==h&&(c=x.get(h),m=R,m.setIndex(c)),l&&(mt(n,a,r),null!==h&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,c.buffer));var v=1/0;null!==h?v=h.count:void 0!==d&&(v=d.count);var y=r.drawRange.start*f,w=r.drawRange.count*f,b=null!==o?o.start*f:0,S=null!==o?o.count*f:1/0,M=Math.max(y,b),E=Math.min(v,y+w,b+S)-1,T=Math.max(0,E-M+1);if(0!==T){if(i.isMesh)if(!0===n.wireframe)g.setLineWidth(n.wireframeLinewidth*it()),m.setMode(p.LINES);else switch(i.drawMode){case we:m.setMode(p.TRIANGLES);break;case be:m.setMode(p.TRIANGLE_STRIP);break;case xe:m.setMode(p.TRIANGLE_FAN);break}else if(i.isLine){var A=n.linewidth;void 0===A&&(A=1),g.setLineWidth(A*it()),i.isLineSegments?m.setMode(p.LINES):i.isLineLoop?m.setMode(p.LINE_LOOP):m.setMode(p.LINE_STRIP)}else i.isPoints&&m.setMode(p.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&m.renderInstances(r,M,T):m.render(M,T)}},this.compile=function(t,e){d=T.get(t,e),d.init(),t.traverse((function(t){t.isLight&&(d.pushLight(t),t.castShadow&&d.pushShadow(t))})),d.setupLights(e),t.traverse((function(e){if(e.material)if(Array.isArray(e.material))for(var r=0;r<e.material.length;r++)Tt(e.material[r],t.fog,e);else Tt(e.material,t.fog,e)}))};var gt=!1,vt=null;function yt(){gt||(bt(),gt=!0)}function wt(){gt=!1}function bt(){var t=at.getDevice();t&&t.isPresenting?t.requestAnimationFrame(xt):window.requestAnimationFrame(xt)}function xt(t){!1!==gt&&(vt(t),bt())}function St(t,e,r){if(!1!==t.visible){var n=t.layers.test(e.layers);if(n)if(t.isLight)d.pushLight(t),t.castShadow&&d.pushShadow(t);else if(t.isSprite)t.frustumCulled&&!J.intersectsSprite(t)||d.pushSprite(t);else if(t.isImmediateRenderObject)r&&nt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt),h.push(t,null,t.material,nt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||J.intersectsObject(t))){r&&nt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(rt);var i=S.update(t),o=t.material;if(Array.isArray(o))for(var s=i.groups,a=0,u=s.length;a<u;a++){var l=s[a],c=o[l.materialIndex];c&&c.visible&&h.push(t,i,c,nt.z,l)}else o.visible&&h.push(t,i,o,nt.z,null)}var p=t.children;for(a=0,u=p.length;a<u;a++)St(p[a],e,r)}}function Mt(t,e,r,n){for(var i=0,o=t.length;i<o;i++){var s=t[i],a=s.object,u=s.geometry,l=void 0===n?s.material:n,c=s.group;if(r.isArrayCamera){U=r;for(var h=r.cameras,d=0,p=h.length;d<p;d++){var f=h[d];if(a.layers.test(f.layers)){var m=f.bounds,v=m.x*q,y=m.y*W,w=m.z*q,b=m.w*W;g.viewport(j.set(v,y,w,b).multiplyScalar($)),Et(a,e,f,u,l,c)}}}else U=null,Et(a,e,r,u,l,c)}}function Et(t,e,r,n,i,o){if(t.onBeforeRender(I,e,r,n,i,o),d=T.get(e,U||r),t.modelViewMatrix.multiplyMatrices(r.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var s=t.isMesh&&t.matrixWorld.determinant()<0;g.setMaterial(i,s);var a=At(r,e.fog,i,t);V="",ft(t,a,i)}else I.renderBufferDirect(r,e.fog,n,i,t,o);t.onAfterRender(I,e,r,n,i,o),d=T.get(e,U||r)}function Tt(t,e,r){var n=w.get(t),i=d.state.lights,o=d.state.shadowsArray,s=M.getParameters(t,i.state,o,e,Q.numPlanes,Q.numIntersection,r),a=M.getProgramCode(t,s),u=n.program,l=!0;if(void 0===u)t.addEventListener("dispose",ht);else if(u.code!==a)pt(t);else if(n.lightsHash!==i.state.hash)w.update(t,"lightsHash",i.state.hash),l=!1;else{if(void 0!==s.shaderID)return;l=!1}if(l){if(s.shaderID){var c=ii[s.shaderID];n.shader={name:t.type,uniforms:ti.clone(c.uniforms),vertexShader:c.vertexShader,fragmentShader:c.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader,I),u=M.acquireProgram(t,n.shader,s,a),n.program=u,t.program=u}var h=u.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<I.maxMorphTargets;p++)h["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(p=0;p<I.maxMorphNormals;p++)h["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var f=n.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=Q.numPlanes,n.numIntersection=Q.numIntersection,f.clippingPlanes=Q.uniform),n.fog=e,n.lightsHash=i.state.hash,t.lights&&(f.ambientLightColor.value=i.state.ambient,f.directionalLights.value=i.state.directional,f.spotLights.value=i.state.spot,f.rectAreaLights.value=i.state.rectArea,f.pointLights.value=i.state.point,f.hemisphereLights.value=i.state.hemi,f.directionalShadowMap.value=i.state.directionalShadowMap,f.directionalShadowMatrix.value=i.state.directionalShadowMatrix,f.spotShadowMap.value=i.state.spotShadowMap,f.spotShadowMatrix.value=i.state.spotShadowMatrix,f.pointShadowMap.value=i.state.pointShadowMap,f.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=n.program.getUniforms(),g=Uo.seqWithValue(m.seq,f);n.uniformsList=g}function At(t,e,r,n){G=0;var i=w.get(r),o=d.state.lights;if(K&&(tt||t!==z)){var s=t===z&&r.id===F;Q.setState(r.clippingPlanes,r.clipIntersection,r.clipShadows,t,i,s)}!1===r.needsUpdate&&(void 0===i.program||r.fog&&i.fog!==e||r.lights&&i.lightsHash!==o.state.hash?r.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===Q.numPlanes&&i.numIntersection===Q.numIntersection||(r.needsUpdate=!0)),r.needsUpdate&&(Tt(r,e,n),r.needsUpdate=!1);var a=!1,u=!1,l=!1,c=i.program,h=c.getUniforms(),f=i.shader.uniforms;if(g.useProgram(c.program)&&(a=!0,u=!0,l=!0),r.id!==F&&(F=r.id,u=!0),a||t!==z){if(h.setValue(p,"projectionMatrix",t.projectionMatrix),m.logarithmicDepthBuffer&&h.setValue(p,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),z!==(U||t)&&(z=U||t,u=!0,l=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshStandardMaterial||r.envMap){var v=h.map.cameraPosition;void 0!==v&&v.setValue(p,nt.setFromMatrixPosition(t.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.skinning)&&h.setValue(p,"viewMatrix",t.matrixWorldInverse)}if(r.skinning){h.setOptional(p,n,"bindMatrix"),h.setOptional(p,n,"bindMatrixInverse");var y=n.skeleton;if(y){var b=y.bones;if(m.floatVertexTextures){if(void 0===y.boneTexture){var x=Math.sqrt(4*b.length);x=Le.ceilPowerOfTwo(x),x=Math.max(x,4);var _=new Float32Array(x*x*4);_.set(y.boneMatrices);var S=new Be(_,x,x,kt,Pt);S.needsUpdate=!0,y.boneMatrices=_,y.boneTexture=S,y.boneTextureSize=x}h.setValue(p,"boneTexture",y.boneTexture),h.setValue(p,"boneTextureSize",y.boneTextureSize)}else h.setOptional(p,y,"boneMatrices")}}return u&&(h.setValue(p,"toneMappingExposure",I.toneMappingExposure),h.setValue(p,"toneMappingWhitePoint",I.toneMappingWhitePoint),r.lights&&Gt(f,l),e&&r.fog&&Dt(f,e),r.isMeshBasicMaterial?Rt(f,r):r.isMeshLambertMaterial?(Rt(f,r),Nt(f,r)):r.isMeshPhongMaterial?(Rt(f,r),r.isMeshToonMaterial?Vt(f,r):Ft(f,r)):r.isMeshStandardMaterial?(Rt(f,r),r.isMeshPhysicalMaterial?Ut(f,r):zt(f,r)):r.isMeshDepthMaterial?(Rt(f,r),jt(f,r)):r.isMeshDistanceMaterial?(Rt(f,r),Bt(f,r)):r.isMeshNormalMaterial?(Rt(f,r),Ht(f,r)):r.isLineBasicMaterial?(Lt(f,r),r.isLineDashedMaterial&&Ot(f,r)):r.isPointsMaterial?It(f,r):r.isShadowMaterial&&(f.color.value=r.color,f.opacity.value=r.opacity),void 0!==f.ltc_1&&(f.ltc_1.value=ni.LTC_1),void 0!==f.ltc_2&&(f.ltc_2.value=ni.LTC_2),Uo.upload(p,i.uniformsList,f,I)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(Uo.upload(p,i.uniformsList,f,I),r.uniformsNeedUpdate=!1),h.setValue(p,"modelViewMatrix",n.modelViewMatrix),h.setValue(p,"normalMatrix",n.normalMatrix),h.setValue(p,"modelMatrix",n.matrixWorld),c}function Rt(t,e){var r;t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=w.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?r=e.map:e.specularMap?r=e.specularMap:e.displacementMap?r=e.displacementMap:e.normalMap?r=e.normalMap:e.bumpMap?r=e.bumpMap:e.roughnessMap?r=e.roughnessMap:e.metalnessMap?r=e.metalnessMap:e.alphaMap?r=e.alphaMap:e.emissiveMap&&(r=e.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix))}function Lt(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function Ot(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function It(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*$,t.scale.value=.5*W,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}function Dt(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function Nt(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function Ft(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Vt(t,e){Ft(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function zt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function Ut(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,zt(t,e)}function jt(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Bt(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}function Ht(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function Gt(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function qt(){var t=G;return t>=m.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+m.maxTextures),G+=1,t}this.animate=function(t){vt=t,null!==vt?yt():wt()},this.render=function(t,e,r,n){if(e&&e.isCamera){if(!D){V="",F=-1,z=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),at.enabled&&(e=at.getCamera(e)),d=T.get(t,e),d.init(),t.onBeforeRender(I,t,e,r),rt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),J.setFromMatrix(rt),tt=this.localClippingEnabled,K=Q.init(this.clippingPlanes,tt,e),h=E.get(t,e),h.init(),St(t,e,I.sortObjects),!0===I.sortObjects&&h.sort(),K&&Q.beginShadows();var i=d.state.shadowsArray;ut.render(i,t,e),d.setupLights(e),K&&Q.endShadows(),this.info.autoReset&&this.info.reset(),void 0===r&&(r=null),this.setRenderTarget(r),A.render(h,t,e,n);var o=h.opaque,s=h.transparent;if(t.overrideMaterial){var a=t.overrideMaterial;o.length&&Mt(o,t,e,a),s.length&&Mt(s,t,e,a)}else o.length&&Mt(o,t,e),s.length&&Mt(s,t,e);var u=d.state.spritesArray;L.render(u,t,e),r&&b.updateRenderTargetMipmap(r),g.buffers.depth.setTest(!0),g.buffers.depth.setMask(!0),g.buffers.color.setMask(!0),g.setPolygonOffset(!1),t.onAfterRender(I,t,e),at.enabled&&at.submitFrame(),h=null,d=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=qt,this.setTexture2D=function(){var t=!1;return function(e,r){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),b.setTexture2D(e,r)}}(),this.setTexture=function(){var t=!1;return function(e,r){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),b.setTexture2D(e,r)}}(),this.setTextureCube=function(){var t=!1;return function(e,r){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?b.setTextureCube(e,r):b.setTextureCubeDynamic(e,r)}}(),this.getRenderTarget=function(){return N},this.setRenderTarget=function(t){N=t,t&&void 0===w.get(t).__webglFramebuffer&&b.setupRenderTarget(t);var e=null,r=!1;if(t){var n=w.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=n[t.activeCubeFace],r=!0):e=n,j.copy(t.viewport),B.copy(t.scissor),H=t.scissorTest}else j.copy(X).multiplyScalar($),B.copy(Y).multiplyScalar($),H=Z;if(k!==e&&(p.bindFramebuffer(p.FRAMEBUFFER,e),k=e),g.viewport(j),g.scissor(B),g.setScissorTest(H),r){var i=w.get(t.texture);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,r,n,i,o){if(t&&t.isWebGLRenderTarget){var s=w.get(t).__webglFramebuffer;if(s){var a=!1;s!==k&&(p.bindFramebuffer(p.FRAMEBUFFER,s),a=!0);try{var u=t.texture,l=u.format,c=u.type;if(l!==kt&&O.convert(l)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(c!==_t&&O.convert(c)!==p.getParameter(p.IMPLEMENTATION_COLOR_READ_TYPE)&&(c!==Pt||!f.get("OES_texture_float")&&!f.get("WEBGL_color_buffer_float"))&&(c!==Ct||!f.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");p.checkFramebufferStatus(p.FRAMEBUFFER)===p.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&r>=0&&r<=t.height-i&&p.readPixels(e,r,n,i,O.convert(l),O.convert(c),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{a&&p.bindFramebuffer(p.FRAMEBUFFER,k)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,r){var n=e.image.width,i=e.image.height,o=O.convert(e.format);this.setTexture2D(e,0),p.copyTexImage2D(p.TEXTURE_2D,r||0,o,t.x,t.y,n,i,0)},this.copyTextureToTexture=function(t,e,r,n){var i=e.image.width,o=e.image.height,s=O.convert(r.format),a=O.convert(r.type),u=e.isDataTexture?e.image.data:e.image;this.setTexture2D(r,0),p.texSubImage2D(p.TEXTURE_2D,n||0,t.x,t.y,i,o,s,a,u)}}function Ts(t,e){this.name="",this.color=new ri(t),this.density=void 0!==e?e:25e-5}function As(t,e,r){this.name="",this.color=new ri(t),this.near=void 0!==e?e:1,this.far=void 0!==r?r:1e3}function Ps(){li.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Cs(t){Di.call(this),this.type="SpriteMaterial",this.color=new ri(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Rs(t){li.call(this),this.type="Sprite",this.material=void 0!==t?t:new Cs,this.center=new Oe(.5,.5)}function Ls(){li.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Os(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var r=0,n=this.bones.length;r<n;r++)this.boneInverses.push(new Ie)}}function Is(){li.call(this),this.type="Bone"}function Ds(t,e){Ui.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ie,this.bindMatrixInverse=new Ie;var r=this.initBones(),n=new Os(r);this.bind(n,this.matrixWorld),this.normalizeSkinWeights()}function Ns(t){Di.call(this),this.type="LineBasicMaterial",this.color=new ri(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function ks(t,e,r){if(1===r)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Fs(t,e);li.call(this),this.type="Line",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new Ns({color:16777215*Math.random()})}function Fs(t,e){ks.call(this,t,e),this.type="LineSegments"}function Vs(t,e){ks.call(this,t,e),this.type="LineLoop"}function zs(t){Di.call(this),this.type="PointsMaterial",this.color=new ri(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Us(t,e){li.call(this),this.type="Points",this.geometry=void 0!==t?t:new Pi,this.material=void 0!==e?e:new zs({color:16777215*Math.random()})}function js(){li.call(this),this.type="Group"}function Bs(t,e,r,n,i,o,s,a,u){Ve.call(this,t,e,r,n,i,o,s,a,u),this.generateMipmaps=!1}function Hs(t,e,r,n,i,o,s,a,u,l,c,h){Ve.call(this,null,o,s,a,u,l,n,i,c,h),this.image={width:e,height:r},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Gs(t,e,r,n,i,o,s,a,u,l){if(l=void 0!==l?l:zt,l!==zt&&l!==Ut)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===r&&l===zt&&(r=Et),void 0===r&&l===Ut&&(r=It),Ve.call(this,null,n,i,o,s,a,l,r,u),this.image={width:t,height:e},this.magFilter=void 0!==s?s:gt,this.minFilter=void 0!==a?a:gt,this.flipY=!1,this.generateMipmaps=!1}function qs(t){Pi.call(this),this.type="WireframeGeometry";var e,r,n,i,o,s,a,u,l,c,h=[],d=[0,0],p={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,n=m.length;e<n;e++){var g=m[e];for(r=0;r<3;r++)a=g[f[r]],u=g[f[(r+1)%3]],d[0]=Math.min(a,u),d[1]=Math.max(a,u),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)s=p[l],c=t.vertices[s.index1],h.push(c.x,c.y,c.z),c=t.vertices[s.index2],h.push(c.x,c.y,c.z)}else if(t&&t.isBufferGeometry){var v,y,w,b,x,_,S,M;if(c=new Ne,null!==t.index){for(v=t.attributes.position,y=t.index,w=t.groups,0===w.length&&(w=[{start:0,count:y.count,materialIndex:0}]),i=0,o=w.length;i<o;++i)for(b=w[i],x=b.start,_=b.count,e=x,n=x+_;e<n;e+=3)for(r=0;r<3;r++)a=y.getX(e+r),u=y.getX(e+(r+1)%3),d[0]=Math.min(a,u),d[1]=Math.max(a,u),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)s=p[l],c.fromBufferAttribute(v,s.index1),h.push(c.x,c.y,c.z),c.fromBufferAttribute(v,s.index2),h.push(c.x,c.y,c.z)}else for(v=t.attributes.position,e=0,n=v.count/3;e<n;e++)for(r=0;r<3;r++)S=3*e+r,c.fromBufferAttribute(v,S),h.push(c.x,c.y,c.z),M=3*e+(r+1)%3,c.fromBufferAttribute(v,M),h.push(c.x,c.y,c.z)}this.addAttribute("position",new Si(h,3))}function Ws(t,e,r){fi.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:r},this.fromBufferGeometry(new $s(t,e,r)),this.mergeVertices()}function $s(t,e,r){Pi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:r};var n,i,o=[],s=[],a=[],u=[],l=1e-5,c=new Ne,h=new Ne,d=new Ne,p=new Ne,f=new Ne,m=e+1;for(n=0;n<=r;n++){var g=n/r;for(i=0;i<=e;i++){var v=i/e;t(v,g,h),s.push(h.x,h.y,h.z),v-l>=0?(t(v-l,g,d),p.subVectors(h,d)):(t(v+l,g,d),p.subVectors(d,h)),g-l>=0?(t(v,g-l,d),f.subVectors(h,d)):(t(v,g+l,d),f.subVectors(d,h)),c.crossVectors(p,f).normalize(),a.push(c.x,c.y,c.z),u.push(v,g)}}for(n=0;n<r;n++)for(i=0;i<e;i++){var y=n*m+i,w=n*m+i+1,b=(n+1)*m+i+1,x=(n+1)*m+i;o.push(y,w,x),o.push(w,b,x)}this.setIndex(o),this.addAttribute("position",new Si(s,3)),this.addAttribute("normal",new Si(a,3)),this.addAttribute("uv",new Si(u,2))}function Xs(t,e,r,n){fi.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},this.fromBufferGeometry(new Ys(t,e,r,n)),this.mergeVertices()}function Ys(t,e,r,n){Pi.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:r,detail:n},r=r||1,n=n||0;var i=[],o=[];function s(t){for(var r=new Ne,n=new Ne,i=new Ne,o=0;o<e.length;o+=3)d(e[o+0],r),d(e[o+1],n),d(e[o+2],i),a(r,n,i,t)}function a(t,e,r,n){var i,o,s=Math.pow(2,n),a=[];for(i=0;i<=s;i++){a[i]=[];var u=t.clone().lerp(r,i/s),l=e.clone().lerp(r,i/s),c=s-i;for(o=0;o<=c;o++)a[i][o]=0===o&&i===s?u:u.clone().lerp(l,o/c)}for(i=0;i<s;i++)for(o=0;o<2*(s-i)-1;o++){var d=Math.floor(o/2);o%2===0?(h(a[i][d+1]),h(a[i+1][d]),h(a[i][d])):(h(a[i][d+1]),h(a[i+1][d+1]),h(a[i+1][d]))}}function u(t){for(var e=new Ne,r=0;r<i.length;r+=3)e.x=i[r+0],e.y=i[r+1],e.z=i[r+2],e.normalize().multiplyScalar(t),i[r+0]=e.x,i[r+1]=e.y,i[r+2]=e.z}function l(){for(var t=new Ne,e=0;e<i.length;e+=3){t.x=i[e+0],t.y=i[e+1],t.z=i[e+2];var r=m(t)/2/Math.PI+.5,n=g(t)/Math.PI+.5;o.push(r,1-n)}p(),c()}function c(){for(var t=0;t<o.length;t+=6){var e=o[t+0],r=o[t+2],n=o[t+4],i=Math.max(e,r,n),s=Math.min(e,r,n);i>.9&&s<.1&&(e<.2&&(o[t+0]+=1),r<.2&&(o[t+2]+=1),n<.2&&(o[t+4]+=1))}}function h(t){i.push(t.x,t.y,t.z)}function d(e,r){var n=3*e;r.x=t[n+0],r.y=t[n+1],r.z=t[n+2]}function p(){for(var t=new Ne,e=new Ne,r=new Ne,n=new Ne,s=new Oe,a=new Oe,u=new Oe,l=0,c=0;l<i.length;l+=9,c+=6){t.set(i[l+0],i[l+1],i[l+2]),e.set(i[l+3],i[l+4],i[l+5]),r.set(i[l+6],i[l+7],i[l+8]),s.set(o[c+0],o[c+1]),a.set(o[c+2],o[c+3]),u.set(o[c+4],o[c+5]),n.copy(t).add(e).add(r).divideScalar(3);var h=m(n);f(s,c+0,t,h),f(a,c+2,e,h),f(u,c+4,r,h)}}function f(t,e,r,n){n<0&&1===t.x&&(o[e]=t.x-1),0===r.x&&0===r.z&&(o[e]=n/2/Math.PI+.5)}function m(t){return Math.atan2(t.z,-t.x)}function g(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}s(n),u(r),l(),this.addAttribute("position",new Si(i,3)),this.addAttribute("normal",new Si(i.slice(),3)),this.addAttribute("uv",new Si(o,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function Zs(t,e){fi.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Js(t,e)),this.mergeVertices()}function Js(t,e){var r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],n=[2,1,0,0,3,2,1,3,0,2,3,1];Ys.call(this,r,n,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Qs(t,e){fi.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ks(t,e)),this.mergeVertices()}function Ks(t,e){var r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],n=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Ys.call(this,r,n,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ta(t,e){fi.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new ea(t,e)),this.mergeVertices()}function ea(t,e){var r=(1+Math.sqrt(5))/2,n=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Ys.call(this,n,i,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ra(t,e){fi.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new na(t,e)),this.mergeVertices()}function na(t,e){var r=(1+Math.sqrt(5))/2,n=1/r,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-r,0,-n,r,0,n,-r,0,n,r,-n,-r,0,-n,r,0,n,-r,0,n,r,0,-r,0,-n,r,0,-n,-r,0,n,r,0,n],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Ys.call(this,i,o,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function ia(t,e,r,n,i,o){fi.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var s=new oa(t,e,r,n,i);this.tangents=s.tangents,this.normals=s.normals,this.binormals=s.binormals,this.fromBufferGeometry(s),this.mergeVertices()}function oa(t,e,r,n,i){Pi.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:r,radialSegments:n,closed:i},e=e||64,r=r||1,n=n||8,i=i||!1;var o=t.computeFrenetFrames(e,i);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;var s,a,u=new Ne,l=new Ne,c=new Oe,h=new Ne,d=[],p=[],f=[],m=[];function g(){for(s=0;s<e;s++)v(s);v(!1===i?e:0),w(),y()}function v(i){h=t.getPointAt(i/e,h);var s=o.normals[i],c=o.binormals[i];for(a=0;a<=n;a++){var f=a/n*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);l.x=g*s.x+m*c.x,l.y=g*s.y+m*c.y,l.z=g*s.z+m*c.z,l.normalize(),p.push(l.x,l.y,l.z),u.x=h.x+r*l.x,u.y=h.y+r*l.y,u.z=h.z+r*l.z,d.push(u.x,u.y,u.z)}}function y(){for(a=1;a<=e;a++)for(s=1;s<=n;s++){var t=(n+1)*(a-1)+(s-1),r=(n+1)*a+(s-1),i=(n+1)*a+s,o=(n+1)*(a-1)+s;m.push(t,r,o),m.push(r,i,o)}}function w(){for(s=0;s<=e;s++)for(a=0;a<=n;a++)c.x=s/e,c.y=a/n,f.push(c.x,c.y)}g(),this.setIndex(m),this.addAttribute("position",new Si(d,3)),this.addAttribute("normal",new Si(p,3)),this.addAttribute("uv",new Si(f,2))}function sa(t,e,r,n,i,o,s){fi.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:o},void 0!==s&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new aa(t,e,r,n,i,o)),this.mergeVertices()}function aa(t,e,r,n,i,o){Pi.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:r,radialSegments:n,p:i,q:o},t=t||1,e=e||.4,r=Math.floor(r)||64,n=Math.floor(n)||8,i=i||2,o=o||3;var s,a,u=[],l=[],c=[],h=[],d=new Ne,p=new Ne,f=new Ne,m=new Ne,g=new Ne,v=new Ne,y=new Ne;for(s=0;s<=r;++s){var w=s/r*i*Math.PI*2;for(A(w,i,o,t,f),A(w+.01,i,o,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),a=0;a<=n;++a){var b=a/n*Math.PI*2,x=-e*Math.cos(b),_=e*Math.sin(b);d.x=f.x+(x*y.x+_*g.x),d.y=f.y+(x*y.y+_*g.y),d.z=f.z+(x*y.z+_*g.z),l.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),c.push(p.x,p.y,p.z),h.push(s/r),h.push(a/n)}}for(a=1;a<=r;a++)for(s=1;s<=n;s++){var S=(n+1)*(a-1)+(s-1),M=(n+1)*a+(s-1),E=(n+1)*a+s,T=(n+1)*(a-1)+s;u.push(S,M,T),u.push(M,E,T)}function A(t,e,r,n,i){var o=Math.cos(t),s=Math.sin(t),a=r/e*t,u=Math.cos(a);i.x=n*(2+u)*.5*o,i.y=n*(2+u)*s*.5,i.z=n*Math.sin(a)*.5}this.setIndex(u),this.addAttribute("position",new Si(l,3)),this.addAttribute("normal",new Si(c,3)),this.addAttribute("uv",new Si(h,2))}function ua(t,e,r,n,i){fi.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},this.fromBufferGeometry(new la(t,e,r,n,i)),this.mergeVertices()}function la(t,e,r,n,i){Pi.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:r,tubularSegments:n,arc:i},t=t||1,e=e||.4,r=Math.floor(r)||8,n=Math.floor(n)||6,i=i||2*Math.PI;var o,s,a=[],u=[],l=[],c=[],h=new Ne,d=new Ne,p=new Ne;for(o=0;o<=r;o++)for(s=0;s<=n;s++){var f=s/n*i,m=o/r*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(f),d.y=(t+e*Math.cos(m))*Math.sin(f),d.z=e*Math.sin(m),u.push(d.x,d.y,d.z),h.x=t*Math.cos(f),h.y=t*Math.sin(f),p.subVectors(d,h).normalize(),l.push(p.x,p.y,p.z),c.push(s/n),c.push(o/r)}for(o=1;o<=r;o++)for(s=1;s<=n;s++){var g=(n+1)*o+s-1,v=(n+1)*(o-1)+s-1,y=(n+1)*(o-1)+s,w=(n+1)*o+s;a.push(g,v,w),a.push(v,y,w)}this.setIndex(a),this.addAttribute("position",new Si(u,3)),this.addAttribute("normal",new Si(l,3)),this.addAttribute("uv",new Si(c,2))}fs.prototype=Object.create(Di.prototype),fs.prototype.constructor=fs,fs.prototype.isMeshDepthMaterial=!0,fs.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},ms.prototype=Object.create(Di.prototype),ms.prototype.constructor=ms,ms.prototype.isMeshDistanceMaterial=!0,ms.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},vs.prototype=Object.create(Ve.prototype),vs.prototype.constructor=vs,_s.prototype=Object.assign(Object.create(ci.prototype),{constructor:_s,isPerspectiveCamera:!0,copy:function(t,e){return ci.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Le.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Le.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Le.RAD2DEG*Math.atan(Math.tan(.5*Le.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,r,n,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=r,this.view.offsetY=n,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Le.DEG2RAD*this.fov)/this.zoom,r=2*e,n=this.aspect*r,i=-.5*n,o=this.view;if(null!==this.view&&this.view.enabled){var s=o.fullWidth,a=o.fullHeight;i+=o.offsetX*n/s,e-=o.offsetY*r/a,n*=o.width/s,r*=o.height/a}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+n,e,e-r,t,this.far)},toJSON:function(t){var e=li.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Ss.prototype=Object.assign(Object.create(_s.prototype),{constructor:Ss,isArrayCamera:!0}),Ts.prototype.isFogExp2=!0,Ts.prototype.clone=function(){return new Ts(this.color.getHex(),this.density)},Ts.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},As.prototype.isFog=!0,As.prototype.clone=function(){return new As(this.color.getHex(),this.near,this.far)},As.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Ps.prototype=Object.assign(Object.create(li.prototype),{constructor:Ps,copy:function(t,e){return li.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=li.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),Cs.prototype=Object.create(Di.prototype),Cs.prototype.constructor=Cs,Cs.prototype.isSpriteMaterial=!0,Cs.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Rs.prototype=Object.assign(Object.create(li.prototype),{constructor:Rs,isSprite:!0,raycast:function(){var t=new Ne,e=new Ne,r=new Ne;return function(n,i){e.setFromMatrixPosition(this.matrixWorld),n.ray.closestPointToPoint(e,t),r.setFromMatrixScale(this.matrixWorld);var o=r.x*r.y/4;if(!(e.distanceToSquared(t)>o)){var s=n.ray.origin.distanceTo(t);s<n.near||s>n.far||i.push({distance:s,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return li.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),Ls.prototype=Object.assign(Object.create(li.prototype),{constructor:Ls,copy:function(t){li.prototype.copy.call(this,t,!1);for(var e=t.levels,r=0,n=e.length;r<n;r++){var i=e[r];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var r=this.levels,n=0;n<r.length;n++)if(e<r[n].distance)break;r.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,r=1,n=e.length;r<n;r++)if(t<e[r].distance)break;return e[r-1].object},raycast:function(){var t=new Ne;return function(e,r){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,r)}}(),update:function(){var t=new Ne,e=new Ne;return function(r){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(r.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);n[0].object.visible=!0;for(var o=1,s=n.length;o<s;o++){if(!(i>=n[o].distance))break;n[o-1].object.visible=!1,n[o].object.visible=!0}for(;o<s;o++)n[o].object.visible=!1}}}(),toJSON:function(t){var e=li.prototype.toJSON.call(this,t);e.object.levels=[];for(var r=this.levels,n=0,i=r.length;n<i;n++){var o=r[n];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(Os.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var r=new Ie;this.bones[t]&&r.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(r)}},pose:function(){var t,e,r;for(e=0,r=this.bones.length;e<r;e++)t=this.bones[e],t&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,r=this.bones.length;e<r;e++)t=this.bones[e],t&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new Ie,e=new Ie;return function(){for(var r=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,s=0,a=r.length;s<a;s++){var u=r[s]?r[s].matrixWorld:e;t.multiplyMatrices(u,n[s]),t.toArray(i,16*s)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Os(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,r=this.bones.length;e<r;e++){var n=this.bones[e];if(n.name===t)return n}}}),Is.prototype=Object.assign(Object.create(li.prototype),{constructor:Is,isBone:!0}),Ds.prototype=Object.assign(Object.create(Ui.prototype),{constructor:Ds,isSkinnedMesh:!0,initBones:function(){var t,e,r,n,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(r=0,n=this.geometry.bones.length;r<n;r++)e=this.geometry.bones[r],t=new Is,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(r=0,n=this.geometry.bones.length;r<n;r++)e=this.geometry.bones[r],-1!==e.parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[r]):this.add(i[r])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var r=this.geometry.skinWeights[e];t=1/r.manhattanLength(),t!==1/0?r.multiplyScalar(t):r.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new ze,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)n.x=i.getX(e),n.y=i.getY(e),n.z=i.getZ(e),n.w=i.getW(e),t=1/n.manhattanLength(),t!==1/0?n.multiplyScalar(t):n.set(1,0,0,0),i.setXYZW(e,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){Ui.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ns.prototype=Object.create(Di.prototype),Ns.prototype.constructor=Ns,Ns.prototype.isLineBasicMaterial=!0,Ns.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},ks.prototype=Object.assign(Object.create(li.prototype),{constructor:ks,isLine:!0,computeLineDistances:function(){var t=new Ne,e=new Ne;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[0],o=1,s=n.count;o<s;o++)t.fromBufferAttribute(n,o-1),e.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=t.distanceTo(e);r.addAttribute("lineDistance",new Si(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var a=r.vertices;i=r.lineDistances;i[0]=0;for(o=1,s=a.length;o<s;o++)i[o]=i[o-1],i[o]+=a[o-1].distanceTo(a[o])}return this}}(),raycast:function(){var t=new Ie,e=new Fi,r=new Ge;return function(n,i){var o=n.linePrecision,s=o*o,a=this.geometry,u=this.matrixWorld;if(null===a.boundingSphere&&a.computeBoundingSphere(),r.copy(a.boundingSphere),r.applyMatrix4(u),!1!==n.ray.intersectsSphere(r)){t.getInverse(u),e.copy(n.ray).applyMatrix4(t);var l=new Ne,c=new Ne,h=new Ne,d=new Ne,p=this&&this.isLineSegments?2:1;if(a.isBufferGeometry){var f=a.index,m=a.attributes,g=m.position.array;if(null!==f)for(var v=f.array,y=0,w=v.length-1;y<w;y+=p){var b=v[y],x=v[y+1];l.fromArray(g,3*b),c.fromArray(g,3*x);var _=e.distanceSqToSegment(l,c,d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);var S=n.ray.origin.distanceTo(d);S<n.near||S>n.far||i.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}else for(y=0,w=g.length/3-1;y<w;y+=p){l.fromArray(g,3*y),c.fromArray(g,3*y+3);_=e.distanceSqToSegment(l,c,d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);S=n.ray.origin.distanceTo(d);S<n.near||S>n.far||i.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}else if(a.isGeometry){var M=a.vertices,E=M.length;for(y=0;y<E-1;y+=p){_=e.distanceSqToSegment(M[y],M[y+1],d,h);if(!(_>s)){d.applyMatrix4(this.matrixWorld);S=n.ray.origin.distanceTo(d);S<n.near||S>n.far||i.push({distance:S,point:h.clone().applyMatrix4(this.matrixWorld),index:y,face:null,faceIndex:null,object:this})}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Fs.prototype=Object.assign(Object.create(ks.prototype),{constructor:Fs,isLineSegments:!0,computeLineDistances:function(){var t=new Ne,e=new Ne;return function(){var r=this.geometry;if(r.isBufferGeometry)if(null===r.index){for(var n=r.attributes.position,i=[],o=0,s=n.count;o<s;o+=2)t.fromBufferAttribute(n,o),e.fromBufferAttribute(n,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);r.addAttribute("lineDistance",new Si(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){var a=r.vertices;for(i=r.lineDistances,o=0,s=a.length;o<s;o+=2)t.copy(a[o]),e.copy(a[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e)}return this}}()}),Vs.prototype=Object.assign(Object.create(ks.prototype),{constructor:Vs,isLineLoop:!0}),zs.prototype=Object.create(Di.prototype),zs.prototype.constructor=zs,zs.prototype.isPointsMaterial=!0,zs.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Us.prototype=Object.assign(Object.create(li.prototype),{constructor:Us,isPoints:!0,raycast:function(){var t=new Ie,e=new Fi,r=new Ge;return function(n,i){var o=this,s=this.geometry,a=this.matrixWorld,u=n.params.Points.threshold;if(null===s.boundingSphere&&s.computeBoundingSphere(),r.copy(s.boundingSphere),r.applyMatrix4(a),r.radius+=u,!1!==n.ray.intersectsSphere(r)){t.getInverse(a),e.copy(n.ray).applyMatrix4(t);var l=u/((this.scale.x+this.scale.y+this.scale.z)/3),c=l*l,h=new Ne,d=new Ne;if(s.isBufferGeometry){var p=s.index,f=s.attributes,m=f.position.array;if(null!==p)for(var g=p.array,v=0,y=g.length;v<y;v++){var w=g[v];h.fromArray(m,3*w),_(h,w)}else{v=0;for(var b=m.length/3;v<b;v++)h.fromArray(m,3*v),_(h,v)}}else{var x=s.vertices;for(v=0,b=x.length;v<b;v++)_(x[v],v)}}function _(t,r){var s=e.distanceSqToPoint(t);if(s<c){e.closestPointToPoint(t,d),d.applyMatrix4(a);var u=n.ray.origin.distanceTo(d);if(u<n.near||u>n.far)return;i.push({distance:u,distanceToRay:Math.sqrt(s),point:d.clone(),index:r,face:null,object:o})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),js.prototype=Object.assign(Object.create(li.prototype),{constructor:js,isGroup:!0}),Bs.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Bs,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Hs.prototype=Object.create(Ve.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isCompressedTexture=!0,Gs.prototype=Object.create(Ve.prototype),Gs.prototype.constructor=Gs,Gs.prototype.isDepthTexture=!0,qs.prototype=Object.create(Pi.prototype),qs.prototype.constructor=qs,Ws.prototype=Object.create(fi.prototype),Ws.prototype.constructor=Ws,$s.prototype=Object.create(Pi.prototype),$s.prototype.constructor=$s,Xs.prototype=Object.create(fi.prototype),Xs.prototype.constructor=Xs,Ys.prototype=Object.create(Pi.prototype),Ys.prototype.constructor=Ys,Zs.prototype=Object.create(fi.prototype),Zs.prototype.constructor=Zs,Js.prototype=Object.create(Ys.prototype),Js.prototype.constructor=Js,Qs.prototype=Object.create(fi.prototype),Qs.prototype.constructor=Qs,Ks.prototype=Object.create(Ys.prototype),Ks.prototype.constructor=Ks,ta.prototype=Object.create(fi.prototype),ta.prototype.constructor=ta,ea.prototype=Object.create(Ys.prototype),ea.prototype.constructor=ea,ra.prototype=Object.create(fi.prototype),ra.prototype.constructor=ra,na.prototype=Object.create(Ys.prototype),na.prototype.constructor=na,ia.prototype=Object.create(fi.prototype),ia.prototype.constructor=ia,oa.prototype=Object.create(Pi.prototype),oa.prototype.constructor=oa,sa.prototype=Object.create(fi.prototype),sa.prototype.constructor=sa,aa.prototype=Object.create(Pi.prototype),aa.prototype.constructor=aa,ua.prototype=Object.create(fi.prototype),ua.prototype.constructor=ua,la.prototype=Object.create(Pi.prototype),la.prototype.constructor=la;var ca={triangulate:function(t,e,r){r=r||2;var n,i,o,s,a,u,l,c=e&&e.length,h=c?e[0]*r:t.length,d=ha(t,0,h,r,!0),p=[];if(!d)return p;if(c&&(d=ya(t,e,d,r)),t.length>80*r){n=o=t[0],i=s=t[1];for(var f=r;f<h;f+=r)a=t[f],u=t[f+1],a<n&&(n=a),u<i&&(i=u),a>o&&(o=a),u>s&&(s=u);l=Math.max(o-n,s-i),l=0!==l?1/l:0}return pa(d,p,r,n,i,l),p}};function ha(t,e,r,n,i){var o,s;if(i===Va(t,e,r,n)>0)for(o=e;o<r;o+=n)s=Na(o,t[o],t[o+1],s);else for(o=r-n;o>=e;o-=n)s=Na(o,t[o],t[o+1],s);return s&&Ca(s,s.next)&&(ka(s),s=s.next),s}function da(t,e){if(!t)return t;e||(e=t);var r,n=t;do{if(r=!1,n.steiner||!Ca(n,n.next)&&0!==Pa(n.prev,n,n.next))n=n.next;else{if(ka(n),n=e=n.prev,n===n.next)break;r=!0}}while(r||n!==e);return e}function pa(t,e,r,n,i,o,s){if(t){!s&&o&&_a(t,n,i,o);var a,u,l=t;while(t.prev!==t.next)if(a=t.prev,u=t.next,o?ma(t,n,i,o):fa(t))e.push(a.i/r),e.push(t.i/r),e.push(u.i/r),ka(t),t=u.next,l=u.next;else if(t=u,t===l){s?1===s?(t=ga(t,e,r),pa(t,e,r,n,i,o,2)):2===s&&va(t,e,r,n,i,o):pa(da(t),e,r,n,i,o,1);break}}}function fa(t){var e=t.prev,r=t,n=t.next;if(Pa(e,r,n)>=0)return!1;var i=t.next.next;while(i!==t.prev){if(Ta(e.x,e.y,r.x,r.y,n.x,n.y,i.x,i.y)&&Pa(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function ma(t,e,r,n){var i=t.prev,o=t,s=t.next;if(Pa(i,o,s)>=0)return!1;var a=i.x<o.x?i.x<s.x?i.x:s.x:o.x<s.x?o.x:s.x,u=i.y<o.y?i.y<s.y?i.y:s.y:o.y<s.y?o.y:s.y,l=i.x>o.x?i.x>s.x?i.x:s.x:o.x>s.x?o.x:s.x,c=i.y>o.y?i.y>s.y?i.y:s.y:o.y>s.y?o.y:s.y,h=Ma(a,u,e,r,n),d=Ma(l,c,e,r,n),p=t.nextZ;while(p&&p.z<=d){if(p!==t.prev&&p!==t.next&&Ta(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Pa(p.prev,p,p.next)>=0)return!1;p=p.nextZ}p=t.prevZ;while(p&&p.z>=h){if(p!==t.prev&&p!==t.next&&Ta(i.x,i.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Pa(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function ga(t,e,r){var n=t;do{var i=n.prev,o=n.next.next;!Ca(i,o)&&Ra(i,n,n.next,o)&&Oa(i,o)&&Oa(o,i)&&(e.push(i.i/r),e.push(n.i/r),e.push(o.i/r),ka(n),ka(n.next),n=t=o),n=n.next}while(n!==t);return n}function va(t,e,r,n,i,o){var s=t;do{var a=s.next.next;while(a!==s.prev){if(s.i!==a.i&&Aa(s,a)){var u=Da(s,a);return s=da(s,s.next),u=da(u,u.next),pa(s,e,r,n,i,o),void pa(u,e,r,n,i,o)}a=a.next}s=s.next}while(s!==t)}function ya(t,e,r,n){var i,o,s,a,u,l=[];for(i=0,o=e.length;i<o;i++)s=e[i]*n,a=i<o-1?e[i+1]*n:t.length,u=ha(t,s,a,n,!1),u===u.next&&(u.steiner=!0),l.push(Ea(u));for(l.sort(wa),i=0;i<l.length;i++)ba(l[i],r),r=da(r,r.next);return r}function wa(t,e){return t.x-e.x}function ba(t,e){if(e=xa(t,e),e){var r=Da(e,t);da(r,r.next)}}function xa(t,e){var r,n=e,i=t.x,o=t.y,s=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var a=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=i&&a>s){if(s=a,a===i){if(o===n.y)return n;if(o===n.next.y)return n.next}r=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!r)return null;if(i===s)return r.prev;var u,l=r,c=r.x,h=r.y,d=1/0;n=r.next;while(n!==l)i>=n.x&&n.x>=c&&i!==n.x&&Ta(o<h?i:s,o,c,h,o<h?s:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),(u<d||u===d&&n.x>r.x)&&Oa(n,t)&&(r=n,d=u)),n=n.next;return r}function _a(t,e,r,n){var i=t;do{null===i.z&&(i.z=Ma(i.x,i.y,e,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Sa(i)}function Sa(t){var e,r,n,i,o,s,a,u,l=1;do{r=t,t=null,o=null,s=0;while(r){for(s++,n=r,a=0,e=0;e<l;e++)if(a++,n=n.nextZ,!n)break;u=l;while(a>0||u>0&&n)0!==a&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,a--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;r=n}o.nextZ=null,l*=2}while(s>1);return t}function Ma(t,e,r,n,i){return t=32767*(t-r)*i,e=32767*(e-n)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function Ea(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function Ta(t,e,r,n,i,o,s,a){return(i-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(n-a)-(r-s)*(e-a)>=0&&(r-s)*(o-a)-(i-s)*(n-a)>=0}function Aa(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!La(t,e)&&Oa(t,e)&&Oa(e,t)&&Ia(t,e)}function Pa(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function Ca(t,e){return t.x===e.x&&t.y===e.y}function Ra(t,e,r,n){return!!(Ca(t,e)&&Ca(r,n)||Ca(t,n)&&Ca(r,e))||Pa(t,e,r)>0!==Pa(t,e,n)>0&&Pa(r,n,t)>0!==Pa(r,n,e)>0}function La(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&Ra(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}function Oa(t,e){return Pa(t.prev,t,t.next)<0?Pa(t,e,t.next)>=0&&Pa(t,t.prev,e)>=0:Pa(t,e,t.prev)<0||Pa(t,t.next,e)<0}function Ia(t,e){var r=t,n=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!==r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==t);return n}function Da(t,e){var r=new Fa(t.i,t.x,t.y),n=new Fa(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Na(t,e,r,n){var i=new Fa(t,e,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function ka(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Fa(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Va(t,e,r,n){for(var i=0,o=e,s=r-n;o<r;o+=n)i+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return i}var za={area:function(t){for(var e=t.length,r=0,n=e-1,i=0;i<e;n=i++)r+=t[n].x*t[i].y-t[i].x*t[n].y;return.5*r},isClockWise:function(t){return za.area(t)<0},triangulateShape:function(t,e){var r=[],n=[],i=[];Ua(t),ja(r,t);var o=t.length;e.forEach(Ua);for(var s=0;s<e.length;s++)n.push(o),o+=e[s].length,ja(r,e[s]);var a=ca.triangulate(r,n);for(s=0;s<a.length;s+=3)i.push(a.slice(s,s+3));return i}};function Ua(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function ja(t,e){for(var r=0;r<e.length;r++)t.push(e[r].x),t.push(e[r].y)}function Ba(t,e){fi.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Ha(t,e)),this.mergeVertices()}function Ha(t,e){Pi.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var r=this,n=[],i=[],o=0,s=t.length;o<s;o++){var a=t[o];u(a,e)}function u(t){var o,s,a,u,l,c,h,d,p=[],f=void 0!==e.curveSegments?e.curveSegments:12,m=void 0!==e.steps?e.steps:1,g=void 0!==e.amount?e.amount:100,v=void 0===e.bevelEnabled||e.bevelEnabled,y=void 0!==e.bevelThickness?e.bevelThickness:6,w=void 0!==e.bevelSize?e.bevelSize:y-2,b=void 0!==e.bevelSegments?e.bevelSegments:3,x=e.extrudePath,_=void 0!==e.UVGenerator?e.UVGenerator:Ga,S=!1;x&&(o=x.getSpacedPoints(m),S=!0,v=!1,s=x.computeFrenetFrames(m,!1),a=new Ne,u=new Ne,l=new Ne),v||(b=0,y=0,w=0);var M=t.extractPoints(f),E=M.shape,T=M.holes,A=!za.isClockWise(E);if(A)for(E=E.reverse(),h=0,d=T.length;h<d;h++)c=T[h],za.isClockWise(c)&&(T[h]=c.reverse());var P=za.triangulateShape(E,T),C=E;for(h=0,d=T.length;h<d;h++)c=T[h],E=E.concat(c);function R(t,e,r){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(r).add(t)}var L,O,I,D,N,k,F=E.length,V=P.length;function z(t,e,r){var n,i,o,s=t.x-e.x,a=t.y-e.y,u=r.x-t.x,l=r.y-t.y,c=s*s+a*a,h=s*l-a*u;if(Math.abs(h)>Number.EPSILON){var d=Math.sqrt(c),p=Math.sqrt(u*u+l*l),f=e.x-a/d,m=e.y+s/d,g=r.x-l/p,v=r.y+u/p,y=((g-f)*l-(v-m)*u)/(s*l-a*u);n=f+s*y-t.x,i=m+a*y-t.y;var w=n*n+i*i;if(w<=2)return new Oe(n,i);o=Math.sqrt(w/2)}else{var b=!1;s>Number.EPSILON?u>Number.EPSILON&&(b=!0):s<-Number.EPSILON?u<-Number.EPSILON&&(b=!0):Math.sign(a)===Math.sign(l)&&(b=!0),b?(n=-a,i=s,o=Math.sqrt(c)):(n=s,i=a,o=Math.sqrt(c/2))}return new Oe(n/o,i/o)}for(var U=[],j=0,B=C.length,H=B-1,G=j+1;j<B;j++,H++,G++)H===B&&(H=0),G===B&&(G=0),U[j]=z(C[j],C[H],C[G]);var q,W,$=[],X=U.concat();for(h=0,d=T.length;h<d;h++){for(c=T[h],q=[],j=0,B=c.length,H=B-1,G=j+1;j<B;j++,H++,G++)H===B&&(H=0),G===B&&(G=0),q[j]=z(c[j],c[H],c[G]);$.push(q),X=X.concat(q)}for(L=0;L<b;L++){for(I=L/b,D=y*Math.cos(I*Math.PI/2),O=w*Math.sin(I*Math.PI/2),j=0,B=C.length;j<B;j++)N=R(C[j],U[j],O),Q(N.x,N.y,-D);for(h=0,d=T.length;h<d;h++)for(c=T[h],q=$[h],j=0,B=c.length;j<B;j++)N=R(c[j],q[j],O),Q(N.x,N.y,-D)}for(O=w,j=0;j<F;j++)N=v?R(E[j],X[j],O):E[j],S?(u.copy(s.normals[0]).multiplyScalar(N.x),a.copy(s.binormals[0]).multiplyScalar(N.y),l.copy(o[0]).add(u).add(a),Q(l.x,l.y,l.z)):Q(N.x,N.y,0);for(W=1;W<=m;W++)for(j=0;j<F;j++)N=v?R(E[j],X[j],O):E[j],S?(u.copy(s.normals[W]).multiplyScalar(N.x),a.copy(s.binormals[W]).multiplyScalar(N.y),l.copy(o[W]).add(u).add(a),Q(l.x,l.y,l.z)):Q(N.x,N.y,g/m*W);for(L=b-1;L>=0;L--){for(I=L/b,D=y*Math.cos(I*Math.PI/2),O=w*Math.sin(I*Math.PI/2),j=0,B=C.length;j<B;j++)N=R(C[j],U[j],O),Q(N.x,N.y,g+D);for(h=0,d=T.length;h<d;h++)for(c=T[h],q=$[h],j=0,B=c.length;j<B;j++)N=R(c[j],q[j],O),S?Q(N.x,N.y+o[m-1].y,o[m-1].x+D):Q(N.x,N.y,g+D)}function Y(){var t=n.length/3;if(v){var e=0,i=F*e;for(j=0;j<V;j++)k=P[j],K(k[2]+i,k[1]+i,k[0]+i);for(e=m+2*b,i=F*e,j=0;j<V;j++)k=P[j],K(k[0]+i,k[1]+i,k[2]+i)}else{for(j=0;j<V;j++)k=P[j],K(k[2],k[1],k[0]);for(j=0;j<V;j++)k=P[j],K(k[0]+F*m,k[1]+F*m,k[2]+F*m)}r.addGroup(t,n.length/3-t,0)}function Z(){var t=n.length/3,e=0;for(J(C,e),e+=C.length,h=0,d=T.length;h<d;h++)c=T[h],J(c,e),e+=c.length;r.addGroup(t,n.length/3-t,1)}function J(t,e){var r,n;j=t.length;while(--j>=0){r=j,n=j-1,n<0&&(n=t.length-1);var i=0,o=m+2*b;for(i=0;i<o;i++){var s=F*i,a=F*(i+1),u=e+r+s,l=e+n+s,c=e+n+a,h=e+r+a;tt(u,l,c,h)}}}function Q(t,e,r){p.push(t),p.push(e),p.push(r)}function K(t,e,i){et(t),et(e),et(i);var o=n.length/3,s=_.generateTopUV(r,n,o-3,o-2,o-1);rt(s[0]),rt(s[1]),rt(s[2])}function tt(t,e,i,o){et(t),et(e),et(o),et(e),et(i),et(o);var s=n.length/3,a=_.generateSideWallUV(r,n,s-6,s-3,s-2,s-1);rt(a[0]),rt(a[1]),rt(a[3]),rt(a[1]),rt(a[2]),rt(a[3])}function et(t){n.push(p[3*t+0]),n.push(p[3*t+1]),n.push(p[3*t+2])}function rt(t){i.push(t.x),i.push(t.y)}Y(),Z()}this.addAttribute("position",new Si(n,3)),this.addAttribute("uv",new Si(i,2)),this.computeVertexNormals()}Ba.prototype=Object.create(fi.prototype),Ba.prototype.constructor=Ba,Ha.prototype=Object.create(Pi.prototype),Ha.prototype.constructor=Ha;var Ga={generateTopUV:function(t,e,r,n,i){var o=e[3*r],s=e[3*r+1],a=e[3*n],u=e[3*n+1],l=e[3*i],c=e[3*i+1];return[new Oe(o,s),new Oe(a,u),new Oe(l,c)]},generateSideWallUV:function(t,e,r,n,i,o){var s=e[3*r],a=e[3*r+1],u=e[3*r+2],l=e[3*n],c=e[3*n+1],h=e[3*n+2],d=e[3*i],p=e[3*i+1],f=e[3*i+2],m=e[3*o],g=e[3*o+1],v=e[3*o+2];return Math.abs(a-c)<.01?[new Oe(s,1-u),new Oe(l,1-h),new Oe(d,1-f),new Oe(m,1-v)]:[new Oe(a,1-u),new Oe(c,1-h),new Oe(p,1-f),new Oe(g,1-v)]}};function qa(t,e){fi.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new Wa(t,e)),this.mergeVertices()}function Wa(t,e){e=e||{};var r=e.font;if(!r||!r.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new fi;var n=r.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Ha.call(this,n,e),this.type="TextBufferGeometry"}function $a(t,e,r,n,i,o,s){fi.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Xa(t,e,r,n,i,o,s)),this.mergeVertices()}function Xa(t,e,r,n,i,o,s){Pi.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:r,phiStart:n,phiLength:i,thetaStart:o,thetaLength:s},t=t||1,e=Math.max(3,Math.floor(e)||8),r=Math.max(2,Math.floor(r)||6),n=void 0!==n?n:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,s=void 0!==s?s:Math.PI;var a,u,l=o+s,c=0,h=[],d=new Ne,p=new Ne,f=[],m=[],g=[],v=[];for(u=0;u<=r;u++){var y=[],w=u/r;for(a=0;a<=e;a++){var b=a/e;d.x=-t*Math.cos(n+b*i)*Math.sin(o+w*s),d.y=t*Math.cos(o+w*s),d.z=t*Math.sin(n+b*i)*Math.sin(o+w*s),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(b,1-w),y.push(c++)}h.push(y)}for(u=0;u<r;u++)for(a=0;a<e;a++){var x=h[u][a+1],_=h[u][a],S=h[u+1][a],M=h[u+1][a+1];(0!==u||o>0)&&f.push(x,_,M),(u!==r-1||l<Math.PI)&&f.push(_,S,M)}this.setIndex(f),this.addAttribute("position",new Si(m,3)),this.addAttribute("normal",new Si(g,3)),this.addAttribute("uv",new Si(v,2))}function Ya(t,e,r,n,i,o){fi.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Za(t,e,r,n,i,o)),this.mergeVertices()}function Za(t,e,r,n,i,o){Pi.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:r,phiSegments:n,thetaStart:i,thetaLength:o},t=t||.5,e=e||1,i=void 0!==i?i:0,o=void 0!==o?o:2*Math.PI,r=void 0!==r?Math.max(3,r):8,n=void 0!==n?Math.max(1,n):1;var s,a,u,l=[],c=[],h=[],d=[],p=t,f=(e-t)/n,m=new Ne,g=new Oe;for(a=0;a<=n;a++){for(u=0;u<=r;u++)s=i+u/r*o,m.x=p*Math.cos(s),m.y=p*Math.sin(s),c.push(m.x,m.y,m.z),h.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);p+=f}for(a=0;a<n;a++){var v=a*(r+1);for(u=0;u<r;u++){s=u+v;var y=s,w=s+r+1,b=s+r+2,x=s+1;l.push(y,w,x),l.push(w,b,x)}}this.setIndex(l),this.addAttribute("position",new Si(c,3)),this.addAttribute("normal",new Si(h,3)),this.addAttribute("uv",new Si(d,2))}function Ja(t,e,r,n){fi.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},this.fromBufferGeometry(new Qa(t,e,r,n)),this.mergeVertices()}function Qa(t,e,r,n){Pi.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:r,phiLength:n},e=Math.floor(e)||12,r=r||0,n=n||2*Math.PI,n=Le.clamp(n,0,2*Math.PI);var i,o,s,a=[],u=[],l=[],c=1/e,h=new Ne,d=new Oe;for(o=0;o<=e;o++){var p=r+o*c*n,f=Math.sin(p),m=Math.cos(p);for(s=0;s<=t.length-1;s++)h.x=t[s].x*f,h.y=t[s].y,h.z=t[s].x*m,u.push(h.x,h.y,h.z),d.x=o/e,d.y=s/(t.length-1),l.push(d.x,d.y)}for(o=0;o<e;o++)for(s=0;s<t.length-1;s++){i=s+o*t.length;var g=i,v=i+t.length,y=i+t.length+1,w=i+1;a.push(g,v,w),a.push(v,y,w)}if(this.setIndex(a),this.addAttribute("position",new Si(u,3)),this.addAttribute("uv",new Si(l,2)),this.computeVertexNormals(),n===2*Math.PI){var b=this.attributes.normal.array,x=new Ne,_=new Ne,S=new Ne;for(i=e*t.length*3,o=0,s=0;o<t.length;o++,s+=3)x.x=b[s+0],x.y=b[s+1],x.z=b[s+2],_.x=b[i+s+0],_.y=b[i+s+1],_.z=b[i+s+2],S.addVectors(x,_).normalize(),b[s+0]=b[i+s+0]=S.x,b[s+1]=b[i+s+1]=S.y,b[s+2]=b[i+s+2]=S.z}}function Ka(t,e){fi.call(this),this.type="ShapeGeometry","object"===typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new tu(t,e)),this.mergeVertices()}function tu(t,e){Pi.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],n=[],i=[],o=[],s=0,a=0;if(!1===Array.isArray(t))l(t);else for(var u=0;u<t.length;u++)l(t[u]),this.addGroup(s,a,u),s+=a,a=0;function l(t){var s,u,l,c=n.length/3,h=t.extractPoints(e),d=h.shape,p=h.holes;if(!1===za.isClockWise(d))for(d=d.reverse(),s=0,u=p.length;s<u;s++)l=p[s],!0===za.isClockWise(l)&&(p[s]=l.reverse());var f=za.triangulateShape(d,p);for(s=0,u=p.length;s<u;s++)l=p[s],d=d.concat(l);for(s=0,u=d.length;s<u;s++){var m=d[s];n.push(m.x,m.y,0),i.push(0,0,1),o.push(m.x,m.y)}for(s=0,u=f.length;s<u;s++){var g=f[s],v=g[0]+c,y=g[1]+c,w=g[2]+c;r.push(v,y,w),a+=3}}this.setIndex(r),this.addAttribute("position",new Si(n,3)),this.addAttribute("normal",new Si(i,3)),this.addAttribute("uv",new Si(o,2))}function eu(t,e){if(e.shapes=[],Array.isArray(t))for(var r=0,n=t.length;r<n;r++){var i=t[r];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function ru(t,e){Pi.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var r,n,i,o,s=[],a=Math.cos(Le.DEG2RAD*e),u=[0,0],l={},c=["a","b","c"];t.isBufferGeometry?(o=new fi,o.fromBufferGeometry(t)):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,d=o.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)r=m[c[g]],n=m[c[(g+1)%3]],u[0]=Math.min(r,n),u[1]=Math.max(r,n),i=u[0]+","+u[1],void 0===l[i]?l[i]={index1:u[0],index2:u[1],face1:p,face2:void 0}:l[i].face2=p;for(i in l){var v=l[i];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=a){var y=h[v.index1];s.push(y.x,y.y,y.z),y=h[v.index2],s.push(y.x,y.y,y.z)}}this.addAttribute("position",new Si(s,3))}function nu(t,e,r,n,i,o,s,a){fi.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a},this.fromBufferGeometry(new iu(t,e,r,n,i,o,s,a)),this.mergeVertices()}function iu(t,e,r,n,i,o,s,a){Pi.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:r,radialSegments:n,heightSegments:i,openEnded:o,thetaStart:s,thetaLength:a};var u=this;t=void 0!==t?t:1,e=void 0!==e?e:1,r=r||1,n=Math.floor(n)||8,i=Math.floor(i)||1,o=void 0!==o&&o,s=void 0!==s?s:0,a=void 0!==a?a:2*Math.PI;var l=[],c=[],h=[],d=[],p=0,f=[],m=r/2,g=0;function v(){var o,v,y=new Ne,w=new Ne,b=0,x=(e-t)/r;for(v=0;v<=i;v++){var _=[],S=v/i,M=S*(e-t)+t;for(o=0;o<=n;o++){var E=o/n,T=E*a+s,A=Math.sin(T),P=Math.cos(T);w.x=M*A,w.y=-S*r+m,w.z=M*P,c.push(w.x,w.y,w.z),y.set(A,x,P).normalize(),h.push(y.x,y.y,y.z),d.push(E,1-S),_.push(p++)}f.push(_)}for(o=0;o<n;o++)for(v=0;v<i;v++){var C=f[v][o],R=f[v+1][o],L=f[v+1][o+1],O=f[v][o+1];l.push(C,R,O),l.push(R,L,O),b+=6}u.addGroup(g,b,0),g+=b}function y(r){var i,o,f,v=new Oe,y=new Ne,w=0,b=!0===r?t:e,x=!0===r?1:-1;for(o=p,i=1;i<=n;i++)c.push(0,m*x,0),h.push(0,x,0),d.push(.5,.5),p++;for(f=p,i=0;i<=n;i++){var _=i/n,S=_*a+s,M=Math.cos(S),E=Math.sin(S);y.x=b*E,y.y=m*x,y.z=b*M,c.push(y.x,y.y,y.z),h.push(0,x,0),v.x=.5*M+.5,v.y=.5*E*x+.5,d.push(v.x,v.y),p++}for(i=0;i<n;i++){var T=o+i,A=f+i;!0===r?l.push(A,A+1,T):l.push(A+1,A,T),w+=3}u.addGroup(g,w,!0===r?1:2),g+=w}v(),!1===o&&(t>0&&y(!0),e>0&&y(!1)),this.setIndex(l),this.addAttribute("position",new Si(c,3)),this.addAttribute("normal",new Si(h,3)),this.addAttribute("uv",new Si(d,2))}function ou(t,e,r,n,i,o,s){nu.call(this,0,t,e,r,n,i,o,s),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:s}}function su(t,e,r,n,i,o,s){iu.call(this,0,t,e,r,n,i,o,s),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:r,heightSegments:n,openEnded:i,thetaStart:o,thetaLength:s}}function au(t,e,r,n){fi.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},this.fromBufferGeometry(new uu(t,e,r,n)),this.mergeVertices()}function uu(t,e,r,n){Pi.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:r,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,r=void 0!==r?r:0,n=void 0!==n?n:2*Math.PI;var i,o,s=[],a=[],u=[],l=[],c=new Ne,h=new Oe;for(a.push(0,0,0),u.push(0,0,1),l.push(.5,.5),o=0,i=3;o<=e;o++,i+=3){var d=r+o/e*n;c.x=t*Math.cos(d),c.y=t*Math.sin(d),a.push(c.x,c.y,c.z),u.push(0,0,1),h.x=(a[i]/t+1)/2,h.y=(a[i+1]/t+1)/2,l.push(h.x,h.y)}for(i=1;i<=e;i++)s.push(i,i+1,0);this.setIndex(s),this.addAttribute("position",new Si(a,3)),this.addAttribute("normal",new Si(u,3)),this.addAttribute("uv",new Si(l,2))}qa.prototype=Object.create(fi.prototype),qa.prototype.constructor=qa,Wa.prototype=Object.create(Ha.prototype),Wa.prototype.constructor=Wa,$a.prototype=Object.create(fi.prototype),$a.prototype.constructor=$a,Xa.prototype=Object.create(Pi.prototype),Xa.prototype.constructor=Xa,Ya.prototype=Object.create(fi.prototype),Ya.prototype.constructor=Ya,Za.prototype=Object.create(Pi.prototype),Za.prototype.constructor=Za,Ja.prototype=Object.create(fi.prototype),Ja.prototype.constructor=Ja,Qa.prototype=Object.create(Pi.prototype),Qa.prototype.constructor=Qa,Ka.prototype=Object.create(fi.prototype),Ka.prototype.constructor=Ka,Ka.prototype.toJSON=function(){var t=fi.prototype.toJSON.call(this),e=this.parameters.shapes;return eu(e,t)},tu.prototype=Object.create(Pi.prototype),tu.prototype.constructor=tu,tu.prototype.toJSON=function(){var t=Pi.prototype.toJSON.call(this),e=this.parameters.shapes;return eu(e,t)},ru.prototype=Object.create(Pi.prototype),ru.prototype.constructor=ru,nu.prototype=Object.create(fi.prototype),nu.prototype.constructor=nu,iu.prototype=Object.create(Pi.prototype),iu.prototype.constructor=iu,ou.prototype=Object.create(nu.prototype),ou.prototype.constructor=ou,su.prototype=Object.create(iu.prototype),su.prototype.constructor=su,au.prototype=Object.create(fi.prototype),au.prototype.constructor=au,uu.prototype=Object.create(Pi.prototype),uu.prototype.constructor=uu;var lu=Object.freeze({WireframeGeometry:qs,ParametricGeometry:Ws,ParametricBufferGeometry:$s,TetrahedronGeometry:Zs,TetrahedronBufferGeometry:Js,OctahedronGeometry:Qs,OctahedronBufferGeometry:Ks,IcosahedronGeometry:ta,IcosahedronBufferGeometry:ea,DodecahedronGeometry:ra,DodecahedronBufferGeometry:na,PolyhedronGeometry:Xs,PolyhedronBufferGeometry:Ys,TubeGeometry:ia,TubeBufferGeometry:oa,TorusKnotGeometry:sa,TorusKnotBufferGeometry:aa,TorusGeometry:ua,TorusBufferGeometry:la,TextGeometry:qa,TextBufferGeometry:Wa,SphereGeometry:$a,SphereBufferGeometry:Xa,RingGeometry:Ya,RingBufferGeometry:Za,PlaneGeometry:Li,PlaneBufferGeometry:Oi,LatheGeometry:Ja,LatheBufferGeometry:Qa,ShapeGeometry:Ka,ShapeBufferGeometry:tu,ExtrudeGeometry:Ba,ExtrudeBufferGeometry:Ha,EdgesGeometry:ru,ConeGeometry:ou,ConeBufferGeometry:su,CylinderGeometry:nu,CylinderBufferGeometry:iu,CircleGeometry:au,CircleBufferGeometry:uu,BoxGeometry:Ci,BoxBufferGeometry:Ri});function cu(t){Di.call(this),this.type="ShadowMaterial",this.color=new ri(0),this.transparent=!0,this.setValues(t)}function hu(t){ki.call(this,t),this.type="RawShaderMaterial"}function du(t){Di.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ri(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ri(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function pu(t){du.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function fu(t){Di.call(this),this.type="MeshPhongMaterial",this.color=new ri(16777215),this.specular=new ri(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ri(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function mu(t){fu.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function gu(t){Di.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Oe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function vu(t){Di.call(this),this.type="MeshLambertMaterial",this.color=new ri(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ri(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=J,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function yu(t){Ns.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}cu.prototype=Object.create(Di.prototype),cu.prototype.constructor=cu,cu.prototype.isShadowMaterial=!0,cu.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this},hu.prototype=Object.create(ki.prototype),hu.prototype.constructor=hu,hu.prototype.isRawShaderMaterial=!0,du.prototype=Object.create(Di.prototype),du.prototype.constructor=du,du.prototype.isMeshStandardMaterial=!0,du.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},pu.prototype=Object.create(du.prototype),pu.prototype.constructor=pu,pu.prototype.isMeshPhysicalMaterial=!0,pu.prototype.copy=function(t){return du.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},fu.prototype=Object.create(Di.prototype),fu.prototype.constructor=fu,fu.prototype.isMeshPhongMaterial=!0,fu.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},mu.prototype=Object.create(fu.prototype),mu.prototype.constructor=mu,mu.prototype.isMeshToonMaterial=!0,mu.prototype.copy=function(t){return fu.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},gu.prototype=Object.create(Di.prototype),gu.prototype.constructor=gu,gu.prototype.isMeshNormalMaterial=!0,gu.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},vu.prototype=Object.create(Di.prototype),vu.prototype.constructor=vu,vu.prototype.isMeshLambertMaterial=!0,vu.prototype.copy=function(t){return Di.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},yu.prototype=Object.create(Ns.prototype),yu.prototype.constructor=yu,yu.prototype.isLineDashedMaterial=!0,yu.prototype.copy=function(t){return Ns.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var wu=Object.freeze({ShadowMaterial:cu,SpriteMaterial:Cs,RawShaderMaterial:hu,ShaderMaterial:ki,PointsMaterial:zs,MeshPhysicalMaterial:pu,MeshStandardMaterial:du,MeshPhongMaterial:fu,MeshToonMaterial:mu,MeshNormalMaterial:gu,MeshLambertMaterial:vu,MeshDepthMaterial:fs,MeshDistanceMaterial:ms,MeshBasicMaterial:Ni,LineDashedMaterial:yu,LineBasicMaterial:Ns,Material:Di}),bu={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function xu(t,e,r){var n=this,i=!1,o=0,s=0,a=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=r,this.itemStart=function(t){s++,!1===i&&void 0!==n.onStart&&n.onStart(t,o,s),i=!0},this.itemEnd=function(t){o++,void 0!==n.onProgress&&n.onProgress(t,o,s),o===s&&(i=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return a?a(t):t},this.setURLModifier=function(t){return a=t,this}}var _u=new xu,Su={};function Mu(t){this.manager=void 0!==t?t:_u}function Eu(t){this.manager=void 0!==t?t:_u,this._parser=null}function Tu(t){this.manager=void 0!==t?t:_u,this._parser=null}function Au(t){this.manager=void 0!==t?t:_u}function Pu(t){this.manager=void 0!==t?t:_u}function Cu(t){this.manager=void 0!==t?t:_u}function Ru(){this.type="Curve",this.arcLengthDivisions=200}function Lu(t,e,r,n,i,o,s,a){Ru.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=r||1,this.yRadius=n||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=s||!1,this.aRotation=a||0}function Ou(t,e,r,n,i,o){Lu.call(this,t,e,r,r,n,i,o),this.type="ArcCurve"}function Iu(){var t=0,e=0,r=0,n=0;function i(i,o,s,a){t=i,e=s,r=-3*i+3*o-2*s-a,n=2*i-2*o+s+a}return{initCatmullRom:function(t,e,r,n,o){i(e,r,o*(r-t),o*(n-e))},initNonuniformCatmullRom:function(t,e,r,n,o,s,a){var u=(e-t)/o-(r-t)/(o+s)+(r-e)/s,l=(r-e)/s-(n-e)/(s+a)+(n-r)/a;u*=s,l*=s,i(e,r,u,l)},calc:function(i){var o=i*i,s=o*i;return t+e*i+r*o+n*s}}}Object.assign(Mu.prototype,{load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=bu.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;if(void 0===Su[t]){var s=/^data:(.*?)(;base64)?,(.*)$/,a=t.match(s);if(a){var u=a[1],l=!!a[2],c=a[3];c=window.decodeURIComponent(c),l&&(c=window.atob(c));try{var h,d=(this.responseType||"").toLowerCase();switch(d){case"arraybuffer":case"blob":for(var p=new Uint8Array(c.length),f=0;f<c.length;f++)p[f]=c.charCodeAt(f);h="blob"===d?new Blob([p.buffer],{type:u}):p.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(c,u);break;case"json":h=JSON.parse(c);break;default:h=c;break}window.setTimeout((function(){e&&e(h),i.manager.itemEnd(t)}),0)}catch(y){window.setTimeout((function(){n&&n(y),i.manager.itemEnd(t),i.manager.itemError(t)}),0)}}else{Su[t]=[],Su[t].push({onLoad:e,onProgress:r,onError:n});var g=new XMLHttpRequest;for(var v in g.open("GET",t,!0),g.addEventListener("load",(function(e){var r=this.response;bu.add(t,r);var n=Su[t];if(delete Su[t],200===this.status){for(var o=0,s=n.length;o<s;o++){var a=n[o];a.onLoad&&a.onLoad(r)}i.manager.itemEnd(t)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(o=0,s=n.length;o<s;o++){a=n[o];a.onLoad&&a.onLoad(r)}i.manager.itemEnd(t)}else{for(o=0,s=n.length;o<s;o++){a=n[o];a.onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}}),!1),g.addEventListener("progress",(function(e){for(var r=Su[t],n=0,i=r.length;n<i;n++){var o=r[n];o.onProgress&&o.onProgress(e)}}),!1),g.addEventListener("error",(function(e){var r=Su[t];delete Su[t];for(var n=0,o=r.length;n<o;n++){var s=r[n];s.onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}),!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)g.setRequestHeader(v,this.requestHeader[v]);g.send(null)}return i.manager.itemStart(t),g}Su[t].push({onLoad:e,onProgress:r,onError:n})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(Eu.prototype,{load:function(t,e,r,n){var i=this,o=[],s=new Hs;s.image=o;var a=new Mu(this.manager);function u(u){a.load(t[u],(function(t){var r=i._parser(t,!0);o[u]={width:r.width,height:r.height,format:r.format,mipmaps:r.mipmaps},l+=1,6===l&&(1===r.mipmapCount&&(s.minFilter=wt),s.format=r.format,s.needsUpdate=!0,e&&e(s))}),r,n)}if(a.setPath(this.path),a.setResponseType("arraybuffer"),Array.isArray(t))for(var l=0,c=0,h=t.length;c<h;++c)u(c);else a.load(t,(function(t){var r=i._parser(t,!0);if(r.isCubemap)for(var n=r.mipmaps.length/r.mipmapCount,a=0;a<n;a++){o[a]={mipmaps:[]};for(var u=0;u<r.mipmapCount;u++)o[a].mipmaps.push(r.mipmaps[a*r.mipmapCount+u]),o[a].format=r.format,o[a].width=r.width,o[a].height=r.height}else s.image.width=r.width,s.image.height=r.height,s.mipmaps=r.mipmaps;1===r.mipmapCount&&(s.minFilter=wt),s.format=r.format,s.needsUpdate=!0,e&&e(s)}),r,n);return s},setPath:function(t){return this.path=t,this}}),Object.assign(Tu.prototype,{load:function(t,e,r,n){var i=this,o=new Be,s=new Mu(this.manager);return s.setResponseType("arraybuffer"),s.load(t,(function(t){var r=i._parser(t);r&&(void 0!==r.image?o.image=r.image:void 0!==r.data&&(o.image.width=r.width,o.image.height=r.height,o.image.data=r.data),o.wrapS=void 0!==r.wrapS?r.wrapS:ft,o.wrapT=void 0!==r.wrapT?r.wrapT:ft,o.magFilter=void 0!==r.magFilter?r.magFilter:wt,o.minFilter=void 0!==r.minFilter?r.minFilter:xt,o.anisotropy=void 0!==r.anisotropy?r.anisotropy:1,void 0!==r.format&&(o.format=r.format),void 0!==r.type&&(o.type=r.type),void 0!==r.mipmaps&&(o.mipmaps=r.mipmaps),1===r.mipmapCount&&(o.minFilter=wt),o.needsUpdate=!0,e&&e(o,r))}),r,n),o}}),Object.assign(Au.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=bu.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;var s=document.createElementNS("http://www.w3.org/1999/xhtml","img");return s.addEventListener("load",(function(){bu.add(t,this),e&&e(this),i.manager.itemEnd(t)}),!1),s.addEventListener("error",(function(e){n&&n(e),i.manager.itemEnd(t),i.manager.itemError(t)}),!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),i.manager.itemStart(t),s.src=t,s},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Pu.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){var i=new Qi,o=new Au(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);var s=0;function a(r){o.load(t[r],(function(t){i.images[r]=t,s++,6===s&&(i.needsUpdate=!0,e&&e(i))}),void 0,n)}for(var u=0;u<t.length;++u)a(u);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Cu.prototype,{crossOrigin:"Anonymous",load:function(t,e,r,n){var i=new Ve,o=new Au(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,(function(r){i.image=r;var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=n?Nt:kt,i.needsUpdate=!0,void 0!==e&&e(i)}),r,n),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Ru.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var r=this.getUtoTmapping(t);return this.getPoint(r,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,r,n=[],i=this.getPoint(0),o=0;for(n.push(0),r=1;r<=t;r++)e=this.getPoint(r/t),o+=e.distanceTo(i),n.push(o),i=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var r,n=this.getLengths(),i=0,o=n.length;r=e||t*n[o-1];var s,a=0,u=o-1;while(a<=u)if(i=Math.floor(a+(u-a)/2),s=n[i]-r,s<0)a=i+1;else{if(!(s>0)){u=i;break}u=i-1}if(i=u,n[i]===r)return i/(o-1);var l=n[i],c=n[i+1],h=c-l,d=(r-l)/h,p=(i+d)/(o-1);return p},getTangent:function(t){var e=1e-4,r=t-e,n=t+e;r<0&&(r=0),n>1&&(n=1);var i=this.getPoint(r),o=this.getPoint(n),s=o.clone().sub(i);return s.normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var r,n,i,o=new Ne,s=[],a=[],u=[],l=new Ne,c=new Ie;for(r=0;r<=t;r++)n=r/t,s[r]=this.getTangentAt(n),s[r].normalize();a[0]=new Ne,u[0]=new Ne;var h=Number.MAX_VALUE,d=Math.abs(s[0].x),p=Math.abs(s[0].y),f=Math.abs(s[0].z);for(d<=h&&(h=d,o.set(1,0,0)),p<=h&&(h=p,o.set(0,1,0)),f<=h&&o.set(0,0,1),l.crossVectors(s[0],o).normalize(),a[0].crossVectors(s[0],l),u[0].crossVectors(s[0],a[0]),r=1;r<=t;r++)a[r]=a[r-1].clone(),u[r]=u[r-1].clone(),l.crossVectors(s[r-1],s[r]),l.length()>Number.EPSILON&&(l.normalize(),i=Math.acos(Le.clamp(s[r-1].dot(s[r]),-1,1)),a[r].applyMatrix4(c.makeRotationAxis(l,i))),u[r].crossVectors(s[r],a[r]);if(!0===e)for(i=Math.acos(Le.clamp(a[0].dot(a[t]),-1,1)),i/=t,s[0].dot(l.crossVectors(a[0],a[t]))>0&&(i=-i),r=1;r<=t;r++)a[r].applyMatrix4(c.makeRotationAxis(s[r],i*r)),u[r].crossVectors(s[r],a[r]);return{tangents:s,normals:a,binormals:u}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Lu.prototype=Object.create(Ru.prototype),Lu.prototype.constructor=Lu,Lu.prototype.isEllipseCurve=!0,Lu.prototype.getPoint=function(t,e){var r=e||new Oe,n=2*Math.PI,i=this.aEndAngle-this.aStartAngle,o=Math.abs(i)<Number.EPSILON;while(i<0)i+=n;while(i>n)i-=n;i<Number.EPSILON&&(i=o?0:n),!0!==this.aClockwise||o||(i===n?i=-n:i-=n);var s=this.aStartAngle+t*i,a=this.aX+this.xRadius*Math.cos(s),u=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var l=Math.cos(this.aRotation),c=Math.sin(this.aRotation),h=a-this.aX,d=u-this.aY;a=h*l-d*c+this.aX,u=h*c+d*l+this.aY}return r.set(a,u)},Lu.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Lu.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Lu.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ou.prototype=Object.create(Lu.prototype),Ou.prototype.constructor=Ou,Ou.prototype.isArcCurve=!0;var Du=new Ne,Nu=new Iu,ku=new Iu,Fu=new Iu;function Vu(t,e,r,n){Ru.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=r||"centripetal",this.tension=n||.5}function zu(t,e,r,n,i){var o=.5*(n-e),s=.5*(i-r),a=t*t,u=t*a;return(2*r-2*n+o+s)*u+(-3*r+3*n-2*o-s)*a+o*t+r}function Uu(t,e){var r=1-t;return r*r*e}function ju(t,e){return 2*(1-t)*t*e}function Bu(t,e){return t*t*e}function Hu(t,e,r,n){return Uu(t,e)+ju(t,r)+Bu(t,n)}function Gu(t,e){var r=1-t;return r*r*r*e}function qu(t,e){var r=1-t;return 3*r*r*t*e}function Wu(t,e){return 3*(1-t)*t*t*e}function $u(t,e){return t*t*t*e}function Xu(t,e,r,n,i){return Gu(t,e)+qu(t,r)+Wu(t,n)+$u(t,i)}function Yu(t,e,r,n){Ru.call(this),this.type="CubicBezierCurve",this.v0=t||new Oe,this.v1=e||new Oe,this.v2=r||new Oe,this.v3=n||new Oe}function Zu(t,e,r,n){Ru.call(this),this.type="CubicBezierCurve3",this.v0=t||new Ne,this.v1=e||new Ne,this.v2=r||new Ne,this.v3=n||new Ne}function Ju(t,e){Ru.call(this),this.type="LineCurve",this.v1=t||new Oe,this.v2=e||new Oe}function Qu(t,e){Ru.call(this),this.type="LineCurve3",this.v1=t||new Ne,this.v2=e||new Ne}function Ku(t,e,r){Ru.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Oe,this.v1=e||new Oe,this.v2=r||new Oe}function tl(t,e,r){Ru.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new Ne,this.v1=e||new Ne,this.v2=r||new Ne}function el(t){Ru.call(this),this.type="SplineCurve",this.points=t||[]}Vu.prototype=Object.create(Ru.prototype),Vu.prototype.constructor=Vu,Vu.prototype.isCatmullRomCurve3=!0,Vu.prototype.getPoint=function(t,e){var r,n,i,o,s=e||new Ne,a=this.points,u=a.length,l=(u-(this.closed?0:1))*t,c=Math.floor(l),h=l-c;if(this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/u)+1)*u:0===h&&c===u-1&&(c=u-2,h=1),this.closed||c>0?r=a[(c-1)%u]:(Du.subVectors(a[0],a[1]).add(a[0]),r=Du),n=a[c%u],i=a[(c+1)%u],this.closed||c+2<u?o=a[(c+2)%u]:(Du.subVectors(a[u-1],a[u-2]).add(a[u-1]),o=Du),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(r.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(i),d),m=Math.pow(i.distanceToSquared(o),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Nu.initNonuniformCatmullRom(r.x,n.x,i.x,o.x,p,f,m),ku.initNonuniformCatmullRom(r.y,n.y,i.y,o.y,p,f,m),Fu.initNonuniformCatmullRom(r.z,n.z,i.z,o.z,p,f,m)}else"catmullrom"===this.curveType&&(Nu.initCatmullRom(r.x,n.x,i.x,o.x,this.tension),ku.initCatmullRom(r.y,n.y,i.y,o.y,this.tension),Fu.initCatmullRom(r.z,n.z,i.z,o.z,this.tension));return s.set(Nu.calc(h),ku.calc(h),Fu.calc(h)),s},Vu.prototype.copy=function(t){Ru.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Vu.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Vu.prototype.fromJSON=function(t){Ru.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Ne).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Yu.prototype=Object.create(Ru.prototype),Yu.prototype.constructor=Yu,Yu.prototype.isCubicBezierCurve=!0,Yu.prototype.getPoint=function(t,e){var r=e||new Oe,n=this.v0,i=this.v1,o=this.v2,s=this.v3;return r.set(Xu(t,n.x,i.x,o.x,s.x),Xu(t,n.y,i.y,o.y,s.y)),r},Yu.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Yu.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Yu.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Zu.prototype=Object.create(Ru.prototype),Zu.prototype.constructor=Zu,Zu.prototype.isCubicBezierCurve3=!0,Zu.prototype.getPoint=function(t,e){var r=e||new Ne,n=this.v0,i=this.v1,o=this.v2,s=this.v3;return r.set(Xu(t,n.x,i.x,o.x,s.x),Xu(t,n.y,i.y,o.y,s.y),Xu(t,n.z,i.z,o.z,s.z)),r},Zu.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Zu.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Zu.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Ju.prototype=Object.create(Ru.prototype),Ju.prototype.constructor=Ju,Ju.prototype.isLineCurve=!0,Ju.prototype.getPoint=function(t,e){var r=e||new Oe;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},Ju.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Ju.prototype.getTangent=function(){var t=this.v2.clone().sub(this.v1);return t.normalize()},Ju.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ju.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ju.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Qu.prototype=Object.create(Ru.prototype),Qu.prototype.constructor=Qu,Qu.prototype.isLineCurve3=!0,Qu.prototype.getPoint=function(t,e){var r=e||new Ne;return 1===t?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},Qu.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Qu.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Qu.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Qu.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ku.prototype=Object.create(Ru.prototype),Ku.prototype.constructor=Ku,Ku.prototype.isQuadraticBezierCurve=!0,Ku.prototype.getPoint=function(t,e){var r=e||new Oe,n=this.v0,i=this.v1,o=this.v2;return r.set(Hu(t,n.x,i.x,o.x),Hu(t,n.y,i.y,o.y)),r},Ku.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ku.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ku.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},tl.prototype=Object.create(Ru.prototype),tl.prototype.constructor=tl,tl.prototype.isQuadraticBezierCurve3=!0,tl.prototype.getPoint=function(t,e){var r=e||new Ne,n=this.v0,i=this.v1,o=this.v2;return r.set(Hu(t,n.x,i.x,o.x),Hu(t,n.y,i.y,o.y),Hu(t,n.z,i.z,o.z)),r},tl.prototype.copy=function(t){return Ru.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},tl.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},tl.prototype.fromJSON=function(t){return Ru.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},el.prototype=Object.create(Ru.prototype),el.prototype.constructor=el,el.prototype.isSplineCurve=!0,el.prototype.getPoint=function(t,e){var r=e||new Oe,n=this.points,i=(n.length-1)*t,o=Math.floor(i),s=i-o,a=n[0===o?o:o-1],u=n[o],l=n[o>n.length-2?n.length-1:o+1],c=n[o>n.length-3?n.length-1:o+2];return r.set(zu(s,a.x,u.x,l.x,c.x),zu(s,a.y,u.y,l.y,c.y)),r},el.prototype.copy=function(t){Ru.prototype.copy.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push(n.clone())}return this},el.prototype.toJSON=function(){var t=Ru.prototype.toJSON.call(this);t.points=[];for(var e=0,r=this.points.length;e<r;e++){var n=this.points[e];t.points.push(n.toArray())}return t},el.prototype.fromJSON=function(t){Ru.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,r=t.points.length;e<r;e++){var n=t.points[e];this.points.push((new Oe).fromArray(n))}return this};var rl=Object.freeze({ArcCurve:Ou,CatmullRomCurve3:Vu,CubicBezierCurve:Yu,CubicBezierCurve3:Zu,EllipseCurve:Lu,LineCurve:Ju,LineCurve3:Qu,QuadraticBezierCurve:Ku,QuadraticBezierCurve3:tl,SplineCurve:el});function nl(){Ru.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function il(t){nl.call(this),this.type="Path",this.currentPoint=new Oe,t&&this.setFromPoints(t)}function ol(t){il.call(this,t),this.uuid=Le.generateUUID(),this.type="Shape",this.holes=[]}function sl(t,e){li.call(this),this.type="Light",this.color=new ri(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function al(t,e,r){sl.call(this,t,r),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(li.DefaultUp),this.updateMatrix(),this.groundColor=new ri(e)}function ul(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Oe(512,512),this.map=null,this.matrix=new Ie}function ll(){ul.call(this,new _s(50,1,.5,500))}function cl(t,e,r,n,i,o){sl.call(this,t,e),this.type="SpotLight",this.position.copy(li.DefaultUp),this.updateMatrix(),this.target=new li,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==r?r:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new ll}function hl(t,e,r,n){sl.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==r?r:0,this.decay=void 0!==n?n:1,this.shadow=new ul(new _s(90,1,.5,500))}function dl(){ul.call(this,new hi(-5,5,5,-5,.5,500))}function pl(t,e){sl.call(this,t,e),this.type="DirectionalLight",this.position.copy(li.DefaultUp),this.updateMatrix(),this.target=new li,this.shadow=new dl}function fl(t,e){sl.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ml(t,e,r,n){sl.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==r?r:10,this.height=void 0!==n?n:10}function gl(t,e,r,n){Al.call(this,t,e,r,n)}function vl(t,e,r){Al.call(this,t,e,r)}function yl(t,e,r,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(r),this.sampleValues=e,this.valueSize=r}function wl(t,e,r,n){yl.call(this,t,e,r,n)}function bl(t,e,r,n){Al.call(this,t,e,r,n)}function xl(t,e,r,n){Al.call(this,t,e,r,n)}function _l(t,e,r,n){Al.call(this,t,e,r,n)}function Sl(t,e,r,n){yl.call(this,t,e,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ml(t,e,r,n){yl.call(this,t,e,r,n)}function El(t,e,r,n){yl.call(this,t,e,r,n)}nl.prototype=Object.assign(Object.create(Ru.prototype),{constructor:nl,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Ju(e,t))},getPoint:function(t){var e=t*this.getLength(),r=this.getCurveLengths(),n=0;while(n<r.length){if(r[n]>=e){var i=r[n]-e,o=this.curves[n],s=o.getLength(),a=0===s?0:1-i/s;return o.getPointAt(a)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,r=0,n=this.curves.length;r<n;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,r=[],n=0,i=this.curves;n<i.length;n++)for(var o=i[n],s=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,a=o.getPoints(s),u=0;u<a.length;u++){var l=a[u];e&&e.equals(l)||(r.push(l),e=l)}return this.autoClose&&r.length>1&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Ru.prototype.copy.call(this,t),this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=Ru.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,r=this.curves.length;e<r;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){Ru.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,r=t.curves.length;e<r;e++){var n=t.curves[e];this.curves.push((new rl[n.type]).fromJSON(n))}return this}}),il.prototype=Object.assign(Object.create(nl.prototype),{constructor:il,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var r=new Ju(this.currentPoint.clone(),new Oe(t,e));this.curves.push(r),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,r,n){var i=new Ku(this.currentPoint.clone(),new Oe(t,e),new Oe(r,n));this.curves.push(i),this.currentPoint.set(r,n)},bezierCurveTo:function(t,e,r,n,i,o){var s=new Yu(this.currentPoint.clone(),new Oe(t,e),new Oe(r,n),new Oe(i,o));this.curves.push(s),this.currentPoint.set(i,o)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),r=new el(e);this.curves.push(r),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,r,n,i,o){var s=this.currentPoint.x,a=this.currentPoint.y;this.absarc(t+s,e+a,r,n,i,o)},absarc:function(t,e,r,n,i,o){this.absellipse(t,e,r,r,n,i,o)},ellipse:function(t,e,r,n,i,o,s,a){var u=this.currentPoint.x,l=this.currentPoint.y;this.absellipse(t+u,e+l,r,n,i,o,s,a)},absellipse:function(t,e,r,n,i,o,s,a){var u=new Lu(t,e,r,n,i,o,s,a);if(this.curves.length>0){var l=u.getPoint(0);l.equals(this.currentPoint)||this.lineTo(l.x,l.y)}this.curves.push(u);var c=u.getPoint(1);this.currentPoint.copy(c)},copy:function(t){return nl.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=nl.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return nl.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),ol.prototype=Object.assign(Object.create(il.prototype),{constructor:ol,getPointsHoles:function(t){for(var e=[],r=0,n=this.holes.length;r<n;r++)e[r]=this.holes[r].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){il.prototype.copy.call(this,t),this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){var t=il.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,r=this.holes.length;e<r;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){il.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,r=t.holes.length;e<r;e++){var n=t.holes[e];this.holes.push((new il).fromJSON(n))}return this}}),sl.prototype=Object.assign(Object.create(li.prototype),{constructor:sl,isLight:!0,copy:function(t){return li.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=li.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),al.prototype=Object.assign(Object.create(sl.prototype),{constructor:al,isHemisphereLight:!0,copy:function(t){return sl.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(ul.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ll.prototype=Object.assign(Object.create(ul.prototype),{constructor:ll,isSpotLightShadow:!0,update:function(t){var e=this.camera,r=2*Le.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;r===e.fov&&n===e.aspect&&i===e.far||(e.fov=r,e.aspect=n,e.far=i,e.updateProjectionMatrix())}}),cl.prototype=Object.assign(Object.create(sl.prototype),{constructor:cl,isSpotLight:!0,copy:function(t){return sl.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),hl.prototype=Object.assign(Object.create(sl.prototype),{constructor:hl,isPointLight:!0,copy:function(t){return sl.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),dl.prototype=Object.assign(Object.create(ul.prototype),{constructor:dl}),pl.prototype=Object.assign(Object.create(sl.prototype),{constructor:pl,isDirectionalLight:!0,copy:function(t){return sl.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),fl.prototype=Object.assign(Object.create(sl.prototype),{constructor:fl,isAmbientLight:!0}),ml.prototype=Object.assign(Object.create(sl.prototype),{constructor:ml,isRectAreaLight:!0,copy:function(t){return sl.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=sl.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),gl.prototype=Object.assign(Object.create(Al.prototype),{constructor:gl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:pe,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),vl.prototype=Object.assign(Object.create(Al.prototype),{constructor:vl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:pe,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(yl.prototype,{evaluate:function(t){var e=this.parameterPositions,r=this._cachedIndex,n=e[r],i=e[r-1];t:{e:{var o;r:{n:if(!(t<n)){for(var s=r+2;;){if(void 0===n){if(t<i)break n;return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,t,i)}if(r===s)break;if(i=n,n=e[++r],t<n)break e}o=e.length;break r}if(t>=i)break t;var a=e[1];t<a&&(r=2,i=a);for(s=r-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(r===s)break;if(n=i,i=e[--r-1],t>=i)break e}o=r,r=0}while(r<o){var u=r+o>>>1;t<e[u]?o=u:r=u+1}if(n=e[r],i=e[r-1],void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return r=e.length,this._cachedIndex=r,this.afterEnd_(r-1,i,t)}this._cachedIndex=r,this.intervalChanged_(r,i,n)}return this.interpolate_(r,i,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,r=this.sampleValues,n=this.valueSize,i=t*n,o=0;o!==n;++o)e[o]=r[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(yl.prototype,{beforeStart_:yl.prototype.copySampleValue_,afterEnd_:yl.prototype.copySampleValue_}),wl.prototype=Object.assign(Object.create(yl.prototype),{constructor:wl,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,u=(r-e)/(n-e),l=a+s;a!==l;a+=4)De.slerpFlat(i,0,o,a-s,o,a,u);return i}}),bl.prototype=Object.assign(Object.create(Al.prototype),{constructor:bl,ValueTypeName:"quaternion",DefaultInterpolation:fe,InterpolantFactoryMethodLinear:function(t){return new wl(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),xl.prototype=Object.assign(Object.create(Al.prototype),{constructor:xl,ValueTypeName:"color"}),_l.prototype=Object.assign(Object.create(Al.prototype),{constructor:_l,ValueTypeName:"number"}),Sl.prototype=Object.assign(Object.create(yl.prototype),{constructor:Sl,DefaultSettings_:{endingStart:ge,endingEnd:ge},intervalChanged_:function(t,e,r){var n=this.parameterPositions,i=t-2,o=t+1,s=n[i],a=n[o];if(void 0===s)switch(this.getSettings_().endingStart){case ve:i=t,s=2*e-r;break;case ye:i=n.length-2,s=e+n[i]-n[i+1];break;default:i=t,s=r}if(void 0===a)switch(this.getSettings_().endingEnd){case ve:o=t,a=2*r-e;break;case ye:o=1,a=r+n[1]-n[0];break;default:o=t-1,a=e}var u=.5*(r-e),l=this.valueSize;this._weightPrev=u/(e-s),this._weightNext=u/(a-r),this._offsetPrev=i*l,this._offsetNext=o*l},interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,u=a-s,l=this._offsetPrev,c=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(r-e)/(n-e),f=p*p,m=f*p,g=-h*m+2*h*f-h*p,v=(1+h)*m+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,w=d*m-d*f,b=0;b!==s;++b)i[b]=g*o[l+b]+v*o[u+b]+y*o[a+b]+w*o[c+b];return i}}),Ml.prototype=Object.assign(Object.create(yl.prototype),{constructor:Ml,interpolate_:function(t,e,r,n){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,a=t*s,u=a-s,l=(r-e)/(n-e),c=1-l,h=0;h!==s;++h)i[h]=o[u+h]*c+o[a+h]*l;return i}}),El.prototype=Object.assign(Object.create(yl.prototype),{constructor:El,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Tl={arraySlice:function(t,e,r){return Tl.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==r?r:t.length)):t.slice(e,r)},convertArray:function(t,e,r){return!t||!r&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,r){return t[e]-t[r]}for(var r=t.length,n=new Array(r),i=0;i!==r;++i)n[i]=i;return n.sort(e),n},sortedArray:function(t,e,r){for(var n=t.length,i=new t.constructor(n),o=0,s=0;s!==n;++o)for(var a=r[o]*e,u=0;u!==e;++u)i[s++]=t[a+u];return i},flattenJSON:function(t,e,r,n){var i=1,o=t[0];while(void 0!==o&&void 0===o[n])o=t[i++];if(void 0!==o){var s=o[n];if(void 0!==s)if(Array.isArray(s))do{s=o[n],void 0!==s&&(e.push(o.time),r.push.apply(r,s)),o=t[i++]}while(void 0!==o);else if(void 0!==s.toArray)do{s=o[n],void 0!==s&&(e.push(o.time),s.toArray(r,r.length)),o=t[i++]}while(void 0!==o);else do{s=o[n],void 0!==s&&(e.push(o.time),r.push(s)),o=t[i++]}while(void 0!==o)}}};function Al(t,e,r,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Tl.convertArray(e,this.TimeBufferType),this.values=Tl.convertArray(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function Pl(t,e,r,n){Al.call(this,t,e,r,n)}function Cl(t,e,r){this.name=t,this.tracks=r,this.duration=void 0!==e?e:-1,this.uuid=Le.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Rl(t){this.manager=void 0!==t?t:_u,this.textures={}}function Ll(t){this.manager=void 0!==t?t:_u}Object.assign(Al,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Al._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var r=[],n=[];Tl.flattenJSON(t.keys,r,n,"value"),t.times=r,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,r=t.constructor;if(void 0!==r.toJSON)e=r.toJSON(t);else{e={name:t.name,times:Tl.convertArray(t.times,Array),values:Tl.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return _l;case"vector":case"vector2":case"vector3":case"vector4":return Pl;case"color":return xl;case"quaternion":return bl;case"bool":case"boolean":return vl;case"string":return gl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Al.prototype,{constructor:Al,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:fe,InterpolantFactoryMethodDiscrete:function(t){return new El(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Ml(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Sl(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case pe:e=this.InterpolantFactoryMethodDiscrete;break;case fe:e=this.InterpolantFactoryMethodLinear;break;case me:e=this.InterpolantFactoryMethodSmooth;break}if(void 0!==e)this.createInterpolant=e;else{var r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(r);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",r)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return pe;case this.InterpolantFactoryMethodLinear:return fe;case this.InterpolantFactoryMethodSmooth:return me}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,r=0,n=e.length;r!==n;++r)e[r]*=t;return this},trim:function(t,e){var r=this.times,n=r.length,i=0,o=n-1;while(i!==n&&r[i]<t)++i;while(-1!==o&&r[o]>e)--o;if(++o,0!==i||o!==n){i>=o&&(o=Math.max(o,1),i=o-1);var s=this.getValueSize();this.times=Tl.arraySlice(r,i,o),this.values=Tl.arraySlice(this.values,i*s,o*s)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var r=this.times,n=this.values,i=r.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,s=0;s!==i;s++){var a=r[s];if("number"===typeof a&&isNaN(a)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,s,a),t=!1;break}if(null!==o&&o>a){console.error("THREE.KeyframeTrack: Out of order keys.",this,s,a,o),t=!1;break}o=a}if(void 0!==n&&Tl.isTypedArray(n)){s=0;for(var u=n.length;s!==u;++s){var l=n[s];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,s,l),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,r=this.getValueSize(),n=this.getInterpolation()===me,i=1,o=t.length-1,s=1;s<o;++s){var a=!1,u=t[s],l=t[s+1];if(u!==l&&(1!==s||u!==u[0]))if(n)a=!0;else for(var c=s*r,h=c-r,d=c+r,p=0;p!==r;++p){var f=e[c+p];if(f!==e[h+p]||f!==e[d+p]){a=!0;break}}if(a){if(s!==i){t[i]=t[s];var m=s*r,g=i*r;for(p=0;p!==r;++p)e[g+p]=e[m+p]}++i}}if(o>0){t[i]=t[o];for(m=o*r,g=i*r,p=0;p!==r;++p)e[g+p]=e[m+p];++i}return i!==t.length&&(this.times=Tl.arraySlice(t,0,i),this.values=Tl.arraySlice(e,0,i*r)),this}}),Pl.prototype=Object.assign(Object.create(Al.prototype),{constructor:Pl,ValueTypeName:"vector"}),Object.assign(Cl,{parse:function(t){for(var e=[],r=t.tracks,n=1/(t.fps||1),i=0,o=r.length;i!==o;++i)e.push(Al.parse(r[i]).scale(n));return new Cl(t.name,t.duration,e)},toJSON:function(t){for(var e=[],r=t.tracks,n={name:t.name,duration:t.duration,tracks:e},i=0,o=r.length;i!==o;++i)e.push(Al.toJSON(r[i]));return n},CreateFromMorphTargetSequence:function(t,e,r,n){for(var i=e.length,o=[],s=0;s<i;s++){var a=[],u=[];a.push((s+i-1)%i,s,(s+1)%i),u.push(0,1,0);var l=Tl.getKeyframeOrder(a);a=Tl.sortedArray(a,1,l),u=Tl.sortedArray(u,1,l),n||0!==a[0]||(a.push(i),u.push(u[0])),o.push(new _l(".morphTargetInfluences["+e[s].name+"]",a,u).scale(1/r))}return new Cl(t,-1,o)},findByName:function(t,e){var r=t;if(!Array.isArray(t)){var n=t;r=n.geometry&&n.geometry.animations||n.animations}for(var i=0;i<r.length;i++)if(r[i].name===e)return r[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,r){for(var n={},i=/^([\w-]*?)([\d]+)$/,o=0,s=t.length;o<s;o++){var a=t[o],u=a.name.match(i);if(u&&u.length>1){var l=u[1],c=n[l];c||(n[l]=c=[]),c.push(a)}}var h=[];for(var l in n)h.push(Cl.CreateFromMorphTargetSequence(l,n[l],e,r));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var r=function(t,e,r,n,i){if(0!==r.length){var o=[],s=[];Tl.flattenJSON(r,o,s,n),0!==o.length&&i.push(new t(e,o,s))}},n=[],i=t.name||"default",o=t.length||-1,s=t.fps||30,a=t.hierarchy||[],u=0;u<a.length;u++){var l=a[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){for(var c={},h=0;h<l.length;h++)if(l[h].morphTargets)for(var d=0;d<l[h].morphTargets.length;d++)c[l[h].morphTargets[d]]=-1;for(var p in c){var f=[],m=[];for(d=0;d!==l[h].morphTargets.length;++d){var g=l[h];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new _l(".morphTargetInfluence["+p+"]",f,m))}o=c.length*(s||1)}else{var v=".bones["+e[u].name+"]";r(Pl,v+".position",l,"pos",n),r(bl,v+".quaternion",l,"rot",n),r(Pl,v+".scale",l,"scl",n)}}if(0===n.length)return null;var y=new Cl(i,o,n);return y}}),Object.assign(Cl.prototype,{resetDuration:function(){for(var t=this.tracks,e=0,r=0,n=t.length;r!==n;++r){var i=this.tracks[r];e=Math.max(e,i.times[i.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Rl.prototype,{load:function(t,e,r,n){var i=this,o=new Mu(i.manager);o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),r,n)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function r(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n=new wu[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(n.uniforms=t.uniforms),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.polygonOffset&&(n.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(n.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(n.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=r(t.map)),void 0!==t.alphaMap&&(n.alphaMap=r(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=r(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=r(t.normalMap)),void 0!==t.normalScale){var i=t.normalScale;!1===Array.isArray(i)&&(i=[i,i]),n.normalScale=(new Oe).fromArray(i)}return void 0!==t.displacementMap&&(n.displacementMap=r(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=r(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=r(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=r(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=r(t.specularMap)),void 0!==t.envMap&&(n.envMap=r(t.envMap)),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=r(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=r(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=r(t.gradientMap)),n}}),Object.assign(Ll.prototype,{load:function(t,e,r,n){var i=this,o=new Mu(i.manager);o.load(t,(function(t){e(i.parse(JSON.parse(t)))}),r,n)},parse:function(t){var e=new Pi,r=t.data.index;if(void 0!==r){var n=new Ol[r.type](r.array);e.setIndex(new mi(n,1))}var i=t.data.attributes;for(var o in i){var s=i[o];n=new Ol[s.type](s.array);e.addAttribute(o,new mi(n,s.itemSize,s.normalized))}var a=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==a)for(var u=0,l=a.length;u!==l;++u){var c=a[u];e.addGroup(c.start,c.count,c.materialIndex)}var h=t.data.boundingSphere;if(void 0!==h){var d=new Ne;void 0!==h.center&&d.fromArray(h.center),e.boundingSphere=new Ge(d,h.radius)}return e}});var Ol={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Il(){}Il.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,r=0,n=e.length;r<n;r+=2){var i=e[r],o=e[r+1];if(i.test(t))return o}return null}},Object.assign(Il.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,r){for(var n=[],i=0;i<t.length;++i)n[i]=this.createMaterial(t[i],e,r);return n},createMaterial:function(){var t={NoBlending:x,NormalBlending:_,AdditiveBlending:S,SubtractiveBlending:M,MultiplyBlending:E,CustomBlending:T},e=new ri,r=new Cu,n=new Rl;return function(i,o,s){var a={};function u(t,e,n,i,u){var l,c=o+t,h=Il.Handlers.get(c);null!==h?l=h.load(c):(r.setCrossOrigin(s),l=r.load(c)),void 0!==e&&(l.repeat.fromArray(e),1!==e[0]&&(l.wrapS=pt),1!==e[1]&&(l.wrapT=pt)),void 0!==n&&l.offset.fromArray(n),void 0!==i&&("repeat"===i[0]&&(l.wrapS=pt),"mirror"===i[0]&&(l.wrapS=mt),"repeat"===i[1]&&(l.wrapT=pt),"mirror"===i[1]&&(l.wrapT=mt)),void 0!==u&&(l.anisotropy=u);var d=Le.generateUUID();return a[d]=l,d}var l={uuid:Le.generateUUID(),type:"MeshLambertMaterial"};for(var c in i){var h=i[c];switch(c){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":l.name=h;break;case"blending":l.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",c,"is no longer supported.");break;case"colorDiffuse":l.color=e.fromArray(h).getHex();break;case"colorSpecular":l.specular=e.fromArray(h).getHex();break;case"colorEmissive":l.emissive=e.fromArray(h).getHex();break;case"specularCoef":l.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(l.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(l.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(l.type="MeshStandardMaterial");break;case"mapDiffuse":l.map=u(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":l.emissiveMap=u(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":l.lightMap=u(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":l.aoMap=u(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":l.bumpMap=u(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":l.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":l.normalMap=u(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":l.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":l.specularMap=u(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":l.metalnessMap=u(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":l.roughnessMap=u(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":l.alphaMap=u(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":l.side=m;break;case"doubleSided":l.side=g;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),l.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":l[c]=h;break;case"vertexColors":!0===h&&(l.vertexColors=b),"face"===h&&(l.vertexColors=w);break;default:console.error("THREE.Loader.createMaterial: Unsupported",c,h);break}}return"MeshBasicMaterial"===l.type&&delete l.emissive,"MeshPhongMaterial"!==l.type&&delete l.specular,l.opacity<1&&(l.transparent=!0),n.setTextures(a),n.parse(l)}}()});var Dl={decodeText:function(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",r=0,n=t.length;r<n;r++)e+=String.fromCharCode(t[r]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};function Nl(t){"boolean"===typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:_u,this.withCredentials=!1}function kl(t){this.manager=void 0!==t?t:_u,this.texturePath=""}Object.assign(Nl.prototype,{load:function(t,e,r,n){var i=this,o=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:Dl.extractUrlBase(t),s=new Mu(this.manager);s.setWithCredentials(this.withCredentials),s.load(t,(function(r){var n=JSON.parse(r),s=n.metadata;if(void 0!==s){var a=s.type;if(void 0!==a&&"object"===a.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.")}var u=i.parse(n,o);e(u.geometry,u.materials)}),r,n)},setTexturePath:function(t){this.texturePath=t},parse:function(){function t(t,e){function r(t,e){return t&1<<e}var n,i,o,s,a,u,l,c,h,d,p,f,m,g,v,y,w,b,x,_,S,M,E,T,A,P,C,R=t.faces,L=t.vertices,O=t.normals,I=t.colors,D=t.scale,N=0;if(void 0!==t.uvs){for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&N++;for(n=0;n<N;n++)e.faceVertexUvs[n]=[]}s=0,a=L.length;while(s<a)b=new Ne,b.x=L[s++]*D,b.y=L[s++]*D,b.z=L[s++]*D,e.vertices.push(b);s=0,a=R.length;while(s<a)if(d=R[s++],p=r(d,0),f=r(d,1),m=r(d,3),g=r(d,4),v=r(d,5),y=r(d,6),w=r(d,7),p){if(_=new di,_.a=R[s],_.b=R[s+1],_.c=R[s+3],S=new di,S.a=R[s+1],S.b=R[s+2],S.c=R[s+3],s+=4,f&&(h=R[s++],_.materialIndex=h,S.materialIndex=h),o=e.faces.length,m)for(n=0;n<N;n++)for(T=t.uvs[n],e.faceVertexUvs[n][o]=[],e.faceVertexUvs[n][o+1]=[],i=0;i<4;i++)c=R[s++],P=T[2*c],C=T[2*c+1],A=new Oe(P,C),2!==i&&e.faceVertexUvs[n][o].push(A),0!==i&&e.faceVertexUvs[n][o+1].push(A);if(g&&(l=3*R[s++],_.normal.set(O[l++],O[l++],O[l]),S.normal.copy(_.normal)),v)for(n=0;n<4;n++)l=3*R[s++],E=new Ne(O[l++],O[l++],O[l]),2!==n&&_.vertexNormals.push(E),0!==n&&S.vertexNormals.push(E);if(y&&(u=R[s++],M=I[u],_.color.setHex(M),S.color.setHex(M)),w)for(n=0;n<4;n++)u=R[s++],M=I[u],2!==n&&_.vertexColors.push(new ri(M)),0!==n&&S.vertexColors.push(new ri(M));e.faces.push(_),e.faces.push(S)}else{if(x=new di,x.a=R[s++],x.b=R[s++],x.c=R[s++],f&&(h=R[s++],x.materialIndex=h),o=e.faces.length,m)for(n=0;n<N;n++)for(T=t.uvs[n],e.faceVertexUvs[n][o]=[],i=0;i<3;i++)c=R[s++],P=T[2*c],C=T[2*c+1],A=new Oe(P,C),e.faceVertexUvs[n][o].push(A);if(g&&(l=3*R[s++],x.normal.set(O[l++],O[l++],O[l])),v)for(n=0;n<3;n++)l=3*R[s++],E=new Ne(O[l++],O[l++],O[l]),x.vertexNormals.push(E);if(y&&(u=R[s++],x.color.setHex(I[u])),w)for(n=0;n<3;n++)u=R[s++],x.vertexColors.push(new ri(I[u]));e.faces.push(x)}}function e(t,e){var r=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,i=t.skinWeights.length;n<i;n+=r){var o=t.skinWeights[n],s=r>1?t.skinWeights[n+1]:0,a=r>2?t.skinWeights[n+2]:0,u=r>3?t.skinWeights[n+3]:0;e.skinWeights.push(new ze(o,s,a,u))}if(t.skinIndices)for(n=0,i=t.skinIndices.length;n<i;n+=r){var l=t.skinIndices[n],c=r>1?t.skinIndices[n+1]:0,h=r>2?t.skinIndices[n+2]:0,d=r>3?t.skinIndices[n+3]:0;e.skinIndices.push(new ze(l,c,h,d))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}function r(t,e){var r=t.scale;if(void 0!==t.morphTargets)for(var n=0,i=t.morphTargets.length;n<i;n++){e.morphTargets[n]={},e.morphTargets[n].name=t.morphTargets[n].name,e.morphTargets[n].vertices=[];for(var o=e.morphTargets[n].vertices,s=t.morphTargets[n].vertices,a=0,u=s.length;a<u;a+=3){var l=new Ne;l.x=s[a]*r,l.y=s[a+1]*r,l.z=s[a+2]*r,o.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var c=e.faces,h=t.morphColors[0].colors;for(n=0,i=c.length;n<i;n++)c[n].color.fromArray(h,3*n)}}function n(t,e){var r=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var i=0;i<n.length;i++){var o=Cl.parseAnimation(n[i],e.bones);o&&r.push(o)}if(e.morphTargets){var s=Cl.CreateClipsFromMorphTargetSequences(e.morphTargets,10);r=r.concat(s)}r.length>0&&(e.animations=r)}return function(i,o){void 0!==i.data&&(i=i.data),void 0!==i.scale?i.scale=1/i.scale:i.scale=1;var s=new fi;if(t(i,s),e(i,s),r(i,s),n(i,s),s.computeFaceNormals(),s.computeBoundingSphere(),void 0===i.materials||0===i.materials.length)return{geometry:s};var a=Il.prototype.initMaterials(i.materials,o,this.crossOrigin);return{geometry:s,materials:a}}}()}),Object.assign(kl.prototype,{load:function(t,e,r,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this,o=new Mu(i.manager);o.load(t,(function(r){var o=null;try{o=JSON.parse(r)}catch(a){return void 0!==n&&n(a),void console.error("THREE:ObjectLoader: Can't parse "+t+".",a.message)}var s=o.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?i.parse(o,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")}),r,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var r=this.parseShape(t.shapes),n=this.parseGeometries(t.geometries,r),i=this.parseImages(t.images,(function(){void 0!==e&&e(a)})),o=this.parseTextures(t.textures,i),s=this.parseMaterials(t.materials,o),a=this.parseObject(t.object,n,s);return t.animations&&(a.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(a),a},parseShape:function(t){var e={};if(void 0!==t)for(var r=0,n=t.length;r<n;r++){var i=(new ol).fromJSON(t[r]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var r={};if(void 0!==t)for(var n=new Nl,i=new Ll,o=0,s=t.length;o<s;o++){var a,u=t[o];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":a=new lu[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":a=new lu[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":a=new lu[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":a=new lu[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":a=new lu[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":a=new lu[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":a=new lu[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":a=new lu[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":a=new lu[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":a=new lu[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":a=new lu[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":a=new lu[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var l=[],c=0,h=u.shapes.length;c<h;c++){var d=e[u.shapes[c]];l.push(d)}a=new lu[u.type](l,u.curveSegments);break;case"BufferGeometry":a=i.parse(u);break;case"Geometry":a=n.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}a.uuid=u.uuid,void 0!==u.name&&(a.name=u.name),r[u.uuid]=a}return r},parseMaterials:function(t,e){var r={};if(void 0!==t){var n=new Rl;n.setTextures(e);for(var i=0,o=t.length;i<o;i++){var s=t[i];if("MultiMaterial"===s.type){for(var a=[],u=0;u<s.materials.length;u++)a.push(n.parse(s.materials[u]));r[s.uuid]=a}else r[s.uuid]=n.parse(s)}}return r},parseAnimations:function(t){for(var e=[],r=0;r<t.length;r++){var n=Cl.parse(t[r]);e.push(n)}return e},parseImages:function(t,e){var r=this,n={};function i(t){return r.manager.itemStart(t),s.load(t,(function(){r.manager.itemEnd(t)}),void 0,(function(){r.manager.itemEnd(t),r.manager.itemError(t)}))}if(void 0!==t&&t.length>0){var o=new xu(e),s=new Au(o);s.setCrossOrigin(this.crossOrigin);for(var a=0,u=t.length;a<u;a++){var l=t[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l.url)?l.url:r.texturePath+l.url;n[l.uuid]=i(c)}}return n},parseTextures:function(t,e){function r(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var s=t[i];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===e[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);var a=new Ve(e[s.image]);a.needsUpdate=!0,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=r(s.mapping,Vl)),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=r(s.wrap[0],zl),a.wrapT=r(s.wrap[1],zl)),void 0!==s.format&&(a.format=s.format),void 0!==s.minFilter&&(a.minFilter=r(s.minFilter,Ul)),void 0!==s.magFilter&&(a.magFilter=r(s.magFilter,Ul)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),n[s.uuid]=a}return n},parseObject:function(t,e,r){var n;function i(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function o(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,i=t.length;n<i;n++){var o=t[n];void 0===r[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(r[o])}return e}return void 0===r[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),r[t]}}switch(t.type){case"Scene":n=new Ps,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new ri(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new As(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new Ts(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new _s(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new hi(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"AmbientLight":n=new fl(t.color,t.intensity);break;case"DirectionalLight":n=new pl(t.color,t.intensity);break;case"PointLight":n=new hl(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new ml(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new cl(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new al(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var s=i(t.geometry),a=o(t.material);n=s.bones&&s.bones.length>0?new Ds(s,a):new Ui(s,a);break;case"LOD":n=new Ls;break;case"Line":n=new ks(i(t.geometry),o(t.material),t.mode);break;case"LineLoop":n=new Vs(i(t.geometry),o(t.material));break;case"LineSegments":n=new Fs(i(t.geometry),o(t.material));break;case"PointCloud":case"Points":n=new Us(i(t.geometry),o(t.material));break;case"Sprite":n=new Rs(o(t.material));break;case"Group":n=new js;break;default:n=new li}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(n.matrixAutoUpdate=t.matrixAutoUpdate),n.matrixAutoUpdate&&n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.frustumCulled&&(n.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(n.renderOrder=t.renderOrder),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var u=t.children,l=0;l<u.length;l++)n.add(this.parseObject(u[l],e,r));if("LOD"===t.type)for(var c=t.levels,h=0;h<c.length;h++){var d=c[h],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var Fl,Vl={UVMapping:ot,CubeReflectionMapping:st,CubeRefractionMapping:at,EquirectangularReflectionMapping:ut,EquirectangularRefractionMapping:lt,SphericalReflectionMapping:ct,CubeUVReflectionMapping:ht,CubeUVRefractionMapping:dt},zl={RepeatWrapping:pt,ClampToEdgeWrapping:ft,MirroredRepeatWrapping:mt},Ul={NearestFilter:gt,NearestMipMapNearestFilter:vt,NearestMipMapLinearFilter:yt,LinearFilter:wt,LinearMipMapNearestFilter:bt,LinearMipMapLinearFilter:xt};function jl(t){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:_u,this.options=void 0}function Bl(){this.type="ShapePath",this.color=new ri,this.subPaths=[],this.currentPath=null}function Hl(t){this.type="Font",this.data=t}function Gl(t,e,r,n){for(var i=String(t).split(""),o=e/n.resolution,s=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*o,a=[],u=0,l=0,c=0;c<i.length;c++){var h=i[c];if("\n"===h)u=0,l-=s;else{var d=ql(h,r,o,u,l,n);u+=d.offsetX,a.push(d.path)}}return a}function ql(t,e,r,n,i,o){var s=o.glyphs[t]||o.glyphs["?"];if(s){var a,u,l,c,h,d,p,f,m=new Bl;if(s.o)for(var g=s._cachedOutline||(s._cachedOutline=s.o.split(" ")),v=0,y=g.length;v<y;){var w=g[v++];switch(w){case"m":a=g[v++]*r+n,u=g[v++]*r+i,m.moveTo(a,u);break;case"l":a=g[v++]*r+n,u=g[v++]*r+i,m.lineTo(a,u);break;case"q":l=g[v++]*r+n,c=g[v++]*r+i,h=g[v++]*r+n,d=g[v++]*r+i,m.quadraticCurveTo(h,d,l,c);break;case"b":l=g[v++]*r+n,c=g[v++]*r+i,h=g[v++]*r+n,d=g[v++]*r+i,p=g[v++]*r+n,f=g[v++]*r+i,m.bezierCurveTo(h,d,p,f,l,c);break}}return{offsetX:s.ha*r,path:m}}}function Wl(t){this.manager=void 0!==t?t:_u}jl.prototype={constructor:jl,setOptions:function(t){return this.options=t,this},load:function(t,e,r,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=bu.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout((function(){e&&e(o),i.manager.itemEnd(t)}),0),o;fetch(t).then((function(t){return t.blob()})).then((function(t){return createImageBitmap(t,i.options)})).then((function(r){bu.add(t,r),e&&e(r),i.manager.itemEnd(t)})).catch((function(e){n&&n(e),i.manager.itemEnd(t),i.manager.itemError(t)}))},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Bl.prototype,{moveTo:function(t,e){this.currentPath=new il,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,r,n){this.currentPath.quadraticCurveTo(t,e,r,n)},bezierCurveTo:function(t,e,r,n,i,o){this.currentPath.bezierCurveTo(t,e,r,n,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function r(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r],o=new ol;o.curves=i.curves,e.push(o)}return e}function n(t,e){for(var r=e.length,n=!1,i=r-1,o=0;o<r;i=o++){var s=e[i],a=e[o],u=a.x-s.x,l=a.y-s.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(s=e[o],u=-u,a=e[i],l=-l),t.y<s.y||t.y>a.y)continue;if(t.y===s.y){if(t.x===s.x)return!0}else{var c=l*(t.x-s.x)-u*(t.y-s.y);if(0===c)return!0;if(c<0)continue;n=!n}}else{if(t.y!==s.y)continue;if(a.x<=t.x&&t.x<=s.x||s.x<=t.x&&t.x<=a.x)return!0}}return n}var i=za.isClockWise,o=this.subPaths;if(0===o.length)return[];if(!0===e)return r(o);var s,a,u,l=[];if(1===o.length)return a=o[0],u=new ol,u.curves=a.curves,l.push(u),l;var c=!i(o[0].getPoints());c=t?!c:c;var h,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=o.length;v<y;v++)a=o[v],h=a.getPoints(),s=i(h),s=t?!s:s,s?(!c&&f[g]&&g++,f[g]={s:new ol,p:h},f[g].s.curves=a.curves,c&&g++,m[g]=[]):m[g].push({h:a,p:h[0]});if(!f[0])return r(o);if(f.length>1){for(var w=!1,b=[],x=0,_=f.length;x<_;x++)p[x]=[];for(x=0,_=f.length;x<_;x++)for(var S=m[x],M=0;M<S.length;M++){for(var E=S[M],T=!0,A=0;A<f.length;A++)n(E.p,f[A].p)&&(x!==A&&b.push({froms:x,tos:A,hole:M}),T?(T=!1,p[A].push(E)):w=!0);T&&p[x].push(E)}b.length>0&&(w||(m=p))}v=0;for(var P=f.length;v<P;v++){u=f[v].s,l.push(u),d=m[v];for(var C=0,R=d.length;C<R;C++)u.holes.push(d[C].h)}return l}}),Object.assign(Hl.prototype,{isFont:!0,generateShapes:function(t,e,r){void 0===e&&(e=100),void 0===r&&(r=4);for(var n=[],i=Gl(t,e,r,this.data),o=0,s=i.length;o<s;o++)Array.prototype.push.apply(n,i[o].toShapes());return n}}),Object.assign(Wl.prototype,{load:function(t,e,r,n){var i=this,o=new Mu(this.manager);o.setPath(this.path),o.load(t,(function(t){var r;try{r=JSON.parse(t)}catch(o){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),r=JSON.parse(t.substring(65,t.length-2))}var n=i.parse(r);e&&e(n)}),r,n)},parse:function(t){return new Hl(t)},setPath:function(t){return this.path=t,this}});var $l={getContext:function(){return void 0===Fl&&(Fl=new(window.AudioContext||window.webkitAudioContext)),Fl},setContext:function(t){Fl=t}};function Xl(t){this.manager=void 0!==t?t:_u}function Yl(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new _s,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new _s,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Zl(t,e,r){li.call(this),this.type="CubeCamera";var n=90,i=1,o=new _s(n,i,t,e);o.up.set(0,-1,0),o.lookAt(new Ne(1,0,0)),this.add(o);var s=new _s(n,i,t,e);s.up.set(0,-1,0),s.lookAt(new Ne(-1,0,0)),this.add(s);var a=new _s(n,i,t,e);a.up.set(0,0,1),a.lookAt(new Ne(0,1,0)),this.add(a);var u=new _s(n,i,t,e);u.up.set(0,0,-1),u.lookAt(new Ne(0,-1,0)),this.add(u);var l=new _s(n,i,t,e);l.up.set(0,-1,0),l.lookAt(new Ne(0,0,1)),this.add(l);var c=new _s(n,i,t,e);c.up.set(0,-1,0),c.lookAt(new Ne(0,0,-1)),this.add(c);var h={format:Nt,magFilter:wt,minFilter:wt};this.renderTarget=new je(r,r,h),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var r=this.renderTarget,n=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,r.activeCubeFace=0,t.render(e,o,r),r.activeCubeFace=1,t.render(e,s,r),r.activeCubeFace=2,t.render(e,a,r),r.activeCubeFace=3,t.render(e,u,r),r.activeCubeFace=4,t.render(e,l,r),r.texture.generateMipmaps=n,r.activeCubeFace=5,t.render(e,c,r),t.setRenderTarget(null)},this.clear=function(t,e,r,n){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,r,n);t.setRenderTarget(null)}}function Jl(){li.call(this),this.type="AudioListener",this.context=$l.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ql(t){li.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Kl(t){Ql.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function tc(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function ec(t,e,r){this.binding=t,this.valueSize=r;var n,i=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":i=Array,n=this._select;break;default:n=this._lerp}this.buffer=new i(4*r),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Xl.prototype,{load:function(t,e,r,n){var i=new Mu(this.manager);i.setResponseType("arraybuffer"),i.load(t,(function(t){var r=$l.getContext();r.decodeAudioData(t,(function(t){e(t)}))}),r,n)}}),Object.assign(Yl.prototype,{update:function(){var t,e,r,n,i,o,s,a,u=new Ie,l=new Ie;return function(c){var h=t!==this||e!==c.focus||r!==c.fov||n!==c.aspect*this.aspect||i!==c.near||o!==c.far||s!==c.zoom||a!==this.eyeSep;if(h){t=this,e=c.focus,r=c.fov,n=c.aspect*this.aspect,i=c.near,o=c.far,s=c.zoom;var d=c.projectionMatrix.clone();a=this.eyeSep/2;var p,f,m=a*i/e,g=i*Math.tan(Le.DEG2RAD*r*.5)/s;l.elements[12]=-a,u.elements[12]=a,p=-g*n+m,f=g*n+m,d.elements[0]=2*i/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraL.projectionMatrix.copy(d),p=-g*n-m,f=g*n-m,d.elements[0]=2*i/(f-p),d.elements[8]=(f+p)/(f-p),this.cameraR.projectionMatrix.copy(d)}this.cameraL.matrixWorld.copy(c.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(c.matrixWorld).multiply(u)}}()}),Zl.prototype=Object.create(li.prototype),Zl.prototype.constructor=Zl,Jl.prototype=Object.assign(Object.create(li.prototype),{constructor:Jl,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01)},updateMatrixWorld:function(){var t=new Ne,e=new De,r=new Ne,n=new Ne;return function(i){li.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,s=this.up;this.matrixWorld.decompose(t,e,r),n.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(n.x,this.context.currentTime),o.forwardY.setValueAtTime(n.y,this.context.currentTime),o.forwardZ.setValueAtTime(n.z,this.context.currentTime),o.upX.setValueAtTime(s.x,this.context.currentTime),o.upY.setValueAtTime(s.y,this.context.currentTime),o.upZ.setValueAtTime(s.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(n.x,n.y,n.z,s.x,s.y,s.z))}}()}),Ql.prototype=Object.assign(Object.create(li.prototype),{constructor:Ql,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),Kl.prototype=Object.assign(Object.create(Ql.prototype),{constructor:Kl,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new Ne;return function(e){li.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(tc.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),r=0;r<e.length;r++)t+=e[r];return t/e.length}}),Object.assign(ec.prototype,{accumulate:function(t,e){var r=this.buffer,n=this.valueSize,i=t*n+n,o=this.cumulativeWeight;if(0===o){for(var s=0;s!==n;++s)r[i+s]=r[s];o=e}else{o+=e;var a=e/o;this._mixBufferRegion(r,i,0,a,n)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,r=this.buffer,n=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var s=3*e;this._mixBufferRegion(r,n,s,1-i,e)}for(var a=e,u=e+e;a!==u;++a)if(r[a]!==r[a+e]){o.setValue(r,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,r=this.valueSize,n=3*r;t.getValue(e,n);for(var i=r,o=n;i!==o;++i)e[i]=e[n+i%r];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,r,n,i){if(n>=.5)for(var o=0;o!==i;++o)t[e+o]=t[r+o]},_slerp:function(t,e,r,n){De.slerpFlat(t,e,t,e,t,r,n)},_lerp:function(t,e,r,n,i){for(var o=1-n,s=0;s!==i;++s){var a=e+s;t[a]=t[a]*o+t[r+s]*n}}});var rc,nc,ic="\\[\\]\\.:\\/";function oc(t,e,r){var n=r||sc.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function sc(t,e,r){this.path=e,this.parsedPath=r||sc.parseTrackName(e),this.node=sc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function ac(){this.uuid=Le.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,r=arguments.length;e!==r;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function uc(t,e,r){this._mixer=t,this._clip=e,this._localRoot=r||null;for(var n=e.tracks,i=n.length,o=new Array(i),s={endingStart:ge,endingEnd:ge},a=0;a!==i;++a){var u=n[a].createInterpolant(null);o[a]=u,u.settings=s}this._interpolantSettings=s,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=he,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function lc(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function cc(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function hc(){Pi.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function dc(t,e,r,n){this.data=t,this.itemSize=e,this.offset=r,this.normalized=!0===n}function pc(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function fc(t,e,r){pc.call(this,t,e),this.meshPerAttribute=r||1}function mc(t,e,r){mi.call(this,t,e),this.meshPerAttribute=r||1}function gc(t,e,r,n){this.ray=new Fi(t,e),this.near=r||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function vc(t,e){return t.distance-e.distance}function yc(t,e,r,n){if(!1!==t.visible&&(t.raycast(e,r),!0===n))for(var i=t.children,o=0,s=i.length;o<s;o++)yc(i[o],e,r,!0)}function wc(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function bc(t,e,r){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==r?r:0,this}function xc(t,e,r){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==r?r:0,this}function _c(t,e){this.min=void 0!==t?t:new Oe(1/0,1/0),this.max=void 0!==e?e:new Oe(-1/0,-1/0)}function Sc(t){li.call(this),this.material=t,this.render=function(){}}function Mc(t,e,r,n){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==r?r:16711680,o=void 0!==n?n:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=3*a.faces.length:a&&a.isBufferGeometry&&(s=a.attributes.normal.count);var u=new Pi,l=new Si(2*s*3,3);u.addAttribute("position",l),Fs.call(this,u,new Ns({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Ec(t,e){li.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var r=new Pi,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1,s=32;i<s;i++,o++){var a=i/s*Math.PI*2,u=o/s*Math.PI*2;n.push(Math.cos(a),Math.sin(a),1,Math.cos(u),Math.sin(u),1)}r.addAttribute("position",new Si(n,3));var l=new Ns({fog:!1});this.cone=new Fs(r,l),this.add(this.cone),this.update()}function Tc(t){var e=[];t&&t.isBone&&e.push(t);for(var r=0;r<t.children.length;r++)e.push.apply(e,Tc(t.children[r]));return e}function Ac(t){for(var e=Tc(t),r=new Pi,n=[],i=[],o=new ri(0,0,1),s=new ri(0,1,0),a=0;a<e.length;a++){var u=e[a];u.parent&&u.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),i.push(o.r,o.g,o.b),i.push(s.r,s.g,s.b))}r.addAttribute("position",new Si(n,3)),r.addAttribute("color",new Si(i,3));var l=new Ns({vertexColors:b,depthTest:!1,depthWrite:!1,transparent:!0});Fs.call(this,r,l),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Pc(t,e,r){this.light=t,this.light.updateMatrixWorld(),this.color=r;var n=new Xa(e,4,2),i=new Ni({wireframe:!0,fog:!1});Ui.call(this,n,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Cc(t,e){li.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var r=new Ns({fog:!1}),n=new Pi;n.addAttribute("position",new mi(new Float32Array(15),3)),this.line=new ks(n,r),this.add(this.line),this.update()}function Rc(t,e,r){li.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r;var n=new Ks(e);n.rotateY(.5*Math.PI),this.material=new Ni({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=b);var i=n.getAttribute("position"),o=new Float32Array(3*i.count);n.addAttribute("color",new mi(o,3)),this.add(new Ui(n,this.material)),this.update()}function Lc(t,e,r,n){t=t||10,e=e||10,r=new ri(void 0!==r?r:4473924),n=new ri(void 0!==n?n:8947848);for(var i=e/2,o=t/e,s=t/2,a=[],u=[],l=0,c=0,h=-s;l<=e;l++,h+=o){a.push(-s,0,h,s,0,h),a.push(h,0,-s,h,0,s);var d=l===i?r:n;d.toArray(u,c),c+=3,d.toArray(u,c),c+=3,d.toArray(u,c),c+=3,d.toArray(u,c),c+=3}var p=new Pi;p.addAttribute("position",new Si(a,3)),p.addAttribute("color",new Si(u,3));var f=new Ns({vertexColors:b});Fs.call(this,p,f)}function Oc(t,e,r,n,i,o){t=t||10,e=e||16,r=r||8,n=n||64,i=new ri(void 0!==i?i:4473924),o=new ri(void 0!==o?o:8947848);var s,a,u,l,c,h,d,p=[],f=[];for(l=0;l<=e;l++)u=l/e*(2*Math.PI),s=Math.sin(u)*t,a=Math.cos(u)*t,p.push(0,0,0),p.push(s,0,a),d=1&l?i:o,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(l=0;l<=r;l++)for(d=1&l?i:o,h=t-t/r*l,c=0;c<n;c++)u=c/n*(2*Math.PI),s=Math.sin(u)*h,a=Math.cos(u)*h,p.push(s,0,a),f.push(d.r,d.g,d.b),u=(c+1)/n*(2*Math.PI),s=Math.sin(u)*h,a=Math.cos(u)*h,p.push(s,0,a),f.push(d.r,d.g,d.b);var m=new Pi;m.addAttribute("position",new Si(p,3)),m.addAttribute("color",new Si(f,3));var g=new Ns({vertexColors:b});Fs.call(this,m,g)}function Ic(t,e,r,n){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==r?r:16776960,o=void 0!==n?n:1,s=0,a=this.object.geometry;a&&a.isGeometry?s=a.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new Pi,l=new Si(2*s*3,3);u.addAttribute("position",l),Fs.call(this,u,new Ns({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function Dc(t,e,r){li.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,void 0===e&&(e=1);var n=new Pi;n.addAttribute("position",new Si([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new Ns({fog:!1});this.lightPlane=new ks(n,i),this.add(this.lightPlane),n=new Pi,n.addAttribute("position",new Si([0,0,0,0,0,1],3)),this.targetLine=new ks(n,i),this.add(this.targetLine),this.update()}function Nc(t){var e=new Pi,r=new Ns({color:16777215,vertexColors:w}),n=[],i=[],o={},s=new ri(16755200),a=new ri(16711680),u=new ri(43775),l=new ri(16777215),c=new ri(3355443);function h(t,e,r){d(t,r),d(e,r)}function d(t,e){n.push(0,0,0),i.push(e.r,e.g,e.b),void 0===o[t]&&(o[t]=[]),o[t].push(n.length/3-1)}h("n1","n2",s),h("n2","n4",s),h("n4","n3",s),h("n3","n1",s),h("f1","f2",s),h("f2","f4",s),h("f4","f3",s),h("f3","f1",s),h("n1","f1",s),h("n2","f2",s),h("n3","f3",s),h("n4","f4",s),h("p","n1",a),h("p","n2",a),h("p","n3",a),h("p","n4",a),h("u1","u2",u),h("u2","u3",u),h("u3","u1",u),h("c","t",l),h("p","c",c),h("cn1","cn2",c),h("cn3","cn4",c),h("cf1","cf2",c),h("cf3","cf4",c),e.addAttribute("position",new Si(n,3)),e.addAttribute("color",new Si(i,3)),Fs.call(this,e,r),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update()}function kc(t,e){this.object=t,void 0===e&&(e=16776960);var r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),i=new Pi;i.setIndex(new mi(r,1)),i.addAttribute("position",new mi(n,3)),Fs.call(this,i,new Ns({color:e})),this.matrixAutoUpdate=!1,this.update()}function Fc(t,e){this.type="Box3Helper",this.box=t;var r=void 0!==e?e:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new Pi;o.setIndex(new mi(n,1)),o.addAttribute("position",new Si(i,3)),Fs.call(this,o,new Ns({color:r})),this.geometry.computeBoundingSphere()}function Vc(t,e,r){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var n=void 0!==r?r:16776960,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new Pi;o.addAttribute("position",new Si(i,3)),o.computeBoundingSphere(),ks.call(this,o,new Ns({color:n}));var s=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],a=new Pi;a.addAttribute("position",new Si(s,3)),a.computeBoundingSphere(),this.add(new Ui(a,new Ni({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function zc(t,e,r,n,i,o){li.call(this),void 0===n&&(n=16776960),void 0===r&&(r=1),void 0===i&&(i=.2*r),void 0===o&&(o=.2*i),void 0===rc&&(rc=new Pi,rc.addAttribute("position",new Si([0,0,0,0,1,0],3)),nc=new iu(0,.5,1,5,1),nc.translate(0,-.5,0)),this.position.copy(e),this.line=new ks(rc,new Ns({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ui(nc,new Ni({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(r,i,o)}function Uc(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new Pi;n.addAttribute("position",new Si(e,3)),n.addAttribute("color",new Si(r,3));var i=new Ns({vertexColors:b});Fs.call(this,n,i)}Object.assign(oc.prototype,{getValue:function(t,e){this.bind();var r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var r=this._bindings,n=this._targetGroup.nCachedObjects_,i=r.length;n!==i;++n)r[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}),Object.assign(sc,{Composite:oc,create:function(t,e,r){return t&&t.isAnimationObjectGroup?new sc.Composite(t,e,r):new sc(t,e,r)},sanitizeNodeName:function(){var t=new RegExp("["+ic+"]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+ic+"]",e="[^"+ic.replace("\\.","")+"]",r=/((?:WC+[\/:])*)/.source.replace("WC",t),n=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),s=new RegExp("^"+r+n+i+o+"$"),a=["material","materials","bones"];return function(t){var e=s.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var i=r.nodeName.substring(n+1);-1!==a.indexOf(i)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=i)}if(null===r.propertyName||0===r.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var r=t.skeleton.getBoneByName(e);if(void 0!==r)return r}if(t.children){var n=function(t){for(var r=0;r<t.length;r++){var i=t[r];if(i.name===e||i.uuid===e)return i;var o=n(i.children);if(o)return o}return null},i=n(t.children);if(i)return i}return null}}),Object.assign(sc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)t[e++]=r[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++]},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var r=this.resolvedProperty,n=0,i=r.length;n!==i;++n)r[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,r=e.objectName,n=e.propertyName,i=e.propertyIndex;if(t||(t=sc.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=e.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var a=t[n];if(void 0!==a){var u=this.Versioning.None;void 0!==t.needsUpdate?(u=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(u=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(s=0;s<this.node.geometry.morphAttributes.position.length;s++)if(t.geometry.morphAttributes.position[s].name===i){i=s;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(s=0;s<this.node.geometry.morphTargets.length;s++)if(t.geometry.morphTargets[s].name===i){i=s;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=i}else void 0!==a.fromArray&&void 0!==a.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]}else{var c=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(sc.prototype,{_getValue_unbound:sc.prototype.getValue,_setValue_unbound:sc.prototype.setValue}),Object.assign(ac.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._paths,o=this._parsedPaths,s=this._bindings,a=s.length,u=void 0,l=0,c=arguments.length;l!==c;++l){var h=arguments[l],d=h.uuid,p=n[d];if(void 0===p){p=e++,n[d]=p,t.push(h);for(var f=0,m=a;f!==m;++f)s[f].push(new sc(h,i[f],o[f]))}else if(p<r){u=t[p];var g=--r,v=t[g];n[v.uuid]=p,t[p]=v,n[d]=g,t[g]=h;for(f=0,m=a;f!==m;++f){var y=s[f],w=y[g],b=y[p];y[p]=w,void 0===b&&(b=new sc(h,i[f],o[f])),y[g]=b}}else t[p]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=r},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,r=this._indicesByUUID,n=this._bindings,i=n.length,o=0,s=arguments.length;o!==s;++o){var a=arguments[o],u=a.uuid,l=r[u];if(void 0!==l&&l>=e){var c=e++,h=t[c];r[h.uuid]=l,t[l]=h,r[u]=c,t[c]=a;for(var d=0,p=i;d!==p;++d){var f=n[d],m=f[c],g=f[l];f[l]=m,f[c]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,r=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,o=i.length,s=0,a=arguments.length;s!==a;++s){var u=arguments[s],l=u.uuid,c=n[l];if(void 0!==c)if(delete n[l],c<r){var h=--r,d=t[h],p=--e,f=t[p];n[d.uuid]=c,t[c]=d,n[f.uuid]=h,t[h]=f,t.pop();for(var m=0,g=o;m!==g;++m){var v=i[m],y=v[h],w=v[p];v[c]=y,v[h]=w,v.pop()}}else{p=--e,f=t[p];n[f.uuid]=c,t[c]=f,t.pop();for(m=0,g=o;m!==g;++m){v=i[m];v[c]=v[p],v.pop()}}}this.nCachedObjects_=r},subscribe_:function(t,e){var r=this._bindingsIndicesByPath,n=r[t],i=this._bindings;if(void 0!==n)return i[n];var o=this._paths,s=this._parsedPaths,a=this._objects,u=a.length,l=this.nCachedObjects_,c=new Array(u);n=i.length,r[t]=n,o.push(t),s.push(e),i.push(c);for(var h=l,d=a.length;h!==d;++h){var p=a[h];c[h]=new sc(p,t,e)}return c},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,r=e[t];if(void 0!==r){var n=this._paths,i=this._parsedPaths,o=this._bindings,s=o.length-1,a=o[s],u=t[s];e[u]=r,o[r]=a,o.pop(),i[r]=i[s],i.pop(),n[r]=n[s],n.pop()}}}),Object.assign(uc.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,r){if(t.fadeOut(e),this.fadeIn(e),r){var n=this._clip.duration,i=t._clip.duration,o=i/n,s=n/i;t.warp(1,o,e),this.warp(s,1,e)}return this},crossFadeTo:function(t,e,r){return t.crossFadeFrom(this,e,r)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,r){var n=this._mixer,i=n.time,o=this._timeScaleInterpolant,s=this.timeScale;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);var a=o.parameterPositions,u=o.sampleValues;return a[0]=i,a[1]=i+r,u[0]=t/s,u[1]=e/s,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,r,n){if(this.enabled){var i=this._startTime;if(null!==i){var o=(t-i)*r;if(o<0||0===r)return;this._startTime=null,e=r*o}e*=this._updateTimeScale(t);var s=this._updateTime(e),a=this._updateWeight(t);if(a>0)for(var u=this._interpolants,l=this._propertyBindings,c=0,h=u.length;c!==h;++c)u[c].evaluate(s),l[c].accumulate(n,a)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var r=this._weightInterpolant;if(null!==r){var n=r.evaluate(t)[0];e*=n,t>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var r=this._timeScaleInterpolant;if(null!==r){var n=r.evaluate(t)[0];e*=n,t>r.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var r=this._clip.duration,n=this.loop,i=this._loopCount;if(n===ce){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=r)e=r;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=n===de;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=r||e<0){var s=Math.floor(e/r);e-=r*s,i+=Math.abs(s);var a=this.repetitions-i;if(a<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?r:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===a){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s})}}if(o&&1===(1&i))return this.time=e,r-e}return this.time=e,e},_setEndings:function(t,e,r){var n=this._interpolantSettings;r?(n.endingStart=ve,n.endingEnd=ve):(n.endingStart=t?this.zeroSlopeAtStart?ve:ge:ye,n.endingEnd=e?this.zeroSlopeAtEnd?ve:ge:ye)},_scheduleFading:function(t,e,r){var n=this._mixer,i=n.time,o=this._weightInterpolant;null===o&&(o=n._lendControlInterpolant(),this._weightInterpolant=o);var s=o.parameterPositions,a=o.sampleValues;return s[0]=i,a[0]=e,s[1]=i+t,a[1]=r,this}}),lc.prototype=Object.assign(Object.create(a.prototype),{constructor:lc,_bindAction:function(t,e){var r=t._localRoot||this._root,n=t._clip.tracks,i=n.length,o=t._propertyBindings,s=t._interpolants,a=r.uuid,u=this._bindingsByRootAndName,l=u[a];void 0===l&&(l={},u[a]=l);for(var c=0;c!==i;++c){var h=n[c],d=h.name,p=l[d];if(void 0!==p)o[c]=p;else{if(p=o[c],void 0!==p){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,a,d));continue}var f=e&&e._propertyBindings[c].binding.parsedPath;p=new ec(sc.create(r,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,a,d),o[c]=p}s[c].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,r=t._clip.uuid,n=this._actionsByClip[r];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,r,e)}for(var i=t._propertyBindings,o=0,s=i.length;o!==s;++o){var a=i[o];0===a.useCount++&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,r){var n=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var s=o.knownActions;t._byClipCacheIndex=s.length,s.push(t)}t._cacheIndex=n.length,n.push(t),o.actionByRoot[r]=t},_removeInactiveAction:function(t){var e=this._actions,r=e[e.length-1],n=t._cacheIndex;r._cacheIndex=n,e[n]=r,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,s=o[i],a=s.knownActions,u=a[a.length-1],l=t._byClipCacheIndex;u._byClipCacheIndex=l,a[l]=u,a.pop(),t._byClipCacheIndex=null;var c=s.actionByRoot,h=(t._localRoot||this._root).uuid;delete c[h],0===a.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,r=0,n=e.length;r!==n;++r){var i=e[r];0===--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,r=t._cacheIndex,n=this._nActiveActions++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_takeBackAction:function(t){var e=this._actions,r=t._cacheIndex,n=--this._nActiveActions,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_addInactiveBinding:function(t,e,r){var n=this._bindingsByRootAndName,i=n[e],o=this._bindings;void 0===i&&(i={},n[e]=i),i[r]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,r=t.binding,n=r.rootNode.uuid,i=r.path,o=this._bindingsByRootAndName,s=o[n],a=e[e.length-1],u=t._cacheIndex;a._cacheIndex=u,e[u]=a,e.pop(),delete s[i];t:{for(var l in s)break t;delete o[n]}},_lendBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=this._nActiveBindings++,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_takeBackBinding:function(t){var e=this._bindings,r=t._cacheIndex,n=--this._nActiveBindings,i=e[n];t._cacheIndex=n,e[n]=t,i._cacheIndex=r,e[r]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,r=t[e];return void 0===r&&(r=new Ml(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),r.__cacheIndex=e,t[e]=r),r},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,r=t.__cacheIndex,n=--this._nActiveControlInterpolants,i=e[n];t.__cacheIndex=n,e[n]=t,i.__cacheIndex=r,e[r]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var r=e||this._root,n=r.uuid,i="string"===typeof t?Cl.findByName(r,t):t,o=null!==i?i.uuid:t,s=this._actionsByClip[o],a=null;if(void 0!==s){var u=s.actionByRoot[n];if(void 0!==u)return u;a=s.knownActions[0],null===i&&(i=a._clip)}if(null===i)return null;var l=new uc(this,i,e);return this._bindAction(l,a),this._addInactiveAction(l,o,n),l},existingAction:function(t,e){var r=e||this._root,n=r.uuid,i="string"===typeof t?Cl.findByName(r,t):t,o=i?i.uuid:t,s=this._actionsByClip[o];return void 0!==s&&s.actionByRoot[n]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,r=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(i=0;i!==n;++i)r[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,r=this._nActiveActions,n=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,s=0;s!==r;++s){var a=e[s];a._update(n,t,i,o)}var u=this._bindings,l=this._nActiveBindings;for(s=0;s!==l;++s)u[s].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,r=t.uuid,n=this._actionsByClip,i=n[r];if(void 0!==i){for(var o=i.knownActions,s=0,a=o.length;s!==a;++s){var u=o[s];this._deactivateAction(u);var l=u._cacheIndex,c=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,c._cacheIndex=l,e[l]=c,e.pop(),this._removeInactiveBindingsForAction(u)}delete n[r]}},uncacheRoot:function(t){var e=t.uuid,r=this._actionsByClip;for(var n in r){var i=r[n].actionByRoot,o=i[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var s=this._bindingsByRootAndName,a=s[e];if(void 0!==a)for(var u in a){var l=a[u];l.restoreOriginalState(),this._removeInactiveBinding(l)}},uncacheAction:function(t,e){var r=this.existingAction(t,e);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}}),cc.prototype.clone=function(){return new cc(void 0===this.value.clone?this.value:this.value.clone())},hc.prototype=Object.assign(Object.create(Pi.prototype),{constructor:hc,isInstancedBufferGeometry:!0,copy:function(t){return Pi.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(dc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(dc.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this},setXYZ:function(t,e,r,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this},setXYZW:function(t,e,r,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=r,this.data.array[t+2]=n,this.data.array[t+3]=i,this}}),Object.defineProperty(pc.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(pc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,r){t*=this.stride,r*=e.stride;for(var n=0,i=this.stride;n<i;n++)this.array[t+n]=e.array[r+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),fc.prototype=Object.assign(Object.create(pc.prototype),{constructor:fc,isInstancedInterleavedBuffer:!0,copy:function(t){return pc.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),mc.prototype=Object.assign(Object.create(mi.prototype),{constructor:mc,isInstancedBufferAttribute:!0,copy:function(t){return mi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(gc.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,r){var n=r||[];return yc(t,this,n,e),n.sort(vc),n},intersectObjects:function(t,e,r){var n=r||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),n;for(var i=0,o=t.length;i<o;i++)yc(t[i],this,n,e);return n.sort(vc),n}}),Object.assign(wc.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"===typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(bc.prototype,{set:function(t,e,r){return this.radius=t,this.phi=e,this.theta=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Le.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(xc.prototype,{set:function(t,e,r){return this.radius=t,this.theta=e,this.y=r,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign(_c.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Oe;return function(e,r){var n=t.copy(r).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new Oe),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new Oe),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new Oe),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new Oe),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Oe;return function(e){var r=t.copy(e).clamp(this.min,this.max);return r.sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Sc.prototype=Object.create(li.prototype),Sc.prototype.constructor=Sc,Sc.prototype.isImmediateRenderObject=!0,Mc.prototype=Object.create(Fs.prototype),Mc.prototype.constructor=Mc,Mc.prototype.update=function(){var t=new Ne,e=new Ne,r=new ke;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,s=this.object.geometry;if(s&&s.isGeometry)for(var a=s.vertices,u=s.faces,l=0,c=0,h=u.length;c<h;c++)for(var d=u[c],p=0,f=d.vertexNormals.length;p<f;p++){var m=a[d[n[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(i),e.copy(g).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}else if(s&&s.isBufferGeometry){var v=s.attributes.position,y=s.attributes.normal;for(l=0,p=0,f=v.count;p<f;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(i),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),o.setXYZ(l,t.x,t.y,t.z),l+=1,o.setXYZ(l,e.x,e.y,e.z),l+=1}o.needsUpdate=!0}}(),Ec.prototype=Object.create(li.prototype),Ec.prototype.constructor=Ec,Ec.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Ec.prototype.update=function(){var t=new Ne,e=new Ne;return function(){this.light.updateMatrixWorld();var r=this.light.distance?this.light.distance:1e3,n=r*Math.tan(this.light.angle);this.cone.scale.set(n,n,r),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Ac.prototype=Object.create(Fs.prototype),Ac.prototype.constructor=Ac,Ac.prototype.updateMatrixWorld=function(){var t=new Ne,e=new Ie,r=new Ie;return function(n){var i=this.bones,o=this.geometry,s=o.getAttribute("position");r.getInverse(this.root.matrixWorld);for(var a=0,u=0;a<i.length;a++){var l=i[a];l.parent&&l.parent.isBone&&(e.multiplyMatrices(r,l.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(u,t.x,t.y,t.z),e.multiplyMatrices(r,l.parent.matrixWorld),t.setFromMatrixPosition(e),s.setXYZ(u+1,t.x,t.y,t.z),u+=2)}o.getAttribute("position").needsUpdate=!0,li.prototype.updateMatrixWorld.call(this,n)}}(),Pc.prototype=Object.create(Ui.prototype),Pc.prototype.constructor=Pc,Pc.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Pc.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Cc.prototype=Object.create(li.prototype),Cc.prototype.constructor=Cc,Cc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Cc.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,r=this.line.geometry.attributes.position,n=r.array;n[0]=t,n[1]=-e,n[2]=0,n[3]=t,n[4]=e,n[5]=0,n[6]=-t,n[7]=e,n[8]=0,n[9]=-t,n[10]=-e,n[11]=0,n[12]=t,n[13]=-e,n[14]=0,r.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Rc.prototype=Object.create(li.prototype),Rc.prototype.constructor=Rc,Rc.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Rc.prototype.update=function(){var t=new Ne,e=new ri,r=new ri;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=n.geometry.getAttribute("color");e.copy(this.light.color),r.copy(this.light.groundColor);for(var o=0,s=i.count;o<s;o++){var a=o<s/2?e:r;i.setXYZ(o,a.r,a.g,a.b)}i.needsUpdate=!0}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Lc.prototype=Object.create(Fs.prototype),Lc.prototype.constructor=Lc,Oc.prototype=Object.create(Fs.prototype),Oc.prototype.constructor=Oc,Ic.prototype=Object.create(Fs.prototype),Ic.prototype.constructor=Ic,Ic.prototype.update=function(){var t=new Ne,e=new Ne,r=new ke;return function(){this.object.updateMatrixWorld(!0),r.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,s=o.vertices,a=o.faces,u=0,l=0,c=a.length;l<c;l++){var h=a[l],d=h.normal;t.copy(s[h.a]).add(s[h.b]).add(s[h.c]).divideScalar(3).applyMatrix4(n),e.copy(d).applyMatrix3(r).normalize().multiplyScalar(this.size).add(t),i.setXYZ(u,t.x,t.y,t.z),u+=1,i.setXYZ(u,e.x,e.y,e.z),u+=1}i.needsUpdate=!0}}(),Dc.prototype=Object.create(li.prototype),Dc.prototype.constructor=Dc,Dc.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Dc.prototype.update=function(){var t=new Ne,e=new Ne,r=new Ne;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),r.subVectors(e,t),this.lightPlane.lookAt(r),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(r),this.targetLine.scale.z=r.length()}}(),Nc.prototype=Object.create(Fs.prototype),Nc.prototype.constructor=Nc,Nc.prototype.update=function(){var t,e,r=new Ne,n=new ci;function i(i,o,s,a){r.set(o,s,a).unproject(n);var u=e[i];if(void 0!==u)for(var l=t.getAttribute("position"),c=0,h=u.length;c<h;c++)l.setXYZ(u[c],r.x,r.y,r.z)}return function(){t=this.geometry,e=this.pointMap;var r=1,o=1;n.projectionMatrix.copy(this.camera.projectionMatrix),i("c",0,0,-1),i("t",0,0,1),i("n1",-r,-o,-1),i("n2",r,-o,-1),i("n3",-r,o,-1),i("n4",r,o,-1),i("f1",-r,-o,1),i("f2",r,-o,1),i("f3",-r,o,1),i("f4",r,o,1),i("u1",.7*r,1.1*o,-1),i("u2",.7*-r,1.1*o,-1),i("u3",0,2*o,-1),i("cf1",-r,0,1),i("cf2",r,0,1),i("cf3",0,-o,1),i("cf4",0,o,1),i("cn1",-r,0,-1),i("cn2",r,0,-1),i("cn3",0,-o,-1),i("cn4",0,o,-1),t.getAttribute("position").needsUpdate=!0}}(),kc.prototype=Object.create(Fs.prototype),kc.prototype.constructor=kc,kc.prototype.update=function(){var t=new He;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var r=t.min,n=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=n.x,o[1]=n.y,o[2]=n.z,o[3]=r.x,o[4]=n.y,o[5]=n.z,o[6]=r.x,o[7]=r.y,o[8]=n.z,o[9]=n.x,o[10]=r.y,o[11]=n.z,o[12]=n.x,o[13]=n.y,o[14]=r.z,o[15]=r.x,o[16]=n.y,o[17]=r.z,o[18]=r.x,o[19]=r.y,o[20]=r.z,o[21]=n.x,o[22]=r.y,o[23]=r.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),kc.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Fc.prototype=Object.create(Fs.prototype),Fc.prototype.constructor=Fc,Fc.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),li.prototype.updateMatrixWorld.call(this,t))},Vc.prototype=Object.create(ks.prototype),Vc.prototype.constructor=Vc,Vc.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),li.prototype.updateMatrixWorld.call(this,t)},zc.prototype=Object.create(li.prototype),zc.prototype.constructor=zc,zc.prototype.setDirection=function(){var t,e=new Ne;return function(r){r.y>.99999?this.quaternion.set(0,0,0,1):r.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(r.z,0,-r.x).normalize(),t=Math.acos(r.y),this.quaternion.setFromAxisAngle(e,t))}}(),zc.prototype.setLength=function(t,e,r){void 0===e&&(e=.2*t),void 0===r&&(r=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(r,e,r),this.cone.position.y=t,this.cone.updateMatrix()},zc.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Uc.prototype=Object.create(Fs.prototype),Uc.prototype.constructor=Uc;function jc(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Vu.call(this,t),this.type="catmullrom",this.closed=!0}function Bc(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Vu.call(this,t),this.type="catmullrom"}function Hc(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Vu.call(this,t),this.type="catmullrom"}Ru.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Ru.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(nl.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new fi,r=0,n=t.length;r<n;r++){var i=t[r];e.vertices.push(new Ne(i.x,i.y,i.z||0))}return e}}),Object.assign(il.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),jc.prototype=Object.create(Vu.prototype),Bc.prototype=Object.create(Vu.prototype),Hc.prototype=Object.create(Vu.prototype),Object.assign(Hc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Lc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ac.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Il.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Dl.extractUrlBase(t)}}),Object.assign(_c.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(He.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Vi.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Le,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Le.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Le.ceilPowerOfTwo(t)}}),Object.assign(ke.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ie.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new Ne),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,r,n,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,r,i,o)}}),qe.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},De.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Fi.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(zi.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(zi,{barycoordFromPoint:function(t,e,r,n,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),zi.getBarycoord(t,e,r,n,i)},normal:function(t,e,r,n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),zi.getNormal(t,e,r,n)}}),Object.assign(ol.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ba(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Ka(this,t)}}),Object.assign(Oe.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ne.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,r){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ze.prototype,{fromAttribute:function(t,e,r){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,r)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(fi.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(li.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(li.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Ls.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Os.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(Ru.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),_s.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(sl.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(mi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(Pi.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,r){void 0!==r&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(Pi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Ha.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(cc.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Di.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ri}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===v}}}),Object.defineProperties(fu.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ki.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Es.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Es.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(gs.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ue.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Ms.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ql.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this,r=new Xl;return r.load(t,(function(t){e.setBuffer(t)})),this},tc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Zl.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};const Gc=1e-6;function qc(t){return Math.abs(t)<Gc}function Wc(t,e,r){return new Ne(t,e,r)}function $c(t){return t.clone()}function Xc(t,e){let r=Wc(t.x,t.y,t.z);return r.multiplyScalar(e),r}function Yc(t){return Xc(t,1/t.length())}function Zc(t,e){return Wc(t.x-e.x,t.y-e.y,t.z-e.z)}function Jc(t,e){return Wc(e.x+t.x,e.y+t.y,e.z+t.z)}function Qc(t,e){let r,n=e.length();if(qc(n))r=Wc(t.x,t.y,t.z);else{let i=eh(t,e)/n/n;r=Xc(e,i)}return r}function Kc(t,e){return Zc(t,Qc(t,e))}function th(t,e){return(new Ne).crossVectors(t,e)}function eh(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function rh(t,e){return Zc(t,e).length()}function nh(t,e){let r=t.length(),n=e.length();if(qc(r*n))return 0;let i=eh(t,e)/r/n;return i>=1?0:i<-1?Math.PI:Math.acos(i)}function ih(t,e,r){let n=Kc(t,e),i=Kc(r,e),o=nh(n,i),s=th(n,i);return eh(s,e)>0&&(o=-o),o}function oh(t,e){let r=Jc(t,e);return Xc(r,.5)}function sh(){return Wc(Math.random(),Math.random(),Math.random())}function ah(t,e){return!!qc(t.x-e.x)&&(!!qc(t.y-e.y)&&!!qc(t.y-e.y))}function uh(t,e){return qc(nh(t,e))}let lh=Ie;function ch(t,e){let r=new lh;return r.multiplyMatrices(t,e),r}function hh(t,e){let r=t.clone().normalize();return(new lh).makeRotationAxis(r,e)}function dh(t){let e=new lh;return e.makeTranslation(t.x,t.y,t.z)}function ph(t){return t*Math.PI/180}var fh={SMALL:Gc,isNearZero:qc,create:Wc,clone:$c,scaled:Xc,normalized:Yc,diff:Zc,sum:Jc,parallel:Qc,perpendicular:Kc,crossProduct:th,dotProduct:eh,distance:rh,angle:nh,dihedral:ih,midPoint:oh,random:sh,isEqual:ah,isAligned:uh,Matrix4:lh,matrixProduct:ch,rotation:hh,translation:dh,degToRad:ph};function mh(t){return!s.a.isNil(t)}function gh(t,e,r){return i()("<span>").html(t).addClass(e).on("click touch",(function(t){t.preventDefault(),r()}))}function vh(t,e,r,n){e.css({position:"absolute","z-index":"2"});let i=t.position().top,o=t.position().left;i=0,o=0;let s=t.outerWidth(),a=t.outerHeight();t.prepend(e);let u=e.outerWidth(),l=e.outerHeight();e.css({top:i+a/2-l/2-n,left:o+s/2-u/2-r})}function yh(t,e){return e.indexOf(t)>=0}function wh(t){let e="0123456789abcdefghiklmnopqrstuvwxyz",r="";for(let n=0;n<t;n++){let t=Math.floor(Math.random()*e.length);r+=e.substring(t,t+1)}return r}function bh(){return"view:"+wh(6)}function xh(t,e,r){function n(){h.remove(),window.keyboardLock=!1}function o(){r(l.val()),n(),window.keyboardLock=!1}function s(){n(),window.keyboardLock=!1}e||(e=""),window.keyboardLock=!0;let a=gh("okay","jolecule-small-button",o),u=gh("discard","jolecule-small-button",s),l=i()("<textarea>").css("width","100%").css("margin-bottom","0.5em").addClass("jolecule-view-text").keydown((function(t){if(27===t.keyCode)return s(),!0})),c=i()("<div>").css("width","100%").append(e).append(l).append(a).append(" ").append(u),h=i()("<div>").addClass("jolecule-dialog").css("display","block").css("z-index","2000").css("width",Math.min(400,t.width()-100)).append(c);vh(t,h,0,20),setTimeout(()=>{c.find("textarea").focus()},100)}function _h(t){return new Promise(e=>{setTimeout(e,t)})}function Sh(t){let e=document.createElement("textarea");e.style.position="fixed",e.style.top=0,e.style.left=0,e.style.width="2em",e.style.height="2em",e.style.padding=0,e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",e.value=t,document.body.appendChild(e),e.select();try{let t=document.execCommand("copy"),e=t?"successful":"unsuccessful";console.log("> copyTextToClipboard",e)}catch(r){console.log("> copyTextToClipboard failed")}document.body.removeChild(e)}function Mh(t,e,r,n,i){let o=.5*(n-e),s=.5*(i-r),a=t*t,u=t*a;return(2*r-2*n+o+s)*u+(-3*r+3*n-2*o-s)*a+o*t+r}function Eh(t,e,r,n,i){return fh.create(Mh(t,e.x,r.x,n.x,i.x),Mh(t,e.y,r.y,n.y,i.y),Mh(t,e.z,r.z,n.z,i.z))}class Th{constructor(){this.points=[],this.normals=[],this.tangents=[],this.binormals=[],this.colors=[],this.indexColors=[],this.segmentTypes=[],this.refIndices=[]}slice(t,e){let r=new Th;return r.points=this.points.slice(t,e),r.normals=this.normals.slice(t,e),r.tangents=this.tangents.slice(t,e),r.binormals=this.binormals.slice(t,e),r}}function Ah(t,e,r,n){let i=new Th;i.points.push(t.points[r]);for(let o=r;o<n-1;o+=1){let r=1,n=e+1;for(let s=r;s<n;s+=1){let r,n,a=s/e;r=o>0?t.points[o-1]:t.points[o].clone().sub(t.tangents[o]),n=o<t.points.length-2?t.points[o+2]:t.points[o+1].clone().add(t.tangents[o]),i.points.push(Eh(a,r,t.points[o],t.points[o+1],n))}}i.normals.push(t.normals[r]);for(let o=r;o<n-1;o+=1)for(let r=1;r<e+1;r+=1){let n,s,a=r/e;n=o>0?t.normals[o-1]:t.normals[o],s=o<t.normals.length-2?t.normals[o+2]:t.normals[o+1],i.normals.push(Eh(a,n,t.normals[o],t.normals[o+1],s).normalize())}for(let o=0;o<i.points.length;o+=1)0===o?i.tangents.push(t.tangents[0]):o===i.points.length-1?i.tangents.push(t.tangents[n-1]):i.tangents.push(i.points[o+1].clone().sub(i.points[o-1]).normalize());for(let o=0;o<i.points.length;o+=1)i.binormals.push(fh.create().crossVectors(i.tangents[o],i.normals[o]));return i}class Ph extends Th{constructor(){super(),this.indices=[],this.detail=4}getReference(t){let e=this.indices[t];return this.referenceObjects[e]}calcTangents(){let t=0,e=this.points.length,r=e-1;if(e-t>2){this.tangents[t]=this.points[t+1].clone().sub(this.points[t]).normalize();for(let e=t+1;e<r;e+=1)this.tangents[e]=this.points[e+1].clone().sub(this.points[e-1]).normalize();this.tangents[r]=this.points[r].clone().sub(this.points[r-1]).normalize()}else{let e=this.points[r].clone().sub(this.points[t]).normalize();this.tangents[t]=e,this.tangents[r]=e}}calcNormals(){let t=0,e=this.points.length,r=e-1;if(e-t>2){for(let e=t+1;e<r;e+=1)if(null!==this.normals[e])this.normals[e]=Dh(this.tangents[e],this.normals[e]),this.normals[e].normalize();else{let t=this.points[e].clone().sub(this.points[e-1]);this.normals[e]=fh.create().crossVectors(t,this.tangents[e]).normalize();let r=this.normals[e-1];null!==r&&this.normals[e].dot(r)<0&&this.normals[e].negate()}this.normals[t]=this.normals[t+1],this.normals[r]=this.normals[r-1]}else for(let n=t;n<=r;n+=1)if(null!==this.normals[n])this.normals[n]=Dh(this.tangents[n],this.normals[n]),this.normals[n].normalize();else{let t=this.points[n];this.normals[n]=fh.create().crossVectors(t,this.tangents[n]).normalize()}}calcBinormals(){let t=0,e=this.points.length;for(let r=t;r<e;r+=1)this.binormals[r]=fh.create().crossVectors(this.tangents[r],this.normals[r])}expand(){this.detailedPath=Ah(this,2*this.detail,0,this.points.length)}getGeometry(t,e,r,n,i){let o=this.detailedPath,s=0,a=this.points.length,u=2*s*this.detail-this.detail;u<0&&(u=0);let l=2*a*this.detail-this.detail+1;l>=o.points.length&&(l=o.points.length-1);let c=o.slice(u,l),h=new Ch(this,c,e,r,n,i);return h}}class Ch extends Pi{constructor(t,e,r=!1){super(),this.type="BufferRibbonGeometry",this.parameters={shape:e,traces:t,isIndexColor:r},this.shapePoints=e.extractPoints(4).shape,this.nShape=this.shapePoints.length,this.nVertex=0,this.nFace=0,this.countVertexAndFacesOfPath(),this.setAttributes(),this.build(),this.setColors()}countVertexAndFacesOfPath(){this.nVertex=0,this.nFace=0,this.paths=[];for(let t of this.parameters.traces){let e=t.detailedPath;this.paths.push(e);let r=e.points.length;this.nVertex+=(r+t.points.length-1)*this.nShape,this.nVertex+=this.nShape,this.nVertex+=this.nShape;let n=t.points.length;this.nFace+=2*(n-1)*this.nShape*(2*t.detail+1),this.nFace+=this.nShape-2,this.nFace+=this.nShape-2,this.nVertex=3*this.nFace}}build(){for(let n of s.a.range(this.paths.length)){let i=this.paths[n],o=this.parameters.traces[n],a=0,u=o.points.length;function t(t){return"C"===o.segmentTypes[t]?.7:8}let l=null,c=null,h=null,d=null,p=!0;for(let n=a;n<u;n+=1){let f=2*n*o.detail-o.detail;f<0&&(f=0);let m=2*(n+1)*o.detail-o.detail+1;m>=i.points.length&&(m=i.points.length);for(let g=f;g<m;g+=1){let v=t(n),y=.7;if(g===f&&g>0&&"C"===o.segmentTypes[n-1]&&"C"!==o.segmentTypes[n]&&(v=t(n-1)),g===m-1&&n<o.points.length-1){let e=n+1;"C"===o.segmentTypes[e]&&"C"!==o.segmentTypes[n]&&(v=t(e))}p="C"!==o.segmentTypes[n];let w=i.points[g],b=i.normals[g],x=i.binormals[g],_=s.a.cloneDeep(this.shapePoints);for(let t of _)t.x=t.x*v,t.y=t.y*y;l=[];for(let t of _){let e=b.clone().multiplyScalar(t.x),r=x.clone().multiplyScalar(t.y),n=w.clone().add(e).add(r);l.push(n)}let S=0===g&&n===a;if(S){let t=_.length,e=t-1,r=Nh([l[0],l[1],l[e]]);for(let n=0;n<t-2;n+=1)this.pushVerticesNormalsOfFace(l[n],l[n+1],l[e],r,r,r)}function e(t){let e,r,n=_.length,o=[],s=new Oe,a=new Oe,u=new Oe;for(let l=0;l<n;l+=1){let c=l>0?l-1:n-1,h=l+1<n?l+1:0,d=_[l];s.subVectors(d,_[c]).normalize(),a.subVectors(d,_[h]).normalize(),u.addVectors(s,a).normalize(),e=i.normals[t].clone().multiplyScalar(u.x),r=i.binormals[t].clone().multiplyScalar(u.y),o.push(e.add(r))}return o}function r(t){let e,r,n=_.length,o=[],s=new Oe;for(let a=0;a<n;a+=1){let u=a>0?a-1:n-1,l=_[a];s.subVectors(l,_[u]).normalize(),e=i.normals[t].clone().multiplyScalar(s.x),r=i.binormals[t].clone().multiplyScalar(s.y),o.push(e.add(r))}return o}if(h=p?r(g):e(g),0===g){d=h,c=l;continue}for(let t=0;t<this.nShape;t+=1){let e;e=0===t?this.nShape-1:t-1,p?(this.pushVerticesNormalsOfFace(c[e],l[e],l[t],d[e],h[e],h[e]),this.pushVerticesNormalsOfFace(c[t],c[e],l[t],d[e],d[e],h[e])):(this.pushVerticesNormalsOfFace(c[e],l[e],l[t],d[e],h[e],h[t]),this.pushVerticesNormalsOfFace(c[t],c[e],l[t],d[t],d[e],h[t]))}let M=g===m-1&&n===u-1;if(M){let t=_.length,e=t-1,r=Nh([l[2],l[1],l[0]]);for(let n=0;n<t-2;n+=1)this.pushVerticesNormalsOfFace(l[e],l[n+1],l[n],r,r,r)}d=h,c=l}}}}setColors(){let t=0;for(let e of s.a.range(this.paths.length)){let r=this.paths[e],n=this.parameters.traces[e],i=0,o=n.points.length;for(let e=i;e<o;e+=1){let s=2*e*n.detail-n.detail;s<0&&(s=0);let a=2*(e+1)*n.detail-n.detail+1;a>=r.points.length&&(a=r.points.length);for(let r=s;r<a;r+=1){let s,u=this.shapePoints.length;s=this.parameters.isIndexColor?n.indexColors[e]:n.colors[e].clone();let l=0===r&&e===i;if(l)for(let e=0;e<3*(u-2);e+=1)this.setColor(t,s),t+=1;if(r>0)for(let e=0;e<6*u;e+=1)this.setColor(t,s),t+=1;let c=r===a-1&&e===o-1;if(c)for(let e=0;e<3*(u-2);e+=1)this.setColor(t,s),t+=1}}}this.attributes.color.needsUpdate=!0}setAttributes(){let t=new Float32Array(3*this.nVertex),e=new Float32Array(3*this.nVertex),r=new Int32Array(3*this.nFace),n=new Float32Array(3*this.nVertex);this.addAttribute("position",new Si(t,3)),this.addAttribute("normal",new Si(e,3)),this.addAttribute("color",new Si(n,3)),this.setIndex(new _i(r,1)),this.positions=this.attributes.position.array,this.normals=this.attributes.normal.array,this.indices=this.index.array,this.colors=this.attributes.color.array,this.positionCount=0,this.indexCount=0,this.vertexCount=0}setColor(t,e){let r=3*t;this.colors[r]=e.r,this.colors[r+1]=e.g,this.colors[r+2]=e.b}pushVertex(t){this.positions[this.positionCount]=t.x,this.positions[this.positionCount+1]=t.y,this.positions[this.positionCount+2]=t.z,this.positionCount+=3,this.vertexCount+=1}pushVerticesNormalsOfFace(t,e,r,n,i,o){this.pushVertex(t),this.pushVertex(e),this.pushVertex(r);let s=this.indexCount;this.indices[this.indexCount]=s,this.indices[this.indexCount+1]=s+1,this.indices[this.indexCount+2]=s+2,this.indexCount+=3;let a=s+1,u=s+2;this.normals[3*s]=n.x,this.normals[3*s+1]=n.y,this.normals[3*s+2]=n.z,this.normals[3*a]=i.x,this.normals[3*a+1]=i.y,this.normals[3*a+2]=i.z,this.normals[3*u]=o.x,this.normals[3*u+1]=o.y,this.normals[3*u+2]=o.z}getVertex(t){return fh.create(this.positions[3*t],this.positions[3*t+1],this.positions[3*t+2])}}class Rh extends Pi{constructor(t,e,r){super(),this.type="BufferRaisedShapesGeometry",this.parameters={verticesList:t,thickness:r,colorList:e},this.nVertex=0,this.nFace=0,this.countVertexAndFacesOfPath(),this.setAttributes(),this.setPath()}countVertexAndFacesOfPath(t,e){this.nVertex=0,this.nFace=0;for(let r of this.parameters.verticesList){let t=r.length;this.nFace+=t-2,this.nFace+=t-2,this.nFace+=2*t}this.nVertex=3*this.nFace}setPath(){for(let[t,e]of this.parameters.verticesList.entries()){let r=Nh(e.slice(0,3)),n=r.clone().multiplyScalar(this.parameters.thickness/2),i=this.parameters.colorList[t],o=e.length,s=o-1,a=[];for(let t=0;t<e.length;t+=1)a.push(e[t].clone().add(n));let u=[];for(let t=0;t<e.length;t+=1)u.push(e[t].clone().sub(n));for(let t=0;t<o-2;t+=1)this.pushVerticesOfFace(a[t],a[t+1],a[s],i);for(let t=0;t<o-2;t+=1)this.pushVerticesOfFace(u[t],u[s],u[t+1],i);for(let t=0;t<o;t+=1){let e=t===o-1?0:t+1;this.pushVerticesOfFace(a[t],u[t],u[e],i),this.pushVerticesOfFace(a[t],u[e],a[e],i)}}this.computeVertexNormals()}setColor(t,e){let r=3*t;this.colors[r]=e.r,this.colors[r+1]=e.g,this.colors[r+2]=e.b}recolor(t){this.parameters.colorList=t;let e=0;for(let[r,n]of this.parameters.verticesList.entries()){let t=this.parameters.colorList[r],i=n.length,o=6*(i-2)+6*i;for(let r=0;r<o;r+=1)this.setColor(e,t),e+=1}this.attributes.color.needsUpdate=!0}setAttributes(){let t=new Float32Array(3*this.nVertex),e=new Float32Array(3*this.nVertex),r=new Int32Array(3*this.nFace),n=new Float32Array(3*this.nVertex);this.addAttribute("position",new Si(t,3)),this.addAttribute("normal",new Si(e,3)),this.addAttribute("color",new Si(n,3)),this.setIndex(new _i(r,1)),this.positions=this.attributes.position.array,this.normals=this.attributes.normal.array,this.indices=this.index.array,this.colors=this.attributes.color.array,this.positionCount=0,this.indexCount=0,this.vertexCount=0}pushVertex(t,e){this.positions[this.positionCount]=t.x,this.positions[this.positionCount+1]=t.y,this.positions[this.positionCount+2]=t.z,this.colors[this.positionCount]=e.r,this.colors[this.positionCount+1]=e.g,this.colors[this.positionCount+2]=e.b,this.positionCount+=3,this.vertexCount+=1}pushVerticesOfFace(t,e,r,n){this.pushVertex(t,n),this.pushVertex(e,n),this.pushVertex(r,n);let i=this.indexCount;this.indices[this.indexCount]=i,this.indices[this.indexCount+1]=i+1,this.indices[this.indexCount+2]=i+2,this.indexCount+=3}getVertex(t){return fh.create(this.positions[3*t],this.positions[3*t+1],this.positions[3*t+2])}}class Lh extends Ba{constructor(){let t=new ol([new Oe(-.25,-.5),new Oe(0,.5),new Oe(.25,-.5)]),e=new Vu([fh.create(0,-.2,0),fh.create(0,.2,0)]);super(t,{steps:2,bevelEnabled:!1,extrudePath:e}),this.type="BlockArrowGeometry",this.applyMatrix((new Ie).makeRotationFromEuler(new si(0,Math.PI/2,0)))}}function Oh(t,e){s.a.isUndefined(t)||t.traverse((function(t){t.visible=e}))}function Ih(t){let e=t.children.length-1;for(let r=e;r>=0;r-=1){let e=t.children[r];s.a.isUndefined(e.dontDelete)&&(s.a.isUndefined(e.geometry)||e.geometry.dispose(),s.a.isUndefined(e.material)||e.material.dispose(),t.remove(e))}}function Dh(t,e){let r=t.clone().multiplyScalar(e.dot(t));return e.clone().sub(r)}function Nh(t){let e=new Ne,r=new Ne;return e.subVectors(t[2],t[1]),r.subVectors(t[0],t[1]),e.cross(r),e.normalize(),e}function kh(t,e){return(new De).setFromUnitVectors(t,e)}function Fh(t,e,r){return r*(e-t)+t}function Vh(t,e){let r=new De;return r.slerp(t,e)}function zh(t,e){let r=new li;return r.matrix.identity(),r.position.copy(t),r.scale.set(e,e,e),r.updateMatrix(),r.matrix}function Uh(t,e){s.a.isUndefined(e)&&(e=4);let r=new iu(t,t,1,e,1,!1);return r.applyMatrix((new Ie).makeRotationFromEuler(new si(Math.PI/2,Math.PI,0))),r}function jh(t,e,r){let n=new li;return n.scale.set(r,r,t.distanceTo(e)),n.position.copy(t).add(e).multiplyScalar(.5),n.lookAt(e),n.updateMatrix(),n.matrix}function Bh(t,e,r,n){let i=t.elements;for(let o=r;o<n;o+=3){let t=e[o],r=e[o+1],n=e[o+2];e[o]=i[0]*t+i[4]*r+i[8]*n+i[12],e[o+1]=i[1]*t+i[5]*r+i[9]*n+i[13],e[o+2]=i[2]*t+i[6]*r+i[10]*n+i[14]}}function Hh(t,e,r,n){let i=t.elements;for(let o=r;o<n;o+=3){let t=e[o],r=e[o+1],n=e[o+2];e[o]=i[0]*t+i[4]*r+i[8]*n,e[o+1]=i[1]*t+i[5]*r+i[9]*n,e[o+2]=i[2]*t+i[6]*r+i[10]*n}}function Gh(t,e){let r=t.length,n=new Float32Array(r*e);for(let i=0;i<e;i+=1){let e=i*r;for(let i=0;i<r;i+=1)n[e+i]=t[i]}return n}function qh(t,e,r,n){for(let i=r;i<n;i+=3)e[i]=t.r,e[i+1]=t.g,e[i+2]=t.b}function Wh(t,e,r){let n=t.length,i=new Uint32Array(n*e);for(let o=0;o<e;o+=1){let e=o*n,s=o*r;for(let r=0;r<n;r+=1)i[e+r]=t[r]+s}return i}class $h extends Pi{constructor(t,e){super(),this.type="CopyBufferGeometry",this.parameters={nCopy:e},this.refBufferGeometry=t;let r=Gh(t.attributes.position.array,e);this.addAttribute("position",new Si(r,3));let n=Gh(t.attributes.normal.array,e);this.addAttribute("normal",new Si(n,3));let i=Gh(t.attributes.uv.array,e);this.addAttribute("uv",new Si(i,2));let o=t.attributes.position.count;if("index"in t&&t.index){let r=Wh(t.index.array,e,o);this.setIndex(new _i(r,1))}let s=new Float32Array(3*o*e);this.addAttribute("color",new Si(s,3))}applyMatrixToCopy(t,e){let r=this.refBufferGeometry.attributes.position.array.length,n=this.attributes.position.array,i=this.attributes.normal.array,o=e*r,s=o+r;Bh(t,n,o,s),Hh(t,i,o,s)}applyColorToCopy(t,e){let r=this.refBufferGeometry.attributes.position.array.length,n=this.attributes.color.array,i=e*r,o=i+r;qh(t,n,i,o)}}class Xh{constructor(){this.id="view:000000",this.iAtom=-1,this.order=1,this.cameraParams={focus:fh.create(0,0,0),position:fh.create(0,0,-1),up:fh.create(0,1,0),zFront:0,zBack:0,zoom:1},this.selected=[],this.labels=[],this.distances=[],this.selectedTraces=[],this.text="Default view of PDB file",this.userId="",this.pdbId="",this.show={sidechain:!0,peptide:!0,hydrogen:!1,water:!1,ligands:!0,trace:!0,backbone:!1,ribbon:!0,sphere:!1,transparent:!1},this.grid={isElem:{},bCutoff:null,isChanged:!1},this.lock=!1,this.creator="public"}setCamera(t){this.cameraParams=t}getViewTranslatedTo(t){let e=this.clone(),r=t.clone().sub(e.cameraParams.focus);return e.cameraParams.focus.copy(t),e.cameraParams.position.add(r),e}clone(){let t=new Xh;return t.id=this.id,t.pdbId=this.pdbId,t.iAtom=this.iAtom,t.selected=this.selected,t.selectedTraces=s.a.cloneDeep(this.selectedTraces),t.labels=s.a.cloneDeep(this.labels),t.distances=s.a.cloneDeep(this.distances),t.order=this.order,t.text=this.text,t.time=this.time,t.cameraParams=s.a.cloneDeep(this.cameraParams),t.show=s.a.cloneDeep(this.show),t.grid=s.a.cloneDeep(this.grid),t.lock=this.lock,t.creator=this.creator,t}getDict(){let t=this.cameraParams.focus.clone().sub(this.cameraParams.position),e=t.length();t.normalize();let r=this.cameraParams.focus,n=r.clone().add(t),i=r.clone().sub(this.cameraParams.up),o=s.a.clone(this.show);return o.all_atom=o.backbone,delete o.backbone,{version:2,view_id:this.id,user_id:this.userId,pdb_id:this.pdbId,order:this.order,show:o,grid:s.a.cloneDeep(this.grid),text:this.text,i_atom:this.iAtom,labels:this.labels,selected:this.selected,selected_traces:this.selectedTraces,distances:this.distances,camera:{slab:{z_front:this.cameraParams.zFront,z_back:this.cameraParams.zBack,zoom:e},pos:[r.x,r.y,r.z],up:[i.x,i.y,i.z],in:[n.x,n.y,n.z]},lock:this.lock,creator:this.creator}}setFromDict(t){this.id=t.view_id,this.pdbId=t.pdb_id,this.lock=t.lock,this.creator=t.creator,this.text=t.text,this.userId=t.user_id,this.order=t.order,this.resId=t.resId,this.iAtom=t.i_atom,this.labels=t.labels,this.selected=t.selected,this.distances=t.distances;for(let c of s.a.keys(t.show))c in this.show&&(this.show[c]=!!t.show[c]),"all_atom"===c&&(this.show.backbone=!!t.show.all_atom);this.show.backbone||this.show.trace||this.show.ribbon||(this.show.ribbon=!0),this.show.all_atom||this.show.trace||this.show.ribbon||(this.show.backbone=!0),"grid"in t&&(this.grid=t.grid),"selected_traces"in t&&(this.selectedTraces=s.a.cloneDeep(t["selected_traces"]));let e=fh.create(t.camera.pos[0],t.camera.pos[1],t.camera.pos[2]),r=fh.create(t.camera.up[0],t.camera.up[1],t.camera.up[2]),n=fh.create(t.camera.in[0],t.camera.in[1],t.camera.in[2]),i=t.camera.slab.zoom,o=fh.clone(e),a=fh.clone(n).sub(o).multiplyScalar(i).negate(),u=fh.clone(o).add(a),l=fh.clone(r).sub(o).negate();this.cameraParams={focus:o,position:u,up:l,zFront:t.camera.slab.z_front,zBack:t.camera.slab.z_back,zoom:i}}}function Yh(t,e,r){let n=t.position.clone().sub(t.focus),i=n.length();n.normalize();let o=e.position.clone().sub(e.focus),s=o.length();o.normalize();let a=kh(n,o),u=t.up.clone().applyQuaternion(a),l=kh(u,e.up).multiply(a),c=Vh(l,r),h=e.focus.clone().sub(t.focus).multiplyScalar(r),d=t.focus.clone().add(h),p=Fh(i,s,r),f=n.clone().applyQuaternion(c).multiplyScalar(p);return{focus:d,position:d.clone().add(f),up:t.up.clone().applyQuaternion(c),zFront:Fh(t.zFront,e.zFront,r),zBack:Fh(t.zBack,e.zBack,r),zoom:p}}class Zh{constructor(t){this.soup=t,this.isChanged=!0,this.isUpdateSidechain=!1,this.isUpdateColors=!1,this.isStartTargetAfterRender=!1,this.isUpdateObservers=!0,this.currentView=new Xh,this.savedViewsByViewId={},this.savedViews=[],this.iLastViewSelected=0,this.animateState="none",this.targetView=null,this.nUpdateStep=-1,this.maxUpdateStep=70,this.msPerStep=17,this.mode="normal"}build(){0!==this.savedViews.length||this.soup.isEmpty()||this.setCurrentViewToDefaultAndSave(),this.saveGridToCurrentView()}getMode(){return this.mode}setMode(t){this.mode=t}saveGridToCurrentView(){for(let t in this.soup.grid.isElem)t in this.soup.grid.isElem&&(this.currentView.grid.isElem[t]=this.soup.grid.isElem[t]);mh(this.soup.grid.bCutoff)&&(this.currentView.grid.bCutoff=this.soup.grid.bCutoff)}setCurrentViewToDefaultAndSave(){this.currentView.show.sidechain=!1,this.currentView.order=0,this.currentView.text=this.soup.title,this.currentView.pdbId=this.soup.structureIds[0],this.currentView=this.getZoomedOutViewOfCurrentView(),this.saveView(this.currentView),this.isChanged=!0}setTargetView(t){this.isStartTargetAfterRender=!0,this.saveTargetView=t.clone(),this.saveTargetView.iAtom=this.soup.getIAtomAtPosition(t.cameraParams.focus)}startTargetView(){this.targetView=this.saveTargetView,this.saveTargetView=null,this.isUpdateObservers=!0,this.isStartTargetAfterRender=!1,this.isChanged=!0}getICenteredAtom(){return this.currentView.iAtom}getIViewFromViewId(t){for(let e=0;e<this.savedViews.length;e+=1)if(this.savedViews[e].id===t)return e;return-1}insertView(t,e,r){this.savedViewsByViewId[e]=r,t>=this.savedViews.length?this.savedViews.push(r):this.savedViews.splice(t,0,r),this.iLastViewSelected=t;for(let n=0;n<this.savedViews.length;n++)this.savedViews[n].order=n}removeView(t){let e=this.getIViewFromViewId(t);if(!(e<0)){this.savedViews.splice(e,1),delete this.savedViewsByViewId[t];for(let t=0;t<this.savedViews.length;t++)this.savedViews[t].order=t;this.iLastViewSelected>=this.savedViews.length&&(this.iLastViewSelected=this.savedViews.length-1),this.isChanged=!0}}saveView(t){this.savedViewsByViewId[t.id]=t,this.savedViews.push(t)}getZoomedOutViewOf(t){let e=this.soup.calcMaxLength(),r=this.currentView.clone();if(0===e)return r;let n=r.cameraParams;n.zFront=-e/2,n.zBack=e/2,n.zoom=1.75*Math.abs(e);let i=this.soup.getCenter(t),o=n.position.clone().sub(n.focus).normalize();return n.focus.copy(i),n.position=n.focus.clone().add(o.multiplyScalar(n.zoom)),r.iAtom=this.soup.getIAtomAtPosition(i),r.selectedTraces.length=0,r}getZoomedOutViewOfCurrentView(){let t=s.a.range(this.soup.getAtomCount());return this.getZoomedOutViewOf(t)}setTargetViewByViewId(t){let e=this.savedViewsByViewId[t];this.iLastViewSelected=this.savedViewsByViewId[t].order,this.setTargetView(e)}getTracesOfChainContainingResidue(t){let e=[],r=this.soup.getResidueProxy(t),n=r.chain,i=r.iStructure;for(let[o,s]of this.soup.traces.entries())r.load(s.indices[0]),r.chain===n&&r.iStructure===i&&e.push(o);return e}setTargetViewByIAtom(t){let e=this.soup.getAtomProxy(t),r=this.currentView.getViewTranslatedTo(e.pos);r.iAtom=this.soup.getIAtomAtPosition(r.cameraParams.focus),r.selectedTraces=this.getTracesOfChainContainingResidue(e.iRes),this.setTargetView(r)}getZoomedOutViewOfSelection(){let t=this.currentView.clone(),e=[],r=this.soup.getResidueProxy();for(let u of s.a.range(this.soup.getResidueCount()))r.load(u),r.selected&&e.push(r.iAtom);let n=this.soup.getCenter(e),i=this.soup.calcMaxLength(e);if(0===i)return t;let o=t.cameraParams;o.zFront=-i/2,o.zBack=i/2,o.zoom=1.2*Math.abs(i);let a=o.position.clone().sub(o.focus).normalize();return o.focus.copy(n),o.position=o.focus.clone().add(a.multiplyScalar(o.zoom)),t.iAtom=this.soup.getIAtomAtPosition(n),t}saveCurrentView(){let t=this.currentView.clone();t.id=bh(),t.text="Click edit to change this text.",t.pdbId=this.soup.structureIds[0],t.selected=this.soup.makeSelectedResidueList(),t.selectedTraces=s.a.cloneDeep(this.soup.selectedTraces);let e=this.iLastViewSelected+1;return this.insertView(e,t.id,t),this.setTargetViewByViewId(t.id),this.isChanged=!0,this.isUpdateColors=!0,console.log("Soupview.saveCurrentView",t),t.id}setCurrentView(t){let e=this.currentView.selected;this.currentView=t.clone(),this.soup.selectedTraces=s.a.cloneDeep(t.selectedTraces),s.a.isEqual(e.sort(),t.selected.sort())||(this.soup.clearSidechainResidues(),this.soup.setSidechainOfResidues(t.selected,!0),this.isUpdateSidechain=!0);for(let r in t.grid.isElem)r in this.soup.grid.isElem&&t.grid.isElem[r]!==this.soup.grid.isElem[r]&&(this.soup.grid.isElem[r]=t.grid.isElem[r],this.isUpdateObservers=!0,this.soup.grid.isChanged=!0);s.a.isNil(t.grid.bCutoff)||this.soup.grid.bCutoff!==t.grid.bCutoff&&(this.soup.grid.bCutoff=t.grid.bCutoff,this.isUpdateObservers=!0,this.soup.grid.isChanged=!0),this.isChanged=!0}setTargetToPrevView(){if(0===this.savedViews.length)return"";this.iLastViewSelected-=1,this.iLastViewSelected<0&&(this.iLastViewSelected=this.savedViews.length-1);let t=this.savedViews[this.iLastViewSelected].id;return this.setTargetViewByViewId(t),t}setTargetToNextView(){if(0===this.savedViews.length)return"";this.iLastViewSelected+=1,this.iLastViewSelected>=this.savedViews.length&&(this.iLastViewSelected=0);let t=this.savedViews[this.iLastViewSelected].id;return this.setTargetViewByViewId(t),t}setTargetToPrevResidue(){let t=s.a.get(this.targetView,"iAtom");t=mh(t)?this.targetView.iAtom:this.currentView.iAtom,t<0&&(t=0);let e=this.soup.getAtomProxy(t).iRes;e<=0?e=this.soup.getResidueCount()-1:e-=1,t=this.soup.getResidueProxy(e).iAtom,this.setTargetViewByIAtom(t)}setTargetToNextResidue(){let t=s.a.get(this.targetView,"iAtom");t=mh(t)?this.targetView.iAtom:this.currentView.iAtom,t<0&&(t=0);let e=this.soup.getAtomProxy(t).iRes;e>=this.soup.getResidueCount()-1?e=0:e+=1,t=this.soup.getResidueProxy(e).iAtom,this.setTargetViewByIAtom(t)}adjustCamera(t,e,r,n){let i=this.currentView.cameraParams,o=i.up,s=i.position.clone().sub(i.focus).normalize(),a=fh.create().crossVectors(o,s).normalize(),u=(new De).setFromAxisAngle(s,r),l=(new De).setFromAxisAngle(o,-e),c=(new De).setFromAxisAngle(a,-t),h=(new De).multiply(u).multiply(l).multiply(c),d=n*i.zoom;d<2&&(d=2),d>1e3&&(d=1e3);let p=i.position.clone().sub(i.focus).applyQuaternion(h).normalize().multiplyScalar(d).add(i.focus),f=this.currentView.clone();f.cameraParams.focus=i.focus.clone(),f.cameraParams.position=p,f.cameraParams.up=i.up.clone().applyQuaternion(h),f.cameraParams.zoom=d,this.setCurrentView(f)}setCurrentViewToTargetView(){this.setCurrentView(this.targetView),"chain"===this.getMode()&&(this.currentView.show.transparent=!0),this.targetView=null,this.isUpdateColors=!0,this.isUpdateObservers=!0,this.isChanged=!0,this.targetView=null}scalingFunction(t,e,r,n){return(r-n)/2*(Math.sin(2*Math.PI/e*t-.5*Math.PI)+1)+n}animate(t){if(this.nUpdateStep-=t/this.msPerStep,this.nUpdateStep<0){if(null!==this.targetView)this.setCurrentViewToTargetView(),this.nUpdateStep=this.maxUpdateStep;else if(this.isStartTargetAfterRender)this.isChanged=!0;else if("loop"===this.animateState)this.nUpdateStep<-this.maxWaitStep&&this.setTargetToNextView();else if("rotate"===this.animateState)this.adjustCamera(0,.002,0,1);else if("rock"===this.animateState){let t=18,e=this.scalingFunction(-this.nUpdateStep-t,2*t,4,1),r=.001,n=r*e;this.nUpdateStep>-t?this.adjustCamera(0,n,0,1):this.nUpdateStep>-3*t?this.adjustCamera(0,-n,0,1):this.nUpdateStep>-4*t?this.adjustCamera(0,+n,0,1):this.nUpdateStep=0}}else if(this.nUpdateStep>0&&null!=this.targetView){let t=this.currentView.clone(),e=this.nUpdateStep,r=this.scalingFunction(e,this.maxUpdateStep,4,1),n=1/e*r;n>1&&(n=1),t.setCamera(Yh(this.currentView.cameraParams,this.targetView.cameraParams,n)),this.setCurrentView(t)}}}class Jh{constructor(t){this.soup=t.soup,this.soupView=t,this.iResLastSelected=null}deleteDistance(t){this.soupView.currentView.distances.splice(t,1),this.soupView.isChanged=!0}makeDistance(t,e){this.soupView.currentView.distances.push({i_atom1:t,i_atom2:e}),this.soupView.isChanged=!0}makeAtomLabel(t,e){this.soupView.currentView.labels.push({i_atom:t,text:e}),this.soupView.isChanged=!0}deleteAtomLabel(t){this.soupView.currentView.labels.splice(t,1),this.soupView.isChanged=!0}setTargetView(t){this.soupView.setTargetView(t)}setTargetViewByViewId(t){this.soupView.setTargetViewByViewId(t)}setTargetViewByIAtom(t){this.soupView.setTargetViewByIAtom(t)}setTargetToPrevResidue(){let t=null,e=this.soup.getResidueProxy();for(let r=0;r<this.soup.getResidueCount();r+=1)if(e.load(r).selected){t=r;break}null!==t?(t>0?t-=1:t=this.soup.getResidueCount-1,e.load(t),this.clearSelectedResidues(),this.setTargetViewByIAtom(e.iAtom)):this.soupView.setTargetToPrevResidue()}setTargetToNextResidue(){let t=null,e=this.soup.getResidueProxy(),r=this.soup.getResidueCount();for(let n=r-1;n>0;n-=1)if(e.load(n).selected){t=n;break}null!==t?(t<r-1?t+=1:t=0,e.load(t),this.clearSelectedResidues(),this.setTargetViewByIAtom(e.iAtom)):this.soupView.setTargetToNextResidue()}selectPrevResidue(t=!0){let e=null,r=this.soup.getResidueProxy();for(let n=0;n<this.soup.getResidueCount();n+=1)if(r.load(n).selected){e=n;break}if(null!==e)e>0?e-=1:e=this.soup.getResidueCount-1,t&&this.clearSelectedResidues(),this.selectResidue(e,!0);else{t&&this.clearSelectedResidues();let e=null;for(let t=this.soup.getResidueCount()-1;t>=0;t-=1)if(r.load(t).isPolymer){e=t;break}this.selectResidue(e,!0)}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}selectNextResidue(t=!0){let e=null,r=this.soup.getResidueProxy(),n=this.soup.getResidueCount();for(let i=n-1;i>=0;i-=1)if(r.load(i).selected){e=i;break}if(console.log("Contreoller.selectNextResidue",e,t),null!==e)e<n-1?e+=1:e=0,t&&this.clearSelectedResidues(),this.selectResidue(e,!0);else{this.clearSelectedResidues();let t=null;for(let e=0;e<n-1;e+=1)if(r.load(e).isPolymer){t=e;break}this.selectResidue(t,!0)}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}setTargetToPrevView(){return this.soupView.setTargetToPrevView()}setTargetToNextView(){return this.soupView.setTargetToNextView()}swapViews(t,e){this.soupView.savedViews[e].order=t,this.soupView.savedViews[t].order=e;let r=this.soupView.savedViews[e];this.soupView.savedViews[e]=this.soupView.savedViews[t],this.soupView.savedViews[t]=r}getViewDicts(){let t=[];for(let e=1;e<this.soupView.savedViews.length;e+=1)t.push(this.soupView.savedViews[e].getDict());return t}clearSidechainResidues(){this.soup.clearSidechainResidues(),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}clearSelectedResidues(){this.soup.clearSelectedResidues(),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}setResidueSelect(t,e){let r=this.soup.getResidueProxy(t);r.selected=e,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}showAllSidechains(){let t=this.soup.getResidueProxy();for(let e of s.a.range(this.soup.getResidueCount()))t.load(e).sidechain=!0;this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}selectResidue(t,e){let r=this.soup.getResidueProxy(t);s.a.isUndefined(e)&&(e=!r.selected),this.setResidueSelect(t,e),this.iResLastSelected=e?t:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAllSidechains(t){for(let e=0;e<this.soup.getResidueCount();e+=1)this.setResidueSelect(e,t);this.iResLastSelected=null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAdditionalResidue(t){let e=this.soup.getResidueProxy(t),r=!e.selected;this.setResidueSelect(t,r),this.iResLastSelected=r?t:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}selectAdditionalRangeToResidue(t){let e=this.soup.getResidueProxy(t),r=!e.selected;if(null!==this.iResLastSelected){let r=this.soup.getResidueProxy(this.iResLastSelected);if(e.iStructure===r.iStructure){let e=Math.min(this.iResLastSelected,t),r=Math.max(this.iResLastSelected,t);for(let t=e;t<r+1;t+=1)this.setResidueSelect(t,!0)}}this.iResLastSelected=r?t:null,this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}getResListOfSs(t){let e=this.soup.getResidueProxy(t),r=e.ss,n=this.soup.getResidueCount(),i=[];for(let o=t;o>=0;o-=1){if(e.load(o),e.ss!==r)break;i.push(o)}for(let o=t+1;o<n;o+=1){if(e.load(o),e.ss!==r)break;i.push(o)}return i}selectSecondaryStructure(t,e=!0){this.clearSelectedResidues();let r=this.getResListOfSs(t),n=this.soup.getResidueProxy(t);for(let i of r)n.load(i).selected=e;this.soupView.isUpdateColors=!0,this.soupView.isChanged=!0}toggleSecondaryStructure(t){let e=this.getResListOfSs(t),r=this.soup.getResidueProxy(t),n=s.a.every(s.a.map(e,t=>!r.load(t).selected));n?this.selectSecondaryStructure(t,!0):this.selectSecondaryStructure(t,!1)}toggleSelectedSidechains(){let t=this.soup.getResidueProxy(),e=[],r=0,n=0,i=0;for(let o=0;o<this.soup.getResidueCount();o+=1)t.load(o),t.selected&&(r+=1,e.push(o),t.sidechain&&(n+=1)),t.sidechain&&(i+=1);if(0===r){let e=!0;i>0&&(e=!1);for(let r=0;r<this.soup.getResidueCount();r+=1)t.load(r),t.sidechain=e}else{let r=!0;n>0&&(r=!1);for(let n of e)t.load(n),t.sidechain=r}this.soupView.isUpdateSidechain=!0,this.soupView.isChanged=!0}toggleResidueNeighbors(){let t=[],e=0,r=this.soup.getResidueProxy();for(let o=0;o<this.soup.getResidueCount();o+=1)r.load(o),r.selected&&(t=s.a.concat(t,this.soup.getNeighbours(o)),e+=1);if(0===e){console.log("Controller.toggleResidueNeighbors none selected");let e=this.soupView.currentView.cameraParams.focus;t=this.soup.getNeighboursOfPoint(e)}if(0===t.length){let e=this.soupView.currentView.iAtom,r=this.soup.getAtomProxy(e).iRes;t=s.a.concat(t,this.soup.getNeighbours(r))}let n=0;for(let o of t)r.load(o).sidechain&&(n+=1);let i=n<t.length;this.soup.setSidechainOfResidues(t,i),this.soupView.currentView.selected=this.soup.makeSelectedResidueList(),this.soupView.isChanged=!0,this.soupView.isUpdateSidechain=!0}saveCurrentView(){return this.soupView.saveCurrentView()}deleteView(t){this.soupView.removeView(t)}sortViewsByOrder(){function t(t,e){return t.order-e.order}this.soupView.savedViews.sort(t);for(let e=0;e<this.soupView.savedViews.length;e+=1)this.soupView.savedViews[e].order=e}loadViewsFromViewDicts(t){for(let e=0;e<t.length;e+=1){let r=new Xh;r.setFromDict(t[e]),"view:000000"!==r.id&&this.soupView.saveView(r)}this.sortViewsByOrder()}async asyncLoadProteinData(t,e){await this.soup.asyncLoadProteinData(t,e),this.soupView.build(),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0}selectChain(t,e){this.soup.selectedTraces.length=0,this.clearSelectedResidues();let r=null;for(let[n,i]of this.soup.traces.entries()){let o=i.indices[0],s=this.soup.getResidueProxy(o);s.iStructure===t&&s.chain===e&&(this.soup.selectedTraces.push(n),r=s.iAtom)}s.a.isNil(r)||this.zoomToChainContainingAtom(r)}setShowOption(t,e){console.log("Controller.setShowOption",t,e),this.soupView.currentView.show[t]=e,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}getShowOption(t){return this.soupView.currentView.show[t]}toggleShowOption(t){let e=this.getShowOption(t);this.setShowOption(t,!e)}setChangeFlag(){this.soupView.isChanged=!0}setZoom(t,e){let r=this.soupView.currentView.cameraParams;r.zBack=t,r.zFront=e,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}toggleGridElem(t){let e=this.soup.grid.isElem[t];this.soup.grid.isElem[t]=!e,this.soup.grid.isChanged=!0,this.soupView.currentView.grid.isElem=s.a.cloneDeep(this.soup.grid.isElem),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0,this.soupView.isUpdateColors=!0}setGridCutoff(t){this.soup.grid.bCutoff=t,this.soup.grid.isChanged=!0,this.soupView.currentView.grid.bCutoff=t,mh(this.soupView.targetView)&&(this.soupView.targetView.grid.bCutoff=t),mh(this.soupView.saveTargetView)&&(this.soupView.saveTargetView.grid.bCutoff=t),this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}clear(){let t=this.soupView.currentView.distances;for(let r of s.a.reverse(s.a.range(t.length)))this.deleteDistance(r);let e=this.soupView.currentView.labels;for(let r of s.a.reverse(s.a.range(e.length)))this.deleteAtomLabel(r);this.clearSidechainResidues(),this.clearSelectedResidues()}getAnimateState(){return this.soupView.animateState}setAnimateState(t){this.soupView.animateState=t,this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}deleteStructure(t){let e=this.soup.getAtomProxy(),r=this.soup.getResidueProxy(),n=null,i=null,o=null,a=null,u=null,l=null;for(let s=0;s<this.soup.getAtomCount();s+=1)e.iAtom=s,r.iRes=e.iRes,r.iStructure===t&&(null===n&&(n=s),i=s+1,null===o&&(o=e.iRes),a=e.iRes+1);for(let x of s.a.range(this.soup.traces.length)){let t=this.soup.traces[x];for(let e of t.indices)c(e,o,a)&&(s.a.isNil(u)?(u=x,l=x+1):l=x+1)}function c(t,e,r){return t>=e&&t<r}function h(t,e,r){return t>=r?t-(r-e):t}function d(t){s.a.remove(t.selectedTraces,s.a.partial(c,u,l)),t.selectedTraces=s.a.map(t.selectedTraces,s.a.partial(h,u,l)),s.a.remove(t.distances,t=>c(t.i_atom1,n,i)||c(t.i_atom2,n,i));for(let e of t.distances)e.i_atom1=h(e.i_atom1,n,i),e.i_atom2=h(e.i_atom2,n,i);s.a.remove(t.selected,t=>c(t,o,a)),t.selected=s.a.map(t.selected,t=>h(t,o,a)),s.a.remove(t.labels,t=>c(t.iAtom,n,i));for(let e of t.labels)e.iAtom=h(e.iAtom,n,i)}s.a.remove(this.soup.selectedTraces,s.a.partial(c,u,l)),this.soup.selectedTraces=s.a.map(this.soup.selectedTraces,s.a.partial(h,u,l)),d(this.soupView.currentView);for(let s of this.soupView.savedViews)d(s);let p=i-n,f=this.soup.getAtomCount(),m=f-p,g=f-i,v=a-o,y=this.soup.getResidueCount(),w=y-v,b=y-a;this.soup.atomStore.copyWithin(n,i,g),this.soup.atomStore.count-=p;for(let s=0;s<m;s+=1)e.iAtom=s,e.iRes>=o&&(e.iRes-=v);for(let s=0;s<w;s+=1)if(s>=o){let t=s+v;t in this.soup.residueNormal&&(this.soup.residueNormal[s]=this.soup.residueNormal[t].clone())}for(let s=w;s<y;s+=1)delete this.soup.residueNormal[s];this.soup.residueStore.copyWithin(o,a,b),this.soup.residueStore.count-=v,this.soup.resIds.splice(o,v);for(let s=0;s<w;s+=1)r.iRes=s,r.iAtom>=n&&(r.iAtom-=p,e.iAtom=r.iAtom),this.soup.residueStore.atomOffset[s]>=n&&(this.soup.residueStore.atomOffset[s]-=p),r.iStructure>=t&&(r.iStructure-=1);if(this.soup.structureIds.splice(t,1),this.soup.iStructure-=1,this.soup.calcBondsStrategic(),this.soup.calculateTracesForRibbons(),this.soup.isEmpty()){this.soupView.savedViews.length=0;for(let t of s.a.keys(this.soupView.savedViewsByViewId))delete this.soupView.savedViewsByViewId[t];this.soupView.currentView=new Xh,this.soupView.targetView=null,this.soupView.isStartTargetAfterRender=!1,this.soupView.nUpdateStep=-1}else this.soupView.isUpdateSidechain=!0,this.soupView.isUpdateColors=!0;this.soupView.isUpdateObservers=!0,this.soupView.isChanged=!0}zoomOut(){this.soup.isEmpty()||(this.setTargetView(this.soupView.getZoomedOutViewOfCurrentView()),this.soupView.isChanged=!0)}zoomToChainContainingAtom(t){let e=this.soup.getAtomProxy(t),r=this.soup.getAtomsOfChainContainingResidue(e.iRes),n=this.soupView.getZoomedOutViewOf(r);n.selectedTraces=this.soupView.getTracesOfChainContainingResidue(e.iRes),this.setTargetView(n)}zoomToSelection(){this.soup.isEmpty()||(this.setTargetView(this.soupView.getZoomedOutViewOfSelection()),this.soupView.isChanged=!0)}adjustCamera(t,e,r,n){this.soupView.adjustCamera(t,e,r,n)}triggerAtom(t){if(s.a.isNil(t))this.clearSelectedResidues(),this.zoomOut();else{let e=this.soup.getAtomProxy(t),r=this.soup.getResidueProxy(e.iRes),n=r.chain,i=r.iStructure,o=!1;if("chain"===this.soupView.getMode()){if(this.soup.selectedTraces.length>0){let t=this.soup.selectedTraces[0],e=this.soup.traces[t].indices[0],r=this.soup.getResidueProxy(e);r.iStructure===i&&r.chain===n&&(o=!0)}if(!o)return this.clearSelectedResidues(),void this.zoomToChainContainingAtom(e.iAtom)}this.clearSelectedResidues(),this.selectResidue(e.iRes,!0),this.setTargetViewByIAtom(t)}this.soupView.isUpdateColors=!0,this.soupView.isUpdateObservers=!0}}class Qh{constructor(t){this.vertices=t,this.padding=.05,this.div=5,this.invDiv=1/this.div,this.maxima=[0,0,0],this.minima=[0,0,0],this.spans=[0,0,0],this.sizes=[0,0,0];for(let e=0;e<3;e++){for(let t=0;t<this.vertices.length;t+=1)this.minima[e]>this.vertices[t][e]&&(this.minima[e]=this.vertices[t][e]),this.maxima[e]<this.vertices[t][e]&&(this.maxima[e]=this.vertices[t][e]);this.minima[e]-=this.padding,this.maxima[e]+=this.padding,this.spans[e]=this.maxima[e]-this.minima[e],this.sizes[e]=Math.ceil(this.spans[e]*this.invDiv)}this.cells={},this.spaces=[];for(let e=0;e<this.vertices.length;e++){let t=this.vertices[e],r=this.getSpaceFromVertex(t);this.spaces.push(r);let n=this.getHashFromSpace(r);n in this.cells||(this.cells[n]=[]),this.cells[n].push(e)}}getSpaceFromVertex(t){let e=[];for(let r=0;r<3;r++)e.push(Math.round((t[r]-this.minima[r])*this.invDiv));return e}getHashFromSpace(t){return t[0]*this.sizes[1]*this.sizes[2]+t[1]*this.sizes[2]+t[2]}pushCellOfSpace(t,e,r){let n=this.getSpaceFromVertex(e),i=Math.max(0,n[0]-1),o=Math.min(this.sizes[0],n[0]+2),s=Math.max(0,n[1]-1),a=Math.min(this.sizes[1],n[1]+2),u=Math.max(0,n[2]-1),l=Math.min(this.sizes[2],n[2]+2);for(let c=i;c<o;c++)for(let e=s;e<a;e++)for(let n=u;n<l;n++){let i=this.getHashFromSpace([c,e,n]);if(i in this.cells){let e=this.cells[i];for(let n=0;n<e.length;n++){let i=e[n];t.push([r,i])}}}}getClosePairs(){let t=[];for(let e=0;e<this.vertices.length;e++)this.pushCellOfSpace(t,this.vertices[e],e);return t}getVerticesNearPoint(t,e){let r=[];return this.pushCellOfSpace(r,t,e),r}}function Kh(t,e){switch(t){case"int8":return new Int8Array(e);case"int16":return new Int16Array(e);case"int32":return new Int32Array(e);case"uint8":return new Uint8Array(e);case"uint16":return new Uint16Array(e);case"uint32":return new Uint32Array(e);case"float32":return new Float32Array(e);default:throw new Error("arrayType unknown: "+t)}}class td{constructor(t,e){this.length=0,this.count=0,this._fields=t,Number.isInteger(e)?this._init(e):this._init(0)}_init(t){this.length=t,this.count=0;for(let e of this._fields)this._initField(...e)}_initField(t,e,r){this[t]=Kh(r,this.length*e)}addField(t,e,r){this._fields.push([t,e,r]),this._initField(t,e,r)}resize(t){this.length=Math.round(t||0),this.count=Math.min(this.count,this.length);for(let e=0,r=this._fields.length;e<r;++e){const t=this._fields[e][0],r=this._fields[e][1],n=this.length*r,i=new this[t].constructor(n);this[t].length>n?i.set(this[t].subarray(0,n)):i.set(this[t]),this[t]=i}}growIfFull(){if(this.count>=this.length){const t=Math.round(1.5*this.length);this.resize(Math.max(256,t))}}increment(){this.count+=1,this.growIfFull()}copyFrom(t,e,r,n){for(let i=0,o=this._fields.length;i<o;++i){const o=this._fields[i][0],s=this._fields[i][1],a=this[o],u=t[o];for(let t=0;t<n;++t){const n=s*(e+t),i=s*(r+t);for(let t=0;t<s;++t)a[n+t]=u[i+t]}}}copyWithin(t,e,r){for(let n=0,i=this._fields.length;n<i;++n){const i=this._fields[n][0],o=this._fields[n][1],s=this[i];for(let n=0;n<r;++n){const r=o*(t+n),i=o*(e+n);for(let t=0;t<o;++t)s[r+t]=s[i+t]}}}sort(t){const e=this,r=new this.constructor(this._fields,1);function n(t,n){t!==n&&(r.copyFrom(e,0,t,1),e.copyWithin(t,n,1),e.copyFrom(r,n,0,1))}function i(e,r){if(e<r){let o=Math.floor((e+r)/2),s=e,a=r;do{while(t(s,o)<0)s+=1;while(t(a,o)>0)a-=1;s<=a&&(s===o?o=a:a===o&&(o=s),n(s,a),s+=1,a-=1)}while(s<=a);i(e,a),i(s,r)}}i(0,this.count-1)}clear(){this.count=0}dispose(){delete this.length,delete this.count;for(let t=0,e=this._fields.length;t<e;++t){const e=this._fields[t][0];delete this[e]}}}var ed=td;const rd=["ALA","CYS","ASP","GLU","PHE","GLY","HIS","ILE","LYS","LEU","MET","ASN","PRO","GLN","ARG","SER","THR","TRP","VAL","TYR"],nd=["DA","DT","DG","DC","A","T","G","C"],id=["RA","RU","RC","RG","A","G","C","U"],od=new ri(7315026),sd=new ri(6590902),ad=new ri(16172569),ud=new ri(9795754),ld=new ri(12303291),cd=new ri(10040115),hd=new ri(10066329);let dd={H:13421772,C:11184810,O:13369344,N:204,S:11184640,P:6693580,F:52224,CL:52224,BR:8921600,I:6684842,FE:13395456,CA:8947882,He:8095426,Ne:10408676,Ar:6145214,Kr:11326326,Xe:16228220,Rn:14851781};for(let[qp,Wp]of s.a.toPairs(dd))dd[qp]=new ri(Wp);function pd(t){return"E"===t?ad:"H"===t?sd:"D"===t?ud:"C"===t?od:"W"===t?cd:ld}const fd={ALA:"A",CYS:"C",ASP:"D",GLU:"E",PHE:"F",GLY:"G",HIS:"H",ILE:"I",LYS:"K",LEU:"L",MET:"M",ASN:"N",PRO:"P",GLN:"Q",ARG:"R",SER:"S",THR:"T",VAL:"V",TRP:"W",TYR:"Y",DA:"A",DT:"T",DG:"G",DC:"C",A:"A",T:"T",G:"G",C:"C",RA:"A",RU:"U",RC:"C",RG:"G",U:"U"},md=["N","C","O","H","HA","CA","OXT","C3'","P","OP1","O5'","OP2","C5'","O5'","O3'","C4'","O4'","C1'","C2'","O2'","H2'","H2''","H3'","H4'","H5'","H5''","HO3'"],gd=new ol([new Oe(-.2,-.2),new Oe(-.2,.2),new Oe(.2,.2),new Oe(.2,-.2)]);function vd(t){let e=[];return"DA"===t||"A"===t||"DG"===t||"G"===t?e=["N9","C8","N7","C5","C6","N1","C2","N3","C4"]:"DT"===t||"U"===t?e=["C6","N1","C2","N3","C4","C5"]:"DC"!==t&&"C"!==t||(e=["C6","N1","C2","N3","C4","C5"]),e}function yd(t){let e=[];return"DA"===t||"A"===t||"DG"===t||"G"===t?e=[["C3'","C2'"],["C2'","C1'"],["C1'","N9"]]:"DT"===t||"U"===t?e=[["C3'","C2'"],["C2'","C1'"],["C1'","N1"]]:"DC"!==t&&"C"!==t||(e=[["C3'","C2'"],["C2'","C1'"],["C1'","N1"]]),e}function wd(t){return t.replace(/\d+/,"")}function bd(t,e,r){e in t||(t[e]=[]),t[e].push(r)}function xd(t,e,r=null){if(s.a.isNil(r))return s.a.includes(t,e)||t.push(e),t.indexOf(e);{let n=s.a.findIndex(t,t=>r(e,t));return n>=0?n:(t.push(e),t.length-1)}}function _d(t){return 1===t}function Sd(t){return t?1:0}function Md(t){return t?String.fromCharCode(t):""}function Ed(t){return t.charCodeAt(0)}function Td(t){let e="",r=t.split(/\r?\n/);for(let n of r)"TITLE"===n.substring(0,5)&&(e+=n.substring(10));return e}function Ad(t){return(new ri).setHex(t+1)}const Pd=[["x",1,"float32"],["y",1,"float32"],["z",1,"float32"],["bfactor",1,"float32"],["alt",1,"uint8"],["iAtomType",1,"uint16"],["iElem",1,"uint16"],["iRes",1,"uint32"],["iChain",1,"int32"],["bondOffset",1,"uint32"],["bondCount",1,"uint16"]];class Cd{constructor(t,e){this.soup=t,Number.isInteger(e)&&this.load(e),this._pos=fh.create()}load(t){return this.iAtom=t,this}get pos(){return this._pos.x=this.soup.atomStore.x[this.iAtom],this._pos.y=this.soup.atomStore.y[this.iAtom],this._pos.z=this.soup.atomStore.z[this.iAtom],this._pos}get resId(){return this.soup.resIds[this.iRes]}get elem(){let t=this.soup.atomStore.iElem[this.iAtom];return this.soup.elemTable[t]}get bfactor(){return this.soup.atomStore.bfactor[this.iAtom]}get atomType(){let t=this.soup.atomStore.iAtomType[this.iAtom];return this.soup.atomTypeTable[t]}get alt(){return Md(this.soup.atomStore.alt[this.iAtom])}set alt(t){this.soup.atomStore.alt[this.iAtom]=Ed(t)}get iRes(){return this.soup.atomStore.iRes[this.iAtom]}set iRes(t){this.soup.atomStore.iRes[this.iAtom]=t}get resType(){let t=this.soup.residueStore.iResType[this.iRes];return this.soup.resTypeTable[t]}get label(){let t=this.soup.residueStore.iResType[this.iRes],e=this.soup.resTypeTable[t],r=this.soup.resIds[this.iRes]+":"+e+":"+this.atomType;return this.alt&&(r+=":"+this.alt),r}getBondIndices(){let t=this.soup.atomStore.bondOffset[this.iAtom],e=this.soup.atomStore.bondCount[this.iAtom],r=t+e;return s.a.range(t,r)}get color(){let t=this.soup.getResidueProxy(this.iRes);if(t.isPolymer){let e=t.activeColor;if("C"===this.elem||"H"===this.elem)return e;if(this.elem in dd){let t=dd[this.elem].clone().offsetHSL(0,-.3,-.3);return(new ri).addColors(e,t)}}return this.elem in dd?dd[this.elem]:hd}}const Rd=[["atomOffset",1,"uint32"],["atomCount",1,"uint16"],["iCentralAtom",1,"uint32"],["iResType",1,"uint16"],["iChain",1,"uint8"],["iStructure",1,"uint8"],["resNum",1,"int32"],["insCode",1,"uint8"],["sstruc",1,"uint8"],["iColor",1,"uint16"],["iCustomColor",1,"uint16"],["isPolymer",1,"uint8"],["selected",1,"uint8"],["sidechain",1,"uint8"],["iChain",1,"uint8"]];function Ld(t,e){return t.r===e.r&&t.g===e.g&&t.b===e.b}class Od{constructor(t,e){this.soup=t,Number.isInteger(e)&&this.load(e)}load(t){return this.iRes=t,this}get iAtom(){return this.soup.residueStore.iCentralAtom[this.iRes]}set iAtom(t){this.soup.residueStore.iCentralAtom[this.iRes]=t}get iChain(){return this.soup.residueStore.iChain[this.iRes]}get chain(){return this.soup.chains[this.iChain]}get iStructure(){return this.soup.residueStore.iStructure[this.iRes]}set iStructure(t){this.soup.residueStore.iStructure[this.iRes]=t}get resId(){return this.soup.resIds[this.iRes]}get resNum(){return this.soup.residueStore.resNum[this.iRes]}get insCode(){return Md(this.soup.residueStore.insCode[this.iRes])}set insCode(t){this.soup.residueStore.insCode[this.iRes]=Ed(t)}get isPolymer(){return _d(this.soup.residueStore.isPolymer[this.iRes])}set isPolymer(t){this.soup.residueStore.isPolymer[this.iRes]=Sd(t)}get sidechain(){return _d(this.soup.residueStore.sidechain[this.iRes])}set sidechain(t){this.soup.residueStore.sidechain[this.iRes]=Sd(t)}get selected(){return _d(this.soup.residueStore.selected[this.iRes])}set selected(t){this.soup.residueStore.selected[this.iRes]=Sd(t)}get color(){let t=this.soup.residueStore.iColor[this.iRes];return this.soup.colorTable[t]}set color(t){let e=xd(this.soup.colorTable,new ri(t),Ld);this.soup.residueStore.iColor[this.iRes]=e}get customColor(){let t=this.soup.residueStore.iCustomColor[this.iRes];return this.soup.colorTable[t]}set customColor(t){let e=xd(this.soup.colorTable,new ri(t),Ld);this.soup.residueStore.iCustomColor[this.iRes]=e}get activeColor(){let t=this.soup.residueStore.iColor[this.iRes],e=this.soup.colorTable[t];return this.selected&&(e=e.clone().offsetHSL(0,0,.3)),e}get resType(){let t=this.soup.residueStore.iResType[this.iRes];return this.soup.resTypeTable[t]}get normal(){let t=this.iRes in this.soup.residueNormal;return t?this.soup.residueNormal[this.iRes].clone():null}get ss(){return Md(this.soup.residueStore.sstruc[this.iRes])}set ss(t){this.soup.residueStore.sstruc[this.iRes]=Ed(t)}get label(){let t=this.soup.residueStore.iResType[this.iRes],e=this.soup.resTypeTable[t],r=this.soup.resIds[this.iRes]+":"+e;return r}getAtomIndices(){let t=this.soup.residueStore.atomOffset[this.iRes],e=this.soup.residueStore.atomCount[this.iRes],r=t+e;return s.a.range(t,r)}getAtomProxy(t){let e=this.soup.getAtomProxy();for(let r of this.getAtomIndices())if(e.iAtom=r,e.atomType===t)return e;return null}getIAtom(t){for(let e of this.getAtomIndices()){let r=this.soup.atomStore.iAtomType[e],n=this.soup.atomTypeTable[r];if(n===t)return e}return null}checkAtomTypes(t){for(let e of t)if(null===this.getIAtom(e))return!1;return!0}isProteinConnectedToPrev(){if(0===this.iRes)return!1;let t=this,e=new Od(this.soup,this.iRes-1);const r=["CA"];if(e.checkAtomTypes(r)&&t.checkAtomTypes(r)){let r=e.getAtomProxy("CA").pos,n=t.getAtomProxy("CA").pos;if(fh.distance(r,n)<5)return!0}return!1}isNucleotideConnectedToPrev(){if(0===this.iRes)return!1;let t=this,e=new Od(this.soup,this.iRes-1);const r=["C3'","O3'"];if(e.checkAtomTypes(r)&&t.checkAtomTypes(r)&&t.checkAtomTypes(["P"])){let r=e.getAtomProxy("O3'").pos,n=t.getAtomProxy("P").pos;if(fh.distance(r,n)<2.5)return!0}return!1}isConnectedToPrev(){return this.isProteinConnectedToPrev()||this.isNucleotideConnectedToPrev()}getNucleotideNormal(){let t=this.getAtomProxy("C3'").pos,e=this.getAtomProxy("C5'").pos,r=this.getAtomProxy("C1'").pos,n=fh.diff(t,e),i=fh.diff(r,t);return fh.crossProduct(n,i)}}const Id=[["iAtom1",1,"int32"],["iAtom2",1,"int32"]];class Dd{constructor(t,e){this.soup=t,Number.isInteger(e)&&this.load(e)}load(t){return this.iBond=t,this}get iAtom1(){return this.soup.bondStore.iAtom1[this.iBond]}get iAtom2(){return this.soup.bondStore.iAtom2[this.iBond]}}class Nd{constructor(){this.parsingError="",this.title="",this.structureIds=[],this.structureId=null,this.iStructure=-1,this.chains=[],this.maxLength=null,this.traces=[],this.selectedTraces=[],this.colorMode="secondary",this.atomStore=new ed(Pd),this.residueStore=new ed(Rd),this.bondStore=new ed(Id),this.resIds=[],this.residueNormal={},this.residueProxy=new Od(this),this.atomProxy=new Cd(this),this.elemTable=[],this.atomTypeTable=[],this.resTypeTable=[],this.colorTable=[],this.grid={bCutoff:.8,bMax:2,bMin:.4,changed:!0,isElem:{},convertB:t=>-t.toFixed(2)}}isEmpty(){return 0===this.getAtomCount()}parseAtomLines(t){let e,r,n,i,o,a,u,l,c,h,d;for(let f=0;f<t.length;f+=1){let m=t[f];if("ATOM"===m.substr(0,4)||"HETATM"===m.substr(0,6)){try{a=s.a.trim(m.substr(12,4)),c=s.a.trim(m.substr(16,1)),o=s.a.trim(m.substr(17,3)),i=m[21],h=parseInt(m.substr(22,4)),d=m.substr(26,1),e=parseFloat(m.substr(30,7)),r=parseFloat(m.substr(38,7)),n=parseFloat(m.substr(46,7)),u=parseFloat(m.substr(60,6)),l=wd(s.a.trim(m.substr(76,2)))}catch(p){this.parsingError="line "+f,console.log(`Error: "${m}"`);continue}""===l&&(l=wd(s.a.trim(a)).substr(0,1)),this.addAtom(e,r,n,u,c,a,l,o,h,d,i)}}}parseSecondaryStructureLines(t){this.assignResidueProperties(this.iStructure),this.parsedSecondaryStructure=!1;let e=this.getResidueProxy();for(let r=0;r<t.length;r+=1){let n=t[r];if("HELIX"===n.substr(0,5)){this.parsedSecondaryStructure=!0;let t=n.substr(19,1),r=parseInt(n.substr(21,4)),i=parseInt(n.substr(33,4));for(let n of this.findResidueIndices(this.iStructure,t,r)){e.iRes=n;while(e.resNum<=i&&t===e.chain)e.ss="H",e.iRes=e.iRes+1}}if("SHEET"===n.substr(0,5)){this.parsedSecondaryStructure=!0;let t=n.substr(21,1),r=parseInt(n.substr(22,4)),i=parseInt(n.substr(33,4));for(let n of this.findResidueIndices(this.iStructure,t,r)){e.iRes=n;while(e.resNum<=i&&t===e.chain)e.ss="E",e.iRes=e.iRes+1}}}}parsePdbData(t,e){this.structureId=e,this.structureIds.push(e),this.iStructure=this.structureIds.length-1;let r=Td(t),n=this.structureId.toUpperCase();this.title=`[<a href="http://www.rcsb.org/structure/${n}">${n}</a>] `+r;let i=t.split(/\r?\n/);if(0!==i.length){for(let t of s.a.range(i.length))if(s.a.includes(["END"],i[t].slice(0,3))){i=i.slice(0,t);break}this.parseAtomLines(i),this.parseSecondaryStructureLines(i)}else this.parsingError="No atom lines"}load(t){console.log(`Soup.load parse ${this.structureId}...`),this.parsePdbData(t.pdbText,this.structureId),console.log(`Soup.load processed ${this.getAtomCount()} atoms, `+this.getResidueCount()+" residues"),console.log("Soup.load finding bonds..."),this.calcBondsStrategic(),console.log(`Soup.load calculated ${this.getBondCount()} bonds`)}async asyncLoadProteinData(t,e){let r=t.pdbText,n=t.pdbId;if(0===t.pdbText.length)return void await e("Error: no soup data");if(await e(`Parsing '${n}'`),this.parsePdbData(r,n),this.parsingError){let t=this.soup.parsingError;return void await e("Error parsing soup: "+t)}let i=this.getAtomCount(),o=this.getResidueCount();await e(`Calculating bonds for ${i} atoms, ${o} residues...`),this.calcBondsStrategic(),this.parsedSecondaryStructure||(await e(`Calculated ${this.getBondCount()} bonds. Calculating secondary structure...`),this.findSecondaryStructure()),this.maxLength=this.calcMaxLength(),this.findGridLimits(),this.setSecondaryStructureColorResidues(),this.colorResidues(),this.calculateTracesForRibbons()}addAtom(t,e,r,n,i,o,s,a,u,l,c){let h=this.atomStore.count;this.atomStore.increment(),this.atomStore.x[h]=t,this.atomStore.y[h]=e,this.atomStore.z[h]=r,this.atomStore.bfactor[h]=n,this.atomStore.alt[h]=Ed(i),this.atomStore.bondCount[h]=0,this.atomStore.iAtomType[h]=xd(this.atomTypeTable,o),this.atomStore.iElem[h]=xd(this.elemTable,s);let d=this.getResidueCount(),p=!1;0===d?p=!0:(this.residueProxy.iRes=d-1,(this.residueProxy.resNum!==u||this.residueProxy.insCode!==l||this.chains[this.residueProxy.iChain]!==c)&&(p=!0)),p&&this.addResidue(h,u,l,c,a);let f=this.getResidueCount()-1;this.residueStore.atomCount[f]+=1,this.atomStore.iRes[h]=f}addResidue(t,e,r,n,i){let o=this.getResidueCount();this.residueStore.increment();let a=this.structureId+":";n&&(a+=n+":"),a+=e+s.a.trim(r),this.resIds.push(a);let u=xd(this.chains,n);this.residueStore.iChain[o]=u,this.residueStore.resNum[o]=e,this.residueStore.insCode[o]=Ed(r),this.residueStore.iResType[o]=xd(this.resTypeTable,i),this.residueStore.atomOffset[o]=t,this.residueStore.atomCount[o]=0,this.residueStore.iStructure[o]=this.iStructure}findFirstResidue(t,e){let r=this.getResidueProxy();for(let n of s.a.range(this.getResidueCount()))if(r.iRes=n,r.chain===t&&r.resNum===e)return r;return null}findResidueIndices(t,e,r){let n=[],i=this.getResidueProxy();for(let o of s.a.range(this.getResidueCount()))i.iRes=o,i.iStructure===t&&i.chain===e&&i.resNum===r&&n.push(o);return n}assignResidueProperties(t){let e=this.getResidueProxy();for(let r=0;r<this.getResidueCount();r+=1)if(e.iRes=r,e.iStructure===t)if(s.a.includes(rd,e.resType))e.iAtom=e.getIAtom("CA"),e.ss="C",e.isPolymer=!0;else if(s.a.includes(nd,e.resType)||s.a.includes(id,e.resType))e.iAtom=e.getIAtom("C3'"),e.ss="D",e.isPolymer=!0;else{e.isPolymer=!1,"HOH"===e.resType?e.ss="W":"XXX"===e.resType?e.ss="G":e.ss="-";let t=this.getCenter(e.getAtomIndices());e.iAtom=this.getIAtomClosest(t,e.getAtomIndices())}}getIAtomClosest(t,e){let r=null,n=1e6,i=this.getAtomProxy();for(let o of e)if(null===r)r=o;else{i.iAtom=o;let e=fh.distance(t,i.pos);e<n&&(r=o,n=e)}return r}getIAtomAtPosition(t){let e=s.a.range(this.getAtomCount()),r=null,n=1e6,i=this.getAtomProxy();for(let o of e)if(null===r)r=o;else{i.iAtom=o;let e=fh.distance(t,i.pos);e<n&&(r=o,n=e)}return n<.1?r:-1}getCenter(t){let e=fh.create(0,0,0),r=this.getAtomProxy();for(let n of t)e=fh.sum(e,r.load(n).pos);return e.divideScalar(t.length),e}calcMaxLength(t=null){let e=[0,0,0],r=[0,0,0],n=[0,0,0];function i(t,e){return 0===e?t.x:1===e?t.y:2===e?t.z:void 0}s.a.isNull(t)&&(t=s.a.range(this.getAtomCount()));let o=this.getAtomProxy();for(let s=0;s<3;s++){for(let n of t){let t=o.load(n).pos;r[s]>i(t,s)&&(r[s]=i(t,s)),e[s]<i(t,s)&&(e[s]=i(t,s))}n[s]=e[s]-r[s]}return Math.max(n[0],n[1],n[2])}calcBondsStrategic(){this.bondStore.count=0;const t=1.44,e=3.61,r=5.76,n=["C","H","O","N","P","S"];function i(i,o){if(null===i||null===o)return!1;if(""!==i.alt&&""!==o.alt&&i.alt!==o.alt)return!1;let s;s="H"===i.elem||"H"===o.elem?t:yh(i.elem,n)&&yh(o.elem,n)?e:r;let a=i.pos.x-o.pos.x,u=i.pos.y-o.pos.y,l=i.pos.z-o.pos.z,c=a*a+u*u+l*l;return c<=s}let o=(t,e)=>{let r=this.getBondCount();this.bondStore.increment(),this.bondStore.iAtom1[r]=t.iAtom,this.bondStore.iAtom2[r]=e.iAtom,r=this.getBondCount(),this.bondStore.increment(),this.bondStore.iAtom1[r]=e.iAtom,this.bondStore.iAtom2[r]=t.iAtom},s=this.getResidueProxy(),a=this.getResidueProxy(),u=this.getResidueCount(),l=this.getAtomProxy(),c=this.getAtomProxy();for(let f=0;f<u;f++){a.iRes=f;for(let t of a.getAtomIndices())for(let e of a.getAtomIndices())l.iAtom=t,c.iAtom=e,i(l,c)&&o(l,c)}for(let f=1;f<u;f++){if(s.iRes=f-1,a.iRes=f,a.isProteinConnectedToPrev())s.checkAtomTypes(["C"])&&a.checkAtomTypes(["N"])&&(l.iAtom=s.getIAtom("C"),c.iAtom=a.getIAtom("N"));else{if(!a.isNucleotideConnectedToPrev())continue;s.checkAtomTypes(["O3'"])&&a.checkAtomTypes(["P"])&&(l.iAtom=s.getIAtom("O3'"),c.iAtom=a.getIAtom("P"))}o(l,c)}let h=this.bondStore.iAtom1;this.bondStore.sort((t,e)=>h[t]-h[e]);for(let f=0;f<this.getAtomCount();f+=1)this.atomStore.bondCount[f]=0;let d=this.getBondProxy(),p=null;for(let f=0;f<this.getBondCount();f+=1)d.iBond=f,p!==d.iAtom1&&(p=d.iAtom1,this.atomStore.bondOffset[p]=f),this.atomStore.bondCount[p]+=1}findBackboneHbonds(){let t=this.getResidueProxy(),e=this.getAtomProxy(),r=this.getAtomProxy(),n=[],i=3.5;for(let o=0;o<this.structureIds.length;o+=1){let s=[],a=[];for(let r=0;r<this.getResidueCount();r+=1)if(t.iRes=r,t.iStructure===o&&t.isPolymer)for(let n of["O","N"]){let r=t.getIAtom(n);null!==r&&(e.iAtom=r,s.push([e.pos.x,e.pos.y,e.pos.z]),a.push(r))}let u=new Qh(s);for(let t of u.getClosePairs()){if(e.iAtom=a[t[0]],r.iAtom=a[t[1]],"O"===e.elem&&"N"===r.elem&&([e,r]=[r,e]),"N"!==e.elem||"O"!==r.elem)continue;let o=e.iRes,s=r.iRes;o!==s&&(fh.distance(e.pos,r.pos)<=i&&bd(n,o,s))}}this.conhPartners=n}findSecondaryStructure(){this.findBackboneHbonds();let t=this.conhPartners,e={},r=this.getResidueCount(),n=this.getResidueProxy(),i=this.getResidueProxy(),o=this.getAtomProxy(),a=this.getAtomProxy();function u(e,n){return!(n<0||n>=r||e<0||e>=r)&&s.a.includes(t[n],e)}function l(t,e){return o.iAtom=n.load(t).iAtom,a.iAtom=i.load(e).iAtom,fh.diff(o.pos,a.pos)}let c=[],h=[],d=[];for(let s=0;s<this.getResidueCount();s+=1)if(n.iRes=s,n.isPolymer&&"D"!==n.ss){let t=n.getIAtom("CA");null!==t&&(o.iAtom=t,c.push([o.pos.x,o.pos.y,o.pos.z]),h.push(t),d.push(s))}for(let s=0;s<r;s+=1)if(n.iRes=s,n.isPolymer)if("D"!==n.ss){if(u(s,s+4)&&u(s+1,s+5)){let t=l(s,s+4),r=l(s+1,s+5);for(let i=s+1;i<s+5;i+=1)n.load(i).ss="H",bd(e,i,t),bd(e,i,r)}if(u(s,s+3)&&u(s+1,s+4)){let t=l(s,s+3),r=l(s+1,s+4);for(let i=s+1;i<s+4;i+=1)n.load(i).ss="H",bd(e,i,t),bd(e,i,r)}}else bd(e,s,n.getNucleotideNormal());let p=[],f=new Qh(c);for(let s of f.getClosePairs()){let[t,r]=s,n=d[t],i=d[r];if(!(Math.abs(n-i)<=5)){if(u(n,i+1)&&u(i-1,n)&&(p=p.concat([n,i])),u(n-1,i)&&u(i,n+1)&&(p=p.concat([n,i])),u(n,i)&&u(i,n)){p=p.concat([n,i]);let t=l(n,i);bd(e,n,t),bd(e,i,fh.scaled(t,-1))}if(u(n-1,i+1)&&u(i-1,n+1)){p=p.concat([n,i]);let t=l(n,i);bd(e,n,fh.scaled(t,-1)),bd(e,i,t)}}}for(let s of p)n.load(s).ss="E";for(let s=0;s<r;s+=1)if(s in e&&e[s].length>0){let t=fh.create(0,0,0);for(let r of e[s])t=fh.sum(t,r);this.residueNormal[s]=fh.normalized(t)}for(let s=1;s<r;s+=1)n.iRes=s-1,i.iRes=s,"E"===n.ss&&n.normal&&"E"===i.ss&&i.normal&&i.normal.dot(n.normal)<0&&this.residueNormal[s].negate()}calculateTracesForRibbons(){let t;this.traces.length=0;let e=this.getResidueProxy(),r=this.getResidueProxy(),n=this.getAtomProxy(),i=this.getResidueCount();for(let o=0;o<i;o+=1)if(e.iRes=o,o<i-1&&(r.iRes=o+1,r.isConnectedToPrev()&&(e.isPolymer=!0,r.isPolymer=!0)),e.isPolymer){if(s.a.isUndefined(t)||0===o||!e.isConnectedToPrev()){let r=new Ph;r.getReference=t=>(e.iRes=r.indices[t],e),this.traces.push(r),t=r}t.indices.push(o),e.getIAtom("CA")?n.iAtom=e.getIAtom("CA"):e.getIAtom("C3'")?n.iAtom=e.getIAtom("C3'"):n.iAtom=e.iAtom,t.refIndices.push(e.iRes),t.points.push(n.pos.clone()),t.colors.push(e.activeColor),t.indexColors.push(Ad(e.iAtom)),t.segmentTypes.push(e.ss),t.normals.push(e.normal)}for(let o of this.traces)o.calcTangents(),o.calcNormals(),o.calcBinormals(),o.expand()}getIStructureAndChain(){if(this.selectedTraces.length>0){let t=this.selectedTraces[0],e=this.traces[t];if(s.a.isNil(e))return null;let r=this.traces[t].indices[0],n=this.getResidueProxy(r),i=n.iStructure,o=n.chain;return{iStructure:i,chain:o}}return null}getAtomProxy(t){return new Cd(this,t)}getAtomCount(){return this.atomStore.count}getResidueProxy(t){return new Od(this,t)}getBondProxy(t){return new Dd(this,t)}getBondCount(){return this.bondStore.count}getResidueCount(){return this.residueStore.count}areCloseResidues(t,e){let r=this.getAtomProxy(),n=this.getAtomProxy(),i=this.getResidueProxy(t),o=r.load(i.iAtom).pos.clone(),s=i.getAtomIndices(),a=this.getResidueProxy(e),u=n.load(a.iAtom).pos.clone(),l=a.getAtomIndices();if(fh.distance(o,u)>17)return!1;for(let c of s)for(let t of l)if(fh.distance(r.load(c).pos,n.load(t).pos)<4)return!0;return!1}clearSelectedResidues(){let t=this.getResidueProxy();for(let e=0;e<this.getResidueCount();e+=1)t.load(e).selected=!1}clearSidechainResidues(){let t=this.getResidueProxy();for(let e=0;e<this.getResidueCount();e+=1)t.load(e).sidechain=!1}setSidechainOfResidues(t,e){let r=this.getResidueProxy();for(let n of t)r.load(n).sidechain=e}getAtomsOfChainContainingResidue(t){let e=this.getResidueProxy(t),r=e.iStructure,n=e.chain,i=[];for(let o=0;o<this.getResidueCount();o+=1)e.iRes=o,e.iStructure===r&&e.chain===n&&i.push(e.iAtom);return i}getNeighbours(t){let e=[t];for(let r=0;r<this.getResidueCount();r+=1)this.areCloseResidues(r,t)&&e.push(r);return e}isResCloseToPoint(t,e){let r=this.getAtomProxy(),n=this.getResidueProxy(t),i=r.load(n.iAtom).pos.clone();if(fh.distance(i,e)>17)return!1;let o=n.getAtomIndices();for(let s of o)if(fh.distance(r.load(s).pos,e)<5)return!0;return!1}getNeighboursOfPoint(t){let e=[];for(let r=0;r<this.getResidueCount();r+=1)this.isResCloseToPoint(r,t)&&e.push(r);return e}setSecondaryStructureColorResidues(){let t=this.getResidueProxy();for(let e of s.a.range(this.getResidueCount()))t.iRes=e,t.customColor=pd(t.ss)}colorResidues(){let t=this.getResidueProxy(),e=s.a.some(s.a.values(this.grid.isElem));if(e)for(let r of s.a.range(this.getResidueCount()))t.iRes=r,t.color=hd;for(let r of s.a.range(this.getResidueCount()))t.iRes=r,t.color=e?hd:t.customColor}findGridLimits(){let t=this.getResidueProxy(),e=this.getAtomProxy();this.grid.isElem={};for(let r=0;r<this.getResidueCount();r+=1)t.iRes=r,"G"===t.ss&&(e.iAtom=t.iAtom,e.elem in this.grid.isElem||(this.grid.isElem[e.elem]=!0),null===this.grid.bMin?(this.grid.bMin=e.bfactor,this.grid.bMax=e.bfactor):(e.bfactor>this.grid.bMax&&(this.grid.bMax=e.bfactor),e.bfactor<this.grid.bMin&&(this.grid.bMin=e.bfactor)));null===this.grid.bMin&&(this.grid.bMin=0),null===this.grid.bMax&&(this.grid.bMin=0),s.a.isNil(this.grid)&&(this.grid.bCutoff=this.grid.bMin)}makeSelectedResidueList(){let t=[],e=this.getResidueProxy();for(let r=0;r<this.getResidueCount();r+=1)e.load(r).sidechain&&t.push(r);return t}}var kd=r("9e12"),Fd=r.n(kd);r("0e33"),r("4939");class Vd{constructor(t,e){this.color=e,this.div=i()("<canvas>").css({position:"absolute","z-index":"1",display:"none","pointer-events":"none"}),this.canvas=this.div[0],this.context2d=this.canvas.getContext("2d"),this.parentDiv=i()(t.divTag),this.parentDiv.append(this.div)}hide(){this.div.css("display","none")}move(t,e,r,n){this.parentDiv.position();let i=Math.abs(t-r),o=Math.abs(e-n),s=Math.min(t,r),a=Math.min(e,n);this.div.css("display","block").css("width",i).css("height",o).css("top",a).css("left",s),this.canvas.width=i,this.canvas.height=o,this.context2d.clearRect(0,0,i,o),this.context2d.beginPath(),this.context2d.moveTo(t-s,e-a),this.context2d.lineTo(r-s,n-a),this.context2d.lineWidth=2,this.context2d.strokeStyle=this.color,this.context2d.stroke()}}class zd{constructor(t){this.parentDiv=i()(t),this.parentDivId=this.parentDiv.attr("id"),this.div=i()("<div>").css("user-select","none"),this.parentDiv.append(this.div),this.canvas=i()("<canvas>"),this.div.append(this.canvas),this.canvasDom=this.canvas[0],this.drawContext=this.canvasDom.getContext("2d"),this.mousePressed=!1,this.downTimer=null;const e=this.canvasDom,r=(t,r)=>{e.addEventListener(t,r)};r("mousedown",t=>this.mousedown(t)),r("mousemove",t=>this.mousemove(t)),r("mouseup",t=>this.mouseup(t)),r("mouseout",t=>this.mouseout(t)),r("touchstart",t=>this.mousedown(t)),r("touchmove",t=>this.mousemove(t)),r("touchend",t=>this.mouseup(t)),r("touchcancel",t=>this.mouseup(t))}width(){return this.parentDiv.width()}height(){return this.parentDiv.height()}x(){let t=this.parentDiv.position();return t.left}y(){let t=this.parentDiv.position();return t.top}inside(t,e){return t>=this.x()&&t<=this.x()+this.width()&&e>=this.y()&&e<=this.y()+this.height()}update(){}resize(){this.canvasDom.width=this.width(),this.canvasDom.height=this.height()}strokeRect(t,e,r,n,i){this.drawContext.strokeStyle=i,this.drawContext.strokeRect(t,e,r,n)}fillRect(t,e,r,n,i){this.drawContext.fillStyle=i,this.drawContext.strokeStyle="none",this.drawContext.fillRect(t,e,r,n)}line(t,e,r,n,i,o){this.drawContext.fillStyle=o,this.drawContext.strokeStyle=o,this.drawContext.beginPath(),this.drawContext.lineWidth=i,this.drawContext.moveTo(t,e),this.drawContext.lineTo(r,n),this.drawContext.stroke()}text(t,e,r,n,i,o){this.drawContext.fillStyle=i,this.drawContext.font=n,this.drawContext.textAlign=o,this.drawContext.textBaseline="middle",this.drawContext.fillText(t,e,r)}textWidth(t,e){return this.drawContext.font=e,this.drawContext.textAlign="center",this.drawContext.measureText(t).width}saveMouse(){this.saveMouseX=this.pointerX,this.saveMouseY=this.pointerY,this.saveMouseR=this.mouseR,this.saveMouseT=this.mouseT}click(t){}doubleclick(t){}mousedown(t){t.preventDefault(),this.getPointer(t),this.saveMouse(),this.mousePressed=!0,null===this.downTimer?this.downTimer=setTimeout(()=>this.click(t),250):(clearTimeout(this.downTimer),this.doubleclick(t),this.downTimer=null),this.mousemove(t)}mousemove(t){}mouseout(t){}mouseup(t){t.preventDefault(),this.mousePressed=!1}getPointer(t){mh(t.touches)&&t.touches.length>0?(this.eventX=t.touches[0].clientX,this.eventY=t.touches[0].clientY):(this.eventX=t.clientX,this.eventY=t.clientY);let e=t.target.getBoundingClientRect();this.pointerX=this.eventX-e.left,this.pointerY=this.eventY-e.top;let r=this.pointerX-this.width()/2,n=this.pointerY-this.height()/2;this.mouseR=Math.sqrt(r*r+n*n),this.mouseT=Math.atan(n/r),r<0&&(n>0?this.mouseT+=Math.PI:this.mouseT-=Math.PI)}}class Ud{constructor(t,e){s.a.isUndefined(e)?this.heightArrow=30:this.heightArrow=e,this.div=i()("<div>").css({position:"absolute",top:0,left:0,background:"white","box-sizing":"border-box",font:"12px Helvetica",color:"#666",padding:"5",opacity:.8,display:"none","max-width":"300px","z-index":1,cursor:"pointer","user-select":"none","pointer-events":"none"}),this.arrow=i()("<div>").css({position:"absolute",top:0,left:0,width:0,height:0,"box-sizing":"border-box","border-left":"5px solid transparent","border-right":"5px solid transparent","border-top":this.heightArrow+"px solid white",opacity:.8,display:"none","z-index":1,"pointer-events":"none","user-select":"none"}),this.parentDiv=i()(t),this.parentDiv.append(this.div),this.parentDiv.append(this.arrow)}move(t,e){this.div.css({display:"block"});let r=this.div[0].getBoundingClientRect(),n=r.width,i=r.height;this.arrow.css({display:"block"}),t<0||t>this.parentDiv.width()||e<0||e>this.parentDiv.height()?this.hide():(this.arrow.css({top:e-this.heightArrow,left:t-5}),this.div.css({top:e-this.heightArrow-i,left:t-n/2}))}hide(){this.div.css("display","none"),this.arrow.css("display","none")}html(t){this.div.html(t)}remove(){this.div.remove(),this.arrow.remove()}}class jd{constructor(t){this.soupWidget=t,this.soupView=t.soupView,this.controller=t.controller,this.popups=[]}removePopup(t){this.controller.deleteAtomLabel(t),this.popups[t].remove(),this.popups.splice(t,1)}createPopup(t){let e=new Ud(this.soupWidget.divTag);return e.i=t,e.div.css("pointer-events","auto"),e.div.click(()=>{this.removePopup(e.i)}),e}drawFrame(){let t=this.soupView.currentView.labels;if(t.length>this.popups.length)for(let r=this.popups.length;r<t.length;r+=1)this.popups.push(this.createPopup(r));if(this.popups.length>t.length)for(let r=this.popups.length-1;r>=t.length;r-=1)this.removePopup(r);let e=this.soupView.soup.getAtomProxy();for(let r=0;r<t.length;r+=1){this.popups[r].i=r,e.iAtom=t[r].i_atom,this.popups[r].html(t[r].text);let n=.7*this.soupWidget.opacity(e.pos)+.2;this.popups[r].div.css("opacity",n),this.popups[r].arrow.css("opacity",n);let i=this.soupWidget.getPosXY(e.pos);this.popups[r].move(i.x,i.y),this.soupWidget.inZlab(e.pos)||(this.popups[r].div.css("display","none"),this.popups[r].arrow.css("display","none"))}}}class Bd{constructor(t){this.distanceMeasures=[],this.scene=t.displayScene,this.soupView=t.soupView,this.controller=t.controller,this.soupWidget=t,this.parentDiv=i()(this.soupWidget.divTag),this.divs=[]}removeDistance(t){this.scene.remove(this.distanceMeasures[t].line),this.distanceMeasures[t].div.remove(),this.controller.deleteDistance(t),this.distanceMeasures.splice(t,1)}createDistanceMeasure(t){let e=i()("<div>").css({position:"absolute",top:0,left:0,"background-color":"#FFDDDD",padding:"5",opacity:.7,"font-family":"sans-serif"});e.i=t,e.click(()=>{this.removeDistance(e.i)}),this.parentDiv.append(e);let r=new fi;r.vertices.push(new Ne(0,0,0)),r.vertices.push(new Ne(1,1,1));let n=new yu({color:16742263,dashSize:3,gapSize:4,linewidth:1}),o=new ks(r,n);return o.dontDelete=!0,this.scene.add(o),{line:o,div:e}}drawFrame(){let t=this.soupView.currentView.distances;if(t.length>this.distanceMeasures.length)for(let n=this.distanceMeasures.length;n<t.length;n+=1)this.distanceMeasures.push(this.createDistanceMeasure(n));if(this.distanceMeasures.length>t.length)for(let n=this.distanceMeasures.length-1;n>=t.length;n-=1)this.removeDistance(n);this.parentDiv.position();let e=this.soupView.soup.getAtomProxy(),r=this.soupView.soup.getAtomProxy();for(let n=0;n<t.length;n+=1){let i=t[n];this.distanceMeasures[n].div.i=n;let o=this.distanceMeasures[n],s=e.load(i.i_atom1).pos,a=r.load(i.i_atom2).pos,u=s.distanceTo(a).toFixed(1);o.div.text(u);let l=s.clone().add(a).multiplyScalar(.5),c=.7*this.soupWidget.opacity(l)+.3,h=this.soupWidget.getPosXY(l),d=h.x,p=h.y;if(d<0||d>this.parentDiv.width()||p<0||p>this.parentDiv.height()){o.div.hide();continue}let f=o.div.innerHeight(),m=o.div.innerWidth();o.div.css({top:p-f/2,left:d-m/2,display:"block",cursor:"pointer",opacity:c}),o.line.geometry.vertices[0].copy(s),o.line.geometry.vertices[1].copy(a),this.soupWidget.inZlab(l)||o.div.css("display","none")}}}class Hd extends zd{constructor(t,e){super(t),this.soupWidget=e,this.soupView=e.soupView,this.soup=e.soup,this.controller=e.controller,this.soupWidget.addObserver(this),this.residue=this.soup.getResidueProxy(),this.charWidth=14,this.charHeight=15,this.offsetY=6,this.heightStructureBar=7,this.spacingY=12,this.yTopSequence=this.offsetY+this.heightStructureBar+2*this.spacingY,this.yBottom=parseInt(this.yTopSequence+2.7*+this.spacingY+this.charHeight),this.yMidSequence=this.yTopSequence+1.2*this.spacingY+this.charHeight/2,this.unclickableColor="#AAA",this.structBarBgroundColor="#CCC",this.seqBarBgroundColor="#FFF",this.highlightColor="red",this.borderColor="#999",this.div.attr("id",this.parentDivId+"-inner"),this.div.css({"background-color":"#CCC",position:"relative"}),this.isWaitForDoubleClick=!1,this.charEntries=[],this.nChar=null,this.iCharSeqStart=null,this.iCharSeqEnd=null,this.nCharSeq=null,this.iCharStructStart=null,this.iCharStructEnd=null,this.nCharStruct=null,this.nPadChar=0,this.hover=new Ud(`#${this.parentDivId}-inner`,15),this.pressSection="none"}width(){return this.parentDiv.width()}height(){return this.yBottom}resize(){super.resize(),this.div.height(this.height()),this.parentDiv.height(this.height())}iCharFromXStruct(t){return parseInt(t*this.nCharStruct/this.textWidth())+this.iCharStructStart}xStructFromIChar(t){return parseInt((t-this.iCharStructStart)/this.nCharStruct*this.textWidth())}textWidth(){return this.width()}iCharFromXSeq(t){return parseInt(t*this.nCharSeq/this.textWidth())+this.iCharSeqStart}xSeqFromIChar(t){return parseInt((t-this.iCharSeqStart)/this.nCharSeq*this.textWidth())}calcNPad(){let t=[];for(let n of s.a.range(this.soup.structureIds.length))t.push(0);let e=this.soup.getResidueProxy();for(let n of s.a.range(this.soup.getResidueCount()))e.iRes=n,e.isPolymer&&(t[e.iStructure]+=1);t=s.a.filter(t,t=>t>0);let r=s.a.mean(t);this.nPadChar=parseInt(.02*r)}rebuild(){this.charEntries.length=0,this.calcNPad();let t=-1,e=0,r=this.soup.getResidueProxy();for(let n of s.a.range(this.soup.getResidueCount())){if(r.iRes=n,!r.isPolymer)continue;if(e!==r.iStructure||t!==r.iChain){t=r.iChain,e=r.iStructure;for(let n of s.a.range(this.nPadChar)){let i=null;0===n&&(i=this.soup.structureIds[e],i+=":"+this.soup.chains[t]),this.charEntries.push({chain:r.chain,iStructure:e,c:"",startLabel:i,iRes:null,ss:""})}}let i={iStructure:e,chain:r.chain,iRes:n,startLabel:null,ss:r.ss,label:r.resId+":"+r.resType,resNum:r.resNum},o=r.resType;i.c=o in fd?fd[o]:".",this.charEntries.push(i)}this.nChar=this.charEntries.length,this.iCharSeqStart=this.nPadChar,this.iCharStructStart=0,this.nCharStruct=this.nChar,this.iCharStructEnd=this.nChar}centerSeqOnIChar(t){this.iCharSeqStart=Math.max(t-.5*this.nCharSeq,0),this.iCharSeqStart=Math.min(this.iCharSeqStart,this.nChar-this.nCharSeq),this.iCharSeqStart=parseInt(this.iCharSeqStart),this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}getColorStyle(t){if(t>=this.charEntries.length)return this.unclickableColor;let e=this.charEntries[t].iRes;return s.a.isNil(e)?this.unclickableColor:(this.residue.load(e),s.a.isNil(this.residue.activeColor)?this.unclickableColor:"#"+this.residue.activeColor.getHexString())}findFirstResidue(t){for(let e=t;e<this.nChar-1;e+=1){let t=this.charEntries[e+1];if(!s.a.isNil(t.iRes))return e}return null}checkChain(){this.nCharSeq=Math.ceil(this.width()/this.charWidth);let t=this.chain;if(this.iCharStructStart=0,this.nCharStruct=this.charEntries.length,this.iCharStructEnd=this.iCharStructStart+this.nCharStruct,"chain"===this.soupView.getMode()){let e=this.soup.getIStructureAndChain();if(s.a.isNil(e))this.chain=null;else{this.iCharStructStart=null;for(let t of s.a.range(this.charEntries.length)){let r=this.charEntries[t];r.iStructure===e.iStructure&&r.chain===e.chain&&(s.a.isNil(this.iCharStructStart)&&(this.iCharStructStart=t,this.chain=r.chain),this.iCharStructEnd=t+1)}if(this.nCharStruct=this.iCharStructEnd-this.iCharStructStart,s.a.isNil(t)&&!s.a.isNil(this.chain)){for(let t=this.iCharStructStart;t<this.iCharStructEnd;t+=1)if(s.a.has(this.charEntries[t],"iRes")){this.iCharSeqStart=t,this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq;break}}else if(this.iCharSeqStart<this.iCharStructStart||this.iCharSeqStart>=this.iCharStructEnd){let t=this.findFirstResidue(this.iCharStructStart);s.a.isNil(t)?this.iCharSeqStart=this.iCharStructStart:this.iCharSeqStart=t,this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}}}this.iCharSeqStart+this.nCharSeq>this.charEntries.length&&(this.iCharSeqStart=this.iCharSeqEnd-this.nCharSeq),this.iCharSeqStart<0&&(this.iCharSeqStart=0),this.iCharSeqEnd=this.iCharSeqStart+this.nCharSeq}draw(){this.checkChain();let t=this.offsetY-2,e=this.offsetY+7,r=this.yTopSequence-t+2,n=t+r/2+2,i=this.yBottom-this.yTopSequence;if(this.fillRect(0,0,this.width(),this.height(),this.structBarBgroundColor),this.fillRect(0,this.yTopSequence,this.width(),i,this.seqBarBgroundColor),this.line(0,this.yTopSequence,this.width(),this.yTopSequence,1,this.borderColor),this.line(0,this.yBottom,this.width(),this.yBottom,1,this.borderColor),!mh(this.soupView))return;if(0===this.charEntries.length)return;let o,a=this.soupView.currentView.iAtom,u=this.soupView.soup.getAtomProxy(a).iRes,l=this.xStructFromIChar(this.iCharSeqStart),c=this.xStructFromIChar(this.iCharSeqEnd);this.fillRect(l,t,c-l,r,this.seqBarBgroundColor),this.line(0,n,this.width(),n,1,this.borderColor);let h,d=this.charEntries[0].ss,p=this.charEntries[0].c,f=this.getColorStyle(0),m=0,g=0;while(g<this.nChar){g+=1,h=this.getColorStyle(g);let t=this.charEntries[g],e=s.a.isNil(t)||g===this.nChar||t.ss!==d||h!==f;if(e){let e=this.xStructFromIChar(m),r=this.xStructFromIChar(g),i=this.heightStructureBar,o=n-i/2;""!==p&&("C"!==d&&"."!==d&&(o-=2,i+=4),this.fillRect(e,o,r-e,i,f)),g<=this.nChar-1&&(m=g,d=t.ss,p=t.c,f=h)}}this.line(0,this.yMidSequence,this.width(),this.yMidSequence,1,this.borderColor);for(let y=this.iCharSeqStart;y<this.iCharSeqEnd;y+=1){let t=this.charEntries[y];if(s.a.isUndefined(t)||""===t.c)continue;o=this.getColorStyle(y);let e=this.xSeqFromIChar(y),r=this.xSeqFromIChar(y+1),n=r-e,i=e+n/2,a=this.charHeight,l=this.yMidSequence-a/2;"C"!==t.ss&&"."!==t.ss&&(l-=4,a+=8),this.fillRect(e,l,n,a,o),this.text(t.c,i,this.yMidSequence,"7pt Helvetica","white","center"),this.soupWidget.isCrossHairs&&u>=0&&u===t.iRes&&this.strokeRect(e,l-5,n,a+10,this.highlightColor),t.resNum%20!==0&&1!==t.resNum||(this.line(e,this.yBottom,e,this.yBottom-6,1,this.borderColor),this.text(""+t.resNum,e+3,this.yBottom-6,"7pt Helvetica",this.borderColor,"left"))}this.line(l-1,t,c+1,t,1,this.borderColor),this.line(l-1,t,l-1,this.yTopSequence+1,1,this.borderColor),this.line(c+1,t,c+1,this.yTopSequence+1,1,this.borderColor);let v=0;while(v<this.nChar){if(this.charEntries[v].startLabel){let t=this.xStructFromIChar(v)+12;this.text(this.charEntries[v].startLabel,t,e,"7pt Helvetica","#666","left")}v+=1}}update(){let t=s.a.get(this.soupView,"targetView.iAtom"),e=this.soupView.soup.getAtomProxy(t).iRes;if(!s.a.isNil(e))for(let r in s.a.range(this.nChar))if(this.charEntries[r].iRes===e){(r<this.iCharSeqStart||r>=this.iCharSeqStart+this.nCharSeq)&&this.centerSeqOnIChar(r);break}this.draw()}mousemove(t){if(this.getPointer(t),this.pointerY<this.yTopSequence){this.hover.hide();let t=this.iCharFromXStruct(this.pointerX),e=this.charEntries[t];""!==s.a.get(e,"c","")&&(this.hover.html(e.label),this.hover.move(this.xStructFromIChar(t),25))}else{this.hover.hide();let t=this.iCharFromXSeq(this.pointerX),e=this.charEntries[t];if(""!==s.a.get(e,"c","")){this.hover.html(e.label);let r=this.xSeqFromIChar(t)+this.charWidth/2;this.hover.move(r,this.yMidSequence)}}if("top"===this.mousePressed)this.centerSeqOnIChar(this.iCharFromXStruct(this.pointerX)),this.draw();else if("bottom"===this.mousePressed){let t=this.iCharFromXSeq(this.pointerX),e=t-this.iCharPressed;this.iCharSeqStart-=e,this.draw()}}mouseout(){this.hover.hide(),this.mousePressed=""}mouseup(){this.isWaitForDoubleClick&&this.click(event),this.hover.hide(),this.mousePressed=""}doubleclick(t){console.log("SequenceWidget.doubleclick",this.pressSection,this.iCharPressed),this.getPointer(t);let e=null;e="bottom"===this.pressSection?this.iCharFromXSeq(this.pointerX):this.iCharFromXStruct(this.pointerX);let r=this.charEntries[e];if(!s.a.isNil(r.iRes)){"top"===this.pressSection?this.controller.selectSecondaryStructure(r.iRes):this.controller.setResidueSelect(r.iRes,!0);let t=this.soup.getResidueProxy(r.iRes);this.controller.triggerAtom(t.iAtom)}}click(t){let e=null;if(e="bottom"===this.pressSection?this.iCharFromXSeq(this.pointerX):this.iCharFromXStruct(this.pointerX),e===this.iCharPressed)if("top"===this.pressSection){let t=this.charEntries[this.iCharPressed];if(!s.a.isNil(t.iRes)){let e=t.iRes;this.controller.toggleSecondaryStructure(e)}}else if("bottom"===this.pressSection){let e=this.charEntries[this.iCharPressed];if(!s.a.isNil(e.iRes)){let r=e.iRes;t.metaKey||t.shiftKey?t.shiftKey?this.controller.selectAdditionalRangeToResidue(r):this.controller.selectAdditionalResidue(r):this.controller.selectResidue(r)}}}mousedown(t){t.preventDefault(),this.getPointer(t),this.saveMouse(),this.pointerY<this.yTopSequence?this.mousePressed="top":this.mousePressed="bottom";let e=(new Date).getTime(),r=this.timePressed?e-this.timePressed:0;r>600&&(this.isWaitForDoubleClick=!1),this.isWaitForDoubleClick?r<600&&(this.doubleclick(t),this.isWaitForDoubleClick=!1):(this.pressSection=this.mousePressed,"bottom"===this.pressSection?this.iCharPressed=this.iCharFromXSeq(this.pointerX):this.iCharPressed=this.iCharFromXStruct(this.pointerX),this.isWaitForDoubleClick=!0),this.timePressed=(new Date).getTime(),this.mousemove(t)}}class Gd extends zd{constructor(t,e){super(e),this.div.css("position","relative"),this.soupView=t.soupView,this.controller=t.controller,t.addObserver(this),this.maxZLength=0,this.div.css("box-sizing","border-box"),this.zFrontColor="rgb(150, 90, 90)"}resize(){this.div.css({width:this.width(),height:this.height()}),super.resize(),this.update()}x(){return 0}y(){return 0}width(){let t=this.parentDiv[0].getBoundingClientRect();return t.width-20}height(){return this.parentDiv.height()}xToZ(t){let e=t/this.width();return(.5-e)*this.maxZLength}zToX(t){let e=t/this.maxZLength;return(.5-e)*this.width()}update(){let t=this.soupView.soup,e=this.soupView.currentView.cameraParams;this.maxZLength=2*t.maxLength;let r=this.zToX(e.zBack),n=this.zToX(e.zFront),i=this.zToX(0),o=this.height()/2,s="9pt Helvetica";this.fillRect(0,0,this.width(),this.height(),"#999"),this.fillRect(0,o-3,this.width(),6,"#AAB"),this.fillRect(i,o-3,r-i,6,this.zFrontColor);let a=this.textWidth("back",s);this.fillRect(r-6-a,0,a+6,this.height(),"#666"),this.text("back",r-3-a,o,s,"#AAA","left"),this.fillRect(n,o-3,i-n,6,this.zFrontColor);let u=this.textWidth("front",s);this.fillRect(n,0,u+6,this.height(),"#666"),this.text("front",n+3,o,s,"#AAA","left"),this.line(i,0,i,this.height(),1,"#995555")}getZ(t){this.getPointer(t),this.z=this.xToZ(this.pointerX)}mousedown(t){this.getZ(t),this.z>0?(this.back=!0,this.front=!1):(this.front=!0,this.back=!1),super.mousedown(t)}mousemove(t){if(t.preventDefault(),super.mousemove(t),!this.mousePressed)return;this.getZ(t);let e=this.soupView.currentView.cameraParams,r=e.zBack,n=e.zFront;this.back?this.controller.setZoom(Math.max(2,this.z),n):this.front&&this.controller.setZoom(r,Math.min(-2,this.z)),this.update()}}class qd{constructor(t,e,r,n,o,s){this.soupView=t.soupView,this.controller=t.controller,this.elem=r,this.color=s,this.div=i()(e).text(r).addClass("jolecule-button").css("position","absolute").css("top",o+"px").css("left",n+"px").css("height","15px").css("width","20px").on("click touch",t=>{t.preventDefault(),this.toggle()}),this.update(),t.addObserver(this)}getToggle(){return this.soupView.soup.grid.isElem[this.elem]}toggle(){this.controller.toggleGridElem(this.elem),this.update()}update(){this.getToggle()?this.color?this.div.css("background-color",this.color):this.div.addClass("jolecule-button-toggle-on"):this.color?this.div.css("background-color",""):this.div.removeClass("jolecule-button-toggle-on")}}class Wd extends zd{constructor(t){super(t.divTag),this.soupWidget=t,this.soupView=t.soupView,this.controller=t.controller,t.addObserver(this),this.backgroundColor="#999",this.buttonHeight=40,this.sliderHeight=6*this.buttonHeight-30,this.isGrid=t.isGrid,this.div.css("display","none"),this.div.attr("id","grid-control"),this.div.css("height",this.height()),this.div.addClass("jolecule-button"),this.buttonsDiv=i()('<div id="grid-control-buttons">'),this.div.append(this.buttonsDiv)}rebuild(){if(!this.isGrid)return;this.buttonsDiv.empty();let t=10;for(let e of s.a.keys(this.soupView.soup.grid.isElem))this.makeElemButton(e,t),t+=this.buttonHeight;0===s.a.keys(this.soupView.soup.grid.isElem).length?this.div.hide():this.div.show()}makeElemButton(t,e){let r=dd[t],n="#"+r.getHexString(),o="grid-button-"+t.toLowerCase(),s="#"+o;this.buttonsDiv.append(i()(`<div id="${o}">`)),new qd(this.soupWidget,s,t,50,e,n)}resize(){this.isGrid&&(this.div.css({width:this.width(),height:this.height(),top:this.y(),left:this.x()}),this.canvasDom.width=this.width(),this.canvasDom.height=this.height())}width(){return 84}height(){return 6*this.buttonHeight+10}x(){let t=this.parentDiv.position();return t.left+5}y(){let t=this.parentDiv.position();return t.top+50}yToZ(t){let e=(t-20)/this.sliderHeight,r=this.soupView.soup.grid,n=r.bMax-r.bMin,i=e*n+r.bMin;return i<this.soupView.soup.grid.bMin&&(i=this.soupView.soup.grid.bMin),i>this.soupView.soup.grid.bMax&&(i=this.soupView.soup.grid.bMax),i}zToY(t){let e=this.soupView.soup.grid,r=e.bMax-e.bMin;return(t-e.bMin)/r*this.sliderHeight+20}update(){if(!this.isGrid)return;this.fillRect(0,0,this.width(),this.height(),this.backgroundColor);let t=20,e=this.zToY(this.soupView.soup.grid.bMin),r=this.zToY(this.soupView.soup.grid.bMax);this.fillRect(t-3,e,6,r-e,"#AAB");let n="10px sans-serif",i="#333",o=this.zToY(this.soupView.soup.grid.bCutoff),s=this.soupView.soup.grid.convertB(this.soupView.soup.grid.bCutoff).toFixed(2);this.fillRect(t-3,o,6,r-o,"rgb(150, 90, 90)"),this.fillRect(5,o,30,5,i),this.text(s,t,o-8,n,i,"center"),this.line(5,r,35,r,1,"#666"),s=this.soupView.soup.grid.convertB(this.soupView.soup.grid.bMax).toFixed(2),this.text(s,t,r+6,n,i,"center")}getZ(t){this.getPointer(t),this.z=this.yToZ(this.pointerY)}mousedown(t){t.preventDefault(),this.getZ(t),this.mousePressed=!0,this.mousemove(t)}mousemove(t){t.preventDefault(),this.mousePressed&&(this.getZ(t),this.controller.setGridCutoff(this.z),this.update())}mouseup(t){t.preventDefault(),this.mousePressed=!1}}class $d extends zd{constructor(t){super(t.divTag),this.offset={x:5,y:5},this.canvas.hide(),this.default(),this.div.css("display","block"),this.div.attr("id","color-legend"),this.div.addClass("jolecule-button"),this.div.css({padding:"8px",position:"absolute",height:"auto",width:"auto"}),this.buttonsDiv=i()("<div>").attr("id","color-legend-buttons").css("text-align","left"),this.div.append(this.buttonsDiv),this.isShow=!0,t.addObserver(this),this.rebuild()}default(){let t=t=>"#"+pd(t).getHexString();this.title="Secondary Structure",this.colorEntries=[{color:t("E"),label:"Strand"},{color:t("H"),label:"Helix"},{color:t("C"),label:"Coil"},{color:t("D"),label:"DNA/RNA"}]}rebuild(){this.buttonsDiv.empty(),this.title&&this.buttonsDiv.append(i()("<div>").text(this.title).css({"font-size":"0.8em","font-style":"italic"}));for(let[t,e]of this.colorEntries.entries()){let r="color-legend-"+t,n=i()("<div>").attr("id",r).css({"font-size":"0.8em","line-height":"1.5em",display:"block"}),o=i()("<div>").html("&block;").css({color:e.color,display:"inline","font-size":"1em","margin-right":"0.7em"});n.append(o),n.append(e.label),this.buttonsDiv.append(n)}this.resize(),this.update()}resize(){this.div.css({bottom:this.offset.y,left:this.offset.x})}width(){return 80}height(){return this.buttonsDiv.height()}update(){this.isShow?this.div.show():this.div.hide()}}class Xd extends zd{constructor(t){super(t.divTag),this.soupWidget=t,this.offset={x:5,y:5},this.canvas.hide(),this.div.css("display","block"),this.div.attr("id",t.webglDivId+"-selection"),this.div.addClass("jolecule-button"),this.div.css({padding:"8px",position:"absolute","max-width":"180px",height:"auto","font-size":"0.8em","text-align":"left"}),this.isShow=!1,t.addObserver(this)}resize(){this.div.css({bottom:this.offset.y,right:this.offset.x})}getText(){let t=this.soupWidget.soup,e=t.getResidueProxy(),r="",n=null,i=null,o=null,s=!1;for(let a=0;a<t.getResidueCount();a+=1)e.iRes=a,e.selected?(null!==o&&o===e.chain||(null!==o&&(r+="<br>"),o=e.chain,r+=t.structureIds[e.iStructure]+"-"+o+": ",s=!1),null===n?(n=e.resNum,i=e.resNum):i=e.resNum):null!==n&&(s?r+=", ":s=!0,r+=n===i?n:n+"-"+i,n=null,i=null);if(!r&&"chain"===this.soupWidget.soupView.getMode()&&t.selectedTraces.length>0){let e=t.selectedTraces[0],n=t.traces[e].indices[0],i=t.getResidueProxy(n),o=t.structureIds[i.iStructure];r+=`${o}-${i.chain}`}return r}async update(){let t=this.getText();t?(this.div.show(),this.div.html(t),this.resize()):this.div.hide()}}class Yd{constructor(t,e){this.controller=t.controller,this.soupView=t.soupView,this.soupWidget=t,this.soupWidget.addObserver(this),this.div=i()(e).css("z-index",2),this.divId=this.div.attr("id"),this.selectId=this.divId+"-residue-select",this.$select=i()("<select>").attr("id",this.selectId),this.div.append(this.$select),this.$select.change(()=>this.change()),this.$select.select2({width:"150px"})}change(){let t=parseInt(this.$select.val()),e=this.soupView.soup.getResidueProxy(t);this.controller.clearSelectedResidues(),this.controller.setResidueSelect(t,!0),this.controller.setTargetViewByIAtom(e.iAtom)}rebuild(){this.$select.empty(),this.soup=this.soupView.soup;let t=this.soup.getResidueProxy();for(let e of s.a.range(this.soup.getResidueCount())){if(t.iRes=e,"XXX"===t.resType)continue;let r=t.resId+"-"+t.resType;this.$select.append(new Option(r,""+e))}}update(){if(this.$select){let t=this.soupView.currentView.iAtom,e=this.soupView.soup.getAtomProxy(t).iRes,r=s.a.isNil(e)?null:""+e,n=this.$select.val();if(n!==r){let t=new Date;this.$select.val(r).trigger("change.select2");let e=(new Date-t)/1e3;console.log(`ResidueSelectorWidget.update ${n} -> ${r} in ${e.toFixed(3)}s`)}}}}class Zd{constructor(t,e,r=!0){this.soupWidget=t,this.controller=t.controller,this.isShowPanel=!1,this.isPopAbove=r,this.div=i()(e).html("Graphics").addClass("jolecule-button").on("click touch",t=>{this.isShowPanel=!this.isShowPanel,this.update(),t.preventDefault()}),this.divId=this.div.attr("id"),this.popOutPanelDiv=i()("<div>").addClass("jolecule-embed-view").css({position:"absolute","z-index":1,padding:"4px 5px"}),this.div.parent().append(this.popOutPanelDiv),this.widget={},this.popOutPanelDiv.append(i()(`<div id="${this.divId}-transparent">`)),this.widget.transparent=new Qd(t,`#${this.divId}-transparent`,"transparent"),this.popOutPanelDiv.append(i()(`<div id="${this.divId}-sphere">`)),this.widget.sphere=new Qd(t,`#${this.divId}-sphere`,"sphere"),this.popOutPanelDiv.append(i()(`<div id="${this.divId}-backbone">`)),this.widget.backbone=new Qd(t,`#${this.divId}-backbone`,"backbone"),this.popOutPanelDiv.append(i()(`<div id="${this.divId}-water">`)),this.widget.water=new Qd(t,`#${this.divId}-water`,"water"),this.popOutPanelDiv.append(i()(`<div id="${this.divId}-ribbon">`)),this.widget.ribbon=new Qd(t,`#${this.divId}-ribbon`,"ribbon"),this.popOutPanelDiv.append(i()(`<div id="${this.divId}-ligand">`)),this.widget.ligand=new Qd(t,`#${this.divId}-ligand`,"ligands"),this.soupWidget.addObserver(this),this.update()}update(){this.popOutPanelDiv.css("display",this.isShowPanel?"block":"none"),this.isShowPanel?this.div.addClass("jolecule-button-toggle-on"):this.div.removeClass("jolecule-button-toggle-on");let t=this.div.position();this.isPopAbove?this.popOutPanelDiv.css({top:t.top-this.popOutPanelDiv.outerHeight()-4,left:t.left-7}):this.popOutPanelDiv.css({top:t.top+this.div.outerHeight()+4,left:t.left-7});let e=this.popOutPanelDiv.position().left+this.popOutPanelDiv.width();e>t.left+this.div.width()&&this.popOutPanelDiv.css("left",t.left+this.div.width()-this.popOutPanelDiv.width())}}class Jd{constructor(t,e){this.soupWidget=t,this.controller=t.controller,this.div=i()(e).html(this.html()).addClass("jolecule-button").on("click touch",t=>{this.set(!this.get()),this.update(),t.preventDefault()}),this.soupWidget.addObserver(this)}html(){}get(){}set(t){}update(){this.get()?this.div.hasClass("jolecule-button-toggle-on")||this.div.addClass("jolecule-button-toggle-on"):this.div.hasClass("jolecule-button-toggle-on")&&this.div.removeClass("jolecule-button-toggle-on")}}class Qd extends Jd{constructor(t,e,r){super(t,e),this.option=r,this.div.html(this.html())}html(){return s.a.capitalize(this.option)}get(){return this.controller.getShowOption(this.option)}set(t){this.controller.setShowOption(this.option,t)}}class Kd extends Jd{constructor(t,e,r,n){super(t,e),this.state=r,this.text=n,this.div.html(this.html())}html(){return this.text}get(){return this.controller.getAnimateState()===this.state}set(t){t?this.controller.setAnimateState(this.state):this.controller.setAnimateState("none")}}class tp extends Jd{constructor(t,e){super(t,e),this.soupView=this.soupWidget.soupView,this.isText=!0}html(){return"Text"}get(){return this.isText}set(t){this.isText=t}async update(){if(super.update(),this.isText&&this.soupWidget){let t,e=this.soupView.savedViews.length;if(e>0){let r=this.soupView.currentView.order+1;t=`${r}/${e}: ${this.soupView.currentView.text}`,await this.soupWidget.asyncSetMesssage(t)}}else this.soupWidget.cleanupMessage()}}function ep(t){window.keyboardLock=!0;let e=i()("<div>").addClass("jolecule-dialog").css("display","block").css("z-index","5").css("width",Math.min(400,t.width()-100));function r(){e.remove(),window.keyboardLock=!1}let n=gh("close","jolecule-small-button",r),o=i()("<div>").css({width:"100%","box-sizing":"border-box","margin-bottom":"0.5em",padding:"1em"}).addClass("jolecule-view-text").html('<label>Jolecule is an embeddable WebGL molecular viewer with easy facilities to\n         make interactive slide shows. For more info, see\n         <a href="https://jolecule.com">jolecule.com</a>\n       </label>').keydown((function(t){if(27===t.keyCode)return r(),!0})),s=i()("<div>").css("width","100%").append(o).append(" ").append(n);e.append(s),vh(t,e,0,0),setTimeout(()=>{s.find("textarea").focus()},100)}class rp{constructor(t,e,r,n=!0,o=!0){this.embedJolecule=t,this.soupWidget=this.embedJolecule.soupWidget,this.proteinDisplayDiv=i()(e),this.isToolbarOnTop=o,this.isChange=!0,this.isToggleOn=!n,this.buttonInDisplayOffset={x:0,y:0},this.toolbarDiv=i()(r),this.buttonInDisplayDiv=i()('<div id="toggle-toolbar-button">').html("&#9776;").addClass("jolecule-button").css({margin:"5px",position:"absolute"}).on("click touch",t=>{this.isChange=!0,this.update(),t.preventDefault()}),this.proteinDisplayDiv.append(this.buttonInDisplayDiv),this.buttonInToolbarDiv=i()('<div id="toggle-toolbar-button2">').html("&#9776;").addClass("jolecule-button").addClass("jolecule-button-toggle-on").on("click touch",t=>{this.isChange=!0,this.update(),t.preventDefault()}),this.toolbarDiv.append(this.buttonInToolbarDiv),this.soupWidget.addObserver(this),this.resize()}resize(){this.isToolbarOnTop?this.buttonInDisplayDiv.css({top:this.buttonInDisplayOffset.y,left:this.buttonInDisplayOffset.x}):this.buttonInDisplayDiv.css({bottom:this.buttonInDisplayOffset.y,left:this.buttonInDisplayOffset.x})}async update(){this.isChange&&(this.isToggleOn=!this.isToggleOn,this.isChange=!1,this.isToggleOn?(this.buttonInDisplayDiv.hide(),this.toolbarDiv.show()):(this.buttonInDisplayDiv.show(),this.toolbarDiv.hide()),this.isToolbarOnTop?this.isToggleOn?(this.soupWidget.messageOffset.x=5,this.soupWidget.messageOffset.y=5):(this.soupWidget.messageOffset.x=35,this.soupWidget.messageOffset.y=5):this.isToggleOn?this.embedJolecule.widget.colorLegend.offset.y=5:this.embedJolecule.widget.colorLegend.offset.y=50,this.resize(),this.embedJolecule.resize())}}var np={LineElement:Vd,PopupText:Ud,AtomLabelsWidget:jd,DistanceMeasuresWidget:Bd,SequenceWidget:Hd,ClippingPlaneWidget:Gd,ColorLegendWidget:$d,SelectionWidget:Xd,GridControlWidget:Wd,ResidueSelectorWidget:Yd,ToggleOptionWidget:Qd,ToggleAnimateWidget:Kd,GraphicsMenuWidget:Zd,HudTextWidget:tp,openAboutDialog:ep,ToggleToolbarWidget:rp};let ip=new Ni({vertexColors:b}),op=new fu({vertexColors:b}),sp=new fu({opacity:.15,premultipliedAlpha:!0,vertexColors:b,transparent:!0});function ap(t){return(new ri).setHex(t+1)}function up(t,e){for(let r of s.a.values(t.children))e.add(r)}class lp{constructor(t){this.soup=t,this.displayObj=new li,this.displayMaterial=op,this.pickingMaterial=ip,this.pickingObj=new li,this.isTransparent=!1}setTransparent(t){this.isTransparent=t,this.isTransparent?this.displayMaterial=sp:this.displayMaterial=op}build(){}}class cp extends lp{constructor(t,e=!1,r=[]){super(t),this.selectedTraces=s.a.cloneDeep(r),this.setTransparent(e),this.traces=[],this.build()}build(){if(this.traces=this.soup.traces,this.selectedTraces.length>0){let t=[];for(let[e,r]of this.traces.entries())s.a.includes(this.selectedTraces,e)&&t.push(r);this.traces=t}Ih(this.displayObj),Ih(this.pickingObj);let t=0;for(let o of this.traces)t+=o.points.length;let e=new Lh,r=(new Pi).fromGeometry(e);this.displayGeom=new $h(r,t),this.pickingGeom=new $h(r,t);let n=new li,i=0;for(let o of this.traces){let t=o.points.length;for(let e of s.a.range(t)){let t=o.points[e],r=o.tangents[e],s=o.binormals[e],a=t.clone().add(r);n.matrix.identity(),n.position.copy(t),n.up.copy(s),n.lookAt(a),n.updateMatrix(),this.displayGeom.applyMatrixToCopy(n.matrix,i),this.pickingGeom.applyMatrixToCopy(n.matrix,i),this.pickingGeom.applyColorToCopy(o.indexColors[e],i),i+=1}}this.recolor(),this.displayObj.add(new Ui(this.displayGeom,this.displayMaterial)),this.pickingObj.add(new Ui(this.pickingGeom,this.pickingMaterial))}recolor(){let t=0,e=this.soup.getResidueProxy();for(let r of this.traces){let n=r.points.length;for(let i of s.a.range(n)){let n=r.refIndices[i],o=e.load(n).activeColor;this.displayGeom.applyColorToCopy(o,t),t+=1}}this.displayGeom.attributes.color.needsUpdate=!0}}class hp extends lp{constructor(t,e=!1,r=[]){super(t),this.selectedTraces=s.a.cloneDeep(r),this.traces=[],this.setTransparent(e),this.build()}build(){if(this.traces=this.soup.traces,this.selectedTraces.length>0){let t=[];for(let[e,r]of this.traces.entries())s.a.includes(this.selectedTraces,e)&&t.push(r);this.traces=t}this.displayGeom=new Ch(this.traces,gd,!1),this.pickingGeom=new Ch(this.traces,gd,!0),Ih(this.displayObj),Ih(this.pickingObj);let t=new Ui(this.displayGeom,this.displayMaterial),e=new Ui(this.pickingGeom,this.pickingMaterial);this.displayObj.add(t),this.pickingObj.add(e),this.recolor()}recolor(){let t=this.soup.getResidueProxy();for(let e of this.traces)for(let r of s.a.range(e.points.length)){let n=e.refIndices[r];e.colors[r]=t.load(n).activeColor}this.displayGeom.setColors()}}class dp extends lp{constructor(t,e=!1,r=null){super(t),this.selectedTraces=s.a.cloneDeep(r),this.setTransparent(e),this.traces=[],this.build()}build(){Ih(this.displayObj),Ih(this.pickingObj),this.displayObj.name="NucleotideRepresentation";let t=this.soup.getResidueProxy(),e=this.soup.getAtomProxy();function r(r){let n=t.getIAtom(r);return null===n?null:e.load(n).pos.clone()}let n=[];this.nucleotideColorList=[];let i=[];if(this.traces=this.soup.traces,this.selectedTraces.length>0){let t=[];for(let[e,r]of this.traces.entries())s.a.includes(this.selectedTraces,e)&&t.push(r);this.traces=t}for(let d of this.traces)for(let e of d.indices)if(t.iRes=e,"D"===t.ss&&t.isPolymer){let e=vd(t.resType),o=s.a.map(e,r);if(s.a.some(o,t=>null===t))continue;n.push(o),i.push(ap(t.iAtom)),this.nucleotideColorList.push(t.activeColor)}this.nucleotideGeom=new Rh(n,this.nucleotideColorList,.2);let o=new Ui(this.nucleotideGeom,this.displayMaterial);this.displayObj.add(o);let a=new Rh(n,i,.2),u=new Ui(a,this.pickingMaterial);this.pickingObj.add(u),this.nucleotideConnectList=[];for(let s of this.traces)for(let e of s.indices)if(t.iRes=e,"D"===t.ss&&t.isPolymer)for(let n of yd(t.resType)){let t=r(n[0]),i=r(n[1]);null!=t&&null!=i&&this.nucleotideConnectList.push([t,i,e])}let l=this.nucleotideConnectList.length,c=Uh(.4);this.nucleotideConnectorGeom=new $h(c,l);for(let s=0;s<l;s+=1){let[t,e,r]=this.nucleotideConnectList[s];this.nucleotideConnectorGeom.applyMatrixToCopy(jh(t,e,.3),s)}for(let s=0;s<l;s+=1){let[e,r,n]=this.nucleotideConnectList[s],i=t.load(n).activeColor;this.nucleotideConnectorGeom.applyColorToCopy(i,s)}let h=new Ui(this.nucleotideConnectorGeom,this.displayMaterial);h.name="nucleotideConnector",this.displayObj.add(h)}recolor(){this.nucleotideColorList=[];let t=this.soup.getResidueProxy();for(let r of this.traces)for(let e of r.indices)t.iRes=e,"D"===t.ss&&t.isPolymer&&this.nucleotideColorList.push(t.activeColor);this.nucleotideGeom.recolor(this.nucleotideColorList);let e=this.nucleotideConnectList.length;for(let r=0;r<e;r+=1){let[e,n,i]=this.nucleotideConnectList[r],o=t.load(i).activeColor;this.nucleotideConnectorGeom.applyColorToCopy(o,r)}this.nucleotideConnectorGeom.attributes.color.needsUpdate=!0}}class pp extends lp{constructor(t,e=!1,r=[]){super(t),super.setTransparent(e),this.selectedTraces=s.a.cloneDeep(r),this.build()}setTransparent(t){super.setTransparent(t),this.ribbonRepr.setTransparent(t),this.arrowRepr.setTransparent(t),this.nucRepr.setTransparent(t)}build(){this.ribbonRepr=new hp(this.soup,this.isTransparent,this.selectedTraces),this.arrowRepr=new cp(this.soup,this.isTransparent,this.selectedTraces),this.nucRepr=new dp(this.soup,this.isTransparent,this.selectedTraces),Ih(this.displayObj),Ih(this.pickingObj),this.displayObj.name="CartoonRepr",up(this.ribbonRepr.displayObj,this.displayObj),up(this.arrowRepr.displayObj,this.displayObj),up(this.nucRepr.displayObj,this.displayObj),up(this.ribbonRepr.pickingObj,this.pickingObj),up(this.arrowRepr.pickingObj,this.pickingObj),up(this.nucRepr.pickingObj,this.pickingObj)}recolor(){this.ribbonRepr.recolor(),this.arrowRepr.recolor(),this.nucRepr.recolor()}}class fp{constructor(t,e,r,n=!1){this.soup=t,this.displayObj=new li,this.pickingObj=new li,this.atomIndices=e,this.atomRadius=r,this.displayMaterial=op,this.pickingMaterial=ip,this.isElementRadius=n,this.build()}build(){if(Ih(this.displayObj),Ih(this.pickingObj),0===this.atomIndices.length)return;let t=this.atomIndices.length,e=new Xa(1,8,8);this.displayGeom=new $h(e,t);let r=new $h(e,t),n=this.soup.getAtomProxy(),i=this.atomRadius;for(let o=0;o<t;o+=1){let t=this.atomIndices[o];n.iAtom=t,this.isElementRadius&&(i="H"===n.elem?1.2:1.7);let e=zh(n.pos,i);this.displayGeom.applyMatrixToCopy(e,o),r.applyMatrixToCopy(e,o),this.displayGeom.applyColorToCopy(n.color,o),r.applyColorToCopy(ap(t),o)}this.displayObj.add(new Ui(this.displayGeom,this.displayMaterial)),this.pickingObj.add(new Ui(r,this.pickingMaterial))}recolor(){if(0===this.atomIndices.length)return;let t=this.atomIndices.length,e=this.soup.getAtomProxy();for(let r=0;r<t;r+=1)e.iAtom=this.atomIndices[r],this.displayGeom.applyColorToCopy(e.color,r);this.displayGeom.attributes.color.needsUpdate=!0}}class mp extends fp{constructor(t,e){super(t,[],e)}build(){let t=this.soup.grid;this.atomIndices=[];let e=this.soup.getResidueProxy(),r=this.soup.getAtomProxy();for(let n of s.a.range(this.soup.getResidueCount()))e.iRes=n,"G"===e.ss&&(r.iAtom=e.iAtom,r.bfactor>t.bCutoff&&t.isElem[r.elem]&&this.atomIndices.push(r.iAtom));super.build()}}class gp extends fp{constructor(t){super(t,[],1.7,!0)}build(){this.soup.grid;this.atomIndices=[];let t=this.soup.getResidueProxy(),e=this.soup.getAtomProxy();for(let r of s.a.range(this.soup.getResidueCount()))if(t.iRes=r,t.isPolymer)for(let n of t.getAtomIndices())e.iAtom=n,this.atomIndices.push(n);this.isElementRadius=!0,super.build()}}class vp{constructor(t,e){this.soup=t,this.bondIndices=e,this.displayObj=new li,this.pickingObj=new li,this.displayMaterial=op,this.pickingMaterial=ip,this.build()}build(){Ih(this.displayObj),Ih(this.pickingObj);let t=this.bondIndices;if(0===t.length)return;let e=t.length,r=new iu(1,1,1,4,1,!1);r.applyMatrix((new Ie).makeRotationFromEuler(new si(Math.PI/2,Math.PI,0))),this.displayGeom=new $h(r,e);let n=this.soup.getAtomProxy(),i=this.soup.getAtomProxy(),o=this.soup.getBondProxy(),s=this.soup.getResidueProxy();for(let u=0;u<e;u+=1){o.iBond=t[u],n.iAtom=o.iAtom1,i.iAtom=o.iAtom2,s.iRes=n.iRes;let e=n.pos.clone(),r=i.pos.clone();if(n.iRes!==i.iRes){let t=r.clone().add(e).multiplyScalar(.5);n.iRes===s.iRes?r=t:i.iRes===s.iRes&&(e=t)}let a=jh(e,r,.2);this.displayGeom.applyMatrixToCopy(a,u),this.displayGeom.applyColorToCopy(s.activeColor,u)}let a=new Ui(this.displayGeom,this.displayMaterial);this.displayObj.add(a)}recolor(){let t=this.bondIndices;if(0===t.length)return;let e=t.length,r=this.soup.getBondProxy(),n=this.soup.getAtomProxy(),i=this.soup.getResidueProxy();for(let o=0;o<e;o+=1)r.iBond=t[o],n.iAtom=r.iAtom1,i.iRes=n.iRes,this.displayGeom.applyColorToCopy(i.activeColor,o);this.displayGeom.attributes.color.needsUpdate=!0}}class yp{constructor(t,e){this.soup=t,this.radius=e,this.displayObj=new li,this.pickingObj=new li,this.build()}build(){Ih(this.displayObj),Ih(this.pickingObj);let t=[],e=[],r=this.soup.getAtomProxy(),n=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount()))if(n.iRes=i,"-"===n.ss)for(let o of n.getAtomIndices()){r.iAtom=o,t.push(o);for(let t of r.getBondIndices())e.push(t)}this.atomRepr=new fp(this.soup,t,this.radius),this.bondRepr=new vp(this.soup,e),t.length>0&&(up(this.atomRepr.displayObj,this.displayObj),up(this.bondRepr.displayObj,this.displayObj),up(this.atomRepr.pickingObj,this.pickingObj))}}class wp extends fp{constructor(t,e){super(t,[],e),this.name="water",this.atomIndices=[];let r=this.soup.getResidueProxy();for(let n of s.a.range(this.soup.getResidueCount()))r.iRes=n,"HOH"===r.resType&&this.atomIndices.push(r.iAtom);this.build()}}class bp{constructor(t,e){this.soup=t,this.displayObj=new li,this.pickingObj=new li,this.radius=e,this.build()}build(){Ih(this.displayObj),Ih(this.pickingObj);let t=[],e=[],r=this.soup.getAtomProxy(),n=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount()))if(n.iRes=i,n.isPolymer&&n.sidechain)for(let o of n.getAtomIndices())if(r.iAtom=o,!yh(r.atomType,md)){t.push(o);for(let t of r.getBondIndices())e.push(t)}this.atomRepr=new fp(this.soup,t,this.radius),this.bondRepr=new vp(this.soup,e),up(this.atomRepr.displayObj,this.displayObj),up(this.bondRepr.displayObj,this.displayObj),up(this.atomRepr.pickingObj,this.pickingObj)}recolor(){this.atomRepr.recolor(),this.bondRepr.recolor()}}class xp{constructor(t,e){this.soup=t,this.displayObj=new li,this.pickingObj=new li,this.radius=e,this.build()}build(){let t=[],e=[],r=this.soup.getAtomProxy(),n=this.soup.getResidueProxy();for(let i of s.a.range(this.soup.getResidueCount()))if(n.iRes=i,n.isPolymer)for(let o of n.getAtomIndices())if(r.iAtom=o,yh(r.atomType,md)){t.push(o);for(let t of r.getBondIndices())e.push(t)}this.atomRepr=new fp(this.soup,t,this.radius),this.bondRepr=new vp(this.soup,e),t.length>0&&(up(this.atomRepr.displayObj,this.displayObj),up(this.bondRepr.displayObj,this.displayObj),up(this.atomRepr.pickingObj,this.pickingObj))}recolor(){this.atomRepr.recolor(),this.bondRepr.recolor()}}function _p(){if(requestAnimationFrame(_p),window.globalWidgets===[])return;let t=(new Date).getTime(),e=t-window.lastTime;for(let r of window.globalWidgets)r.animate(e);for(let r of window.globalWidgets)r.isChanged()&&r.drawFrame();window.lastTime=t}function Sp(t){"undefined"===typeof window.globalWidgets&&(window.globalWidgets=[],_p(),window.lastTime=(new Date).getTime()),window.globalWidgets.push(t)}class Mp{constructor(t,e){this.divTag=t,this.div=i()(this.divTag),this.div.css("overflow","hidden"),this.backgroundColor=e,this.div.css("background-color",this.backgroundColor),this.webglDivId=this.div.attr("id")+"-canvas-wrapper",this.webglDiv=i()("<div>").attr("id",this.webglDivId).css("overflow","hidden").css("box-sizing","border-box").css("z-index","0").css("background-color","#CCC").css("position","relative"),this.webglDiv.contextmenu(()=>!1),this.div.append(this.webglDiv),this.cameraParams={focus:new Ne(0,0,0),position:new Ne(0,0,-1),up:new Ne(0,1,0),zFront:-40,zBack:20,zoom:1},this.camera=new _s(45,this.width()/this.height()),this.displayScene=new Ps,this.displayScene.background=new ri(this.backgroundColor),this.displayScene.fog=new As(this.backgroundColor,1,100),this.representations={},this.displayMeshes={},this.pickingMeshes={},this.pickingScene=new Ps,this.pickingTexture=new Ue(this.width(),this.height()),this.pickingTexture.texture.minFilter=wt,this.lights=[],this.buildLights(),this.messageOffset={x:5,y:5},this.messageDiv=i()("<div>").attr("id","loading-message").css("position","absolute").addClass("jolecule-overlay-text"),this.div.append(this.messageDiv),this.setMesssage("Initialized jolecule."),this.saveMouseX=null,this.saveMouseY=null,this.saveMouseR=null,this.saveMouseT=null,this.mouseX=null,this.mouseY=null,this.mouseR=null,this.mouseT=null}initWebglRenderer(){this.renderer=new Es({antialias:!0}),this.renderer.setClearColor(this.backgroundColor),this.renderer.setSize(this.width(),this.height());let t=this.renderer.domElement;this.webglDiv[0].appendChild(t);const e=(e,r)=>{t.addEventListener(e,r)};e("mousedown",t=>this.mousedown(t)),e("mousemove",t=>this.mousemove(t)),e("mouseup",t=>this.mouseup(t)),e("mouseleave",t=>this.mouseout(t)),e("mousewheel",t=>this.mousewheel(t)),e("DOMMouseScroll",t=>this.mousewheel(t)),e("touchstart",t=>this.mousedown(t)),e("touchmove",t=>this.mousemove(t)),e("touchend",t=>this.mouseup(t)),e("touchcancel",t=>this.mouseup(t)),e("gesturestart",t=>this.gesturestart(t)),e("gesturechange",t=>this.gesturechange(t)),e("gestureend",t=>this.gestureend(t))}render(){mh(this.renderer)||this.initWebglRenderer(),this.renderer.render(this.displayScene,this.camera)}getPosXY(t){let e=.5*this.width(),r=.5*this.height(),n=t.clone().project(this.camera);return{x:n.x*e+e+this.x(),y:-n.y*r+r+this.y()}}getPickColorFromMouse(){let t=this.mouseX,e=this.mouseY;if(null===t||null===e)return null;let r=new Uint8Array(4);return this.renderer.render(this.pickingScene,this.camera,this.pickingTexture),this.renderer.readRenderTargetPixels(this.pickingTexture,this.mouseX,this.pickingTexture.height-e,1,1,r),r[0]<<16|r[1]<<8|r[2]}setCameraParams(t){let e=this.cameraParams.position.clone().sub(this.cameraParams.focus).normalize(),r=t.position.clone().sub(t.focus);r.normalize();let n=kh(e,r);for(let s=0;s<this.lights.length;s+=1)this.lights[s].position.applyQuaternion(n);this.cameraParams=t;let i=this.cameraParams.zoom+this.cameraParams.zBack,o=this.cameraParams.zoom+this.cameraParams.zFront;o<1&&(o=1),this.camera.position.copy(this.cameraParams.position),this.camera.up.copy(this.cameraParams.up),this.camera.lookAt(this.cameraParams.focus),this.camera.near=o,this.camera.far=i,this.camera.updateProjectionMatrix(),this.displayScene.fog.near=this.cameraParams.zoom,this.displayScene.fog.far=i}buildLights(){this.lights.length=0;let t=new pl(16777215);t.position.copy(fh.create(.2,.2,-100).normalize()),t.dontDelete=!0,this.lights.push(t);let e=new fl(6316128,1);e.dontDelete=!0,this.lights.push(e);for(let r=0;r<this.lights.length;r+=1)this.displayScene.add(this.lights[r])}resize(){let t=this.div.outerHeight();this.webglDiv.css("height",t);let e=this.div.outerWidth();this.webglDiv.css("width",e),this.messageDiv.css({top:this.messageOffset.y,left:this.messageOffset.x}),this.messageDiv.css("max-width",Math.max(.9*this.div.width()-40,this.div.width()-200)),this.camera.aspect=this.width()/this.height(),this.camera.updateProjectionMatrix(),this.pickingTexture.setSize(this.width(),this.height()),mh(this.renderer)&&this.renderer.setSize(this.width(),this.height())}setMesssage(t){console.log("SoupWidget.setMesssage:",t),this.messageDiv.html(t).show()}async asyncSetMesssage(t){this.setMesssage(t),await _h(0)}async asyncFlashMesssage(t,e){this.setMesssage(t),await _h(e),this.messageDiv.hide().html("")}cleanupMessage(){this.messageDiv.hide()}rebuildSceneFromMeshes(){Ih(this.displayScene),Ih(this.pickingScene);for(let t of s.a.values(this.displayMeshes))t.children.length>0&&this.displayScene.add(t);for(let t of s.a.values(this.pickingMeshes))t.children.length>0&&this.pickingScene.add(t)}setMeshVisible(t,e){t in this.displayMeshes&&Oh(this.displayMeshes[t],e),t in this.pickingMeshes&&Oh(this.pickingMeshes[t],e)}x(){return 0}y(){return 0}width(){let t=this.div.width()-this.x();return t}height(){let t=this.div.height()-this.y();return t}getPointer(t){mh(t.touches)&&t.touches.length>0?(this.eventX=t.touches[0].clientX,this.eventY=t.touches[0].clientY):(this.eventX=t.clientX,this.eventY=t.clientY);let e=t.target.getBoundingClientRect();this.mouseX=this.eventX-e.left,this.mouseY=this.eventY-e.top;let r=this.mouseX-this.width()/2,n=this.mouseY-this.height()/2;this.mouseR=Math.sqrt(r*r+n*n),this.mouseT=Math.atan(n/r),r<0&&(n>0?this.mouseT+=Math.PI:this.mouseT-=Math.PI)}savePointer(){this.saveMouseX=this.mouseX,this.saveMouseY=this.mouseY,this.saveMouseR=this.mouseR,this.saveMouseT=this.mouseT}}class Ep extends Mp{constructor(t,e,r,n,i,o){super(e,i),this.observers={rebuilt:new Fd.a,updated:new Fd.a,resized:new Fd.a},this.dataServer=null,this.soupView=t,this.soup=t.soup,this.controller=r,this.atomRadius=.35,this.gridAtomRadius=1,this.isCrossHairs=!0,this.buildCrossHairs(),this.isClickInitiated=!1,this.hover=new np.PopupText(this.divTag,50),this.iAtomHover=null,this.isGrid=n,this.isMouseWheel=o,this.distanceMeasuresWidget=new np.DistanceMeasuresWidget(this),this.atomLabelsWidget=new np.AtomLabelsWidget(this),this.lineElement=new np.LineElement(this,"#FF7777"),Sp(this)}addObserver(t){"update"in t&&this.observers.updated.add(()=>{t.update()}),"rebuild"in t&&this.observers.rebuilt.add(()=>{t.rebuild()}),"resize"in t&&this.observers.resized.add(()=>{t.resize()})}buildCrossHairs(){let t=2,e=60,r=new Ns({color:16733525}),n=new au(t,e);n.vertices.shift(),this.crossHairs=new Vs(n,r),this.crossHairs.dontDelete=!0,this.displayScene.add(this.crossHairs)}setTargetViewByIAtom(t){this.controller.setTargetViewByIAtom(t)}getCameraOfCurrentView(){return this.soupView.currentView.cameraParams}getZ(t){let e=this.getCameraOfCurrentView(),r=e.focus.clone().sub(e.position).normalize(),n=t.clone().sub(e.focus);return n.dot(r)}inZlab(t){let e=this.getZ(t),r=this.getCameraOfCurrentView();return e>=r.zFront&&e<=r.zBack}opacity(t){let e=this.getZ(t),r=this.getCameraOfCurrentView();return e<r.zFront?1:e>r.zBack?0:1-(e-r.zFront)/(r.zBack-r.zFront)}updateCrossHairs(){let t=this.getCameraOfCurrentView();this.crossHairs.position.copy(t.focus),this.crossHairs.lookAt(t.position),this.crossHairs.updateMatrix()}atomLabelDialog(){let t=this.soupView.currentView.iAtom;if(t>=0){let e=this.soup.getAtomProxy(t),r="Label atom : "+e.label,n=e=>{this.controller.makeAtomLabel(t,e)};xh(this.div,r,n)}}getIAtomHover(){let t=this.getPickColorFromMouse();return t>0&&t<this.soup.getAtomCount()+1?t-1:null}popupText(t){let e=this.soup.getAtomProxy(t),r=e.label,n=e.iAtom;"XXX"===e.resType&&(r+=":E="+this.soup.grid.convertB(e.bfactor));let i="";return n===this.soupView.getICenteredAtom()?(i='<div style="text-align: center">',i+=r,i+="<br>[drag distances]<br>",i+="[double-click labels]",i+="</div>"):i=r,i}updateHover(){if(this.iAtomHover=this.getIAtomHover(),this.iAtomHover){this.hover.html(this.popupText(this.iAtomHover));let t=this.soup.getAtomProxy(this.iAtomHover).pos,e=this.getPosXY(t);this.hover.move(e.x,e.y)}else this.hover.hide()}addRepresentation(t,e){this.representations[t]=e,this.displayMeshes[t]=e.displayObj,this.pickingMeshes[t]=e.pickingObj,this.updateMeshesInScene=!0}buildScene(){for(let t of s.a.keys(this.displayMeshes))s.a.unset(this.displayMeshes,t);for(let t of s.a.keys(this.pickingMeshes))s.a.unset(this.pickingMeshes,t);this.addRepresentation("transparentRibbon",new pp(this.soup,!0)),this.addRepresentation("ribbon",new pp(this.soup,!1,this.soup.selectedTraces)),this.addRepresentation("ligand",new yp(this.soup,this.atomRadius)),this.isGrid&&this.addRepresentation("grid",new mp(this.soup,this.gridAtomRadius)),this.addRepresentation("sidechain",new bp(this.soup,this.atomRadius)),this.rebuildSceneFromMeshes(),this.observers.rebuilt.dispatch(),this.soupView.isChanged=!0,this.soupView.isUpdateObservers=!0}deleteStructure(t){this.controller.deleteStructure(t),this.buildScene(),this.observers.rebuilt.dispatch()}isChanged(){return this.soupView.isChanged}drawFrame(){if(!this.isChanged())return;let t=!this.soupView.soup.grid.isChanged&&!this.soupView.isUpdateSidechain&&!this.soupView.isUpdateColors;this.soupView.isStartTargetAfterRender&&t&&(this.soupView.startTargetView(),this.soupView.nUpdateStep=this.soupView.maxUpdateStep),this.updateMeshesInScene=!1;let e=(t,e)=>e&&!(t in this.displayMeshes),r=this.soupView.currentView.show;if(e("water",r.water)&&this.addRepresentation("water",new wp(this.soup,this.atomRadius)),e("backbone",r.backbone)&&this.addRepresentation("backbone",new xp(this.soup,this.atomRadius)),e("sphere",r.sphere)&&this.addRepresentation("sphere",new gp(this.soup)),this.setMeshVisible("ribbon",r.ribbon),this.setMeshVisible("transparentRibbon",r.ribbon&&r.transparent),this.setMeshVisible("water",r.water),this.setMeshVisible("backbone",r.backbone),this.setMeshVisible("ligand",r.ligands),this.setMeshVisible("sphere",r.sphere),r.transparent?s.a.isEqual(this.soup.selectedTraces,this.representations.ribbon.selectedTraces)||(this.representations.ribbon.selectedTraces=s.a.cloneDeep(this.soup.selectedTraces),this.representations.ribbon.build(),this.updateMeshesInScene=!0):this.representations.ribbon&&this.representations.ribbon.selectedTraces.length>0&&(this.representations.ribbon.selectedTraces.length=0,this.representations.ribbon.build(),this.updateMeshesInScene=!0),this.isGrid?this.soupView.soup.grid.isChanged&&(s.a.isUndefined(this.representations.grid)||(this.soup.colorResidues(),this.representations.grid.build()),this.soupView.soup.grid.isChanged=!1):this.soupView.soup.grid.isChanged=!1,this.soupView.isUpdateSidechain&&(this.representations.sidechain.build(),this.soupView.isUpdateSidechain=!1,this.updateMeshesInScene=!0),this.soupView.isUpdateColors){for(let t of s.a.values(this.representations))"recolor"in t&&t.recolor();this.soupView.isUpdateColors=!1,this.soupView.isUpdateObservers=!0}this.updateMeshesInScene&&this.rebuildSceneFromMeshes(),this.updateCrossHairs(),this.setCameraParams(this.getCameraOfCurrentView()),this.distanceMeasuresWidget.drawFrame(),this.render(),this.soupView.isUpdateObservers&&(this.observers.updated.dispatch(),this.soupView.isUpdateObservers=!1),this.atomLabelsWidget.drawFrame(),this.soupView.isChanged=!1}animate(t){this.soupView.animate(t),this.updateHover()}focus(){console.log("SoupWidget.focus")}resize(){super.resize(),this.observers.resized.dispatch(),this.soupView.isUpdateObservers=!0,this.controller.setChangeFlag()}doubleclick(t){null!==this.iAtomHover?(this.iAtomHover===this.soupView.getICenteredAtom()?this.atomLabelDialog():this.iAtomHover===this.iAtomPreClick&&this.controller.triggerAtom(this.iAtomHover),this.isDraggingCentralAtom=!1):this.controller.triggerAtom(),this.iAtomFirstPressed=null,this.iResFirstPressed=null,this.iAtomPreClick=null}click(t){let e=this.iAtomHover,r=this.soup.getAtomProxy(e).iRes;if(mh(r)&&r===this.iResFirstPressed)if(t.metaKey||t.shiftKey)t.shiftKey?this.controller.selectAdditionalRangeToResidue(this.iResFirstPressed):this.controller.selectAdditionalResidue(this.iResFirstPressed);else{let t=this.soup.getResidueProxy(r),e=!t.selected;this.controller.selectResidue(r,e)}else this.controller.clearSelectedResidues();this.iAtomFirstPressed=null,this.iResFirstPressed=null,this.getPointer(t),this.updateHover()}mousedown(t){if(this.focus(),this.isGesture)return;t.preventDefault(),this.getPointer(t),this.updateHover(),this.iAtomFirstPressed=this.iAtomHover,this.iResFirstPressed=this.soup.getAtomProxy(this.iAtomFirstPressed).iRes,this.iAtomFirstPressed===this.soupView.getICenteredAtom()&&(this.isDraggingCentralAtom=null!==this.iAtomFirstPressed);let e=(new Date).getTime(),r=this.timePressed?e-this.timePressed:0;this.isClickInitiated?r<600&&(this.doubleclick(t),this.isClickInitiated=!1):(this.iAtomPreClick=this.iAtomHover,this.isClickInitiated=!0),this.getPointer(t),this.savePointer(),this.timePressed=(new Date).getTime(),this.pointerPressedAndInDiv=!0}mousemove(t){if(t.preventDefault(),!this.isGesture)if(this.getPointer(t),this.updateHover(),this.isDraggingCentralAtom){let t=this.soup.getAtomProxy(this.soupView.getICenteredAtom()).pos,e=this.getPosXY(t);this.lineElement.move(this.mouseX+this.x(),this.mouseY+this.y(),e.x,e.y)}else{let e=2===t.button||3===t.which;if(this.pointerPressedAndInDiv){let r=1,n=0,i=0,o=0,s=this.mouseX-this.saveMouseX,a=this.mouseY-this.saveMouseY;if(this.isClickInitiated=!1,e||t.metaKey)n=this.mouseT-this.saveMouseT,this.mouseR>0&&(r=this.saveMouseR/this.mouseR);else if(t.ctrlKey)n=this.mouseT-this.saveMouseT;else if(t.shiftKey){let t=a/100;r=Math.pow(1+Math.abs(t)/2,t>0?1:-1)}else i=fh.degToRad(s),o=fh.degToRad(a);this.controller.adjustCamera(o,i,n,r),this.savePointer()}}}mouseout(t){this.hover.hide(),this.pointerPressedAndInDiv=!1}mouseup(t){if(this.getPointer(t),t.preventDefault(),this.isDraggingCentralAtom){if(null!==this.iAtomHover){let t=this.soupView.getICenteredAtom();this.iAtomHover!==t&&this.controller.makeDistance(this.iAtomHover,t)}this.lineElement.hide(),this.isDraggingCentralAtom=!1}this.isClickInitiated&&this.click(t),mh(t.touches)&&this.hover.hide(),this.pointerPressedAndInDiv=!1}mousewheel(t){if(console.log("SoupWidget.mousewheel",this.isMouseWheel),!this.isMouseWheel)return;if(this.isGesture)return;let e;t.preventDefault(),e=mh(t.wheelDelta)?t.wheelDelta/480:-t.detail/24,t.ctrlKey&&(e/=2,e*=-1);let r=Math.pow(1+Math.abs(e)/2,e>0?1:-1);this.controller.adjustCamera(0,0,0,r)}gesturestart(t){t.preventDefault(),this.isGesture=!0,this.lastPinchRotation=0,this.lastScale=t.scale*t.scale}gesturechange(t){t.preventDefault(),this.controller.adjustCamera(0,0,fh.degToRad(2*t.rotation-this.lastPinchRotation),this.lastScale/(t.scale*t.scale)),this.lastPinchRotation=2*t.rotation,this.lastScale=t.scale*t.scale}gestureend(t){t.preventDefault(),this.isGesture=!1,this.iAtomFirstPressed=null,this.iResFirstPressed=null,null!==this.isClickInitiated&&(clearTimeout(this.isClickInitiated),this.isClickInitiated=null),this.pointerPressedAndInDiv=!1}}r("f21a");let Tp={divTag:"",backgroundColor:0,viewId:"",viewHeight:170,isViewTextShown:!1,isSequenceBar:!0,isResidueSelector:!0,isLegend:!1,isEditable:!0,animateState:"none",isGrid:!1,bCutoff:.5,isPlayable:!1,maxUpdateStep:50,msPerStep:17,maxWaitStep:30,isToolbarOnTop:!1,isToolbarOn:!1,isTextOverlay:!0,isMouseWheel:!0};class Ap{constructor(t){this.params=s.a.cloneDeep(Tp),s.a.assign(this.params,t),console.log("EmbedJolecule.constructor",this.params),this.isProcessing={flag:!1},this.divTag=this.params.divTag,this.div=i()(this.params.divTag),this.divId=this.div.attr("id"),this.div[0].oncontextmenu=s.a.noop,this.soup=new Nd,this.soupView=new Zh(this.soup),this.controller=new Jh(this.soupView),this.soupView.animateState=this.params.animateState,this.soupView.maxUpdateStep=this.params.maxUpdateStep,this.soupView.msPerStep=this.params.msPerStep,this.soupView.maxWaitStep=this.params.maxWaitStep,null!==this.params.bCutoff&&(this.soup.grid.bCutoff=this.params.bCutoff),this.widget={},this.createDivs();let e=()=>this.resize();i()(window).resize(e),window.onorientationchange=e,e()}async asyncAddDataServer(t){while(this.isProcessing.flag)await _h(100);console.log("EmbedJolecule.asyncAddDataServer",t),this.isProcessing.flag=!0,await this.soupWidget.asyncSetMesssage("Loading structure...");let e=t=>this.soupWidget.asyncSetMesssage(t);await new Promise(r=>{t.getProteinData(async t=>{await this.controller.asyncLoadProteinData(t,e),r()})}),this.soupWidget.buildScene(),this.resize(),this.controller.zoomOut(),s.a.isNil(this.soupView.dataServer)&&(await this.soupWidget.asyncSetMesssage("Preparing views..."),this.soupWidget.dataServer=t,await new Promise(e=>{t.getViews((t,r)=>{this.controller.loadViewsFromViewDicts(t),r&&(this.params.viewId=r);let n=this.params.viewId in this.soupView.savedViewsByViewId;n&&this.controller.setTargetViewByViewId(this.params.viewId),e()})}),this.soupView.isUpdateObservers=!0),this.soupWidget.cleanupMessage(),this.isProcessing.flag=!1,console.log("EmbedJolecule.asyncAddDataServer finished")}clear(){while(this.soupWidget.soup.structureIds.length>0)this.soupWidget.deleteStructure(0)}createDivs(){this.div.css({display:"flex","flex-direction":"column"}),this.headerDiv=i()("<div>").addClass("jolecule-embed-header").css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}),this.div.append(this.headerDiv),this.bodyDiv=i()("<div>").attr("id",this.divId+"-jolecule-soup-display").addClass("jolecule-embed-body").css({flex:"1 1",position:"relative"}),this.div.append(this.bodyDiv),this.soupWidget=new Ep(this.soupView,`#${this.divId}-jolecule-soup-display`,this.controller,this.params.isGrid,this.params.backgroundColor,this.params.isMouseWheel),this.footerDiv=i()("<div>").addClass("jolecule-embed-footer").css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}),this.div.append(this.footerDiv),this.sequenceBarDiv=i()("<div>").attr("id",this.divId+"-sequence-widget").css({width:"100%"}),this.params.isToolbarOnTop?this.footerDiv.append(this.sequenceBarDiv):this.headerDiv.append(this.sequenceBarDiv),this.params.isSequenceBar&&(this.widget.sequence=new np.SequenceWidget(`#${this.divId}-sequence-widget`,this.soupWidget)),this.params.isGrid&&(this.widget.grid=new np.GridControlWidget(this.soupWidget)),this.widget.colorLegend=new np.ColorLegendWidget(this.soupWidget),this.widget.colorLegend.isShow=this.params.isLegend,this.widget.selection=new np.SelectionWidget(this.soupWidget),this.params.isToolbarOnTop?this.toolbarDiv=this.headerDiv:(this.toolbarDiv=this.footerDiv,this.widget.selection.offset.y=5,this.widget.colorLegend.offset.y=5);let t=this.params.isPlayable||this.params.isEditable||this.params.isExtraEditable;t&&(this.toolbarDiv.css({display:"flex","flex-wrap":"wrap","flex-direction":"row"}).addClass("jolecule-embed-toolbar"),this.params.isToolbarOn&&(this.widget.toolbar=new np.ToggleToolbarWidget(this,this.soupWidget.divTag,".jolecule-embed-toolbar",!1,this.params.isToolbarOnTop)),this.toolbarDiv.append(gh("?","jolecule-button",()=>{np.openAboutDialog(this.soupWidget.div)})),this.params.isPlayable&&(this.toolbarDiv.append(i()(`<div id="${this.divId}-rotate">`)),this.widget.rotate=new np.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-rotate`,"rotate","&orarr;"),this.toolbarDiv.append(i()(`<div id="${this.divId}-rock">`)),this.widget.rotate=new np.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-rock`,"rock","&hArr;"),this.toolbarDiv.append(gh("<","jolecule-button",()=>{this.controller.setTargetToPrevView()})),this.toolbarDiv.append(i()(`<div id="${this.divId}-loop">`)),this.widget.loop=new np.ToggleAnimateWidget(this.soupWidget,`#${this.divId}-loop`,"loop","Play"),this.toolbarDiv.append(gh(">","jolecule-button",()=>{this.controller.setTargetToNextView()})),this.params.isTextOverlay&&(this.toolbarDiv.append(i()(`<div id="${this.divId}-hud">`)),this.widget.hud=new np.HudTextWidget(this.soupWidget,`#${this.divId}-hud`))),this.params.isEditable&&(this.params.isResidueSelector&&(this.toolbarDiv.append(i()("<div>").attr("id",this.divId+"-res-selector").addClass("jolecule-button").css({"padding-top":"6px",height:"24px","box-sizing":"content-box"})),this.widget.residueSelect=new np.ResidueSelectorWidget(this.soupWidget,`#${this.divId}-res-selector`)),this.toolbarDiv.append(i()("<div>").attr("id",this.divId+"-clipping-plane").addClass("jolecule-button").css({flex:"1 1 80px",display:"flex","flex-diretion":"row","justify-content":"center","max-width":"40%"})),this.widget.clippingPlane=new np.ClippingPlaneWidget(this.soupWidget,`#${this.divId}-clipping-plane`)),this.params.isEditable&&(this.toolbarDiv.append(gh("Zoom","jolecule-button",()=>{this.controller.zoomToSelection()})),this.toolbarDiv.append(gh("Clear","jolecule-button",()=>{this.controller.clear()})).append(gh("Sidechains","jolecule-button",()=>{this.controller.toggleSelectedSidechains()})).append(gh("Neighbors","jolecule-button",()=>{this.controller.toggleResidueNeighbors()})).append(i()("<div>").attr("id",this.divId+"-menu").addClass("jolecule-button")),this.widget.graphicsMenu=new np.GraphicsMenuWidget(this.soupWidget,`#${this.divId}-menu`,!this.params.isToolbarOnTop)),this.headerDiv.contents().length>0&&this.headerDiv.css({"border-bottom":"2px solid #AAA"}),this.footerDiv.contents().length>0&&this.footerDiv.css({"border-top":"2px solid #AAA"}))}resize(){this.soupWidget.resize()}}r("d6ec");class Pp{constructor(t){this.params=t,this.div=i()("<div>").addClass("jolecule-view"),this.makeEditDiv(),this.makeShowDiv()}saveChange(){console.log("ViewPiece.saveChange");let t=this.editTextArea.val();this.editDiv.hide(),this.showDiv.show(),this.params.saveChange(t),window.keyboardLock=!1}startEdit(){this.params.pick(),this.editTextArea.text(this.params.view.text),this.editDiv.show(),this.showDiv.hide();let t=this.editTextArea.find("textarea");setTimeout((function(){t.focus()}),100),window.keyboardLock=!0}discardChange(){this.editDiv.hide(),this.showDiv.show(),window.keyboardLock=!1}makeEditDiv(){this.editTextArea=i()("<textarea>").addClass("jolecule-view-text").css("width","100%").css("height","5em").click(s.a.noop),this.editDiv=i()("<div>").css("width","100%").click(s.a.noop).append(this.editTextArea).append(gh("save","jolecule-small-button",t=>{this.saveChange()})).append(" &nbsp; ").append(gh("discard","jolecule-small-button",t=>{this.discardChange()})).hide(),this.div.append(this.editDiv)}makeShowDiv(){let t=this.params.view,e=gh("edit","jolecule-small-button",()=>{this.startEdit()});this.showTextDiv=i()("<div>").addClass("jolecule-button").css("height","auto").css("padding","0").css("background-color","#BBB").css("text-align","left").on("click touch",t=>{"A"===t.target.tagName?window.location.href=t.target.href:(t.preventDefault(),this.params.pick())}),this.showDiv=i()("<div>").css("width","100%").append(this.showTextDiv);let r=this.params.isEditable&&!t.lock&&"view:000000"!==t.id;r&&(this.showTextDiv.css("margin-bottom","7px"),this.showDiv.append(e),mh(this.params.swapUp)&&this.showDiv.append(" ").append(gh("up","jolecule-small-button",()=>{this.params.swapUp()})),mh(this.params.swapUp)&&this.showDiv.append(" ").append(gh("down","jolecule-small-button",()=>{this.params.swapDown()})),mh(this.params.deleteView)&&this.showDiv.append(i()("<div>").css("float","right").append(gh("delete","jolecule-small-button",()=>{console.log("ViewPiece.deleteButton"),this.params.deleteView()})))),this.div.append(this.showDiv)}}class Cp{constructor(t,e,r){this.divTag=t,this.soupWidget=e,this.soupView=e.soupView,this.controller=e.controller,this.isEditable=r,this.viewPiece={},this.subheaderDiv=i()("<div>").addClass("jolecule-sub-header").append("SAVED VIEWS &nbsp;"),this.div=i()(this.divTag).append(this.subheaderDiv).append(i()('<div id="jolecule-views">')),this.isEditable&&this.subheaderDiv.append(gh("Save","jolecule-button",()=>{this.saveCurrentView()}))}saveViewsToDataServer(t){console.log("ViewPanelList.saveViewsToDataServer"),this.soupWidget.dataServer.saveViews(this.controller.getViewDicts(),t)}update(){for(let n in this.viewPiece)n in this.soupView.savedViewsByViewId||(this.viewPiece[n].div.remove(),delete this.viewPiece[n]);let t=this.soupView.savedViews.length,e=this.soupView.iLastViewSelected;e>=this.soupView.savedViews.length&&(e=0,this.soupView.iLastViewSelected=e);let r=null;e<this.soupView.savedViews.length&&(r=this.soupView.savedViews[e].id);for(let n=0;n<t;n++){let e=this.soupView.savedViews[n],i=e.id;e.id in this.viewPiece||this.insertNewViewDiv(e.id),r===i?(this.viewPiece[i].div.removeClass("jolecule-unselected-box"),this.viewPiece[i].div.addClass("jolecule-selected-box")):(this.viewPiece[i].div.removeClass("jolecule-selected-box"),this.viewPiece[i].div.addClass("jolecule-unselected-box"));let o=this.viewPiece[i],s=e.order+1+"/"+t+": "+e.text;e.creator&&(s+=` <span class="jolecule-author">${e.creator}</span>`),s!==o.showTextDiv.html()&&o.showTextDiv.html(s)}if(r&&history.pushState){let t="?view_id="+r;"view:000000"===r&&(t="");let e=window.location.protocol+"//"+window.location.host+window.location.pathname+t;window.history.pushState({path:e},"",e)}}setTargetByViewId(t){this.controller.setTargetViewByViewId(t),this.update()}gotoPrevView(){this.controller.setTargetToPrevView(),this.update()}gotoNextView(){this.controller.setTargetToNextView(),this.update()}removeView(t){console.log("ViewPanelList.removeView"),this.viewPiece[t].div.css("background-color","lightgray"),this.soupWidget.dataServer.deleteView(t,()=>{this.controller.deleteView(t),this.update()})}swapViews(t,e){let r=this.soupView.savedViews[t].id,n=this.soupView.savedViews[e].id,i=this.viewPiece[r].div,o=this.viewPiece[n].div;this.controller.swapViews(t,e),i.css("background-color","lightgray"),o.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{o.insertBefore(i),this.update(),i.css("background-color",""),o.css("background-color","")})}swapUp(t){let e=this.soupView.getIViewFromViewId(t);e<2||this.swapViews(e-1,e)}swapDown(t){let e=this.soupView.getIViewFromViewId(t);e>this.soupView.savedViews.length-2||this.swapViews(e,e+1)}makeViewDiv(t){let e=this.soupView.savedViewsByViewId[t];return this.viewPiece[t]=new Pp({view:e,isEditable:this.isEditable,deleteView:()=>{this.removeView(t)},saveChange:r=>{const n=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;while(n.test(r))r=r.replace(n,"");e.text=r,this.viewPiece[t].div.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{this.viewPiece[t].div.css("background-color",""),this.soupView.isChanged=!0,this.update()})},pick:()=>{this.setTargetByViewId(t)},swapUp:()=>{this.swapUp(t)},swapDown:()=>{this.swapDown(t)}}),this.viewPiece[t].div}makeAllViews(){for(let t=0;t<this.soupView.savedViews.length;t+=1){let e=this.soupView.savedViews[t].id,r=this.makeViewDiv(e);i()("#jolecule-views").append(r)}}insertNewViewDiv(t){let e=this.makeViewDiv(t);if(0===this.soupView.iLastViewSelected||this.soupView.iLastViewSelected===this.soupView.savedViews.length-1)i()("#jolecule-views").append(e);else{let t=this.soupView.iLastViewSelected-1,r=this.soupView.savedViews[t].id,n=this.viewPiece[r].div;e.insertAfter(n)}}saveCurrentView(){console.log("ViewPanelList.saveCurrentView");let t=this.controller.saveCurrentView();this.insertNewViewDiv(t),this.update();let e=this.viewPiece[t].div;e.css("background-color","lightgray"),this.saveViewsToDataServer(()=>{console.log("ViewPieceList.saveCurrentView success"),e.css("background-color",""),i()("#jolecule-views").stop().scrollTo(e,1e3,{offset:{top:-80}})})}}function Rp(t){let e=RegExp("[?&]"+t+"=([^&]*)").exec(window.location.search);return e&&decodeURIComponent(e[1].replace(/\+/g," "))}class Lp{constructor(t,e,r){if(this.viewsDisplayTag=e,this.params={divTag:t,backgroundColor:13421772,viewId:"",viewHeight:170,isViewTextShown:!1,isSequenceBar:!0,isEditable:!0,isGrid:!0,bCutoff:.5,isPlayable:!1},mh(r)&&(this.params=s.a.assign(this.params,r)),!this.params.viewId){let t=Rp("view_id");t&&(this.params.viewId=t,console.log("FullPageJolecule.constructor viewId="+this.params.viewId))}this.embedJolecule=new Ap(this.params),this.embedJolecule.soupWidget.addObserver(this),document.oncontextmenu=s.a.noop,document.onkeydown=t=>{this.onkeydown(t)}}clear(){this.embedJolecule.clear()}async asyncAddDataServer(t){console.log("FullPageWidget.asyncAddDataServer"),await this.embedJolecule.asyncAddDataServer(t),this.viewPanelList||(this.soupView=this.embedJolecule.soupView,this.controller=this.embedJolecule.controller,this.soupWidget=this.embedJolecule.soupWidget,this.viewPanelList=new Cp(this.viewsDisplayTag,this.soupWidget,this.params.isEditable),this.viewPanelList.makeAllViews()),this.viewPanelList.update(),this.embedJolecule.resize()}update(){s.a.isUndefined(this.viewPanelList)||this.viewPanelList.update()}onkeydown(t){if(!window.keyboardLock){let e=String.fromCharCode(t.keyCode).toUpperCase();if("V"===e)this.viewPanelList.saveCurrentView();else if("K"===e||37===t.keyCode)this.controller.setTargetToPrevResidue();else if("J"===e||39===t.keyCode)this.controller.setTargetToNextResidue();else if(38===t.keyCode)this.viewPanelList.gotoPrevView();else if(" "===e||40===t.keyCode)this.viewPanelList.gotoNextView();else if("S"===e)this.controller.toggleShowOption("sphere");else if("B"===e)this.controller.toggleShowOption("backbone");else if("R"===e)this.controller.toggleShowOption("ribbon");else if("L"===e)this.controller.toggleShowOption("ligands");else if("W"===e)this.controller.toggleShowOption("water");else if("T"===e)this.controller.toggleShowOption("transparent");else if("E"===e){let t=this.soupWidget.soupView.iLastViewSelected;if(t>0){let e=this.soupWidget.soupView.savedViews[t].id;this.viewPanelList.viewPiece[e].startEdit()}}else if("N"===e)this.controller.toggleResidueNeighbors();else if("C"===e)this.controller.toggleSelectedSidechains();else if("X"===e){let t=this.soupView.getICenteredAtom();if(t>=0){let e=this.soupView.soup.getAtomProxy(t);this.controller.selectResidue(e.iRes)}}else if("A"===e)t.metaKey?(this.controller.selectAllSidechains(!0),t.preventDefault()):this.soupWidget.atomLabelDialog();else if(27===t.keyCode)this.controller.clear();else if("Z"===e||13===t.keyCode)this.controller.zoomToSelection();else{let t=parseInt(e)-1;if((t||0===t)&&t<this.soupView.savedViews.length){let e=this.soupView.savedViews[t].id;this.viewPanelList.setTargetByViewId(e)}}}}}function Op(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),r=parseInt(e[1],16)/255,n=parseInt(e[2],16)/255,i=parseInt(e[3],16)/255;return new ri(r,n,i)}function Ip(t){return/^\d+$/.test(t)}function Dp(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),r=parseInt(e[1],16),n=parseInt(e[2],16),i=parseInt(e[3],16);return`rgb(${r}, ${n}, ${i})`}function Np(t,e){if(!t)return[];if(!e)return t.split("").map((function(t,e){return e}));let r=[];for(let n=0;n<t.length;n+=1)t.substring(n,n+e.length)===e&&r.push(n);return r}const kp="\n  FY FW LI LM IM ST AG QE ND KR\n  FL FM FH IV YH YW SC HQ QN DE\n  FI FV LV LP LY LW IT IY IW MV \n  MY MW VP SA SN SQ PT PA TA TN \n  HN HW QK QD NE",Fp={};for(let qp of kp.split(/\s+/)){Fp[qp]=1;let t=qp.charAt(1)+qp.charAt(0);Fp[t]=1}function Vp(t,e){return t===e?"identical":s.a.has(Fp,t+e)?"conserved":"nonconserved"}class zp{reload(t,e){this.data=t,this.selectSeqId=this.data.sequences[0].primary_accession,this.pdbId=this.data.pdb_id,this.selectSeq="",console.log("AquariaAlignment.reload",this.data,this.pdbId,this.selectSeqId),this.alignEntries=[];for(let r of this.data.alignment.split(";")){let t=r.split(","),e=s.a.head(t).split(":"),[n,i,o,,a]=s.a.take(e,5);if(s.a.isNil(o))continue;let[u,l,c]=s.a.last(t).split(":"),h={pdbId:n,pdbChain:i,resNumPdbStart:o,resNumPdbEnd:a,seqId:u,resNumSeqStart:l,resNumSeqEnd:c};for(let r of s.a.keys(h))Ip(h[r])&&(h[r]=parseInt(h[r]));this.alignEntries.push(h)}this.setEmbedJolecule(e)}mapSeqResToPdbResOfChain(t,e,r){for(let n of this.alignEntries)if(e>=n.resNumSeqStart&&e<=n.resNumSeqEnd&&r===n.pdbChain){let t=e-n.resNumSeqStart,r=n.resNumPdbStart+t;return[n.pdbId,n.pdbChain,r]}return null}mapSeqResToPdbResList(t){let e=[];for(let r of this.alignEntries)if(t>=r.resNumSeqStart&&t<=r.resNumSeqEnd){let n=t-r.resNumSeqStart,i=r.resNumPdbStart+n;e.push([r.pdbId,r.pdbChain,i])}return e}mapPdbResOfChainToSeqRes(t,e){for(let r of this.alignEntries)if(t===r.pdbChain&&e>=r.resNumPdbStart&&e<=r.resNumPdbEnd){let t=this.getISeqFromSeqId(r.seqId),n=this.data.common_names[t];n||(n=null);let i=e-r.resNumPdbStart,o=r.resNumSeqStart+i,s=this.data.sequences[t].sequence[o-1];return[n,o,s]}return[null,null,null]}getChainsThatMapToSeqId(t){let e=[];for(let r of s.a.range(this.data.pdb_chain.length))this.data.sequences[r].primary_accession===t&&e.push(this.data.pdb_chain[r]);return e}getISeqFromSeqId(t){let e=this.data.sequences;for(let r of s.a.range(e.length)){if(e[r].primary_accession===t)return r;let n=this.data.pdb_id+"-"+this.data.pdb_chain[r];if(n===t)return r}return null}mapSeqResToPdbResColorEntry(t,e,r){let n=this.getChainsThatMapToSeqId(t),i=[];for(let o of this.mapSeqResToPdbResList(e)){let[t,e,a]=o;s.a.includes(n,e)&&i.push({pdbId:t,chain:e,resNum:a,color:Dp(r)})}return i}colorSoup(t){t.setSecondaryStructureColorResidues();let e=[];for(let n of s.a.range(this.data.sequences.length))s.a.isNil(this.data.sequences[n].primary_accession)||e.push(this.data.pdb_chain[n]);let r=t.getResidueProxy();for(let n=0;n<t.getResidueCount();n+=1){r.iRes=n;let t=r.chain,i=r.resNum,o=s.a.get(fd,r.resType,"."),[,a,u]=this.mapPdbResOfChainToSeqRes(t,i);s.a.isNil(a)?r.customColor="#999999":s.a.includes(e,r.chain)?"conserved"===Vp(u,o)?r.customColor="#586C7C":"nonconserved"===Vp(u,o)&&(r.customColor="#4D4D4D"):r.customColor="#999999"}t.colorResidues()}setColorLegend(t){t.default(),t.colorEntries.push({color:"#586C7C",label:"Conserved"}),t.colorEntries.push({color:"#4D4D4D",label:"Nonconserved"}),t.rebuild()}setFullSequence(t){let e=t.soup;t.charEntries.length=0,t.nChar=0;let r=this.data.pdb_id,n=this.data.pdb_chain;for(let i=0;i<n.length;i+=1){let o=n[i],a=this.data.sequences[i].sequence,u=this.data.sequences[i].primary_accession,l=this.data.common_names[i];s.a.isNil(u)&&(u=""),console.log("AquariaAlignment.setFullSequence",i,u,l);for(let n=0;n<a.length;n+=1){if(0===n)for(let e of s.a.range(t.nPadChar)){let n=null;0===e&&(n="",l&&(n+=l+", "),n+=r+"-"+o);let i={iStructure:0,chain:o,c:"",startLabel:n,ss:""};t.charEntries.push(i)}let i=a[n],c=n+1,h=this.mapSeqResToPdbResOfChain(u,c,o),d="";if(l&&(d=`Sequence: ${l} ${i}${c}<br>`),s.a.isNil(h)){let e={iStructure:0,chain:o,c:i,startLabel:null,ss:".",label:d+"Structure: [No match]",resNum:n+1};t.charEntries.push(e)}else{let[r,o,a]=h,u=e.findFirstResidue(o,a);if(s.a.isNil(u)){let e={chain:o,iStructure:0,c:i,startLabel:null,ss:".",label:d+"Structure: [No match]",resNum:n+1};t.charEntries.push(e)}else{let e=s.a.get(fd,u.resType,"."),l={chain:o,iStructure:u.iStructure,c:i,startLabel:null,iRes:u.iRes,ss:u.ss,label:`${d}Structure: ${r}-${o} ${e}${a}`,resNum:n+1};t.charEntries.push(l)}}}}t.nChar=t.charEntries.length}colorFromFeatures(t,e,r,n){let i=t.soupView.soup,o=i.getResidueProxy();for(let s=0;s<i.getResidueCount();s+=1)o.iRes=s,o.customColor=Op("#999999");for(let a of e){let t=parseInt(a.Residue);for(let e of this.mapSeqResToPdbResColorEntry(r,t,a.Color)){let t=i.findFirstResidue(e.chain,e.resNum);s.a.isNil(t)||(t.customColor=e.color)}}i.colorResidues(),t.soupView.isUpdateColors=!0,t.soupView.isChanged=!0,this.setFeatureColorLegend(t.widget.colorLegend,e,n)}setFeatureColorLegend(t,e,r){this.features=e;let n=[];for(let i of e){let t=s.a.find(n,t=>t.color===i.Color);t?t.label.push(i.Name):n.push({color:i.Color,label:[i.Name]})}for(let i of n){i.label=s.a.uniq(i.label),i.label=s.a.join(i.label,", ");let t=50;i.label.length>t&&(i.label=i.label.substring(0,t-3)+"...")}t.colorEntries.length=0;for(let i of n)t.colorEntries.push(i);t.title=r,t.rebuild()}colorFromConservation(t){t.soupView.isUpdateObservers=!0,t.soupView.isUpdateColors=!0,t.soupView.isChanged=!0,this.colorSoup(t.soup),this.setColorLegend(t.widget.colorLegend)}selectNewChain(t,e,r,n){console.log("AquariaAlignment.selectNewChain [overriddeable]",t,e,r,n)}setPopup(t){let e=t.soup;t.soupWidget.popupText=t=>{let r=this.data.pdb_id,n=e.getAtomProxy(t),i=n.iRes,o=e.getResidueProxy(i),[a,u,l]=this.mapPdbResOfChainToSeqRes(o.chain,o.resNum),c=s.a.get(fd,o.resType,"."),h=`Structure: ${r}-${o.chain} ${c}${o.resNum} <br>Atom: ${n.atomType}`;if(s.a.isNil(u))h="Sequence: [No match]<br>"+h;else if(h=a?`Sequence: ${a} ${l}${u} <br>`+h:"Sequence: [No match]<br>"+h,this.features)for(let e of this.features)e.Residue===u&&(h+="<br>Feature: "+e.Name,e.Description&&(e.Name&&(h+=" - "),h+=""+e.Description));return h}}getSelectionText(){if(s.a.isNil(this.embedJolecule))return"";let t=this.embedJolecule.soup,e=t.getResidueProxy(),r=[],n=null,i={},o=null,a=null,u=null,l=null;for(let h=0;h<t.getResidueCount();h+=1)if(e.iRes=h,e.selected){let[c,h,d]=this.mapPdbResOfChainToSeqRes(e.chain,e.resNum);if(null===n||n!==e.chain){i={pdbChain:t.structureIds[e.iStructure]+"-"+e.chain,seqName:c,firstPdbRes:null,firstSeqRes:null,pdbResRanges:[],seqResRanges:[]},r.push(i);let o=s.a.get(fd,e.resType,".");i.firstPdbRes=o+e.resNum,i.firstSeqRes=d+h,n=e.chain}null===o?(o=e.resNum,a=o,u=h,l=u):(a=e.resNum,l=h)}else null!==o&&(i.pdbResRanges.push([o,a]),i.seqResRanges.push([u,l])),o=null;let c="";if(this.selectSeq&&(c+=`SEQUENCE: "${this.selectSeq}" <br>`),r.length>0)for(let[h,d]of r.entries()){if(d.pdbResRanges.length>0){c+=d.pdbChain+": ";let t=d.pdbResRanges[0],e=t[0]===t[1];if(1===d.pdbResRanges.length&&e)c+=d.firstPdbRes;else for(let[r,n]of s.a.toPairs(d.pdbResRanges))r>0&&(c+=", "),n[0]===n[1]?c+=n[0]:c+=` ${n[0]}-${n[1]}`;c+="<br>"}if(d.seqName&&d.seqResRanges.length>0){c+=d.seqName+": ";let t=d.seqResRanges[0],e=t[0]===t[1];if(1===d.seqResRanges.length&&e)c+=d.firstSeqRes;else for(let[r,n]of s.a.toPairs(d.seqResRanges))r>0&&(c+=", "),n[0]===n[1]?c+=n[0]:c+=` ${n[0]}-${n[1]}`;c+="<br>"}}return c}copyToClipboard(){let t="",e=this.embedJolecule.soup,r=this.data.pdb_chain,n=this.data.pdb_id;for(let i=0;i<r.length;i+=1){let o=r[i],a=this.data.sequences[i].sequence,u=this.data.sequences[i].primary_accession,l=this.data.common_names[i],c=`${n}-${o}`,h=c+"_SELECTED";s.a.isNil(u)&&(u=""),s.a.isNil(l)&&(l="SEQUENCE");let d="",p="";for(let t=0;t<a.length;t+=1){let r=t+1,n=this.mapSeqResToPdbResOfChain(u,r,o),i="-",a="-";if(!s.a.isNil(n)){let[,t,r]=n,o=e.findFirstResidue(t,r);s.a.isNil(o)||(i=s.a.get(fd,o.resType,"-"),o.selected&&(a=i))}d+=i,p+=a}let f=[{name:l,seq:a},{name:c,seq:d},{name:h,seq:p}],m=s.a.max(s.a.map(f,t=>t.name.length)),g=s.a.max(s.a.map(f,t=>t.seq.length)),v=50,y=Math.ceil(g/v),w="";for(let t=0;t<y;t+=1){for(let e=0;e<f.length;e+=1){let r=f[e];w+=s.a.padEnd(r.name,m)+" ",w+=r.seq.substring(t*v,(t+1)*v),w+="\n"}w+="\n"}t+=w}return console.log("AquariaAlignment.copyToClipboard"),console.log(t),Sh(t),t}selectNextChar(t){this.selectSeq+=t;let e=this.embedJolecule.soup;this.embedJolecule.controller.clearSelectedResidues();let r=this.data.pdb_chain,n=this.selectSeq.length;for(let i=0;i<r.length;i+=1){let t=r[i],o=this.data.sequences[i].sequence,a=this.data.sequences[i].primary_accession;s.a.isNil(a)&&(a="");for(let r of Np(o,this.selectSeq))for(let i=r;i<r+n;i+=1){let r=this.mapSeqResToPdbResOfChain(a,i+1,t);if(!s.a.isNil(r)){let[,t,n]=r,i=e.findFirstResidue(t,n);s.a.isNil(i)||this.embedJolecule.controller.setResidueSelect(i.iRes,!0)}}}this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.timeoutId=null,this.selectSeq="",this.embedJolecule.soupView.isUpdateObservers=!0,this.embedJolecule.soupView.isChanged=!0,console.log("AquariaAlignment.selectNextChar settimeout cancel")},4e3)}setSelectionPanel(t){let e=t.widget.selection;e.getText=()=>this.getSelectionText()}setEmbedJolecule(t){t.soupView.setMode("chain"),t.soupWidget.isCrossHairs=!1,t.soupWidget.crossHairs.visible=!1,t.soupView.setMode("chain"),this.setFullSequence(t.widget.sequence),t.widget.sequence.update();for(let[e,r]of this.data.sequences.entries())if(!s.a.isNil(r.primary_accession)){let r=this.data.pdb_chain[e];console.log("AquariaAlignment.setEmbedJolecule",r),t.controller.selectChain(0,r);break}s.a.isNil(t.soupWidget.isAquariaTracking)&&(t.soupWidget.addObserver(this),t.soupWidget.isAquariaTracking=!0,this.embedJolecule=t),this.colorFromConservation(t),this.setPopup(t),this.setSelectionPanel(t)}update(){let t=this.embedJolecule.soup.getIStructureAndChain();if(s.a.isNil(t))this.selectNewChain(null,null,null,null);else{let e=s.a.findIndex(this.data.pdb_chain,e=>e===t.chain);if(e>=0){this.selectSeqId=this.data.sequences[e].primary_accession;let r=this.data.common_names[e],n=this.embedJolecule.soup.structureIds[t.iStructure];this.selectNewChain(this.selectSeqId,r,n,t.chain)}else console.log("AquariaAlignment.update error, chain not found in alignment:",t.chain,this.data.pdb_chain,this.data)}}}function Up(t){return new Ap(s.a.merge(Tp,t))}function jp(...t){return new Lp(...t)}let Bp={pdbId:"",userId:"",isDisableSaveViews:!0,saveViewsUrl:"",isLoadViews:!1,biounit:0,viewId:""};function Hp(t){return t=s.a.merge(Bp,t),console.log("makePdbDataServer",t),Gp(t.pdbId,t.userId,t.isDisableSaveViews,t.saveViewsUrl,t.isLoadViews,t.biounit,t.viewId)}function Gp(t,e=null,r=!1,n="",o=!0,s=0,a=""){return{pdbId:t,getProteinData:function(e){let r;r=4===t.length?s?`https://files.rcsb.org/download/${t}.pdb${s}`:`https://files.rcsb.org/download/${t}.pdb`:`${n}/pdb/${t}.txt`,i.a.get(r).done(n=>{let i={pdbId:t,pdbText:n};console.log(`makeDataServer.getProteinData success ${r} biounit:${s}`),e(i)}).fail(()=>{console.log(`makeDataServer.getProteinData fail ${r} biounit:${s}`),e({pdbId:t,pdbText:""})})},getViews:function(r){if(!o)return void r([]);let s=`${n}/pdb/${t}.views.json`;e&&(s+="?user_id="+e),i.a.getJSON(s).done(t=>{console.log("makeDataServer.getViews",s,t),r(t,a)}).fail(()=>{console.log("makeDataServer.getViews fail",s),r([])})},saveViews:function(t,e){r?e():i.a.post(n+"/save/views",JSON.stringify(t)).done(()=>{console.log("makeDataServer.saveViews success","/save/views",t),e(!0)}).fail(()=>{console.log("makeDataServer.saveViews fail","/save/views",t),e(!1)})},deleteView:function(e,o){r?o():i.a.post(n+"/delete/view",JSON.stringify({pdbId:t,viewId:e})).done(()=>{console.log("makeDataServer.deleteView success",e),o(!0)}).fail(()=>{console.log("makeDataServer.deleteView fail",e),o(!1)})}}}},"5cc6":function(t,e,r){var n=r("74e8");n("Uint8",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},"5cf5":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d="errs__"+i,p=t.util.copy(t),f="";p.level++;var m="valid"+p.level,g="i"+i,v=p.dataLevel=t.dataLevel+1,y="data"+v,w=t.baseId,b=t.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:t.util.schemaHasRules(s,t.RULES.all);if(n+="var "+d+" = errors;var "+h+";",b){var x=t.compositeRule;t.compositeRule=p.compositeRule=!0,p.schema=s,p.schemaPath=a,p.errSchemaPath=u,n+=" var "+m+" = false; for (var "+g+" = 0; "+g+" < "+c+".length; "+g+"++) { ",p.errorPath=t.util.getPathExpr(t.errorPath,g,t.opts.jsonPointers,!0);var _=c+"["+g+"]";p.dataPathArr[v]=g;var S=t.validate(p);p.baseId=w,t.util.varOccurences(S,y)<2?n+=" "+t.util.varReplace(S,y,_)+" ":n+=" var "+y+" = "+_+"; "+S+" ",n+=" if ("+m+") break; }  ",t.compositeRule=p.compositeRule=x,n+=" "+f+" if (!"+m+") {"}else n+=" if ("+c+".length == 0) {";var M=M||[];M.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: 'should contain a valid item' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var E=n;return n=M.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+E+"]); ":n+=" validate.errors = ["+E+"]; return false; ":n+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { ",b&&(n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),t.opts.allErrors&&(n+=" } "),n}},"5cf7":function(t,e,r){"use strict";function n(t){var e=this;if(e instanceof n||(e=new n),e.tail=null,e.head=null,e.length=0,t&&"function"===typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)e.push(arguments[r]);return e}function i(t,e,r){var n=e===t.head?new a(r,null,e,t):new a(r,e,e.next,t);return null===n.next&&(t.tail=n),null===n.prev&&(t.head=n),t.length++,n}function o(t,e){t.tail=new a(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function s(t,e){t.head=new a(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function a(t,e,r,n){if(!(this instanceof a))return new a(t,e,r,n);this.list=n,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}t.exports=n,n.Node=a,n.create=n,n.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,r=t.prev;return e&&(e.prev=r),r&&(r.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=r),t.list.length--,t.next=null,t.prev=null,t.list=null,e},n.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},n.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},n.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)o(this,arguments[t]);return this.length},n.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)s(this,arguments[t]);return this.length},n.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},n.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},n.prototype.forEach=function(t,e){e=e||this;for(var r=this.head,n=0;null!==r;n++)t.call(e,r.value,n,this),r=r.next},n.prototype.forEachReverse=function(t,e){e=e||this;for(var r=this.tail,n=this.length-1;null!==r;n--)t.call(e,r.value,n,this),r=r.prev},n.prototype.get=function(t){for(var e=0,r=this.head;null!==r&&e<t;e++)r=r.next;if(e===t&&null!==r)return r.value},n.prototype.getReverse=function(t){for(var e=0,r=this.tail;null!==r&&e<t;e++)r=r.prev;if(e===t&&null!==r)return r.value},n.prototype.map=function(t,e){e=e||this;for(var r=new n,i=this.head;null!==i;)r.push(t.call(e,i.value,this)),i=i.next;return r},n.prototype.mapReverse=function(t,e){e=e||this;for(var r=new n,i=this.tail;null!==i;)r.push(t.call(e,i.value,this)),i=i.prev;return r},n.prototype.reduce=function(t,e){var r,n=this.head;if(arguments.length>1)r=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");n=this.head.next,r=this.head.value}for(var i=0;null!==n;i++)r=t(r,n.value,i),n=n.next;return r},n.prototype.reduceReverse=function(t,e){var r,n=this.tail;if(arguments.length>1)r=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");n=this.tail.prev,r=this.tail.value}for(var i=this.length-1;null!==n;i--)r=t(r,n.value,i),n=n.prev;return r},n.prototype.toArray=function(){for(var t=new Array(this.length),e=0,r=this.head;null!==r;e++)t[e]=r.value,r=r.next;return t},n.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,r=this.tail;null!==r;e++)t[e]=r.value,r=r.prev;return t},n.prototype.slice=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=0,o=this.head;null!==o&&i<t;i++)o=o.next;for(;null!==o&&i<e;i++,o=o.next)r.push(o.value);return r},n.prototype.sliceReverse=function(t,e){e=e||this.length,e<0&&(e+=this.length),t=t||0,t<0&&(t+=this.length);var r=new n;if(e<t||e<0)return r;t<0&&(t=0),e>this.length&&(e=this.length);for(var i=this.length,o=this.tail;null!==o&&i>e;i--)o=o.prev;for(;null!==o&&i>t;i--,o=o.prev)r.push(o.value);return r},n.prototype.splice=function(t,e){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,n=this.head;null!==n&&r<t;r++)n=n.next;var o=[];for(r=0;n&&r<e;r++)o.push(n.value),n=this.removeNode(n);null===n&&(n=this.tail),n!==this.head&&n!==this.tail&&(n=n.prev);for(r=2;r<arguments.length;r++)n=i(this,n,arguments[r]);return o},n.prototype.reverse=function(){for(var t=this.head,e=this.tail,r=t;null!==r;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=e,this.tail=t,this};try{r("1f03")(n)}catch(u){}},"5f96":function(t,e,r){"use strict";var n=r("ebb5"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=[].join;o("join",(function(t){return s.apply(i(this),arguments)}))},"60bd":function(t,e,r){"use strict";var n=r("da84"),i=r("ebb5"),o=r("e260"),s=r("b622"),a=s("iterator"),u=n.Uint8Array,l=o.values,c=o.keys,h=o.entries,d=i.aTypedArray,p=i.exportTypedArrayMethod,f=u&&u.prototype[a],m=!!f&&("values"==f.name||void 0==f.name),g=function(){return l.call(d(this))};p("entries",(function(){return h.call(d(this))})),p("keys",(function(){return c.call(d(this))})),p("values",g,!m),p(a,g,!m)},"60f5":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d="errs__"+i,p=t.util.copy(t),f="";p.level++;var m="valid"+p.level,g=s.every((function(e){return t.opts.strictKeywords?"object"==typeof e&&Object.keys(e).length>0:t.util.schemaHasRules(e,t.RULES.all)}));if(g){var v=p.baseId;n+=" var "+d+" = errors; var "+h+" = false;  ";var y=t.compositeRule;t.compositeRule=p.compositeRule=!0;var w=s;if(w){var b,x=-1,_=w.length-1;while(x<_)b=w[x+=1],p.schema=b,p.schemaPath=a+"["+x+"]",p.errSchemaPath=u+"/"+x,n+="  "+t.validate(p)+" ",p.baseId=v,n+=" "+h+" = "+h+" || "+m+"; if (!"+h+") { ",f+="}"}t.compositeRule=p.compositeRule=y,n+=" "+f+" if (!"+h+") {   var err =   ",!1!==t.createErrors?(n+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: 'should match some schema in anyOf' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&l&&(t.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",t.opts.allErrors&&(n+=" } ")}else l&&(n+=" if (true) { ");return n}},6125:function(t,e,r){var n=r("1212"),i=r("b838"),o=r("a49e"),s=r("cae0"),a=r("7aec"),u=r("89ed"),l=r("a49d");l.alea=n,l.xor128=i,l.xorwow=o,l.xorshift7=s,l.xor4096=a,l.tychei=u,t.exports=l},"621a":function(t,e,r){"use strict";var n=r("da84"),i=r("83ab"),o=r("a981"),s=r("9112"),a=r("e2cc"),u=r("d039"),l=r("19aa"),c=r("a691"),h=r("50c4"),d=r("0b25"),p=r("77a7"),f=r("e163"),m=r("d2bb"),g=r("241c").f,v=r("9bf2").f,y=r("81d5"),w=r("d44e"),b=r("69f3"),x=b.get,_=b.set,S="ArrayBuffer",M="DataView",E="prototype",T="Wrong length",A="Wrong index",P=n[S],C=P,R=n[M],L=R&&R[E],O=Object.prototype,I=n.RangeError,D=p.pack,N=p.unpack,k=function(t){return[255&t]},F=function(t){return[255&t,t>>8&255]},V=function(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]},z=function(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]},U=function(t){return D(t,23,4)},j=function(t){return D(t,52,8)},B=function(t,e){v(t[E],e,{get:function(){return x(this)[e]}})},H=function(t,e,r,n){var i=d(r),o=x(t);if(i+e>o.byteLength)throw I(A);var s=x(o.buffer).bytes,a=i+o.byteOffset,u=s.slice(a,a+e);return n?u:u.reverse()},G=function(t,e,r,n,i,o){var s=d(r),a=x(t);if(s+e>a.byteLength)throw I(A);for(var u=x(a.buffer).bytes,l=s+a.byteOffset,c=n(+i),h=0;h<e;h++)u[l+h]=c[o?h:e-h-1]};if(o){if(!u((function(){P(1)}))||!u((function(){new P(-1)}))||u((function(){return new P,new P(1.5),new P(NaN),P.name!=S}))){C=function(t){return l(this,C),new P(d(t))};for(var q,W=C[E]=P[E],$=g(P),X=0;$.length>X;)(q=$[X++])in C||s(C,q,P[q]);W.constructor=C}m&&f(L)!==O&&m(L,O);var Y=new R(new C(2)),Z=L.setInt8;Y.setInt8(0,2147483648),Y.setInt8(1,2147483649),!Y.getInt8(0)&&Y.getInt8(1)||a(L,{setInt8:function(t,e){Z.call(this,t,e<<24>>24)},setUint8:function(t,e){Z.call(this,t,e<<24>>24)}},{unsafe:!0})}else C=function(t){l(this,C,S);var e=d(t);_(this,{bytes:y.call(new Array(e),0),byteLength:e}),i||(this.byteLength=e)},R=function(t,e,r){l(this,R,M),l(t,C,M);var n=x(t).byteLength,o=c(e);if(o<0||o>n)throw I("Wrong offset");if(r=void 0===r?n-o:h(r),o+r>n)throw I(T);_(this,{buffer:t,byteLength:r,byteOffset:o}),i||(this.buffer=t,this.byteLength=r,this.byteOffset=o)},i&&(B(C,"byteLength"),B(R,"buffer"),B(R,"byteLength"),B(R,"byteOffset")),a(R[E],{getInt8:function(t){return H(this,1,t)[0]<<24>>24},getUint8:function(t){return H(this,1,t)[0]},getInt16:function(t){var e=H(this,2,t,arguments.length>1?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=H(this,2,t,arguments.length>1?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(t){return z(H(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return z(H(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return N(H(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return N(H(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,e){G(this,1,t,k,e)},setUint8:function(t,e){G(this,1,t,k,e)},setInt16:function(t,e){G(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,e){G(this,2,t,F,e,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,e){G(this,4,t,V,e,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,e){G(this,4,t,V,e,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,e){G(this,4,t,U,e,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,e){G(this,8,t,j,e,arguments.length>2?arguments[2]:void 0)}});w(C,S),w(R,M),t.exports={ArrayBuffer:C,DataView:R}},"62e4":function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},6374:function(t,e,r){r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");var n=r("6613");function i(t,e){var r;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=n(t))||e&&t&&"number"===typeof t.length){r&&(t=r);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){r=t[Symbol.iterator]()},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,s=t},f:function(){try{a||null==r["return"]||r["return"]()}finally{if(u)throw s}}}}t.exports=i},6376:function(t,e,r){"use strict";t.exports={$ref:r("6ef8"),allOf:r("ea07"),anyOf:r("60f5"),$comment:r("5c3d"),const:r("0302"),contains:r("5cf5"),dependencies:r("b920"),enum:r("e8c2"),format:r("00ad"),if:r("dd93"),items:r("798e"),maximum:r("bf8d"),minimum:r("bf8d"),maxItems:r("da3b"),minItems:r("da3b"),maxLength:r("9906"),minLength:r("9906"),maxProperties:r("77ea"),minProperties:r("77ea"),multipleOf:r("a931"),not:r("00f5"),oneOf:r("4db1"),pattern:r("714b"),properties:r("bd5b"),propertyNames:r("6d63"),required:r("b7e6"),uniqueItems:r("d30e"),validate:r("d508")}},"649e":function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").some,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("some",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},6613:function(t,e,r){r("a630"),r("fb6a"),r("b0c0"),r("d3b7"),r("25f0"),r("3ca3");var n=r("5a43");function i(t,e){if(t){if("string"===typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}t.exports=i},"66c0":function(t,e,r){"use strict";var n=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];t.exports=function(t,e){for(var r=0;r<e.length;r++){t=JSON.parse(JSON.stringify(t));var i,o=e[r].split("/"),s=t;for(i=1;i<o.length;i++)s=s[o[i]];for(i=0;i<n.length;i++){var a=n[i],u=s[a];u&&(s[a]={anyOf:[u,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]})}}return t}},"694b":function(t,e,r){"use strict";t.exports=function t(e,r){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){if(e.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;0!==i--;)if(!t(e[i],r[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(i=n;0!==i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!==i--;){var s=o[i];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}},"6c57":function(t,e,r){var n=r("23e7"),i=r("da84");n({global:!0},{globalThis:i})},"6d63":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="errs__"+i,d=t.util.copy(t),p="";d.level++;var f="valid"+d.level;if(n+="var "+h+" = errors;",t.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:t.util.schemaHasRules(s,t.RULES.all)){d.schema=s,d.schemaPath=a,d.errSchemaPath=u;var m="key"+i,g="idx"+i,v="i"+i,y="' + "+m+" + '",w=d.dataLevel=t.dataLevel+1,b="data"+w,x="dataProperties"+i,_=t.opts.ownProperties,S=t.baseId;_&&(n+=" var "+x+" = undefined; "),n+=_?" "+x+" = "+x+" || Object.keys("+c+"); for (var "+g+"=0; "+g+"<"+x+".length; "+g+"++) { var "+m+" = "+x+"["+g+"]; ":" for (var "+m+" in "+c+") { ",n+=" var startErrs"+i+" = errors; ";var M=m,E=t.compositeRule;t.compositeRule=d.compositeRule=!0;var T=t.validate(d);d.baseId=S,t.util.varOccurences(T,b)<2?n+=" "+t.util.varReplace(T,b,M)+" ":n+=" var "+b+" = "+M+"; "+T+" ",t.compositeRule=d.compositeRule=E,n+=" if (!"+f+") { for (var "+v+"=startErrs"+i+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+m+"; }   var err =   ",!1!==t.createErrors?(n+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { propertyName: '"+y+"' } ",!1!==t.opts.messages&&(n+=" , message: 'property name \\'"+y+"\\' is invalid' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&l&&(t.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),l&&(n+=" break; "),n+=" } }"}return l&&(n+=" "+p+" if ("+h+" == errors) {"),n}},"6e76":function(t){t.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')},"6ef8":function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i,o=" ",s=t.level,a=t.dataLevel,u=t.schema[e],l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(a||""),d="valid"+s;if("#"==u||"#/"==u)t.isRoot?(n=t.async,i="validate"):(n=!0===t.root.schema.$async,i="root.refVal[0]");else{var p=t.resolveRef(t.baseId,u,t.isRoot);if(void 0===p){var f=t.MissingRefError.message(t.baseId,u);if("fail"==t.opts.missingRefs){t.logger.error(f);var m=m||[];m.push(o),o="",!1!==t.createErrors?(o+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { ref: '"+t.util.escapeQuotes(u)+"' } ",!1!==t.opts.messages&&(o+=" , message: 'can\\'t resolve reference "+t.util.escapeQuotes(u)+"' "),t.opts.verbose&&(o+=" , schema: "+t.util.toQuotedString(u)+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),o+=" } "):o+=" {} ";var g=o;o=m.pop(),!t.compositeRule&&c?t.async?o+=" throw new ValidationError(["+g+"]); ":o+=" validate.errors = ["+g+"]; return false; ":o+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c&&(o+=" if (false) { ")}else{if("ignore"!=t.opts.missingRefs)throw new t.MissingRefError(t.baseId,u,f);t.logger.warn(f),c&&(o+=" if (true) { ")}}else if(p.inline){var v=t.util.copy(t);v.level++;var y="valid"+v.level;v.schema=p.schema,v.schemaPath="",v.errSchemaPath=u;var w=t.validate(v).replace(/validate\.schema/g,p.code);o+=" "+w+" ",c&&(o+=" if ("+y+") { ")}else n=!0===p.$async||t.async&&!1!==p.$async,i=p.code}if(i){m=m||[];m.push(o),o="",t.opts.passContext?o+=" "+i+".call(this, ":o+=" "+i+"( ",o+=" "+h+", (dataPath || '')",'""'!=t.errorPath&&(o+=" + "+t.errorPath);var b=a?"data"+(a-1||""):"parentData",x=a?t.dataPathArr[a]:"parentDataProperty";o+=" , "+b+" , "+x+", rootData)  ";var _=o;if(o=m.pop(),n){if(!t.async)throw new Error("async schema referenced by sync schema");c&&(o+=" var "+d+"; "),o+=" try { await "+_+"; ",c&&(o+=" "+d+" = true; "),o+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",c&&(o+=" "+d+" = false; "),o+=" } ",c&&(o+=" if ("+d+") { ")}else o+=" if (!"+_+") { if (vErrors === null) vErrors = "+i+".errors; else vErrors = vErrors.concat("+i+".errors); errors = vErrors.length; } ",c&&(o+=" else { ")}return o}},7037:function(t,e,r){function n(e){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0"),t.exports=n},7039:function(t,e,r){var n=r("23e7"),i=r("d039"),o=r("057f").f,s=i((function(){return!Object.getOwnPropertyNames(1)}));n({target:"Object",stat:!0,forced:s},{getOwnPropertyNames:o})},"714b":function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a;var p=d?"(new RegExp("+n+"))":t.usePattern(a);i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'string') || "),i+=" !"+p+".test("+h+") ) {   ";var f=f||[];f.push(i),i="",!1!==t.createErrors?(i+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { pattern:  ",i+=d?""+n:""+t.util.toQuotedString(a),i+="  } ",!1!==t.opts.messages&&(i+=" , message: 'should match pattern \"",i+=d?"' + "+n+" + '":""+t.util.escapeQuotes(a),i+="\"' "),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+t.util.toQuotedString(a),i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var m=i;return i=f.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+m+"]); ":i+=" validate.errors = ["+m+"]; return false; ":i+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},7236:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i,o=" ",s=t.level,a=t.dataLevel,u=t.schema[e],l=t.schemaPath+t.util.getProperty(e),c=t.errSchemaPath+"/"+e,h=!t.opts.allErrors,d="data"+(a||""),p="valid"+s,f="errs__"+s,m=t.opts.$data&&u&&u.$data;m?(o+=" var schema"+s+" = "+t.util.getData(u.$data,a,t.dataPathArr)+"; ",i="schema"+s):i=u;var g,v,y,w,b,x=this,_="definition"+s,S=x.definition,M="";if(m&&S.$data){b="keywordValidate"+s;var E=S.validateSchema;o+=" var "+_+" = RULES.custom['"+e+"'].definition; var "+b+" = "+_+".validate;"}else{if(w=t.useCustomRule(x,u,t.schema,t),!w)return;i="validate.schema"+l,b=w.code,g=S.compile,v=S.inline,y=S.macro}var T=b+".errors",A="i"+s,P="ruleErr"+s,C=S.async;if(C&&!t.async)throw new Error("async keyword in sync schema");if(v||y||(o+=T+" = null;"),o+="var "+f+" = errors;var "+p+";",m&&S.$data&&(M+="}",o+=" if ("+i+" === undefined) { "+p+" = true; } else { ",E&&(M+="}",o+=" "+p+" = "+_+".validateSchema("+i+"); if ("+p+") { ")),v)S.statements?o+=" "+w.validate+" ":o+=" "+p+" = "+w.validate+"; ";else if(y){var R=t.util.copy(t);M="";R.level++;var L="valid"+R.level;R.schema=w.validate,R.schemaPath="";var O=t.compositeRule;t.compositeRule=R.compositeRule=!0;var I=t.validate(R).replace(/validate\.schema/g,b);t.compositeRule=R.compositeRule=O,o+=" "+I}else{var D=D||[];D.push(o),o="",o+="  "+b+".call( ",t.opts.passContext?o+="this":o+="self",g||!1===S.schema?o+=" , "+d+" ":o+=" , "+i+" , "+d+" , validate.schema"+t.schemaPath+" ",o+=" , (dataPath || '')",'""'!=t.errorPath&&(o+=" + "+t.errorPath);var N=a?"data"+(a-1||""):"parentData",k=a?t.dataPathArr[a]:"parentDataProperty";o+=" , "+N+" , "+k+" , rootData )  ";var F=o;o=D.pop(),!1===S.errors?(o+=" "+p+" = ",C&&(o+="await "),o+=F+"; "):C?(T="customErrors"+s,o+=" var "+T+" = null; try { "+p+" = await "+F+"; } catch (e) { "+p+" = false; if (e instanceof ValidationError) "+T+" = e.errors; else throw e; } "):o+=" "+T+" = null; "+p+" = "+F+"; "}if(S.modifying&&(o+=" if ("+N+") "+d+" = "+N+"["+k+"];"),o+=""+M,S.valid)h&&(o+=" if (true) { ");else{o+=" if ( ",void 0===S.valid?(o+=" !",o+=y?""+L:""+p):o+=" "+!S.valid+" ",o+=") { ",n=x.keyword;D=D||[];D.push(o),o="";D=D||[];D.push(o),o="",!1!==t.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",!1!==t.opts.messages&&(o+=" , message: 'should pass \""+x.keyword+"\" keyword validation' "),t.opts.verbose&&(o+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ";var V=o;o=D.pop(),!t.compositeRule&&h?t.async?o+=" throw new ValidationError(["+V+"]); ":o+=" validate.errors = ["+V+"]; return false; ":o+=" var err = "+V+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var z=o;o=D.pop(),v?S.errors?"full"!=S.errors&&(o+="  for (var "+A+"="+f+"; "+A+"<errors; "+A+"++) { var "+P+" = vErrors["+A+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+c+'"; } ',t.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+d+"; "),o+=" } "):!1===S.errors?o+=" "+z+" ":(o+=" if ("+f+" == errors) { "+z+" } else {  for (var "+A+"="+f+"; "+A+"<errors; "+A+"++) { var "+P+" = vErrors["+A+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+t.errorPath+"; if ("+P+".schemaPath === undefined) { "+P+'.schemaPath = "'+c+'"; } ',t.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+d+"; "),o+=" } } "):y?(o+="   var err =   ",!1!==t.createErrors?(o+=" { keyword: '"+(n||"custom")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(c)+" , params: { keyword: '"+x.keyword+"' } ",!1!==t.opts.messages&&(o+=" , message: 'should pass \""+x.keyword+"\" keyword validation' "),t.opts.verbose&&(o+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+d+" "),o+=" } "):o+=" {} ",o+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&h&&(t.async?o+=" throw new ValidationError(vErrors); ":o+=" validate.errors = vErrors; return false; ")):!1===S.errors?o+=" "+z+" ":(o+=" if (Array.isArray("+T+")) { if (vErrors === null) vErrors = "+T+"; else vErrors = vErrors.concat("+T+"); errors = vErrors.length;  for (var "+A+"="+f+"; "+A+"<errors; "+A+"++) { var "+P+" = vErrors["+A+"]; if ("+P+".dataPath === undefined) "+P+".dataPath = (dataPath || '') + "+t.errorPath+";  "+P+'.schemaPath = "'+c+'";  ',t.opts.verbose&&(o+=" "+P+".schema = "+i+"; "+P+".data = "+d+"; "),o+=" } } else { "+z+" } "),o+=" } ",h&&(o+=" else { ")}return o}},"72f7":function(t,e,r){"use strict";var n=r("ebb5").exportTypedArrayMethod,i=r("d039"),o=r("da84"),s=o.Uint8Array,a=s&&s.prototype||{},u=[].toString,l=[].join;i((function(){u.call({})}))&&(u=function(){return l.call(this)});var c=a.toString!=u;n("toString",u,c)},"735e":function(t,e,r){"use strict";var n=r("ebb5"),i=r("81d5"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("fill",(function(t){return i.apply(o(this),arguments)}))},"74d0":function(t,e,r){r("1f8f");var n=r("9052"),i=n.vec3,o=n.mat3,s=n.mat4,a=(r("17fb"),t.exports=function(t,e){this.finger=t,this._center=null,this._matrix=null,this.type=e.type,this.prevJoint=e.prevJoint,this.nextJoint=e.nextJoint,this.width=e.width;var r=new Array(3);i.sub(r,e.nextJoint,e.prevJoint),this.length=i.length(r),this.basis=e.basis});a.prototype.left=function(){return this._left||(this._left=o.determinant(this.basis[0].concat(this.basis[1]).concat(this.basis[2]))<0),this._left},a.prototype.matrix=function(){if(this._matrix)return this._matrix;var t=this.basis,e=this._matrix=s.create();return e[0]=t[0][0],e[1]=t[0][1],e[2]=t[0][2],e[4]=t[1][0],e[5]=t[1][1],e[6]=t[1][2],e[8]=t[2][0],e[9]=t[2][1],e[10]=t[2][2],e[3]=this.center()[0],e[7]=this.center()[1],e[11]=this.center()[2],this.left()&&(e[0]*=-1,e[1]*=-1,e[2]*=-1),this._matrix},a.prototype.lerp=function(t,e){i.lerp(t,this.prevJoint,this.nextJoint,e)},a.prototype.center=function(){if(this._center)return this._center;var t=i.create();return this.lerp(t,.5),this._center=t,t},a.prototype.direction=function(){return[-1*this.basis[2][0],-1*this.basis[2][1],-1*this.basis[2][2]]}},"74e8":function(t,e,r){"use strict";var n=r("23e7"),i=r("da84"),o=r("83ab"),s=r("8aa7"),a=r("ebb5"),u=r("621a"),l=r("19aa"),c=r("5c6c"),h=r("9112"),d=r("50c4"),p=r("0b25"),f=r("182d"),m=r("c04e"),g=r("5135"),v=r("f5df"),y=r("861d"),w=r("7c73"),b=r("d2bb"),x=r("241c").f,_=r("a078"),S=r("b727").forEach,M=r("2626"),E=r("9bf2"),T=r("06cf"),A=r("69f3"),P=r("7156"),C=A.get,R=A.set,L=E.f,O=T.f,I=Math.round,D=i.RangeError,N=u.ArrayBuffer,k=u.DataView,F=a.NATIVE_ARRAY_BUFFER_VIEWS,V=a.TYPED_ARRAY_TAG,z=a.TypedArray,U=a.TypedArrayPrototype,j=a.aTypedArrayConstructor,B=a.isTypedArray,H="BYTES_PER_ELEMENT",G="Wrong length",q=function(t,e){var r=0,n=e.length,i=new(j(t))(n);while(n>r)i[r]=e[r++];return i},W=function(t,e){L(t,e,{get:function(){return C(this)[e]}})},$=function(t){var e;return t instanceof N||"ArrayBuffer"==(e=v(t))||"SharedArrayBuffer"==e},X=function(t,e){return B(t)&&"symbol"!=typeof e&&e in t&&String(+e)==String(e)},Y=function(t,e){return X(t,e=m(e,!0))?c(2,t[e]):O(t,e)},Z=function(t,e,r){return!(X(t,e=m(e,!0))&&y(r)&&g(r,"value"))||g(r,"get")||g(r,"set")||r.configurable||g(r,"writable")&&!r.writable||g(r,"enumerable")&&!r.enumerable?L(t,e,r):(t[e]=r.value,t)};o?(F||(T.f=Y,E.f=Z,W(U,"buffer"),W(U,"byteOffset"),W(U,"byteLength"),W(U,"length")),n({target:"Object",stat:!0,forced:!F},{getOwnPropertyDescriptor:Y,defineProperty:Z}),t.exports=function(t,e,r){var o=t.match(/\d+$/)[0]/8,a=t+(r?"Clamped":"")+"Array",u="get"+t,c="set"+t,m=i[a],g=m,v=g&&g.prototype,E={},T=function(t,e){var r=C(t);return r.view[u](e*o+r.byteOffset,!0)},A=function(t,e,n){var i=C(t);r&&(n=(n=I(n))<0?0:n>255?255:255&n),i.view[c](e*o+i.byteOffset,n,!0)},O=function(t,e){L(t,e,{get:function(){return T(this,e)},set:function(t){return A(this,e,t)},enumerable:!0})};F?s&&(g=e((function(t,e,r,n){return l(t,g,a),P(function(){return y(e)?$(e)?void 0!==n?new m(e,f(r,o),n):void 0!==r?new m(e,f(r,o)):new m(e):B(e)?q(g,e):_.call(g,e):new m(p(e))}(),t,g)})),b&&b(g,z),S(x(m),(function(t){t in g||h(g,t,m[t])})),g.prototype=v):(g=e((function(t,e,r,n){l(t,g,a);var i,s,u,c=0,h=0;if(y(e)){if(!$(e))return B(e)?q(g,e):_.call(g,e);i=e,h=f(r,o);var m=e.byteLength;if(void 0===n){if(m%o)throw D(G);if(s=m-h,s<0)throw D(G)}else if(s=d(n)*o,s+h>m)throw D(G);u=s/o}else u=p(e),s=u*o,i=new N(s);R(t,{buffer:i,byteOffset:h,byteLength:s,length:u,view:new k(i)});while(c<u)O(t,c++)})),b&&b(g,z),v=g.prototype=w(U)),v.constructor!==g&&h(v,"constructor",g),V&&h(v,V,a),E[a]=g,n({global:!0,forced:g!=m,sham:!F},E),H in g||h(g,H,o),H in v||h(v,H,o),M(a)}):t.exports=function(){}},"775e":function(t,e,r){"use strict";t.exports=function(t){var e,r=0,n=t.length,i=0;while(i<n)r++,e=t.charCodeAt(i++),e>=55296&&e<=56319&&i<n&&(e=t.charCodeAt(i),56320==(64512&e)&&i++);return r}},"77a7":function(t,e){var r=1/0,n=Math.abs,i=Math.pow,o=Math.floor,s=Math.log,a=Math.LN2,u=function(t,e,u){var l,c,h,d=new Array(u),p=8*u-e-1,f=(1<<p)-1,m=f>>1,g=23===e?i(2,-24)-i(2,-77):0,v=t<0||0===t&&1/t<0?1:0,y=0;for(t=n(t),t!=t||t===r?(c=t!=t?1:0,l=f):(l=o(s(t)/a),t*(h=i(2,-l))<1&&(l--,h*=2),t+=l+m>=1?g/h:g*i(2,1-m),t*h>=2&&(l++,h/=2),l+m>=f?(c=0,l=f):l+m>=1?(c=(t*h-1)*i(2,e),l+=m):(c=t*i(2,m-1)*i(2,e),l=0));e>=8;d[y++]=255&c,c/=256,e-=8);for(l=l<<e|c,p+=e;p>0;d[y++]=255&l,l/=256,p-=8);return d[--y]|=128*v,d},l=function(t,e){var n,o=t.length,s=8*o-e-1,a=(1<<s)-1,u=a>>1,l=s-7,c=o-1,h=t[c--],d=127&h;for(h>>=7;l>0;d=256*d+t[c],c--,l-=8);for(n=d&(1<<-l)-1,d>>=-l,l+=e;l>0;n=256*n+t[c],c--,l-=8);if(0===d)d=1-u;else{if(d===a)return n?NaN:h?-r:r;n+=i(2,e),d-=u}return(h?-1:1)*n*i(2,d-e)};t.exports={pack:u,unpack:l}},"77ea":function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;if(d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a,!d&&"number"!=typeof a)throw new Error(e+" must be number");var p="maxProperties"==e?">":"<";i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" Object.keys("+h+").length "+p+" "+n+") { ";var f=e,m=m||[];m.push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(f||"_limitProperties")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxProperties"==e?"more":"fewer",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" properties' "),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var g=i;return i=m.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},"783b":function(t,e,r){"use strict";var n=r("8d02"),i=r("a971"),o=r("ea9c"),s=r("ba00"),a=r("f71e"),u=r("9fe4"),l=r("c17c"),c=r("66c0"),h=r("fbda");t.exports=v,v.prototype.validate=y,v.prototype.compile=w,v.prototype.addSchema=b,v.prototype.addMetaSchema=x,v.prototype.validateSchema=_,v.prototype.getSchema=M,v.prototype.removeSchema=A,v.prototype.addFormat=k,v.prototype.errorsText=N,v.prototype._addSchema=C,v.prototype._compile=R,v.prototype.compileAsync=r("b1a8");var d=r("fff2");v.prototype.addKeyword=d.add,v.prototype.getKeyword=d.get,v.prototype.removeKeyword=d.remove,v.prototype.validateKeyword=d.validate;var p=r("899a");v.ValidationError=p.Validation,v.MissingRefError=p.MissingRef,v.$dataMetaSchema=c;var f="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes","strictDefaults"],g=["/properties"];function v(t){if(!(this instanceof v))return new v(t);t=this._opts=h.copy(t)||{},H(this),this._schemas={},this._refs={},this._fragments={},this._formats=u(t.format),this._cache=t.cache||new o,this._loadingSchemas={},this._compilations=[],this.RULES=l(),this._getId=L(t),t.loopRequired=t.loopRequired||1/0,"property"==t.errorDataPath&&(t._errorDataPathProperty=!0),void 0===t.serialize&&(t.serialize=a),this._metaOpts=B(this),t.formats&&z(this),t.keywords&&U(this),F(this),"object"==typeof t.meta&&this.addMetaSchema(t.meta),t.nullable&&this.addKeyword("nullable",{metaSchema:{type:"boolean"}}),V(this)}function y(t,e){var r;if("string"==typeof t){if(r=this.getSchema(t),!r)throw new Error('no schema with key or ref "'+t+'"')}else{var n=this._addSchema(t);r=n.validate||this._compile(n)}var i=r(e);return!0!==r.$async&&(this.errors=r.errors),i}function w(t,e){var r=this._addSchema(t,void 0,e);return r.validate||this._compile(r)}function b(t,e,r,n){if(Array.isArray(t)){for(var o=0;o<t.length;o++)this.addSchema(t[o],void 0,r,n);return this}var s=this._getId(t);if(void 0!==s&&"string"!=typeof s)throw new Error("schema id must be string");return e=i.normalizeId(e||s),j(this,e),this._schemas[e]=this._addSchema(t,r,n,!0),this}function x(t,e,r){return this.addSchema(t,e,r,!0),this}function _(t,e){var r=t.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this._opts.defaultMeta||S(this),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;var n=this.validate(r,t);if(!n&&e){var i="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(i);this.logger.error(i)}return n}function S(t){var e=t._opts.meta;return t._opts.defaultMeta="object"==typeof e?t._getId(e)||e:t.getSchema(f)?f:void 0,t._opts.defaultMeta}function M(t){var e=T(this,t);switch(typeof e){case"object":return e.validate||this._compile(e);case"string":return this.getSchema(e);case"undefined":return E(this,t)}}function E(t,e){var r=i.schema.call(t,{schema:{}},e);if(r){var o=r.schema,a=r.root,u=r.baseId,l=n.call(t,o,a,void 0,u);return t._fragments[e]=new s({ref:e,fragment:!0,schema:o,root:a,baseId:u,validate:l}),l}}function T(t,e){return e=i.normalizeId(e),t._schemas[e]||t._refs[e]||t._fragments[e]}function A(t){if(t instanceof RegExp)return P(this,this._schemas,t),P(this,this._refs,t),this;switch(typeof t){case"undefined":return P(this,this._schemas),P(this,this._refs),this._cache.clear(),this;case"string":var e=T(this,t);return e&&this._cache.del(e.cacheKey),delete this._schemas[t],delete this._refs[t],this;case"object":var r=this._opts.serialize,n=r?r(t):t;this._cache.del(n);var o=this._getId(t);o&&(o=i.normalizeId(o),delete this._schemas[o],delete this._refs[o])}return this}function P(t,e,r){for(var n in e){var i=e[n];i.meta||r&&!r.test(n)||(t._cache.del(i.cacheKey),delete e[n])}}function C(t,e,r,n){if("object"!=typeof t&&"boolean"!=typeof t)throw new Error("schema should be object or boolean");var o=this._opts.serialize,a=o?o(t):t,u=this._cache.get(a);if(u)return u;n=n||!1!==this._opts.addUsedSchema;var l=i.normalizeId(this._getId(t));l&&n&&j(this,l);var c,h=!1!==this._opts.validateSchema&&!e;h&&!(c=l&&l==i.normalizeId(t.$schema))&&this.validateSchema(t,!0);var d=i.ids.call(this,t),p=new s({id:l,schema:t,localRefs:d,cacheKey:a,meta:r});return"#"!=l[0]&&n&&(this._refs[l]=p),this._cache.put(a,p),h&&c&&this.validateSchema(t,!0),p}function R(t,e){if(t.compiling)return t.validate=o,o.schema=t.schema,o.errors=null,o.root=e||o,!0===t.schema.$async&&(o.$async=!0),o;var r,i;t.compiling=!0,t.meta&&(r=this._opts,this._opts=this._metaOpts);try{i=n.call(this,t.schema,e,t.localRefs)}catch(s){throw delete t.validate,s}finally{t.compiling=!1,t.meta&&(this._opts=r)}return t.validate=i,t.refs=i.refs,t.refVal=i.refVal,t.root=i.root,i;function o(){var e=t.validate,r=e.apply(this,arguments);return o.errors=e.errors,r}}function L(t){switch(t.schemaId){case"auto":return D;case"id":return O;default:return I}}function O(t){return t.$id&&this.logger.warn("schema $id ignored",t.$id),t.id}function I(t){return t.id&&this.logger.warn("schema id ignored",t.id),t.$id}function D(t){if(t.$id&&t.id&&t.$id!=t.id)throw new Error("schema $id is different from id");return t.$id||t.id}function N(t,e){if(t=t||this.errors,!t)return"No errors";e=e||{};for(var r=void 0===e.separator?", ":e.separator,n=void 0===e.dataVar?"data":e.dataVar,i="",o=0;o<t.length;o++){var s=t[o];s&&(i+=n+s.dataPath+" "+s.message+r)}return i.slice(0,-r.length)}function k(t,e){return"string"==typeof e&&(e=new RegExp(e)),this._formats[t]=e,this}function F(t){var e;if(t._opts.$data&&(e=r("46c0"),t.addMetaSchema(e,e.$id,!0)),!1!==t._opts.meta){var n=r("6e76");t._opts.$data&&(n=c(n,g)),t.addMetaSchema(n,f,!0),t._refs["http://json-schema.org/schema"]=f}}function V(t){var e=t._opts.schemas;if(e)if(Array.isArray(e))t.addSchema(e);else for(var r in e)t.addSchema(e[r],r)}function z(t){for(var e in t._opts.formats){var r=t._opts.formats[e];t.addFormat(e,r)}}function U(t){for(var e in t._opts.keywords){var r=t._opts.keywords[e];t.addKeyword(e,r)}}function j(t,e){if(t._schemas[e]||t._refs[e])throw new Error('schema with key or id "'+e+'" already exists')}function B(t){for(var e=h.copy(t._opts),r=0;r<m.length;r++)delete e[m[r]];return e}function H(t){var e=t._opts.logger;if(!1===e)t.logger={log:G,warn:G,error:G};else{if(void 0===e&&(e=console),!("object"==typeof e&&e.log&&e.warn&&e.error))throw new Error("logger must implement log, warn and error methods");t.logger=e}}function G(){}},7976:function(t,e,r){"use strict";var n=r("6e76");t.exports={$id:"https://github.com/ajv-validator/ajv/blob/master/lib/definition_schema.js",definitions:{simpleTypes:n.definitions.simpleTypes},type:"object",dependencies:{schema:["validate"],$data:["validate"],statements:["inline"],valid:{not:{required:["macro"]}}},properties:{type:n.properties.type,schema:{type:"boolean"},statements:{type:"boolean"},dependencies:{type:"array",items:{type:"string"}},metaSchema:{type:"object"},modifying:{type:"boolean"},valid:{type:"boolean"},$data:{type:"boolean"},async:{type:"boolean"},errors:{anyOf:[{type:"boolean"},{const:"full"}]}}}},"798e":function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d="errs__"+i,p=t.util.copy(t),f="";p.level++;var m="valid"+p.level,g="i"+i,v=p.dataLevel=t.dataLevel+1,y="data"+v,w=t.baseId;if(n+="var "+d+" = errors;var "+h+";",Array.isArray(s)){var b=t.schema.additionalItems;if(!1===b){n+=" "+h+" = "+c+".length <= "+s.length+"; ";var x=u;u=t.errSchemaPath+"/additionalItems",n+="  if (!"+h+") {   ";var _=_||[];_.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { limit: "+s.length+" } ",!1!==t.opts.messages&&(n+=" , message: 'should NOT have more than "+s.length+" items' "),t.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var S=n;n=_.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+S+"]); ":n+=" validate.errors = ["+S+"]; return false; ":n+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } ",u=x,l&&(f+="}",n+=" else { ")}var M=s;if(M){var E,T=-1,A=M.length-1;while(T<A)if(E=M[T+=1],t.opts.strictKeywords?"object"==typeof E&&Object.keys(E).length>0:t.util.schemaHasRules(E,t.RULES.all)){n+=" "+m+" = true; if ("+c+".length > "+T+") { ";var P=c+"["+T+"]";p.schema=E,p.schemaPath=a+"["+T+"]",p.errSchemaPath=u+"/"+T,p.errorPath=t.util.getPathExpr(t.errorPath,T,t.opts.jsonPointers,!0),p.dataPathArr[v]=T;var C=t.validate(p);p.baseId=w,t.util.varOccurences(C,y)<2?n+=" "+t.util.varReplace(C,y,P)+" ":n+=" var "+y+" = "+P+"; "+C+" ",n+=" }  ",l&&(n+=" if ("+m+") { ",f+="}")}}if("object"==typeof b&&(t.opts.strictKeywords?"object"==typeof b&&Object.keys(b).length>0:t.util.schemaHasRules(b,t.RULES.all))){p.schema=b,p.schemaPath=t.schemaPath+".additionalItems",p.errSchemaPath=t.errSchemaPath+"/additionalItems",n+=" "+m+" = true; if ("+c+".length > "+s.length+") {  for (var "+g+" = "+s.length+"; "+g+" < "+c+".length; "+g+"++) { ",p.errorPath=t.util.getPathExpr(t.errorPath,g,t.opts.jsonPointers,!0);P=c+"["+g+"]";p.dataPathArr[v]=g;C=t.validate(p);p.baseId=w,t.util.varOccurences(C,y)<2?n+=" "+t.util.varReplace(C,y,P)+" ":n+=" var "+y+" = "+P+"; "+C+" ",l&&(n+=" if (!"+m+") break; "),n+=" } }  ",l&&(n+=" if ("+m+") { ",f+="}")}}else if(t.opts.strictKeywords?"object"==typeof s&&Object.keys(s).length>0:t.util.schemaHasRules(s,t.RULES.all)){p.schema=s,p.schemaPath=a,p.errSchemaPath=u,n+="  for (var "+g+" = 0; "+g+" < "+c+".length; "+g+"++) { ",p.errorPath=t.util.getPathExpr(t.errorPath,g,t.opts.jsonPointers,!0);P=c+"["+g+"]";p.dataPathArr[v]=g;C=t.validate(p);p.baseId=w,t.util.varOccurences(C,y)<2?n+=" "+t.util.varReplace(C,y,P)+" ":n+=" var "+y+" = "+P+"; "+C+" ",l&&(n+=" if (!"+m+") break; "),n+=" }"}return l&&(n+=" "+f+" if ("+d+" == errors) {"),n}},"7aec":function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this;function r(t,e){var r,n,i,o,s,a=[],u=128;for(e===(0|e)?(n=e,e=null):(e+="\0",n=0,u=Math.max(u,e.length)),i=0,o=-32;o<u;++o)e&&(n^=e.charCodeAt((o+32)%e.length)),0===o&&(s=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,o>=0&&(s=s+1640531527|0,r=a[127&o]^=n+s,i=0==r?i+1:0);for(i>=128&&(a[127&(e&&e.length||0)]=-1),i=127,o=512;o>0;--o)n=a[i+34&127],r=a[i=i+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,a[i]=n^r;t.w=s,t.X=a,t.i=i}e.next=function(){var t,r,n=e.w,i=e.X,o=e.i;return e.w=n=n+1640531527|0,r=i[o+34&127],t=i[o=o+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=i[o]=r^t,e.i=o,r+(n^n>>>16)|0},r(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function u(t,e){null==t&&(t=+new Date);var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=r.next()>>>11,e=(r.next()>>>0)/4294967296,n=(t+e)/(1<<21)}while(0===n);return n},i.int32=r.next,i.quick=i,n&&(n.X&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.xor4096=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},"808a":function(t,e,r){var n=r("16c3"),i=r("1f8f"),o=r("a3b3").createGesture,s=r("9052"),a=s.mat3,u=s.vec3,l=r("df2a"),c=r("5915"),h=r("17fb"),d=t.exports=function(t){if(this.valid=!0,this.id=t.id,this.timestamp=t.timestamp,this.hands=[],this.handsMap={},this.pointables=[],this.tools=[],this.fingers=[],t.interactionBox&&(this.interactionBox=new l(t.interactionBox)),this.gestures=[],this.pointablesMap={},this._translation=t.t,this._rotation=h.flatten(t.r),this._scaleFactor=t.s,this.data=t,this.type="frame",this.currentFrameRate=t.currentFrameRate,t.gestures)for(var e=0,r=t.gestures.length;e!=r;e++)this.gestures.push(o(t.gestures[e]));this.postprocessData(t)};d.prototype.postprocessData=function(t){t||(t=this.data);for(var e=0,r=t.hands.length;e!=r;e++){var o=new n(t.hands[e]);o.frame=this,this.hands.push(o),this.handsMap[o.id]=o}t.pointables=h.sortBy(t.pointables,(function(t){return t.id}));for(var s=0,a=t.pointables.length;s!=a;s++){var u=t.pointables[s],l=u.dipPosition?new c(u):new i(u);l.frame=this,this.addPointable(l)}},d.prototype.addPointable=function(t){if(this.pointables.push(t),this.pointablesMap[t.id]=t,(t.tool?this.tools:this.fingers).push(t),void 0!==t.handId&&this.handsMap.hasOwnProperty(t.handId)){var e=this.handsMap[t.handId];switch(e.pointables.push(t),(t.tool?e.tools:e.fingers).push(t),t.type){case 0:e.thumb=t;break;case 1:e.indexFinger=t;break;case 2:e.middleFinger=t;break;case 3:e.ringFinger=t;break;case 4:e.pinky=t;break}}},d.prototype.tool=function(t){var e=this.pointable(t);return e.tool?e:i.Invalid},d.prototype.pointable=function(t){return this.pointablesMap[t]||i.Invalid},d.prototype.finger=function(t){var e=this.pointable(t);return e.tool?i.Invalid:e},d.prototype.hand=function(t){return this.handsMap[t]||n.Invalid},d.prototype.rotationAngle=function(t,e){if(!this.valid||!t.valid)return 0;var r=this.rotationMatrix(t),n=.5*(r[0]+r[4]+r[8]-1),i=Math.acos(n);if(i=isNaN(i)?0:i,void 0!==e){var o=this.rotationAxis(t);i*=u.dot(o,u.normalize(u.create(),e))}return i},d.prototype.rotationAxis=function(t){return this.valid&&t.valid?u.normalize(u.create(),[this._rotation[7]-t._rotation[5],this._rotation[2]-t._rotation[6],this._rotation[3]-t._rotation[1]]):u.create()},d.prototype.rotationMatrix=function(t){if(!this.valid||!t.valid)return a.create();var e=a.transpose(a.create(),this._rotation);return a.multiply(a.create(),t._rotation,e)},d.prototype.scaleFactor=function(t){return this.valid&&t.valid?Math.exp(this._scaleFactor-t._scaleFactor):1},d.prototype.translation=function(t){return this.valid&&t.valid?u.subtract(u.create(),this._translation,t._translation):u.create()},d.prototype.toString=function(){var t="Frame [ id:"+this.id+" | timestamp:"+this.timestamp+" | Hand count:("+this.hands.length+") | Pointable count:("+this.pointables.length+")";return this.gestures&&(t+=" | Gesture count:("+this.gestures.length+")"),t+=" ]",t},d.prototype.dump=function(){var t="";t+="Frame Info:<br/>",t+=this.toString(),t+="<br/><br/>Hands:<br/>";for(var e=0,r=this.hands.length;e!=r;e++)t+="  "+this.hands[e].toString()+"<br/>";t+="<br/><br/>Pointables:<br/>";for(var n=0,i=this.pointables.length;n!=i;n++)t+="  "+this.pointables[n].toString()+"<br/>";if(this.gestures){t+="<br/><br/>Gestures:<br/>";for(var o=0,s=this.gestures.length;o!=s;o++)t+="  "+this.gestures[o].toString()+"<br/>"}return t+="<br/><br/>Raw JSON:<br/>",t+=JSON.stringify(this.data),t},d.Invalid={valid:!1,hands:[],fingers:[],tools:[],gestures:[],pointables:[],pointable:function(){return i.Invalid},finger:function(){return i.Invalid},hand:function(){return n.Invalid},toString:function(){return"invalid frame"},dump:function(){return this.toString()},rotationAngle:function(){return 0},rotationMatrix:function(){return a.create()},rotationAxis:function(){return u.create()},scaleFactor:function(){return 1},translation:function(){return u.create()}}},"81d5":function(t,e,r){"use strict";var n=r("7b0b"),i=r("23cb"),o=r("50c4");t.exports=function(t){var e=n(this),r=o(e.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,r),u=s>2?arguments[2]:void 0,l=void 0===u?r:i(u,r);while(l>a)e[a++]=t;return e}},"82f8":function(t,e,r){"use strict";var n=r("ebb5"),i=r("4d64").includes,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("includes",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},"84c3":function(t,e,r){var n=r("74e8");n("Uint16",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},"899a":function(t,e,r){"use strict";var n=r("a971");function i(t){this.message="validation failed",this.errors=t,this.ajv=this.validation=!0}function o(t,e,r){this.message=r||o.message(t,e),this.missingRef=n.url(t,e),this.missingSchema=n.normalizeId(n.fullPath(this.missingRef))}function s(t){return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}t.exports={Validation:s(i),MissingRef:s(o)},o.message=function(t,e){return"can't resolve reference "+e+" from id "+t}},"89a9":function(t,e,r){"use strict";var n=t.exports=function(t,e,r){"function"==typeof e&&(r=e,e={}),r=e.cb||r;var n="function"==typeof r?r:r.pre||function(){},o=r.post||function(){};i(e,n,o,t,"",t)};function i(t,e,r,s,a,u,l,c,h,d){if(s&&"object"==typeof s&&!Array.isArray(s)){for(var p in e(s,a,u,l,c,h,d),s){var f=s[p];if(Array.isArray(f)){if(p in n.arrayKeywords)for(var m=0;m<f.length;m++)i(t,e,r,f[m],a+"/"+p+"/"+m,u,a,p,s,m)}else if(p in n.propsKeywords){if(f&&"object"==typeof f)for(var g in f)i(t,e,r,f[g],a+"/"+p+"/"+o(g),u,a,p,s,g)}else(p in n.keywords||t.allKeys&&!(p in n.skipKeywords))&&i(t,e,r,f,a+"/"+p,u,a,p,s)}r(s,a,u,l,c,h,d)}}function o(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}n.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},n.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},n.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},n.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},"89ed":function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,n=e.d,i=e.a;return t=t<<25^t>>>7^r,r=r-n|0,n=n<<24^n>>>8^i,i=i-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-n|0,e.d=n<<16^r>>>16^i,e.a=i-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var n=0;n<r.length+20;n++)e.b^=0|r.charCodeAt(n),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function u(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=r.next()>>>11,e=(r.next()>>>0)/4294967296,n=(t+e)/(1<<21)}while(0===n);return n},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.tychei=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},"8aa7":function(t,e,r){var n=r("da84"),i=r("d039"),o=r("1c7e"),s=r("ebb5").NATIVE_ARRAY_BUFFER_VIEWS,a=n.ArrayBuffer,u=n.Int8Array;t.exports=!s||!i((function(){u(1)}))||!i((function(){new u(-1)}))||!o((function(t){new u,new u(null),new u(1.5),new u(t)}),!0)||i((function(){return 1!==new u(new a(2),1,void 0).length}))},"8d02":function(t,e,r){"use strict";var n=r("a971"),i=r("fbda"),o=r("899a"),s=r("f71e"),a=r("d508"),u=i.ucs2length,l=r("694b"),c=o.Validation;function h(t,e,r,f){var b=this,x=this._opts,_=[void 0],S={},M=[],E={},T=[],A={},P=[];e=e||{schema:t,refVal:_,refs:S};var C=d.call(this,t,e,f),R=this._compilations[C.index];if(C.compiling)return R.callValidate=N;var L=this._formats,O=this.RULES;try{var I=k(t,e,r,f);R.validate=I;var D=R.callValidate;return D&&(D.schema=I.schema,D.errors=null,D.refs=I.refs,D.refVal=I.refVal,D.root=I.root,D.$async=I.$async,x.sourceCode&&(D.source=I.source)),I}finally{p.call(this,t,e,f)}function N(){var t=R.validate,e=t.apply(this,arguments);return N.errors=t.errors,e}function k(t,r,s,d){var p=!r||r&&r.schema==t;if(r.schema!=e.schema)return h.call(b,t,r,s,d);var f,E=!0===t.$async,A=a({isTop:!0,schema:t,isRoot:p,baseId:d,root:r,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:o.MissingRef,RULES:O,validate:a,util:i,resolve:n,resolveRef:F,usePattern:B,useDefault:H,useCustomRule:G,opts:x,formats:L,logger:b.logger,self:b});A=w(_,v)+w(M,m)+w(T,g)+w(P,y)+A,x.processCode&&(A=x.processCode(A,t));try{var C=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",A);f=C(b,O,L,e,_,T,P,l,u,c),_[0]=f}catch(R){throw b.logger.error("Error compiling schema, function code:",A),R}return f.schema=t,f.errors=null,f.refs=S,f.refVal=_,f.root=p?f:r,E&&(f.$async=!0),!0===x.sourceCode&&(f.source={code:A,patterns:M,defaults:T}),f}function F(t,i,o){i=n.url(t,i);var s,a,u=S[i];if(void 0!==u)return s=_[u],a="refVal["+u+"]",j(s,a);if(!o&&e.refs){var l=e.refs[i];if(void 0!==l)return s=e.refVal[l],a=V(i,s),j(s,a)}a=V(i);var c=n.call(b,k,e,i);if(void 0===c){var d=r&&r[i];d&&(c=n.inlineRef(d,x.inlineRefs)?d:h.call(b,d,e,r,t))}if(void 0!==c)return U(i,c),j(c,a);z(i)}function V(t,e){var r=_.length;return _[r]=e,S[t]=r,"refVal"+r}function z(t){delete S[t]}function U(t,e){var r=S[t];_[r]=e}function j(t,e){return"object"==typeof t||"boolean"==typeof t?{code:e,schema:t,inline:!0}:{code:e,$async:t&&!!t.$async}}function B(t){var e=E[t];return void 0===e&&(e=E[t]=M.length,M[e]=t),"pattern"+e}function H(t){switch(typeof t){case"boolean":case"number":return""+t;case"string":return i.toQuotedString(t);case"object":if(null===t)return"null";var e=s(t),r=A[e];return void 0===r&&(r=A[e]=T.length,T[r]=t),"default"+r}}function G(t,e,r,n){if(!1!==b._opts.validateSchema){var i=t.definition.dependencies;if(i&&!i.every((function(t){return Object.prototype.hasOwnProperty.call(r,t)})))throw new Error("parent schema must have all required keywords: "+i.join(","));var o=t.definition.validateSchema;if(o){var s=o(e);if(!s){var a="keyword schema is invalid: "+b.errorsText(o.errors);if("log"!=b._opts.validateSchema)throw new Error(a);b.logger.error(a)}}}var u,l=t.definition.compile,c=t.definition.inline,h=t.definition.macro;if(l)u=l.call(b,e,r,n);else if(h)u=h.call(b,e,r,n),!1!==x.validateSchema&&b.validateSchema(u,!0);else if(c)u=c.call(b,n,t.keyword,e,r);else if(u=t.definition.validate,!u)return;if(void 0===u)throw new Error('custom keyword "'+t.keyword+'"failed to compile');var d=P.length;return P[d]=u,{code:"customRule"+d,validate:u}}}function d(t,e,r){var n=f.call(this,t,e,r);return n>=0?{index:n,compiling:!0}:(n=this._compilations.length,this._compilations[n]={schema:t,root:e,baseId:r},{index:n,compiling:!1})}function p(t,e,r){var n=f.call(this,t,e,r);n>=0&&this._compilations.splice(n,1)}function f(t,e,r){for(var n=0;n<this._compilations.length;n++){var i=this._compilations[n];if(i.schema==t&&i.root==e&&i.baseId==r)return n}return-1}function m(t,e){return"var pattern"+t+" = new RegExp("+i.toQuotedString(e[t])+");"}function g(t){return"var default"+t+" = defaults["+t+"];"}function v(t,e){return void 0===e[t]?"":"var refVal"+t+" = refVal["+t+"];"}function y(t){return"var customRule"+t+" = customRules["+t+"];"}function w(t,e){if(!t.length)return"";for(var r="",n=0;n<t.length;n++)r+=e(n,t);return r}t.exports=h},9052:function(t,e,r){(function(t){"use strict";var r={};r.exports=e,function(t){if(!e)var e=1e-6;if(!r)var r="undefined"!==typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var i={setMatrixArrayType:function(t){r=t}};"undefined"!==typeof t&&(t.glMatrix=i);var o=Math.PI/180;i.toRadian=function(t){return t*o};var s={create:function(){var t=new r(2);return t[0]=0,t[1]=0,t},clone:function(t){var e=new r(2);return e[0]=t[0],e[1]=t[1],e},fromValues:function(t,e){var n=new r(2);return n[0]=t,n[1]=e,n},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t},set:function(t,e,r){return t[0]=e,t[1]=r,t},add:function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},subtract:function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}};s.sub=s.subtract,s.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t},s.mul=s.multiply,s.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t},s.div=s.divide,s.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},s.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},s.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},s.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t},s.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)},s.dist=s.distance,s.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n},s.sqrDist=s.squaredDistance,s.length=function(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)},s.len=s.length,s.squaredLength=function(t){var e=t[0],r=t[1];return e*e+r*r},s.sqrLen=s.squaredLength,s.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},s.normalize=function(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},s.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},s.cross=function(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t},s.lerp=function(t,e,r,n){var i=e[0],o=e[1];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t},s.random=function(t,e){e=e||1;var r=2*n()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},s.transformMat2=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t},s.transformMat2d=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t},s.transformMat3=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t},s.transformMat4=function(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t},s.forEach=function(){var t=s.create();return function(e,r,n,i,o,s){var a,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}(),s.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},"undefined"!==typeof t&&(t.vec2=s);var a={create:function(){var t=new r(3);return t[0]=0,t[1]=0,t[2]=0,t},clone:function(t){var e=new r(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},fromValues:function(t,e,n){var i=new r(3);return i[0]=t,i[1]=e,i[2]=n,i},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},set:function(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t},add:function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},subtract:function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}};a.sub=a.subtract,a.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t},a.mul=a.multiply,a.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t},a.div=a.divide,a.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},a.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},a.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},a.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t},a.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)},a.dist=a.distance,a.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i},a.sqrDist=a.squaredDistance,a.length=function(t){var e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)},a.len=a.length,a.squaredLength=function(t){var e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n},a.sqrLen=a.squaredLength,a.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},a.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t},a.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},a.cross=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2];return t[0]=i*u-o*a,t[1]=o*s-n*u,t[2]=n*a-i*s,t},a.lerp=function(t,e,r,n){var i=e[0],o=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=s+n*(r[2]-s),t},a.random=function(t,e){e=e||1;var r=2*n()*Math.PI,i=2*n()-1,o=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*o,t[1]=Math.sin(r)*o,t[2]=i*e,t},a.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12],t[1]=r[1]*n+r[5]*i+r[9]*o+r[13],t[2]=r[2]*n+r[6]*i+r[10]*o+r[14],t},a.transformMat3=function(t,e,r){var n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t},a.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2],l=r[3],c=l*n+a*o-u*i,h=l*i+u*n-s*o,d=l*o+s*i-a*n,p=-s*n-a*i-u*o;return t[0]=c*l+p*-s+h*-u-d*-a,t[1]=h*l+p*-a+d*-s-c*-u,t[2]=d*l+p*-u+c*-a-h*-s,t},a.rotateX=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateY=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.rotateZ=function(t,e,r,n){var i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t},a.forEach=function(){var t=a.create();return function(e,r,n,i,o,s){var a,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}(),a.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},"undefined"!==typeof t&&(t.vec3=a);var u={create:function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},clone:function(t){var e=new r(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},fromValues:function(t,e,n,i){var o=new r(4);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},set:function(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t},add:function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},subtract:function(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}};u.sub=u.subtract,u.multiply=function(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t},u.mul=u.multiply,u.divide=function(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t},u.div=u.divide,u.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},u.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},u.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},u.scaleAndAdd=function(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t},u.distance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)},u.dist=u.distance,u.squaredDistance=function(t,e){var r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o},u.sqrDist=u.squaredDistance,u.length=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)},u.len=u.length,u.squaredLength=function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i},u.sqrLen=u.squaredLength,u.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},u.normalize=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s),t},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},u.lerp=function(t,e,r,n){var i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=s+n*(r[2]-s),t[3]=a+n*(r[3]-a),t},u.random=function(t,e){return e=e||1,t[0]=n(),t[1]=n(),t[2]=n(),t[3]=n(),u.normalize(t,t),u.scale(t,t,e),t},u.transformMat4=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,t},u.transformQuat=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2],l=r[3],c=l*n+a*o-u*i,h=l*i+u*n-s*o,d=l*o+s*i-a*n,p=-s*n-a*i-u*o;return t[0]=c*l+p*-s+h*-u-d*-a,t[1]=h*l+p*-a+d*-s-c*-u,t[2]=d*l+p*-u+c*-a-h*-s,t},u.forEach=function(){var t=u.create();return function(e,r,n,i,o,s){var a,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}(),u.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!==typeof t&&(t.vec4=u);var l={create:function(){var t=new r(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},clone:function(t){var e=new r(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},transpose:function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},invert:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r*o-i*n;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t):null},adjoint:function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},determinant:function(t){return t[0]*t[3]-t[2]*t[1]},multiply:function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1],l=r[2],c=r[3];return t[0]=n*a+o*u,t[1]=i*a+s*u,t[2]=n*l+o*c,t[3]=i*l+s*c,t}};l.mul=l.multiply,l.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*a,t[1]=i*u+s*a,t[2]=n*-a+o*u,t[3]=i*-a+s*u,t},l.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1];return t[0]=n*a,t[1]=i*a,t[2]=o*u,t[3]=s*u,t},l.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},l.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},l.LDU=function(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]},"undefined"!==typeof t&&(t.mat2=l);var c={create:function(){var t=new r(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},clone:function(t){var e=new r(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},invert:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=r*o-n*i;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*a-o*s)*u,t[5]=(n*s-r*a)*u,t):null},determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=r[0],c=r[1],h=r[2],d=r[3],p=r[4],f=r[5];return t[0]=n*l+o*c,t[1]=i*l+s*c,t[2]=n*h+o*d,t[3]=i*h+s*d,t[4]=n*p+o*f+a,t[5]=i*p+s*f+u,t}};c.mul=c.multiply,c.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=Math.sin(r),c=Math.cos(r);return t[0]=n*c+o*l,t[1]=i*c+s*l,t[2]=n*-l+o*c,t[3]=i*-l+s*c,t[4]=a,t[5]=u,t},c.scale=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=r[0],c=r[1];return t[0]=n*l,t[1]=i*l,t[2]=o*c,t[3]=s*c,t[4]=a,t[5]=u,t},c.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=r[0],c=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=n*l+o*c+a,t[5]=i*l+s*c+u,t},c.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},c.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},"undefined"!==typeof t&&(t.mat2d=c);var h={create:function(){var t=new r(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat4:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},clone:function(t){var e=new r(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:function(t,e){if(t===e){var r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},invert:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=c*s-a*l,d=-c*o+a*u,p=l*o-s*u,f=r*h+n*d+i*p;return f?(f=1/f,t[0]=h*f,t[1]=(-c*n+i*l)*f,t[2]=(a*n-i*s)*f,t[3]=d*f,t[4]=(c*r-i*u)*f,t[5]=(-a*r+i*o)*f,t[6]=p*f,t[7]=(-l*r+n*u)*f,t[8]=(s*r-n*o)*f,t):null},adjoint:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8];return t[0]=s*c-a*l,t[1]=i*l-n*c,t[2]=n*a-i*s,t[3]=a*u-o*c,t[4]=r*c-i*u,t[5]=i*o-r*a,t[6]=o*l-s*u,t[7]=n*u-r*l,t[8]=r*s-n*o,t},determinant:function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8];return e*(l*o-s*u)+r*(-l*i+s*a)+n*(u*i-o*a)},multiply:function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=r[0],p=r[1],f=r[2],m=r[3],g=r[4],v=r[5],y=r[6],w=r[7],b=r[8];return t[0]=d*n+p*s+f*l,t[1]=d*i+p*a+f*c,t[2]=d*o+p*u+f*h,t[3]=m*n+g*s+v*l,t[4]=m*i+g*a+v*c,t[5]=m*o+g*u+v*h,t[6]=y*n+w*s+b*l,t[7]=y*i+w*a+b*c,t[8]=y*o+w*u+b*h,t}};h.mul=h.multiply,h.translate=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=r[0],p=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=d*n+p*s+l,t[7]=d*i+p*a+c,t[8]=d*o+p*u+h,t},h.rotate=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=Math.sin(r),p=Math.cos(r);return t[0]=p*n+d*s,t[1]=p*i+d*a,t[2]=p*o+d*u,t[3]=p*s-d*n,t[4]=p*a-d*i,t[5]=p*u-d*o,t[6]=l,t[7]=c,t[8]=h,t},h.scale=function(t,e,r){var n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},h.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},h.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,a=n+n,u=i+i,l=r*s,c=n*s,h=n*a,d=i*s,p=i*a,f=i*u,m=o*s,g=o*a,v=o*u;return t[0]=1-h-f,t[3]=c-v,t[6]=d+g,t[1]=c+v,t[4]=1-l-f,t[7]=p-m,t[2]=d-g,t[5]=p+m,t[8]=1-l-h,t},h.normalFromMat4=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=r*a-n*s,w=r*u-i*s,b=r*l-o*s,x=n*u-i*a,_=n*l-o*a,S=i*l-o*u,M=c*m-h*f,E=c*g-d*f,T=c*v-p*f,A=h*g-d*m,P=h*v-p*m,C=d*v-p*g,R=y*C-w*P+b*A+x*T-_*E+S*M;return R?(R=1/R,t[0]=(a*C-u*P+l*A)*R,t[1]=(u*T-s*C-l*E)*R,t[2]=(s*P-a*T+l*M)*R,t[3]=(i*P-n*C-o*A)*R,t[4]=(r*C-i*T+o*E)*R,t[5]=(n*T-r*P-o*M)*R,t[6]=(m*S-g*_+v*x)*R,t[7]=(g*b-f*S-v*w)*R,t[8]=(f*_-m*b+v*y)*R,t):null},h.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},h.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},"undefined"!==typeof t&&(t.mat3=h);var d={create:function(){var t=new r(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},clone:function(t){var e=new r(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},transpose:function(t,e){if(t===e){var r=e[1],n=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},invert:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=e[15],y=r*a-n*s,w=r*u-i*s,b=r*l-o*s,x=n*u-i*a,_=n*l-o*a,S=i*l-o*u,M=c*m-h*f,E=c*g-d*f,T=c*v-p*f,A=h*g-d*m,P=h*v-p*m,C=d*v-p*g,R=y*C-w*P+b*A+x*T-_*E+S*M;return R?(R=1/R,t[0]=(a*C-u*P+l*A)*R,t[1]=(i*P-n*C-o*A)*R,t[2]=(m*S-g*_+v*x)*R,t[3]=(d*_-h*S-p*x)*R,t[4]=(u*T-s*C-l*E)*R,t[5]=(r*C-i*T+o*E)*R,t[6]=(g*b-f*S-v*w)*R,t[7]=(c*S-d*b+p*w)*R,t[8]=(s*P-a*T+l*M)*R,t[9]=(n*T-r*P-o*M)*R,t[10]=(f*_-m*b+v*y)*R,t[11]=(h*b-c*_-p*y)*R,t[12]=(a*E-s*A-u*M)*R,t[13]=(r*A-n*E+i*M)*R,t[14]=(m*w-f*x-g*y)*R,t[15]=(c*x-h*w+d*y)*R,t):null},adjoint:function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],l=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],v=e[15];return t[0]=a*(d*v-p*g)-h*(u*v-l*g)+m*(u*p-l*d),t[1]=-(n*(d*v-p*g)-h*(i*v-o*g)+m*(i*p-o*d)),t[2]=n*(u*v-l*g)-a*(i*v-o*g)+m*(i*l-o*u),t[3]=-(n*(u*p-l*d)-a*(i*p-o*d)+h*(i*l-o*u)),t[4]=-(s*(d*v-p*g)-c*(u*v-l*g)+f*(u*p-l*d)),t[5]=r*(d*v-p*g)-c*(i*v-o*g)+f*(i*p-o*d),t[6]=-(r*(u*v-l*g)-s*(i*v-o*g)+f*(i*l-o*u)),t[7]=r*(u*p-l*d)-s*(i*p-o*d)+c*(i*l-o*u),t[8]=s*(h*v-p*m)-c*(a*v-l*m)+f*(a*p-l*h),t[9]=-(r*(h*v-p*m)-c*(n*v-o*m)+f*(n*p-o*h)),t[10]=r*(a*v-l*m)-s*(n*v-o*m)+f*(n*l-o*a),t[11]=-(r*(a*p-l*h)-s*(n*p-o*h)+c*(n*l-o*a)),t[12]=-(s*(h*g-d*m)-c*(a*g-u*m)+f*(a*d-u*h)),t[13]=r*(h*g-d*m)-c*(n*g-i*m)+f*(n*d-i*h),t[14]=-(r*(a*g-u*m)-s*(n*g-i*m)+f*(n*u-i*a)),t[15]=r*(a*d-u*h)-s*(n*d-i*h)+c*(n*u-i*a),t},determinant:function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],l=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],m=t[14],g=t[15],v=e*s-r*o,y=e*a-n*o,w=e*u-i*o,b=r*a-n*s,x=r*u-i*s,_=n*u-i*a,S=l*f-c*p,M=l*m-h*p,E=l*g-d*p,T=c*m-h*f,A=c*g-d*f,P=h*g-d*m;return v*P-y*A+w*T+b*E-x*M+_*S},multiply:function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],w=r[0],b=r[1],x=r[2],_=r[3];return t[0]=w*n+b*a+x*h+_*m,t[1]=w*i+b*u+x*d+_*g,t[2]=w*o+b*l+x*p+_*v,t[3]=w*s+b*c+x*f+_*y,w=r[4],b=r[5],x=r[6],_=r[7],t[4]=w*n+b*a+x*h+_*m,t[5]=w*i+b*u+x*d+_*g,t[6]=w*o+b*l+x*p+_*v,t[7]=w*s+b*c+x*f+_*y,w=r[8],b=r[9],x=r[10],_=r[11],t[8]=w*n+b*a+x*h+_*m,t[9]=w*i+b*u+x*d+_*g,t[10]=w*o+b*l+x*p+_*v,t[11]=w*s+b*c+x*f+_*y,w=r[12],b=r[13],x=r[14],_=r[15],t[12]=w*n+b*a+x*h+_*m,t[13]=w*i+b*u+x*d+_*g,t[14]=w*o+b*l+x*p+_*v,t[15]=w*s+b*c+x*f+_*y,t}};d.mul=d.multiply,d.translate=function(t,e,r){var n,i,o,s,a,u,l,c,h,d,p,f,m=r[0],g=r[1],v=r[2];return e===t?(t[12]=e[0]*m+e[4]*g+e[8]*v+e[12],t[13]=e[1]*m+e[5]*g+e[9]*v+e[13],t[14]=e[2]*m+e[6]*g+e[10]*v+e[14],t[15]=e[3]*m+e[7]*g+e[11]*v+e[15]):(n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],l=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=l,t[7]=c,t[8]=h,t[9]=d,t[10]=p,t[11]=f,t[12]=n*m+a*g+h*v+e[12],t[13]=i*m+u*g+d*v+e[13],t[14]=o*m+l*g+p*v+e[14],t[15]=s*m+c*g+f*v+e[15]),t},d.scale=function(t,e,r){var n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},d.rotate=function(t,r,n,i){var o,s,a,u,l,c,h,d,p,f,m,g,v,y,w,b,x,_,S,M,E,T,A,P,C=i[0],R=i[1],L=i[2],O=Math.sqrt(C*C+R*R+L*L);return Math.abs(O)<e?null:(O=1/O,C*=O,R*=O,L*=O,o=Math.sin(n),s=Math.cos(n),a=1-s,u=r[0],l=r[1],c=r[2],h=r[3],d=r[4],p=r[5],f=r[6],m=r[7],g=r[8],v=r[9],y=r[10],w=r[11],b=C*C*a+s,x=R*C*a+L*o,_=L*C*a-R*o,S=C*R*a-L*o,M=R*R*a+s,E=L*R*a+C*o,T=C*L*a+R*o,A=R*L*a-C*o,P=L*L*a+s,t[0]=u*b+d*x+g*_,t[1]=l*b+p*x+v*_,t[2]=c*b+f*x+y*_,t[3]=h*b+m*x+w*_,t[4]=u*S+d*M+g*E,t[5]=l*S+p*M+v*E,t[6]=c*S+f*M+y*E,t[7]=h*S+m*M+w*E,t[8]=u*T+d*A+g*P,t[9]=l*T+p*A+v*P,t[10]=c*T+f*A+y*P,t[11]=h*T+m*A+w*P,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)},d.rotateX=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[4],s=e[5],a=e[6],u=e[7],l=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+l*n,t[5]=s*i+c*n,t[6]=a*i+h*n,t[7]=u*i+d*n,t[8]=l*i-o*n,t[9]=c*i-s*n,t[10]=h*i-a*n,t[11]=d*i-u*n,t},d.rotateY=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],l=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-l*n,t[1]=s*i-c*n,t[2]=a*i-h*n,t[3]=u*i-d*n,t[8]=o*n+l*i,t[9]=s*n+c*i,t[10]=a*n+h*i,t[11]=u*n+d*i,t},d.rotateZ=function(t,e,r){var n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],l=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+l*n,t[1]=s*i+c*n,t[2]=a*i+h*n,t[3]=u*i+d*n,t[4]=l*i-o*n,t[5]=c*i-s*n,t[6]=h*i-a*n,t[7]=d*i-u*n,t},d.fromRotationTranslation=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=n+n,u=i+i,l=o+o,c=n*a,h=n*u,d=n*l,p=i*u,f=i*l,m=o*l,g=s*a,v=s*u,y=s*l;return t[0]=1-(p+m),t[1]=h+y,t[2]=d-v,t[3]=0,t[4]=h-y,t[5]=1-(c+m),t[6]=f+g,t[7]=0,t[8]=d+v,t[9]=f-g,t[10]=1-(c+p),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},d.fromQuat=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,a=n+n,u=i+i,l=r*s,c=n*s,h=n*a,d=i*s,p=i*a,f=i*u,m=o*s,g=o*a,v=o*u;return t[0]=1-h-f,t[1]=c+v,t[2]=d-g,t[3]=0,t[4]=c-v,t[5]=1-l-f,t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-l-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},d.frustum=function(t,e,r,n,i,o,s){var a=1/(r-e),u=1/(i-n),l=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(i+n)*u,t[10]=(s+o)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*l,t[15]=0,t},d.perspective=function(t,e,r,n,i){var o=1/Math.tan(e/2),s=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*s,t[15]=0,t},d.ortho=function(t,e,r,n,i,o,s){var a=1/(e-r),u=1/(n-i),l=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*l,t[11]=0,t[12]=(e+r)*a,t[13]=(i+n)*u,t[14]=(s+o)*l,t[15]=1,t},d.lookAt=function(t,r,n,i){var o,s,a,u,l,c,h,p,f,m,g=r[0],v=r[1],y=r[2],w=i[0],b=i[1],x=i[2],_=n[0],S=n[1],M=n[2];return Math.abs(g-_)<e&&Math.abs(v-S)<e&&Math.abs(y-M)<e?d.identity(t):(h=g-_,p=v-S,f=y-M,m=1/Math.sqrt(h*h+p*p+f*f),h*=m,p*=m,f*=m,o=b*f-x*p,s=x*h-w*f,a=w*p-b*h,m=Math.sqrt(o*o+s*s+a*a),m?(m=1/m,o*=m,s*=m,a*=m):(o=0,s=0,a=0),u=p*a-f*s,l=f*o-h*a,c=h*s-p*o,m=Math.sqrt(u*u+l*l+c*c),m?(m=1/m,u*=m,l*=m,c*=m):(u=0,l=0,c=0),t[0]=o,t[1]=u,t[2]=h,t[3]=0,t[4]=s,t[5]=l,t[6]=p,t[7]=0,t[8]=a,t[9]=c,t[10]=f,t[11]=0,t[12]=-(o*g+s*v+a*y),t[13]=-(u*g+l*v+c*y),t[14]=-(h*g+p*v+f*y),t[15]=1,t)},d.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},d.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},"undefined"!==typeof t&&(t.mat4=d);var p={create:function(){var t=new r(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}};p.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(n,i,o){var s=a.dot(i,o);return s<-.999999?(a.cross(t,e,i),a.length(t)<1e-6&&a.cross(t,r,i),a.normalize(t,t),p.setAxisAngle(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(a.cross(t,i,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,p.normalize(n,n))}}(),p.setAxes=function(){var t=h.create();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],p.normalize(e,p.fromMat3(e,t))}}(),p.clone=u.clone,p.fromValues=u.fromValues,p.copy=u.copy,p.set=u.set,p.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},p.setAxisAngle=function(t,e,r){r*=.5;var n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t},p.add=u.add,p.multiply=function(t,e,r){var n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1],l=r[2],c=r[3];return t[0]=n*c+s*a+i*l-o*u,t[1]=i*c+s*u+o*a-n*l,t[2]=o*c+s*l+n*u-i*a,t[3]=s*c-n*a-i*u-o*l,t},p.mul=p.multiply,p.scale=u.scale,p.rotateX=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-n*a,t},p.rotateY=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u-o*a,t[1]=i*u+s*a,t[2]=o*u+n*a,t[3]=s*u-i*a,t},p.rotateZ=function(t,e,r){r*=.5;var n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*a,t[1]=i*u-n*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t},p.calculateW=function(t,e){var r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=-Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t},p.dot=u.dot,p.lerp=u.lerp,p.slerp=function(t,e,r,n){var i,o,s,a,u,l=e[0],c=e[1],h=e[2],d=e[3],p=r[0],f=r[1],m=r[2],g=r[3];return o=l*p+c*f+h*m+d*g,o<0&&(o=-o,p=-p,f=-f,m=-m,g=-g),1-o>1e-6?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(a=1-n,u=n),t[0]=a*l+u*p,t[1]=a*c+u*f,t[2]=a*h+u*m,t[3]=a*d+u*g,t},p.invert=function(t,e){var r=e[0],n=e[1],i=e[2],o=e[3],s=r*r+n*n+i*i+o*o,a=s?1/s:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=o*a,t},p.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},p.length=u.length,p.len=p.length,p.squaredLength=u.squaredLength,p.sqrLen=p.squaredLength,p.normalize=u.normalize,p.fromMat3=function(t,e){var r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[7]-e[5])*r,t[1]=(e[2]-e[6])*r,t[2]=(e[3]-e[1])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var o=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*o+o]-e[3*s+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*s+o]-e[3*o+s])*r,t[o]=(e[3*o+i]+e[3*i+o])*r,t[s]=(e[3*s+i]+e[3*i+s])*r}return t},p.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},"undefined"!==typeof t&&(t.quat=p)}(r.exports)})()},9091:function(t,e,r){
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2011, The Dojo Foundation
 *  Released under the MIT, BSD, and GPL Licenses.
 *  More information: http://sizzlejs.com/
 */
(function(){var e=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,r="sizcache"+(Math.random()+"").replace(".",""),n=0,i=Object.prototype.toString,o=!1,s=!0,a=/\\/g,u=/\r\n/g,l=/\W/;[0,0].sort((function(){return s=!1,0}));var c=function(t,r,n,o){n=n||[],r=r||document;var s=r;if(1!==r.nodeType&&9!==r.nodeType)return[];if(!t||"string"!==typeof t)return n;var a,u,l,h,f,m,g,v,w=!0,b=c.isXML(r),_=[],S=t;do{if(e.exec(""),a=e.exec(S),a&&(S=a[3],_.push(a[1]),a[2])){h=a[3];break}}while(a);if(_.length>1&&p.exec(t))if(2===_.length&&d.relative[_[0]])u=x(_[0]+_[1],r,o);else{u=d.relative[_[0]]?[r]:c(_.shift(),r);while(_.length)t=_.shift(),d.relative[t]&&(t+=_.shift()),u=x(t,u,o)}else if(!o&&_.length>1&&9===r.nodeType&&!b&&d.match.ID.test(_[0])&&!d.match.ID.test(_[_.length-1])&&(f=c.find(_.shift(),r,b),r=f.expr?c.filter(f.expr,f.set)[0]:f.set[0]),r){f=o?{expr:_.pop(),set:y(o)}:c.find(_.pop(),1!==_.length||"~"!==_[0]&&"+"!==_[0]||!r.parentNode?r:r.parentNode,b),u=f.expr?c.filter(f.expr,f.set):f.set,_.length>0?l=y(u):w=!1;while(_.length)m=_.pop(),g=m,d.relative[m]?g=_.pop():m="",null==g&&(g=r),d.relative[m](l,g,b)}else l=_=[];if(l||(l=u),l||c.error(m||t),"[object Array]"===i.call(l))if(w)if(r&&1===r.nodeType)for(v=0;null!=l[v];v++)l[v]&&(!0===l[v]||1===l[v].nodeType&&c.contains(r,l[v]))&&n.push(u[v]);else for(v=0;null!=l[v];v++)l[v]&&1===l[v].nodeType&&n.push(u[v]);else n.push.apply(n,l);else y(l,n);return h&&(c(h,s,n,o),c.uniqueSort(n)),n};c.uniqueSort=function(t){if(g&&(o=s,t.sort(g),o))for(var e=1;e<t.length;e++)t[e]===t[e-1]&&t.splice(e--,1);return t},c.matches=function(t,e){return c(t,null,null,e)},c.matchesSelector=function(t,e){return c(e,null,null,[t]).length>0},c.find=function(t,e,r){var n,i,o,s,u,l;if(!t)return[];for(i=0,o=d.order.length;i<o;i++)if(u=d.order[i],(s=d.leftMatch[u].exec(t))&&(l=s[1],s.splice(1,1),"\\"!==l.substr(l.length-1)&&(s[1]=(s[1]||"").replace(a,""),n=d.find[u](s,e,r),null!=n))){t=t.replace(d.match[u],"");break}return n||(n="undefined"!==typeof e.getElementsByTagName?e.getElementsByTagName("*"):[]),{set:n,expr:t}},c.filter=function(t,e,r,n){var i,o,s,a,u,l,h,p,f,m=t,g=[],v=e,y=e&&e[0]&&c.isXML(e[0]);while(t&&e.length){for(s in d.filter)if(null!=(i=d.leftMatch[s].exec(t))&&i[2]){if(l=d.filter[s],h=i[1],o=!1,i.splice(1,1),"\\"===h.substr(h.length-1))continue;if(v===g&&(g=[]),d.preFilter[s])if(i=d.preFilter[s](i,v,r,g,n,y),i){if(!0===i)continue}else o=a=!0;if(i)for(p=0;null!=(u=v[p]);p++)u&&(a=l(u,i,p,v),f=n^a,r&&null!=a?f?o=!0:v[p]=!1:f&&(g.push(u),o=!0));if(void 0!==a){if(r||(v=g),t=t.replace(d.match[s],""),!o)return[];break}}if(t===m){if(null!=o)break;c.error(t)}m=t}return v},c.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)};var h=c.getText=function(t){var e,r,n=t.nodeType,i="";if(n){if(1===n||9===n||11===n){if("string"===typeof t.textContent)return t.textContent;if("string"===typeof t.innerText)return t.innerText.replace(u,"");for(t=t.firstChild;t;t=t.nextSibling)i+=h(t)}else if(3===n||4===n)return t.nodeValue}else for(e=0;r=t[e];e++)8!==r.nodeType&&(i+=h(r));return i},d=c.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{class:"className",for:"htmlFor"},attrHandle:{href:function(t){return t.getAttribute("href")},type:function(t){return t.getAttribute("type")}},relative:{"+":function(t,e){var r="string"===typeof e,n=r&&!l.test(e),i=r&&!n;n&&(e=e.toLowerCase());for(var o,s=0,a=t.length;s<a;s++)if(o=t[s]){while((o=o.previousSibling)&&1!==o.nodeType);t[s]=i||o&&o.nodeName.toLowerCase()===e?o||!1:o===e}i&&c.filter(e,t,!0)},">":function(t,e){var r,n="string"===typeof e,i=0,o=t.length;if(n&&!l.test(e)){for(e=e.toLowerCase();i<o;i++)if(r=t[i],r){var s=r.parentNode;t[i]=s.nodeName.toLowerCase()===e&&s}}else{for(;i<o;i++)r=t[i],r&&(t[i]=n?r.parentNode:r.parentNode===e);n&&c.filter(e,t,!0)}},"":function(t,e,r){var i,o=n++,s=b;"string"!==typeof e||l.test(e)||(e=e.toLowerCase(),i=e,s=w),s("parentNode",e,o,t,i,r)},"~":function(t,e,r){var i,o=n++,s=b;"string"!==typeof e||l.test(e)||(e=e.toLowerCase(),i=e,s=w),s("previousSibling",e,o,t,i,r)}},find:{ID:function(t,e,r){if("undefined"!==typeof e.getElementById&&!r){var n=e.getElementById(t[1]);return n&&n.parentNode?[n]:[]}},NAME:function(t,e){if("undefined"!==typeof e.getElementsByName){for(var r=[],n=e.getElementsByName(t[1]),i=0,o=n.length;i<o;i++)n[i].getAttribute("name")===t[1]&&r.push(n[i]);return 0===r.length?null:r}},TAG:function(t,e){if("undefined"!==typeof e.getElementsByTagName)return e.getElementsByTagName(t[1])}},preFilter:{CLASS:function(t,e,r,n,i,o){if(t=" "+t[1].replace(a,"")+" ",o)return t;for(var s,u=0;null!=(s=e[u]);u++)s&&(i^(s.className&&(" "+s.className+" ").replace(/[\t\n\r]/g," ").indexOf(t)>=0)?r||n.push(s):r&&(e[u]=!1));return!1},ID:function(t){return t[1].replace(a,"")},TAG:function(t,e){return t[1].replace(a,"").toLowerCase()},CHILD:function(t){if("nth"===t[1]){t[2]||c.error(t[0]),t[2]=t[2].replace(/^\+|\s*/g,"");var e=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(("even"===t[2]?"2n":"odd"===t[2]&&"2n+1")||!/\D/.test(t[2])&&"0n+"+t[2]||t[2]);t[2]=e[1]+(e[2]||1)-0,t[3]=e[3]-0}else t[2]&&c.error(t[0]);return t[0]=n++,t},ATTR:function(t,e,r,n,i,o){var s=t[1]=t[1].replace(a,"");return!o&&d.attrMap[s]&&(t[1]=d.attrMap[s]),t[4]=(t[4]||t[5]||"").replace(a,""),"~="===t[2]&&(t[4]=" "+t[4]+" "),t},PSEUDO:function(t,r,n,i,o){if("not"===t[1]){if(!((e.exec(t[3])||"").length>1||/^\w/.test(t[3]))){var s=c.filter(t[3],r,n,!0^o);return n||i.push.apply(i,s),!1}t[3]=c(t[3],null,null,r)}else if(d.match.POS.test(t[0])||d.match.CHILD.test(t[0]))return!0;return t},POS:function(t){return t.unshift(!0),t}},filters:{enabled:function(t){return!1===t.disabled&&"hidden"!==t.type},disabled:function(t){return!0===t.disabled},checked:function(t){return!0===t.checked},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},parent:function(t){return!!t.firstChild},empty:function(t){return!t.firstChild},has:function(t,e,r){return!!c(r[3],t).length},header:function(t){return/h\d/i.test(t.nodeName)},text:function(t){var e=t.getAttribute("type"),r=t.type;return"input"===t.nodeName.toLowerCase()&&"text"===r&&(e===r||null===e)},radio:function(t){return"input"===t.nodeName.toLowerCase()&&"radio"===t.type},checkbox:function(t){return"input"===t.nodeName.toLowerCase()&&"checkbox"===t.type},file:function(t){return"input"===t.nodeName.toLowerCase()&&"file"===t.type},password:function(t){return"input"===t.nodeName.toLowerCase()&&"password"===t.type},submit:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"submit"===t.type},image:function(t){return"input"===t.nodeName.toLowerCase()&&"image"===t.type},reset:function(t){var e=t.nodeName.toLowerCase();return("input"===e||"button"===e)&&"reset"===t.type},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},input:function(t){return/input|select|textarea|button/i.test(t.nodeName)},focus:function(t){return t===t.ownerDocument.activeElement}},setFilters:{first:function(t,e){return 0===e},last:function(t,e,r,n){return e===n.length-1},even:function(t,e){return e%2===0},odd:function(t,e){return e%2===1},lt:function(t,e,r){return e<r[3]-0},gt:function(t,e,r){return e>r[3]-0},nth:function(t,e,r){return r[3]-0===e},eq:function(t,e,r){return r[3]-0===e}},filter:{PSEUDO:function(t,e,r,n){var i=e[1],o=d.filters[i];if(o)return o(t,r,e,n);if("contains"===i)return(t.textContent||t.innerText||h([t])||"").indexOf(e[3])>=0;if("not"===i){for(var s=e[3],a=0,u=s.length;a<u;a++)if(s[a]===t)return!1;return!0}c.error(i)},CHILD:function(t,e){var n,i,o,s,a,u,l=e[1],c=t;switch(l){case"only":case"first":while(c=c.previousSibling)if(1===c.nodeType)return!1;if("first"===l)return!0;c=t;case"last":while(c=c.nextSibling)if(1===c.nodeType)return!1;return!0;case"nth":if(n=e[2],i=e[3],1===n&&0===i)return!0;if(o=e[0],s=t.parentNode,s&&(s[r]!==o||!t.nodeIndex)){for(a=0,c=s.firstChild;c;c=c.nextSibling)1===c.nodeType&&(c.nodeIndex=++a);s[r]=o}return u=t.nodeIndex-i,0===n?0===u:u%n===0&&u/n>=0}},ID:function(t,e){return 1===t.nodeType&&t.getAttribute("id")===e},TAG:function(t,e){return"*"===e&&1===t.nodeType||!!t.nodeName&&t.nodeName.toLowerCase()===e},CLASS:function(t,e){return(" "+(t.className||t.getAttribute("class"))+" ").indexOf(e)>-1},ATTR:function(t,e){var r=e[1],n=c.attr?c.attr(t,r):d.attrHandle[r]?d.attrHandle[r](t):null!=t[r]?t[r]:t.getAttribute(r),i=n+"",o=e[2],s=e[4];return null==n?"!="===o:!o&&c.attr?null!=n:"="===o?i===s:"*="===o?i.indexOf(s)>=0:"~="===o?(" "+i+" ").indexOf(s)>=0:s?"!="===o?i!==s:"^="===o?0===i.indexOf(s):"$="===o?i.substr(i.length-s.length)===s:"|="===o&&(i===s||i.substr(0,s.length+1)===s+"-"):i&&!1!==n},POS:function(t,e,r,n){var i=e[2],o=d.setFilters[i];if(o)return o(t,r,e,n)}}},p=d.match.POS,f=function(t,e){return"\\"+(e-0+1)};for(var m in d.match)d.match[m]=new RegExp(d.match[m].source+/(?![^\[]*\])(?![^\(]*\))/.source),d.leftMatch[m]=new RegExp(/(^(?:.|\r|\n)*?)/.source+d.match[m].source.replace(/\\(\d+)/g,f));d.match.globalPOS=p;var g,v,y=function(t,e){return t=Array.prototype.slice.call(t,0),e?(e.push.apply(e,t),e):t};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(_){y=function(t,e){var r=0,n=e||[];if("[object Array]"===i.call(t))Array.prototype.push.apply(n,t);else if("number"===typeof t.length)for(var o=t.length;r<o;r++)n.push(t[r]);else for(;t[r];r++)n.push(t[r]);return n}}function w(t,e,n,i,o,s){for(var a=0,u=i.length;a<u;a++){var l=i[a];if(l){var c=!1;l=l[t];while(l){if(l[r]===n){c=i[l.sizset];break}if(1!==l.nodeType||s||(l[r]=n,l.sizset=a),l.nodeName.toLowerCase()===e){c=l;break}l=l[t]}i[a]=c}}}function b(t,e,n,i,o,s){for(var a=0,u=i.length;a<u;a++){var l=i[a];if(l){var h=!1;l=l[t];while(l){if(l[r]===n){h=i[l.sizset];break}if(1===l.nodeType)if(s||(l[r]=n,l.sizset=a),"string"!==typeof e){if(l===e){h=!0;break}}else if(c.filter(e,[l]).length>0){h=l;break}l=l[t]}i[a]=h}}}document.documentElement.compareDocumentPosition?g=function(t,e){return t===e?(o=!0,0):t.compareDocumentPosition&&e.compareDocumentPosition?4&t.compareDocumentPosition(e)?-1:1:t.compareDocumentPosition?-1:1}:(g=function(t,e){if(t===e)return o=!0,0;if(t.sourceIndex&&e.sourceIndex)return t.sourceIndex-e.sourceIndex;var r,n,i=[],s=[],a=t.parentNode,u=e.parentNode,l=a;if(a===u)return v(t,e);if(!a)return-1;if(!u)return 1;while(l)i.unshift(l),l=l.parentNode;l=u;while(l)s.unshift(l),l=l.parentNode;r=i.length,n=s.length;for(var c=0;c<r&&c<n;c++)if(i[c]!==s[c])return v(i[c],s[c]);return c===r?v(t,s[c],-1):v(i[c],e,1)},v=function(t,e,r){if(t===e)return r;var n=t.nextSibling;while(n){if(n===e)return-1;n=n.nextSibling}return 1}),function(){var t=document.createElement("div"),e="script"+(new Date).getTime(),r=document.documentElement;t.innerHTML="<a name='"+e+"'/>",r.insertBefore(t,r.firstChild),document.getElementById(e)&&(d.find.ID=function(t,e,r){if("undefined"!==typeof e.getElementById&&!r){var n=e.getElementById(t[1]);return n?n.id===t[1]||"undefined"!==typeof n.getAttributeNode&&n.getAttributeNode("id").nodeValue===t[1]?[n]:void 0:[]}},d.filter.ID=function(t,e){var r="undefined"!==typeof t.getAttributeNode&&t.getAttributeNode("id");return 1===t.nodeType&&r&&r.nodeValue===e}),r.removeChild(t),r=t=null}(),function(){var t=document.createElement("div");t.appendChild(document.createComment("")),t.getElementsByTagName("*").length>0&&(d.find.TAG=function(t,e){var r=e.getElementsByTagName(t[1]);if("*"===t[1]){for(var n=[],i=0;r[i];i++)1===r[i].nodeType&&n.push(r[i]);r=n}return r}),t.innerHTML="<a href='#'></a>",t.firstChild&&"undefined"!==typeof t.firstChild.getAttribute&&"#"!==t.firstChild.getAttribute("href")&&(d.attrHandle.href=function(t){return t.getAttribute("href",2)}),t=null}(),document.querySelectorAll&&function(){var t=c,e=document.createElement("div"),r="__sizzle__";if(e.innerHTML="<p class='TEST'></p>",!e.querySelectorAll||0!==e.querySelectorAll(".TEST").length){for(var n in c=function(e,n,i,o){if(n=n||document,!o&&!c.isXML(n)){var s=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(e);if(s&&(1===n.nodeType||9===n.nodeType)){if(s[1])return y(n.getElementsByTagName(e),i);if(s[2]&&d.find.CLASS&&n.getElementsByClassName)return y(n.getElementsByClassName(s[2]),i)}if(9===n.nodeType){if("body"===e&&n.body)return y([n.body],i);if(s&&s[3]){var a=n.getElementById(s[3]);if(!a||!a.parentNode)return y([],i);if(a.id===s[3])return y([a],i)}try{return y(n.querySelectorAll(e),i)}catch(m){}}else if(1===n.nodeType&&"object"!==n.nodeName.toLowerCase()){var u=n,l=n.getAttribute("id"),h=l||r,p=n.parentNode,f=/^\s*[+~]/.test(e);l?h=h.replace(/'/g,"\\$&"):n.setAttribute("id",h),f&&p&&(n=n.parentNode);try{if(!f||p)return y(n.querySelectorAll("[id='"+h+"'] "+e),i)}catch(g){}finally{l||u.removeAttribute("id")}}}return t(e,n,i,o)},t)c[n]=t[n];e=null}}(),function(){var t=document.documentElement,e=t.matchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector;if(e){var r=!e.call(document.createElement("div"),"div"),n=!1;try{e.call(document.documentElement,"[test!='']:sizzle")}catch(i){n=!0}c.matchesSelector=function(t,i){if(i=i.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!c.isXML(t))try{if(n||!d.match.PSEUDO.test(i)&&!/!=/.test(i)){var o=e.call(t,i);if(o||!r||t.document&&11!==t.document.nodeType)return o}}catch(_){}return c(i,null,null,[t]).length>0}}}(),function(){var t=document.createElement("div");t.innerHTML="<div class='test e'></div><div class='test'></div>",t.getElementsByClassName&&0!==t.getElementsByClassName("e").length&&(t.lastChild.className="e",1!==t.getElementsByClassName("e").length&&(d.order.splice(1,0,"CLASS"),d.find.CLASS=function(t,e,r){if("undefined"!==typeof e.getElementsByClassName&&!r)return e.getElementsByClassName(t[1])},t=null))}(),document.documentElement.contains?c.contains=function(t,e){return t!==e&&(!t.contains||t.contains(e))}:document.documentElement.compareDocumentPosition?c.contains=function(t,e){return!!(16&t.compareDocumentPosition(e))}:c.contains=function(){return!1},c.isXML=function(t){var e=(t?t.ownerDocument||t:0).documentElement;return!!e&&"HTML"!==e.nodeName};var x=function(t,e,r){var n,i=[],o="",s=e.nodeType?[e]:e;while(n=d.match.PSEUDO.exec(t))o+=n[0],t=t.replace(d.match.PSEUDO,"");t=d.relative[t]?t+"*":t;for(var a=0,u=s.length;a<u;a++)c(t,s[a],i,r);return c.filter(o,i)};t.exports?t.exports=c:window.Sizzle=c})()},"91dd":function(t,e,r){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,r,o){e=e||"&",r=r||"=";var s={};if("string"!==typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"===typeof o.maxKeys&&(u=o.maxKeys);var l=t.length;u>0&&l>u&&(l=u);for(var c=0;c<l;++c){var h,d,p,f,m=t[c].replace(a,"%20"),g=m.indexOf(r);g>=0?(h=m.substr(0,g),d=m.substr(g+1)):(h=m,d=""),p=decodeURIComponent(h),f=decodeURIComponent(d),n(s,p)?i(s[p])?s[p].push(f):s[p]=[s[p],f]:s[p]=f}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},"956e":function(t,e,r){var n=r("d0ea").chooseProtocol,i=r("faa1").EventEmitter,o=r("17fb"),s=t.exports=function(t){this.opts=o.defaults(t||{},{host:"127.0.0.1",enableGestures:!1,scheme:this.getScheme(),port:this.getPort(),background:!1,optimizeHMD:!1,requestProtocolVersion:s.defaultProtocolVersion}),this.host=this.opts.host,this.port=this.opts.port,this.scheme=this.opts.scheme,this.protocolVersionVerified=!1,this.background=null,this.optimizeHMD=null,this.on("ready",(function(){this.enableGestures(this.opts.enableGestures),this.setBackground(this.opts.background),this.setOptimizeHMD(this.opts.optimizeHMD),this.opts.optimizeHMD?console.log("Optimized for head mounted display usage."):console.log("Optimized for desktop usage.")}))};s.defaultProtocolVersion=6,s.prototype.getUrl=function(){return this.scheme+"//"+this.host+":"+this.port+"/v"+this.opts.requestProtocolVersion+".json"},s.prototype.getScheme=function(){return"ws:"},s.prototype.getPort=function(){return 6437},s.prototype.setBackground=function(t){this.opts.background=t,this.protocol&&this.protocol.sendBackground&&this.background!==this.opts.background&&(this.background=this.opts.background,this.protocol.sendBackground(this,this.opts.background))},s.prototype.setOptimizeHMD=function(t){this.opts.optimizeHMD=t,this.protocol&&this.protocol.sendOptimizeHMD&&this.optimizeHMD!==this.opts.optimizeHMD&&(this.optimizeHMD=this.opts.optimizeHMD,this.protocol.sendOptimizeHMD(this,this.opts.optimizeHMD))},s.prototype.handleOpen=function(){this.connected||(this.connected=!0,this.emit("connect"))},s.prototype.enableGestures=function(t){this.gesturesEnabled=!!t,this.send(this.protocol.encode({enableGestures:this.gesturesEnabled}))},s.prototype.handleClose=function(t,e){this.connected&&(this.disconnect(),1001===t&&this.opts.requestProtocolVersion>1&&(this.protocolVersionVerified?this.protocolVersionVerified=!1:this.opts.requestProtocolVersion--),this.startReconnection())},s.prototype.startReconnection=function(){var t=this;this.reconnectionTimer||(this.reconnectionTimer=setInterval((function(){t.reconnect()}),500))},s.prototype.stopReconnection=function(){this.reconnectionTimer=clearInterval(this.reconnectionTimer)},s.prototype.disconnect=function(t){if(t||this.stopReconnection(),this.socket)return this.socket.close(),delete this.socket,delete this.protocol,delete this.background,delete this.optimizeHMD,delete this.focusedState,this.connected&&(this.connected=!1,this.emit("disconnect")),!0},s.prototype.reconnect=function(){this.connected?this.stopReconnection():(this.disconnect(!0),this.connect())},s.prototype.handleData=function(t){var e,r=JSON.parse(t);void 0===this.protocol?(e=this.protocol=n(r),this.protocolVersionVerified=!0,this.emit("ready")):e=this.protocol(r),this.emit(e.type,e)},s.prototype.connect=function(){if(!this.socket)return this.socket=this.setupSocket(),!0},s.prototype.send=function(t){this.socket.send(t)},s.prototype.reportFocus=function(t){this.connected&&this.focusedState!==t&&(this.focusedState=t,this.emit(this.focusedState?"focus":"blur"),this.protocol&&this.protocol.sendFocused&&this.protocol.sendFocused(this,this.focusedState))},o.extend(s.prototype,i.prototype)},9871:function(t,e){var r=t.exports=function(t){this.pos=0,this._buf=[],this.size=t};r.prototype.get=function(t){if(void 0==t&&(t=0),!(t>=this.size)&&!(t>=this._buf.length))return this._buf[(this.pos-t-1)%this.size]},r.prototype.push=function(t){return this._buf[this.pos%this.size]=t,this.pos++}},9906:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;if(d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a,!d&&"number"!=typeof a)throw new Error(e+" must be number");var p="maxLength"==e?">":"<";i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),!1===t.opts.unicode?i+=" "+h+".length ":i+=" ucs2length("+h+") ",i+=" "+p+" "+n+") { ";var f=e,m=m||[];m.push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(f||"_limitLength")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(i+=" , message: 'should NOT be ",i+="maxLength"==e?"longer":"shorter",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" characters' "),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var g=i;return i=m.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},"9a8c":function(t,e,r){"use strict";var n=r("ebb5"),i=r("145e"),o=n.aTypedArray,s=n.exportTypedArrayMethod;s("copyWithin",(function(t,e){return i.call(o(this),t,e,arguments.length>2?arguments[2]:void 0)}))},"9bdf":function(t,e,r){var n=r("3ce1"),i=r("1739"),o=100,s=30,a=1e-5,u=function(t){this.gestureDispatcher=t,this.lastX=-1,this.lastY=-1};u.prototype.start=function(){var t=this;return this.controller=n.loop({enableGestures:!1},(function(e){return t.onFrame(e)})),t},u.prototype.limitRotation=function(t){return t*=o,t=Math.max(-s,t),t=Math.min(s,t),Math.abs(t)<a&&(t=0),t},u.prototype.axisAngle=function(t){var e=[t[5]-t[7],t[6]-t[2],t[1]-t[3]],r=n.vec3.len(e),i=.5*(t[0]+t[4]+t[8]-1),o=Math.atan2(r,i);return-1e-6<r&&r<1e-6?(e=[0,0,0],o=0,[e,o]):(n.vec3.scale(e,e,1/r),[e,o])},u.prototype.getBasis=function(t){var e=t.hands[0],r=e.direction,i=e.palmNormal,o=n.vec3.create();n.vec3.cross(o,r,i);var s=[].concat(r).concat(i);return s[6]=o[0],s[7]=o[1],s[8]=o[2],s},u.prototype.onFrame=function(t){var e=this;if(1==t.hands.length){if(t.fingers.length>3){var r=this.controller.frame(1);if(r&&r.hands.length>0){e.lastY=-1,e.lastX=-1;var o=t.hands[0],s=o.translation(r);e.gestureDispatcher.triggerPan(s[0],-s[1]),e.gestureDispatcher.triggerZoom(-s[2]);var u=e.getBasis(t),l=e.getBasis(r);n.mat3.transpose(l,l);var c=n.mat3.create();n.mat3.multiply(c,u,l);var h=e.axisAngle(c);n.vec3.scale(h[0],h[0],h[1]),(Math.abs(h[0][0])>a||Math.abs(h[0][1])>a||Math.abs(h[0][2])>a)&&e.gestureDispatcher.triggerRotate(this.limitRotation(h[0][0]),this.limitRotation(h[0][1]),this.limitRotation(h[0][2]))}}else if(t.fingers.length>0)try{var d=t.fingers[0],p=i(d),f=d.tipVelocity.getZ[2],m=Math.abs(f),g=p.getY(),v=p.getX();if(m>50&&-1!=e.lastY){var y=2500/(m*m);v=(p.x-e.lastX)*y+e.lastX,g=(p.y-e.lastY)*y+e.lastY}e.lastY=g,e.lastX=v,!isNaN(v)&&isNaN(g)}catch(w){console.log("error occurred when pointing: "+w)}else e.lastY=-1,e.lastX=-1;t.gestures&&t.gestures.forEach((function(t){switch(t.type){case"swipe":e.gestureDispatcher.reset();break;case"screenTap":e.gestureDispatcher.selectMouseCursor(),setTimeout(e.gestureDispatcher.zoomToSelection,100);break;case"keyTap":e.gestureDispatcher.zoomToSelection();break;default:console.log("Unknown gesture type: "+t.type);break}}))}},t.exports=u},"9e12":function(t,e,r){var n;
/** @license
 * JS Signals <http://millermedeiros.github.com/js-signals/>
 * Released under the MIT license
 * Author: Miller Medeiros
 * Version: 1.0.0 - Build: 268 (2012/11/29 05:48 PM)
 */(function(i){function o(t,e,r,n,i){this._listener=e,this._isOnce=r,this.context=n,this._signal=t,this._priority=i||0}function s(t,e){if("function"!==typeof t)throw new Error("listener is a required param of {fn}() and should be a Function.".replace("{fn}",e))}function a(){this._bindings=[],this._prevParams=null;var t=this;this.dispatch=function(){a.prototype.dispatch.apply(t,arguments)}}o.prototype={active:!0,params:null,execute:function(t){var e,r;return this.active&&this._listener&&(r=this.params?this.params.concat(t):t,e=this._listener.apply(this.context,r),this._isOnce&&this.detach()),e},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},a.prototype={VERSION:"1.0.0",memorize:!1,_shouldPropagate:!0,active:!0,_registerListener:function(t,e,r,n){var i,s=this._indexOfListener(t,r);if(-1!==s){if(i=this._bindings[s],i.isOnce()!==e)throw new Error("You cannot add"+(e?"":"Once")+"() then add"+(e?"Once":"")+"() the same listener without removing the relationship first.")}else i=new o(this,t,e,r,n),this._addBinding(i);return this.memorize&&this._prevParams&&i.execute(this._prevParams),i},_addBinding:function(t){var e=this._bindings.length;do{--e}while(this._bindings[e]&&t._priority<=this._bindings[e]._priority);this._bindings.splice(e+1,0,t)},_indexOfListener:function(t,e){var r,n=this._bindings.length;while(n--)if(r=this._bindings[n],r._listener===t&&r.context===e)return n;return-1},has:function(t,e){return-1!==this._indexOfListener(t,e)},add:function(t,e,r){return s(t,"add"),this._registerListener(t,!1,e,r)},addOnce:function(t,e,r){return s(t,"addOnce"),this._registerListener(t,!0,e,r)},remove:function(t,e){s(t,"remove");var r=this._indexOfListener(t,e);return-1!==r&&(this._bindings[r]._destroy(),this._bindings.splice(r,1)),t},removeAll:function(){var t=this._bindings.length;while(t--)this._bindings[t]._destroy();this._bindings.length=0},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(t){if(this.active){var e,r=Array.prototype.slice.call(arguments),n=this._bindings.length;if(this.memorize&&(this._prevParams=r),n){e=this._bindings.slice(),this._shouldPropagate=!0;do{n--}while(e[n]&&this._shouldPropagate&&!1!==e[n].execute(r))}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}};var u=a;u.Signal=a,n=function(){return u}.call(e,r,e,t),void 0===n||(t.exports=n)})()},"9fe4":function(t,e,r){"use strict";var n=r("fbda"),i=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,o=[0,31,28,31,30,31,30,31,31,30,31,30,31],s=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i,a=/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,u=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,l=/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,c=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,h=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,d=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,p=/^(?:\/(?:[^~/]|~0|~1)*)*$/,f=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,m=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function g(t){return t="full"==t?"full":"fast",n.copy(g[t])}function v(t){return t%4===0&&(t%100!==0||t%400===0)}function y(t){var e=t.match(i);if(!e)return!1;var r=+e[1],n=+e[2],s=+e[3];return n>=1&&n<=12&&s>=1&&s<=(2==n&&v(r)?29:o[n])}function w(t,e){var r=t.match(s);if(!r)return!1;var n=r[1],i=r[2],o=r[3],a=r[5];return(n<=23&&i<=59&&o<=59||23==n&&59==i&&60==o)&&(!e||a)}t.exports=g,g.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":c,url:h,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:a,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:d,"json-pointer":p,"json-pointer-uri-fragment":f,"relative-json-pointer":m},g.full={date:y,time:w,"date-time":x,uri:S,"uri-reference":l,"uri-template":c,url:h,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:a,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:E,uuid:d,"json-pointer":p,"json-pointer-uri-fragment":f,"relative-json-pointer":m};var b=/t|\s/i;function x(t){var e=t.split(b);return 2==e.length&&y(e[0])&&w(e[1],!0)}var _=/\/|:/;function S(t){return _.test(t)&&u.test(t)}var M=/[^\\]\\Z/;function E(t){if(M.test(t))return!1;try{return new RegExp(t),!0}catch(e){return!1}}},a078:function(t,e,r){var n=r("7b0b"),i=r("50c4"),o=r("35a1"),s=r("e95a"),a=r("0366"),u=r("ebb5").aTypedArrayConstructor;t.exports=function(t){var e,r,l,c,h,d,p=n(t),f=arguments.length,m=f>1?arguments[1]:void 0,g=void 0!==m,v=o(p);if(void 0!=v&&!s(v)){h=v.call(p),d=h.next,p=[];while(!(c=d.call(h)).done)p.push(c.value)}for(g&&f>2&&(m=a(m,arguments[2],2)),r=i(p.length),l=new(u(this))(r),e=0;r>e;e++)l[e]=g?m(p[e],e):p[e];return l}},a3b3:function(t,e,r){var n=r("9052"),i=n.vec3,o=r("faa1").EventEmitter,s=r("17fb"),a=(e.createGesture=function(t){var e;switch(t.type){case"circle":e=new u(t);break;case"swipe":e=new l(t);break;case"screenTap":e=new c(t);break;case"keyTap":e=new h(t);break;default:throw"unknown gesture type"}return e.id=t.id,e.handIds=t.handIds.slice(),e.pointableIds=t.pointableIds.slice(),e.duration=t.duration,e.state=t.state,e.type=t.type,e},e.gestureListener=function(t,e){var r={},n={};t.on("gesture",(function(t,i){if(t.type==e){if(("start"==t.state||"stop"==t.state)&&void 0===n[t.id]){var o=new a(t,i);n[t.id]=o,s.each(r,(function(t,e){o.on(e,t)}))}n[t.id].update(t,i),"stop"==t.state&&delete n[t.id]}}));var i={start:function(t){return r["start"]=t,i},stop:function(t){return r["stop"]=t,i},complete:function(t){return r["stop"]=t,i},update:function(t){return r["update"]=t,i}};return i},e.Gesture=function(t,e){this.gestures=[t],this.frames=[e]});a.prototype.update=function(t,e){this.lastGesture=t,this.lastFrame=e,this.gestures.push(t),this.frames.push(e),this.emit(t.state,this)},a.prototype.translation=function(){return i.subtract(i.create(),this.lastGesture.startPosition,this.lastGesture.position)},s.extend(a.prototype,o.prototype);var u=function(t){this.center=t.center,this.normal=t.normal,this.progress=t.progress,this.radius=t.radius};u.prototype.toString=function(){return"CircleGesture ["+JSON.stringify(this)+"]"};var l=function(t){this.startPosition=t.startPosition,this.position=t.position,this.direction=t.direction,this.speed=t.speed};l.prototype.toString=function(){return"SwipeGesture ["+JSON.stringify(this)+"]"};var c=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};c.prototype.toString=function(){return"ScreenTapGesture ["+JSON.stringify(this)+"]"};var h=function(t){this.position=t.position,this.direction=t.direction,this.progress=t.progress};h.prototype.toString=function(){return"KeyTapGesture ["+JSON.stringify(this)+"]"}},a434:function(t,e,r){"use strict";var n=r("23e7"),i=r("23cb"),o=r("a691"),s=r("50c4"),a=r("7b0b"),u=r("65f0"),l=r("8418"),c=r("1dde"),h=r("ae40"),d=c("splice"),p=h("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,m=Math.min,g=9007199254740991,v="Maximum allowed length exceeded";n({target:"Array",proto:!0,forced:!d||!p},{splice:function(t,e){var r,n,c,h,d,p,y=a(this),w=s(y.length),b=i(t,w),x=arguments.length;if(0===x?r=n=0:1===x?(r=0,n=w-b):(r=x-2,n=m(f(o(e),0),w-b)),w+r-n>g)throw TypeError(v);for(c=u(y,n),h=0;h<n;h++)d=b+h,d in y&&l(c,h,y[d]);if(c.length=n,r<n){for(h=b;h<w-n;h++)d=h+n,p=h+r,d in y?y[p]=y[d]:delete y[p];for(h=w;h>w-n+r;h--)delete y[h-1]}else if(r>n)for(h=w-n;h>b;h--)d=h+n-1,p=h+r-1,d in y?y[p]=y[d]:delete y[p];for(h=0;h<r;h++)y[h+b]=arguments[h+2];return y.length=w-n+r,c}})},a49d:function(t,e,r){var n;(function(i,o,s){var a,u=256,l=6,c=52,h="random",d=s.pow(u,l),p=s.pow(2,c),f=2*p,m=u-1;function g(t,e,r){var n=[];e=1==e?{entropy:!0}:e||{};var i=b(w(e.entropy?[t,_(o)]:null==t?x():t,3),n),a=new v(n),c=function(){var t=a.g(l),e=d,r=0;while(t<p)t=(t+r)*u,e*=u,r=a.g(1);while(t>=f)t/=2,e/=2,r>>>=1;return(t+r)/e};return c.int32=function(){return 0|a.g(4)},c.quick=function(){return a.g(4)/4294967296},c.double=c,b(_(a.S),o),(e.pass||r||function(t,e,r,n){return n&&(n.S&&y(n,a),t.state=function(){return y(a,{})}),r?(s[h]=t,e):t})(c,i,"global"in e?e.global:this==s,e.state)}function v(t){var e,r=t.length,n=this,i=0,o=n.i=n.j=0,s=n.S=[];r||(t=[r++]);while(i<u)s[i]=i++;for(i=0;i<u;i++)s[i]=s[o=m&o+t[i%r]+(e=s[i])],s[o]=e;(n.g=function(t){var e,r=0,i=n.i,o=n.j,s=n.S;while(t--)e=s[i=m&i+1],r=r*u+s[m&(s[i]=s[o=m&o+e])+(s[o]=e)];return n.i=i,n.j=o,r})(u)}function y(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function w(t,e){var r,n=[],i=typeof t;if(e&&"object"==i)for(r in t)try{n.push(w(t[r],e-1))}catch(o){}return n.length?n:"string"==i?t:t+"\0"}function b(t,e){var r,n=t+"",i=0;while(i<n.length)e[m&i]=m&(r^=19*e[m&i])+n.charCodeAt(i++);return _(e)}function x(){try{var t;return a&&(t=a.randomBytes)?t=t(u):(t=new Uint8Array(u),(i.crypto||i.msCrypto).getRandomValues(t)),_(t)}catch(n){var e=i.navigator,r=e&&e.plugins;return[+new Date,i,r,i.screen,_(o)]}}function _(t){return String.fromCharCode.apply(0,t)}if(b(s.random(),o),t.exports){t.exports=g;try{a=r(1)}catch(S){}}else n=function(){return g}.call(e,r,e,t),void 0===n||(t.exports=n)})("undefined"!==typeof self?self:this,[],Math)},a49e:function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),n==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function u(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=r.next()>>>11,e=(r.next()>>>0)/4294967296,n=(t+e)/(1<<21)}while(0===n);return n},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.xorwow=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},a931:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;if(d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a,!d&&"number"!=typeof a)throw new Error(e+" must be number");i+="var division"+o+";if (",d&&(i+=" "+n+" !== undefined && ( typeof "+n+" != 'number' || "),i+=" (division"+o+" = "+h+" / "+n+", ",t.opts.multipleOfPrecision?i+=" Math.abs(Math.round(division"+o+") - division"+o+") > 1e-"+t.opts.multipleOfPrecision+" ":i+=" division"+o+" !== parseInt(division"+o+") ",i+=" ) ",d&&(i+="  )  "),i+=" ) {   ";var p=p||[];p.push(i),i="",!1!==t.createErrors?(i+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { multipleOf: "+n+" } ",!1!==t.opts.messages&&(i+=" , message: 'should be multiple of ",i+=d?"' + "+n:n+"'"),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var f=i;return i=p.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+f+"]); ":i+=" validate.errors = ["+f+"]; return false; ":i+=" var err = "+f+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},a971:function(t,e,r){"use strict";var n=r("4e14"),i=r("694b"),o=r("fbda"),s=r("ba00"),a=r("89a9");function u(t,e,r){var n=this._refs[r];if("string"==typeof n){if(!this._refs[n])return u.call(this,t,e,n);n=this._refs[n]}if(n=n||this._schemas[r],n instanceof s)return f(n.schema,this._opts.inlineRefs)?n.schema:n.validate||this._compile(n);var i,o,a,c=l.call(this,e,r);return c&&(i=c.schema,e=c.root,a=c.baseId),i instanceof s?o=i.validate||t.call(this,i.schema,e,void 0,a):void 0!==i&&(o=f(i,this._opts.inlineRefs)?i:t.call(this,i,e,void 0,a)),o}function l(t,e){var r=n.parse(e),i=y(r),o=v(this._getId(t.schema));if(0===Object.keys(t.schema).length||i!==o){var a=b(i),u=this._refs[a];if("string"==typeof u)return c.call(this,t,u,r);if(u instanceof s)u.validate||this._compile(u),t=u;else{if(u=this._schemas[a],!(u instanceof s))return;if(u.validate||this._compile(u),a==b(e))return{schema:u,root:t,baseId:o};t=u}if(!t.schema)return;o=v(this._getId(t.schema))}return d.call(this,r,o,t.schema,t)}function c(t,e,r){var n=l.call(this,t,e);if(n){var i=n.schema,o=n.baseId;t=n.root;var s=this._getId(i);return s&&(o=x(o,s)),d.call(this,r,o,i,t)}}t.exports=u,u.normalizeId=b,u.fullPath=v,u.url=x,u.ids=_,u.inlineRef=f,u.schema=l;var h=o.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function d(t,e,r,n){if(t.fragment=t.fragment||"","/"==t.fragment.slice(0,1)){for(var i=t.fragment.split("/"),s=1;s<i.length;s++){var a=i[s];if(a){if(a=o.unescapeFragment(a),r=r[a],void 0===r)break;var u;if(!h[a]&&(u=this._getId(r),u&&(e=x(e,u)),r.$ref)){var c=x(e,r.$ref),d=l.call(this,n,c);d&&(r=d.schema,n=d.root,e=d.baseId)}}}return void 0!==r&&r!==n.schema?{schema:r,root:n,baseId:e}:void 0}}var p=o.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function f(t,e){return!1!==e&&(void 0===e||!0===e?m(t):e?g(t)<=e:void 0)}function m(t){var e;if(Array.isArray(t)){for(var r=0;r<t.length;r++)if(e=t[r],"object"==typeof e&&!m(e))return!1}else for(var n in t){if("$ref"==n)return!1;if(e=t[n],"object"==typeof e&&!m(e))return!1}return!0}function g(t){var e,r=0;if(Array.isArray(t)){for(var n=0;n<t.length;n++)if(e=t[n],"object"==typeof e&&(r+=g(e)),r==1/0)return 1/0}else for(var i in t){if("$ref"==i)return 1/0;if(p[i])r++;else if(e=t[i],"object"==typeof e&&(r+=g(e)+1),r==1/0)return 1/0}return r}function v(t,e){!1!==e&&(t=b(t));var r=n.parse(t);return y(r)}function y(t){return n.serialize(t).split("#")[0]+"#"}var w=/#\/?$/;function b(t){return t?t.replace(w,""):""}function x(t,e){return e=b(e),n.resolve(t,e)}function _(t){var e=b(this._getId(t)),r={"":e},s={"":v(e,!1)},u={},l=this;return a(t,{allKeys:!0},(function(t,e,a,c,h,d,p){if(""!==e){var f=l._getId(t),m=r[c],g=s[c]+"/"+h;if(void 0!==p&&(g+="/"+("number"==typeof p?p:o.escapeFragment(p))),"string"==typeof f){f=m=b(m?n.resolve(m,f):f);var v=l._refs[f];if("string"==typeof v&&(v=l._refs[v]),v&&v.schema){if(!i(t,v.schema))throw new Error('id "'+f+'" resolves to more than one schema')}else if(f!=b(g))if("#"==f[0]){if(u[f]&&!i(t,u[f]))throw new Error('id "'+f+'" resolves to more than one schema');u[f]=t}else l._refs[f]=g}r[e]=m,s[e]=g}})),u}},a975:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").every,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("every",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},a981:function(t,e){t.exports="undefined"!==typeof ArrayBuffer&&"undefined"!==typeof DataView},aaad:function(t,e,r){(function(e){var n=r("808a"),i=r("16c3"),o=r("1f8f"),s=r("5915"),a=r("9871"),u=r("d419"),l=r("faa1").EventEmitter,c=r("a3b3").gestureListener,h=r("32ce"),d=r("17fb"),p=t.exports=function(t){var i="undefined"!==typeof e&&e.versions&&e.versions.node,o=this;t=d.defaults(t||{},{inNode:i}),this.inNode=t.inNode,t=d.defaults(t||{},{frameEventName:this.useAnimationLoop()?"animationFrame":"deviceFrame",suppressAnimationLoop:!this.useAnimationLoop(),loopWhileDisconnected:!0,useAllPlugins:!1,checkVersion:!0}),this.animationFrameRequested=!1,this.onAnimationFrame=function(t){o.lastConnectionFrame.valid&&o.emit("animationFrame",o.lastConnectionFrame),o.emit("frameEnd",t),o.loopWhileDisconnected&&(!1!==o.connection.focusedState||o.connection.opts.background)?window.requestAnimationFrame(o.onAnimationFrame):o.animationFrameRequested=!1},this.suppressAnimationLoop=t.suppressAnimationLoop,this.loopWhileDisconnected=t.loopWhileDisconnected,this.frameEventName=t.frameEventName,this.useAllPlugins=t.useAllPlugins,this.history=new a(200),this.lastFrame=n.Invalid,this.lastValidFrame=n.Invalid,this.lastConnectionFrame=n.Invalid,this.accumulatedGestures=[],this.checkVersion=t.checkVersion,void 0===t.connectionType?this.connectionType=this.inBrowser()?r("e303"):r("4511"):this.connectionType=t.connectionType,this.connection=new this.connectionType(t),this.streamingCount=0,this.devices={},this.plugins={},this._pluginPipelineSteps={},this._pluginExtendedMethods={},t.useAllPlugins&&this.useRegisteredPlugins(),this.setupFrameEvents(t),this.setupConnectionEvents(),this.startAnimationLoop()};p.prototype.gesture=function(t,e){var r=c(this,t);return void 0!==e&&r.stop(e),r},p.prototype.setBackground=function(t){return this.connection.setBackground(t),this},p.prototype.setOptimizeHMD=function(t){return this.connection.setOptimizeHMD(t),this},p.prototype.inBrowser=function(){return!this.inNode},p.prototype.useAnimationLoop=function(){return this.inBrowser()&&!this.inBackgroundPage()},p.prototype.inBackgroundPage=function(){return"undefined"!==typeof chrome&&chrome.extension&&chrome.extension.getBackgroundPage&&chrome.extension.getBackgroundPage()===window},p.prototype.connect=function(){return this.connection.connect(),this},p.prototype.streaming=function(){return this.streamingCount>0},p.prototype.connected=function(){return!!this.connection.connected},p.prototype.startAnimationLoop=function(){this.suppressAnimationLoop||this.animationFrameRequested||(this.animationFrameRequested=!0,window.requestAnimationFrame(this.onAnimationFrame))},p.prototype.disconnect=function(){return this.connection.disconnect(),this},p.prototype.frame=function(t){return this.history.get(t)||n.Invalid},p.prototype.loop=function(t){return t&&("function"===typeof t?this.on(this.frameEventName,t):this.setupFrameEvents(t)),this.connect()},p.prototype.addStep=function(t){this.pipeline||(this.pipeline=new u(this)),this.pipeline.addStep(t)},p.prototype.processFrame=function(t){t.gestures&&(this.accumulatedGestures=this.accumulatedGestures.concat(t.gestures)),this.lastConnectionFrame=t,this.startAnimationLoop(),this.emit("deviceFrame",t)},p.prototype.processFinishedFrame=function(t){if(this.lastFrame=t,t.valid&&(this.lastValidFrame=t),t.controller=this,t.historyIdx=this.history.push(t),t.gestures){t.gestures=this.accumulatedGestures,this.accumulatedGestures=[];for(var e=0;e!=t.gestures.length;e++)this.emit("gesture",t.gestures[e],t)}this.pipeline&&(t=this.pipeline.run(t),t||(t=n.Invalid)),this.emit("frame",t),this.emitHandEvents(t)},p.prototype.emitHandEvents=function(t){for(var e=0;e<t.hands.length;e++)this.emit("hand",t.hands[e])},p.prototype.setupFrameEvents=function(t){t.frame&&this.on("frame",t.frame),t.hand&&this.on("hand",t.hand)},p.prototype.setupConnectionEvents=function(){var t=this;this.connection.on("frame",(function(e){t.processFrame(e)})),this.on(this.frameEventName,(function(e){t.processFinishedFrame(e)}));var e=function(){if(t.connection.opts.requestProtocolVersion<5&&0==t.streamingCount){t.streamingCount=1;var r={attached:!0,streaming:!0,type:"unknown",id:"Lx00000000000"};t.devices[r.id]=r,t.emit("deviceAttached",r),t.emit("deviceStreaming",r),t.emit("streamingStarted",r),t.connection.removeListener("frame",e)}},r=function(){if(t.streamingCount>0){for(var e in t.devices)t.emit("deviceStopped",t.devices[e]),t.emit("deviceRemoved",t.devices[e]);for(var e in t.emit("streamingStopped",t.devices[e]),t.streamingCount=0,t.devices)delete t.devices[e]}};this.connection.on("focus",(function(){t.loopWhileDisconnected&&t.startAnimationLoop(),t.emit("focus")})),this.connection.on("blur",(function(){t.emit("blur")})),this.connection.on("protocol",(function(e){e.on("beforeFrameCreated",(function(e){t.emit("beforeFrameCreated",e)})),e.on("afterFrameCreated",(function(e,r){t.emit("afterFrameCreated",e,r)})),t.emit("protocol",e)})),this.connection.on("ready",(function(){t.checkVersion&&!t.inNode&&t.checkOutOfDate(),t.emit("ready")})),this.connection.on("connect",(function(){t.emit("connect"),t.connection.removeListener("frame",e),t.connection.on("frame",e)})),this.connection.on("disconnect",(function(){t.emit("disconnect"),r()})),this.connection.on("deviceConnect",(function(n){n.state?(t.emit("deviceConnected"),t.connection.removeListener("frame",e),t.connection.on("frame",e)):(t.emit("deviceDisconnected"),r())})),this.connection.on("deviceEvent",(function(e){var r=e.state,n=t.devices[r.id],i={};for(var o in r)n&&n.hasOwnProperty(o)&&n[o]==r[o]||(i[o]=!0);t.devices[r.id]=r,i.attached&&t.emit(r.attached?"deviceAttached":"deviceRemoved",r),i.streaming&&(r.streaming?(t.streamingCount++,t.emit("deviceStreaming",r),1==t.streamingCount&&t.emit("streamingStarted",r),i.attached||t.emit("deviceConnected")):i.attached&&r.attached||(t.streamingCount--,t.emit("deviceStopped",r),0==t.streamingCount&&t.emit("streamingStopped",r),t.emit("deviceDisconnected")))})),this.on("newListener",(function(t,e){"deviceConnected"!=t&&"deviceDisconnected"!=t||console.warn(t+" events are depricated.  Consider using 'streamingStarted/streamingStopped' or 'deviceStreaming/deviceStopped' instead")}))},p.prototype.checkOutOfDate=function(){console.assert(this.connection&&this.connection.protocol);var t=this.connection.protocol.serviceVersion,e=this.connection.protocol.version,r=this.connectionType.defaultProtocolVersion;return r>e&&(console.warn("Your Protocol Version is v"+e+", this app was designed for v"+r),h.warnOutOfDate({sV:t,pV:e}),!0)},p._pluginFactories={},p.plugin=function(t,e){return this._pluginFactories[t]&&console.warn('Plugin "'+t+'" already registered'),this._pluginFactories[t]=e},p.plugins=function(){return d.keys(this._pluginFactories)};var f=function(t,e,r){-1!=["beforeFrameCreated","afterFrameCreated"].indexOf(e)?this.on(e,r):(this.pipeline||(this.pipeline=new u(this)),this._pluginPipelineSteps[t]||(this._pluginPipelineSteps[t]=[]),this._pluginPipelineSteps[t].push(this.pipeline.addWrappedStep(e,r)))},m=function(t,e,r){var a;switch(this._pluginExtendedMethods[t]||(this._pluginExtendedMethods[t]=[]),e){case"frame":a=n;break;case"hand":a=i;break;case"pointable":a=o,d.extend(s.prototype,r),d.extend(s.Invalid,r);break;case"finger":a=s;break;default:throw t+' specifies invalid object type "'+e+'" for prototypical extension'}d.extend(a.prototype,r),d.extend(a.Invalid,r),this._pluginExtendedMethods[t].push([a,r])};p.prototype.use=function(t,e){var r,n,i,o;if(n="function"==typeof t?t:p._pluginFactories[t],!n)throw"Leap Plugin "+t+" not found.";if(e||(e={}),this.plugins[t])return d.extend(this.plugins[t],e),this;for(i in this.plugins[t]=e,o=n.call(this,e),o)r=o[i],"function"===typeof r?f.call(this,t,i,r):m.call(this,t,i,r);return this},p.prototype.stopUsing=function(t){var e,r,n=this._pluginPipelineSteps[t],i=this._pluginExtendedMethods[t],o=0;if(this.plugins[t]){if(n)for(o=0;o<n.length;o++)this.pipeline.removeStep(n[o]);if(i)for(o=0;o<i.length;o++)for(var s in e=i[o][0],r=i[o][1],r)delete e.prototype[s],delete e.Invalid[s];return delete this.plugins[t],this}},p.prototype.useRegisteredPlugins=function(){for(var t in p._pluginFactories)this.use(t)},d.extend(p.prototype,l.prototype)}).call(this,r("4362"))},ace4:function(t,e,r){"use strict";var n=r("23e7"),i=r("d039"),o=r("621a"),s=r("825a"),a=r("23cb"),u=r("50c4"),l=r("4840"),c=o.ArrayBuffer,h=o.DataView,d=c.prototype.slice,p=i((function(){return!new c(2).slice(1,void 0).byteLength}));n({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:p},{slice:function(t,e){if(void 0!==d&&void 0===e)return d.call(s(this),t);var r=s(this).byteLength,n=a(t,r),i=a(void 0===e?r:e,r),o=new(l(this,c))(u(i-n)),p=new h(this),f=new h(o),m=0;while(n<i)f.setUint8(m++,p.getUint8(n++));return o}})},b1a8:function(t,e,r){"use strict";var n=r("899a").MissingRef;function i(t,e,r){var o=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof e&&(r=e,e=void 0);var s=a(t).then((function(){var r=o._addSchema(t,void 0,e);return r.validate||u(r)}));return r&&s.then((function(t){r(null,t)}),r),s;function a(t){var e=t.$schema;return e&&!o.getSchema(e)?i.call(o,{$ref:e},!0):Promise.resolve()}function u(t){try{return o._compile(t)}catch(i){if(i instanceof n)return r(i);throw i}function r(r){var n=r.missingSchema;if(l(n))throw new Error("Schema "+n+" is loaded but "+r.missingRef+" cannot be resolved");var i=o._loadingSchemas[n];return i||(i=o._loadingSchemas[n]=o._opts.loadSchema(n),i.then(s,s)),i.then((function(t){if(!l(n))return a(t).then((function(){l(n)||o.addSchema(t,n,void 0,e)}))})).then((function(){return u(t)}));function s(){delete o._loadingSchemas[n]}function l(t){return o._refs[t]||o._schemas[t]}}}}t.exports=i},b383:function(t,e,r){"use strict";e.decode=e.parse=r("91dd"),e.encode=e.stringify=r("e099")},b39a:function(t,e,r){"use strict";var n=r("da84"),i=r("ebb5"),o=r("d039"),s=n.Int8Array,a=i.aTypedArray,u=i.exportTypedArrayMethod,l=[].toLocaleString,c=[].slice,h=!!s&&o((function(){l.call(new s(1))})),d=o((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!o((function(){s.prototype.toLocaleString.call([1,2])}));u("toLocaleString",(function(){return l.apply(h?c.call(a(this)):a(this),arguments)}),d)},b7e6:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d=t.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ");var p="schema"+i;if(!d)if(s.length<t.opts.loopRequired&&t.schema.properties&&Object.keys(t.schema.properties).length){var f=[],m=s;if(m){var g,v=-1,y=m.length-1;while(v<y){g=m[v+=1];var w=t.schema.properties[g];w&&(t.opts.strictKeywords?"object"==typeof w&&Object.keys(w).length>0:t.util.schemaHasRules(w,t.RULES.all))||(f[f.length]=g)}}}else f=s;if(d||f.length){var b=t.errorPath,x=d||f.length>=t.opts.loopRequired,_=t.opts.ownProperties;if(l)if(n+=" var missing"+i+"; ",x){d||(n+=" var "+p+" = validate.schema"+a+"; ");var S="i"+i,M="schema"+i+"["+S+"]",E="' + "+M+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(b,M,t.opts.jsonPointers)),n+=" var "+h+" = true; ",d&&(n+=" if (schema"+i+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+i+")) "+h+" = false; else {"),n+=" for (var "+S+" = 0; "+S+" < "+p+".length; "+S+"++) { "+h+" = "+c+"["+p+"["+S+"]] !== undefined ",_&&(n+=" &&   Object.prototype.hasOwnProperty.call("+c+", "+p+"["+S+"]) "),n+="; if (!"+h+") break; } ",d&&(n+="  }  "),n+="  if (!"+h+") {   ";var T=T||[];T.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+E+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var A=n;n=T.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+A+"]); ":n+=" validate.errors = ["+A+"]; return false; ":n+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else{n+=" if ( ";var P=f;if(P){S=-1;var C=P.length-1;while(S<C){I=P[S+=1],S&&(n+=" || ");var R=t.util.getProperty(I),L=c+R;n+=" ( ( "+L+" === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(I)+"') "),n+=") && (missing"+i+" = "+t.util.toQuotedString(t.opts.jsonPointers?I:R)+") ) "}}n+=") {  ";M="missing"+i,E="' + "+M+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(b,M,!0):b+" + "+M);T=T||[];T.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+E+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";A=n;n=T.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+A+"]); ":n+=" validate.errors = ["+A+"]; return false; ":n+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else { "}else if(x){d||(n+=" var "+p+" = validate.schema"+a+"; ");S="i"+i,M="schema"+i+"["+S+"]",E="' + "+M+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(b,M,t.opts.jsonPointers)),d&&(n+=" if ("+p+" && !Array.isArray("+p+")) {  var err =   ",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+E+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+p+" !== undefined) { "),n+=" for (var "+S+" = 0; "+S+" < "+p+".length; "+S+"++) { if ("+c+"["+p+"["+S+"]] === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", "+p+"["+S+"]) "),n+=") {  var err =   ",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+E+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(n+="  }  ")}else{var O=f;if(O){var I,D=-1,N=O.length-1;while(D<N){I=O[D+=1];R=t.util.getProperty(I),E=t.util.escapeQuotes(I),L=c+R;t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(b,I,t.opts.jsonPointers)),n+=" if ( "+L+" === undefined ",_&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(I)+"') "),n+=") {  var err =   ",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+E+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+E+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}}t.errorPath=b}else l&&(n+=" if (true) {");return n}},b838:function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var n=0;n<r.length+64;n++)e.x^=0|r.charCodeAt(n),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function u(t,e){var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=r.next()>>>11,e=(r.next()>>>0)/4294967296,n=(t+e)/(1<<21)}while(0===n);return n},i.int32=r.next,i.quick=i,n&&("object"==typeof n&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.xor128=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},b920:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="errs__"+i,d=t.util.copy(t),p="";d.level++;var f="valid"+d.level,m={},g={},v=t.opts.ownProperties;for(x in s)if("__proto__"!=x){var y=s[x],w=Array.isArray(y)?g:m;w[x]=y}n+="var "+h+" = errors;";var b=t.errorPath;for(var x in n+="var missing"+i+";",g)if(w=g[x],w.length){if(n+=" if ( "+c+t.util.getProperty(x)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(x)+"') "),l){n+=" && ( ";var _=w;if(_){var S=-1,M=_.length-1;while(S<M){O=_[S+=1],S&&(n+=" || ");var E=t.util.getProperty(O),T=c+E;n+=" ( ( "+T+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(O)+"') "),n+=") && (missing"+i+" = "+t.util.toQuotedString(t.opts.jsonPointers?O:E)+") ) "}}n+=")) {  ";var A="missing"+i,P="' + "+A+" + '";t.opts._errorDataPathProperty&&(t.errorPath=t.opts.jsonPointers?t.util.getPathExpr(b,A,!0):b+" + "+A);var C=C||[];C.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { property: '"+t.util.escapeQuotes(x)+"', missingProperty: '"+P+"', depsCount: "+w.length+", deps: '"+t.util.escapeQuotes(1==w.length?w[0]:w.join(", "))+"' } ",!1!==t.opts.messages&&(n+=" , message: 'should have ",1==w.length?n+="property "+t.util.escapeQuotes(w[0]):n+="properties "+t.util.escapeQuotes(w.join(", ")),n+=" when property "+t.util.escapeQuotes(x)+" is present' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var R=n;n=C.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+R+"]); ":n+=" validate.errors = ["+R+"]; return false; ":n+=" var err = "+R+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{n+=" ) { ";var L=w;if(L){var O,I=-1,D=L.length-1;while(I<D){O=L[I+=1];E=t.util.getProperty(O),P=t.util.escapeQuotes(O),T=c+E;t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(b,O,t.opts.jsonPointers)),n+=" if ( "+T+" === undefined ",v&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(O)+"') "),n+=") {  var err =   ",!1!==t.createErrors?(n+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { property: '"+t.util.escapeQuotes(x)+"', missingProperty: '"+P+"', depsCount: "+w.length+", deps: '"+t.util.escapeQuotes(1==w.length?w[0]:w.join(", "))+"' } ",!1!==t.opts.messages&&(n+=" , message: 'should have ",1==w.length?n+="property "+t.util.escapeQuotes(w[0]):n+="properties "+t.util.escapeQuotes(w.join(", ")),n+=" when property "+t.util.escapeQuotes(x)+" is present' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}}n+=" }   ",l&&(p+="}",n+=" else { ")}t.errorPath=b;var N=d.baseId;for(var x in m){y=m[x];(t.opts.strictKeywords?"object"==typeof y&&Object.keys(y).length>0:t.util.schemaHasRules(y,t.RULES.all))&&(n+=" "+f+" = true; if ( "+c+t.util.getProperty(x)+" !== undefined ",v&&(n+=" && Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(x)+"') "),n+=") { ",d.schema=y,d.schemaPath=a+t.util.getProperty(x),d.errSchemaPath=u+"/"+t.util.escapeFragment(x),n+="  "+t.validate(d)+" ",d.baseId=N,n+=" }  ",l&&(n+=" if ("+f+") { ",p+="}"))}return l&&(n+="   "+p+" if ("+h+" == errors) {"),n}},ba00:function(t,e,r){"use strict";var n=r("fbda");function i(t){n.copy(t,this)}t.exports=i},bd5b:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="errs__"+i,d=t.util.copy(t),p="";d.level++;var f="valid"+d.level,m="key"+i,g="idx"+i,v=d.dataLevel=t.dataLevel+1,y="data"+v,w="dataProperties"+i,b=Object.keys(s||{}).filter(I),x=t.schema.patternProperties||{},_=Object.keys(x).filter(I),S=t.schema.additionalProperties,M=b.length||_.length,E=!1===S,T="object"==typeof S&&Object.keys(S).length,A=t.opts.removeAdditional,P=E||T||A,C=t.opts.ownProperties,R=t.baseId,L=t.schema.required;if(L&&(!t.opts.$data||!L.$data)&&L.length<t.opts.loopRequired)var O=t.util.toHash(L);function I(t){return"__proto__"!==t}if(n+="var "+h+" = errors;var "+f+" = true;",C&&(n+=" var "+w+" = undefined;"),P){if(n+=C?" "+w+" = "+w+" || Object.keys("+c+"); for (var "+g+"=0; "+g+"<"+w+".length; "+g+"++) { var "+m+" = "+w+"["+g+"]; ":" for (var "+m+" in "+c+") { ",M){if(n+=" var isAdditional"+i+" = !(false ",b.length)if(b.length>8)n+=" || validate.schema"+a+".hasOwnProperty("+m+") ";else{var D=b;if(D){var N=-1,k=D.length-1;while(N<k)Z=D[N+=1],n+=" || "+m+" == "+t.util.toQuotedString(Z)+" "}}if(_.length){var F=_;if(F){var V=-1,z=F.length-1;while(V<z)ot=F[V+=1],n+=" || "+t.usePattern(ot)+".test("+m+") "}}n+=" ); if (isAdditional"+i+") { "}if("all"==A)n+=" delete "+c+"["+m+"]; ";else{var U=t.errorPath,j="' + "+m+" + '";if(t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPathExpr(t.errorPath,m,t.opts.jsonPointers)),E)if(A)n+=" delete "+c+"["+m+"]; ";else{n+=" "+f+" = false; ";var B=u;u=t.errSchemaPath+"/additionalProperties";var H=H||[];H.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { additionalProperty: '"+j+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is an invalid additional property":n+="should NOT have additional properties",n+="' "),t.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var G=n;n=H.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+G+"]); ":n+=" validate.errors = ["+G+"]; return false; ":n+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=B,l&&(n+=" break; ")}else if(T)if("failing"==A){n+=" var "+h+" = errors;  ";var q=t.compositeRule;t.compositeRule=d.compositeRule=!0,d.schema=S,d.schemaPath=t.schemaPath+".additionalProperties",d.errSchemaPath=t.errSchemaPath+"/additionalProperties",d.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,m,t.opts.jsonPointers);var W=c+"["+m+"]";d.dataPathArr[v]=m;var $=t.validate(d);d.baseId=R,t.util.varOccurences($,y)<2?n+=" "+t.util.varReplace($,y,W)+" ":n+=" var "+y+" = "+W+"; "+$+" ",n+=" if (!"+f+") { errors = "+h+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+c+"["+m+"]; }  ",t.compositeRule=d.compositeRule=q}else{d.schema=S,d.schemaPath=t.schemaPath+".additionalProperties",d.errSchemaPath=t.errSchemaPath+"/additionalProperties",d.errorPath=t.opts._errorDataPathProperty?t.errorPath:t.util.getPathExpr(t.errorPath,m,t.opts.jsonPointers);W=c+"["+m+"]";d.dataPathArr[v]=m;$=t.validate(d);d.baseId=R,t.util.varOccurences($,y)<2?n+=" "+t.util.varReplace($,y,W)+" ":n+=" var "+y+" = "+W+"; "+$+" ",l&&(n+=" if (!"+f+") break; ")}t.errorPath=U}M&&(n+=" } "),n+=" }  ",l&&(n+=" if ("+f+") { ",p+="}")}var X=t.opts.useDefaults&&!t.compositeRule;if(b.length){var Y=b;if(Y){var Z,J=-1,Q=Y.length-1;while(J<Q){Z=Y[J+=1];var K=s[Z];if(t.opts.strictKeywords?"object"==typeof K&&Object.keys(K).length>0:t.util.schemaHasRules(K,t.RULES.all)){var tt=t.util.getProperty(Z),et=(W=c+tt,X&&void 0!==K.default);d.schema=K,d.schemaPath=a+tt,d.errSchemaPath=u+"/"+t.util.escapeFragment(Z),d.errorPath=t.util.getPath(t.errorPath,Z,t.opts.jsonPointers),d.dataPathArr[v]=t.util.toQuotedString(Z);$=t.validate(d);if(d.baseId=R,t.util.varOccurences($,y)<2){$=t.util.varReplace($,y,W);var rt=W}else{rt=y;n+=" var "+y+" = "+W+"; "}if(et)n+=" "+$+" ";else{if(O&&O[Z]){n+=" if ( "+rt+" === undefined ",C&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(Z)+"') "),n+=") { "+f+" = false; ";U=t.errorPath,B=u;var nt=t.util.escapeQuotes(Z);t.opts._errorDataPathProperty&&(t.errorPath=t.util.getPath(U,Z,t.opts.jsonPointers)),u=t.errSchemaPath+"/required";H=H||[];H.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'required' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { missingProperty: '"+nt+"' } ",!1!==t.opts.messages&&(n+=" , message: '",t.opts._errorDataPathProperty?n+="is a required property":n+="should have required property \\'"+nt+"\\'",n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";G=n;n=H.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+G+"]); ":n+=" validate.errors = ["+G+"]; return false; ":n+=" var err = "+G+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u=B,t.errorPath=U,n+=" } else { "}else l?(n+=" if ( "+rt+" === undefined ",C&&(n+=" || ! Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(Z)+"') "),n+=") { "+f+" = true; } else { "):(n+=" if ("+rt+" !== undefined ",C&&(n+=" &&   Object.prototype.hasOwnProperty.call("+c+", '"+t.util.escapeQuotes(Z)+"') "),n+=" ) { ");n+=" "+$+" } "}}l&&(n+=" if ("+f+") { ",p+="}")}}}if(_.length){var it=_;if(it){var ot,st=-1,at=it.length-1;while(st<at){ot=it[st+=1];K=x[ot];if(t.opts.strictKeywords?"object"==typeof K&&Object.keys(K).length>0:t.util.schemaHasRules(K,t.RULES.all)){d.schema=K,d.schemaPath=t.schemaPath+".patternProperties"+t.util.getProperty(ot),d.errSchemaPath=t.errSchemaPath+"/patternProperties/"+t.util.escapeFragment(ot),n+=C?" "+w+" = "+w+" || Object.keys("+c+"); for (var "+g+"=0; "+g+"<"+w+".length; "+g+"++) { var "+m+" = "+w+"["+g+"]; ":" for (var "+m+" in "+c+") { ",n+=" if ("+t.usePattern(ot)+".test("+m+")) { ",d.errorPath=t.util.getPathExpr(t.errorPath,m,t.opts.jsonPointers);W=c+"["+m+"]";d.dataPathArr[v]=m;$=t.validate(d);d.baseId=R,t.util.varOccurences($,y)<2?n+=" "+t.util.varReplace($,y,W)+" ":n+=" var "+y+" = "+W+"; "+$+" ",l&&(n+=" if (!"+f+") break; "),n+=" } ",l&&(n+=" else "+f+" = true; "),n+=" }  ",l&&(n+=" if ("+f+") { ",p+="}")}}}}return l&&(n+=" "+p+" if ("+h+" == errors) {"),n}},bee2:function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}r.d(e,"a",(function(){return i}))},bf8d:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a;var p="maximum"==e,f=p?"exclusiveMaximum":"exclusiveMinimum",m=t.schema[f],g=t.opts.$data&&m&&m.$data,v=p?"<":">",y=p?">":"<",w=void 0;if(!d&&"number"!=typeof a&&void 0!==a)throw new Error(e+" must be number");if(!g&&void 0!==m&&"number"!=typeof m&&"boolean"!=typeof m)throw new Error(f+" must be number or boolean");if(g){var b=t.util.getData(m.$data,s,t.dataPathArr),x="exclusive"+o,_="exclType"+o,S="exclIsNumber"+o,M="op"+o,E="' + "+M+" + '";i+=" var schemaExcl"+o+" = "+b+"; ",b="schemaExcl"+o,i+=" var "+x+"; var "+_+" = typeof "+b+"; if ("+_+" != 'boolean' && "+_+" != 'undefined' && "+_+" != 'number') { ";w=f;var T=T||[];T.push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(w||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: {} ",!1!==t.opts.messages&&(i+=" , message: '"+f+" should be boolean' "),t.opts.verbose&&(i+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var A=i;i=T.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+A+"]); ":i+=" validate.errors = ["+A+"]; return false; ":i+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } else if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+_+" == 'number' ? ( ("+x+" = "+n+" === undefined || "+b+" "+v+"= "+n+") ? "+h+" "+y+"= "+b+" : "+h+" "+y+" "+n+" ) : ( ("+x+" = "+b+" === true) ? "+h+" "+y+"= "+n+" : "+h+" "+y+" "+n+" ) || "+h+" !== "+h+") { var op"+o+" = "+x+" ? '"+v+"' : '"+v+"='; ",void 0===a&&(w=f,l=t.errSchemaPath+"/"+f,n=b,d=g)}else{S="number"==typeof m,E=v;if(S&&d){M="'"+E+"'";i+=" if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" ( "+n+" === undefined || "+m+" "+v+"= "+n+" ? "+h+" "+y+"= "+m+" : "+h+" "+y+" "+n+" ) || "+h+" !== "+h+") { "}else{S&&void 0===a?(x=!0,w=f,l=t.errSchemaPath+"/"+f,n=m,y+="="):(S&&(n=Math[p?"min":"max"](m,a)),m===(!S||n)?(x=!0,w=f,l=t.errSchemaPath+"/"+f,y+="="):(x=!1,E+="="));M="'"+E+"'";i+=" if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+h+" "+y+" "+n+" || "+h+" !== "+h+") { "}}w=w||e;T=T||[];T.push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(w||"_limit")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { comparison: "+M+", limit: "+n+", exclusive: "+x+" } ",!1!==t.opts.messages&&(i+=" , message: 'should be "+E+" ",i+=d?"' + "+n:n+"'"),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";A=i;return i=T.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+A+"]); ":i+=" validate.errors = ["+A+"]; return false; ":i+=" var err = "+A+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c&&(i+=" else { "),i}},c17c:function(t,e,r){"use strict";var n=r("6376"),i=r("fbda").toHash;t.exports=function(){var t=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],e=["type","$comment"],r=["$schema","$id","id","$data","$async","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"],o=["number","integer","string","array","object","boolean","null"];return t.all=i(e),t.types=i(o),t.forEach((function(r){r.rules=r.rules.map((function(r){var i;if("object"==typeof r){var o=Object.keys(r)[0];i=r[o],r=o,i.forEach((function(r){e.push(r),t.all[r]=!0}))}e.push(r);var s=t.all[r]={keyword:r,code:n[r],implements:i};return s})),t.all.$comment={keyword:"$comment",code:n.$comment},r.type&&(t.types[r.type]=r)})),t.keywords=i(e.concat(r)),t.custom={},t}},c1ac:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").filter,o=r("4840"),s=n.aTypedArray,a=n.aTypedArrayConstructor,u=n.exportTypedArrayMethod;u("filter",(function(t){var e=i(s(this),t,arguments.length>1?arguments[1]:void 0),r=o(this,this.constructor),n=0,u=e.length,l=new(a(r))(u);while(u>n)l[n]=e[n++];return l}))},ca91:function(t,e,r){"use strict";var n=r("ebb5"),i=r("d58f").left,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("reduce",(function(t){return i(o(this),t,arguments.length,arguments.length>1?arguments[1]:void 0)}))},cae0:function(t,e,r){(function(t){var n;(function(t,i,o){function s(t){var e=this;function r(t,e){var r,n=[];if(e===(0|e))n[0]=e;else for(e=""+e,r=0;r<e.length;++r)n[7&r]=n[7&r]<<15^e.charCodeAt(r)+n[r+1&7]<<13;while(n.length<8)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],t.x=n,t.i=0,r=256;r>0;--r)t.next()}e.next=function(){var t,r,n=e.x,i=e.i;return t=n[i],t^=t>>>7,r=t^t<<24,t=n[i+1&7],r^=t^t>>>10,t=n[i+3&7],r^=t^t>>>3,t=n[i+4&7],r^=t^t<<7,t=n[i+7&7],t^=t<<13,r^=t^t<<9,n[i]=r,e.i=i+1&7,r},r(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function u(t,e){null==t&&(t=+new Date);var r=new s(t),n=e&&e.state,i=function(){return(r.next()>>>0)/4294967296};return i.double=function(){do{var t=r.next()>>>11,e=(r.next()>>>0)/4294967296,n=(t+e)/(1<<21)}while(0===n);return n},i.int32=r.next,i.quick=i,n&&(n.x&&a(n,r),i.state=function(){return a(r,{})}),i}i&&i.exports?i.exports=u:r("07d6")&&r("3c35")?(n=function(){return u}.call(e,r,e,i),void 0===n||(i.exports=n)):this.xorshift7=u})(0,t,r("07d6"))}).call(this,r("62e4")(t))},cb27:function(module,exports,__webpack_require__){"use strict";(function(global){var numeric=exports;"undefined"!==typeof global&&(global.numeric=numeric),numeric.version="1.2.6",numeric.bench=function(t,e){var r,n,i,o;"undefined"===typeof e&&(e=15),i=.5,r=new Date;while(1){for(i*=2,o=i;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;if(n=new Date,n-r>e)break}for(o=i;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;return n=new Date,1e3*(3*i-1)/(n-r)},numeric._myIndexOf=function(t){var e,r=this.length;for(e=0;e<r;++e)if(this[e]===t)return e;return-1},numeric.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:numeric._myIndexOf,numeric.Function=Function,numeric.precision=4,numeric.largeArray=50,numeric.prettyPrint=function(t){function e(t){if(0===t)return"0";if(isNaN(t))return"NaN";if(t<0)return"-"+e(-t);if(isFinite(t)){var r=Math.floor(Math.log(t)/Math.log(10)),n=t/Math.pow(10,r),i=n.toPrecision(numeric.precision);return 10===parseFloat(i)&&(r++,n=1,i=n.toPrecision(numeric.precision)),parseFloat(i).toString()+"e"+r.toString()}return"Infinity"}var r=[];function n(t){var i;if("undefined"===typeof t)return r.push(Array(numeric.precision+8).join(" ")),!1;if("string"===typeof t)return r.push('"'+t+'"'),!1;if("boolean"===typeof t)return r.push(t.toString()),!1;if("number"===typeof t){var o=e(t),s=t.toPrecision(numeric.precision),a=parseFloat(t.toString()).toString(),u=[o,s,a,parseFloat(s).toString(),parseFloat(a).toString()];for(i=1;i<u.length;i++)u[i].length<o.length&&(o=u[i]);return r.push(Array(numeric.precision+8-o.length).join(" ")+o),!1}if(null===t)return r.push("null"),!1;if("function"===typeof t){r.push(t.toString());var l=!1;for(i in t)t.hasOwnProperty(i)&&(l?r.push(",\n"):r.push("\n{"),l=!0,r.push(i),r.push(": \n"),n(t[i]));return l&&r.push("}\n"),!0}if(t instanceof Array){if(t.length>numeric.largeArray)return r.push("...Large Array..."),!0;l=!1;for(r.push("["),i=0;i<t.length;i++)i>0&&(r.push(","),l&&r.push("\n ")),l=n(t[i]);return r.push("]"),!0}r.push("{");l=!1;for(i in t)t.hasOwnProperty(i)&&(l&&r.push(",\n"),l=!0,r.push(i),r.push(": \n"),n(t[i]));return r.push("}"),!0}return n(t),r.join("")},numeric.parseDate=function(t){function e(t){if("string"===typeof t)return Date.parse(t.replace(/-/g,"/"));if(!(t instanceof Array))throw new Error("parseDate: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}return e(t)},numeric.parseFloat=function(t){function e(t){if("string"===typeof t)return parseFloat(t);if(!(t instanceof Array))throw new Error("parseFloat: parameter must be arrays of strings");var r,n=[];for(r=0;r<t.length;r++)n[r]=e(t[r]);return n}return e(t)},numeric.parseCSV=function(t){var e,r,n=t.split("\n"),i=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,s=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(t){return t.substr(0,t.length-1)},u=0;for(r=0;r<n.length;r++){var l,c=(n[r]+",").match(o);if(c.length>0){for(i[u]=[],e=0;e<c.length;e++)l=a(c[e]),s.test(l)?i[u][e]=parseFloat(l):i[u][e]=l;u++}}return i},numeric.toCSV=function(t){var e,r,n,i,o,s=numeric.dim(t);for(n=s[0],s[1],o=[],e=0;e<n;e++){for(i=[],r=0;r<n;r++)i[r]=t[e][r].toString();o[e]=i.join(", ")}return o.join("\n")+"\n"},numeric.getURL=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(),e},numeric.imageURL=function(t){function e(t){var e,r,n,i,o,s,a,u,l=t.length,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h="";for(e=0;e<l;e+=3)r=t[e],n=t[e+1],i=t[e+2],o=r>>2,s=((3&r)<<4)+(n>>4),a=((15&n)<<2)+(i>>6),u=63&i,e+1>=l?a=u=64:e+2>=l&&(u=64),h+=c.charAt(o)+c.charAt(s)+c.charAt(a)+c.charAt(u);return h}function r(t,e,r){"undefined"===typeof e&&(e=0),"undefined"===typeof r&&(r=t.length);var n,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],o=-1,s=0;t.length;for(n=e;n<r;n++)s=255&(o^t[n]),o=o>>>8^i[s];return-1^o}var n,i,o,s,a,u,l,c,h,d,p=t[0].length,f=t[0][0].length,m=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,255&f,p>>24&255,p>>16&255,p>>8&255,255&p,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];for(d=r(m,12,29),m[29]=d>>24&255,m[30]=d>>16&255,m[31]=d>>8&255,m[32]=255&d,n=1,i=0,l=0;l<p;l++){for(l<p-1?m.push(0):m.push(1),a=3*f+1+(0===l)&255,u=3*f+1+(0===l)>>8&255,m.push(a),m.push(u),m.push(255&~a),m.push(255&~u),0===l&&m.push(0),c=0;c<f;c++)for(o=0;o<3;o++)a=t[o][l][c],a=a>255?255:a<0?0:Math.round(a),n=(n+a)%65521,i=(i+n)%65521,m.push(a);m.push(0)}return h=(i<<16)+n,m.push(h>>24&255),m.push(h>>16&255),m.push(h>>8&255),m.push(255&h),s=m.length-41,m[33]=s>>24&255,m[34]=s>>16&255,m[35]=s>>8&255,m[36]=255&s,d=r(m,37),m.push(d>>24&255),m.push(d>>16&255),m.push(d>>8&255),m.push(255&d),m.push(0),m.push(0),m.push(0),m.push(0),m.push(73),m.push(69),m.push(78),m.push(68),m.push(174),m.push(66),m.push(96),m.push(130),"data:image/png;base64,"+e(m)},numeric._dim=function(t){var e=[];while("object"===typeof t)e.push(t.length),t=t[0];return e},numeric.dim=function(t){var e,r;return"object"===typeof t?(e=t[0],"object"===typeof e?(r=e[0],"object"===typeof r?numeric._dim(t):[t.length,e.length]):[t.length]):[]},numeric.mapreduce=function(t,e){return Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+e+';\nif(typeof x === "number") { var xi = x; '+t+'; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    '+t+";\n    xi = x[i-1];\n    "+t+";\n}\nif(i === 0) {\n    xi = x[i];\n    "+t+"\n}\nreturn accum;")},numeric.mapreduce2=function(t,e){return Function("x","var n = x.length;\nvar i,xi;\n"+e+";\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    "+t+";\n}\nreturn accum;")},numeric.same=function t(e,r){var n,i;if(!(e instanceof Array)||!(r instanceof Array))return!1;if(i=e.length,i!==r.length)return!1;for(n=0;n<i;n++)if(e[n]!==r[n]){if("object"!==typeof e[n])return!1;if(!t(e[n],r[n]))return!1}return!0},numeric.rep=function(t,e,r){"undefined"===typeof r&&(r=0);var n,i=t[r],o=Array(i);if(r===t.length-1){for(n=i-2;n>=0;n-=2)o[n+1]=e,o[n]=e;return-1===n&&(o[0]=e),o}for(n=i-1;n>=0;n--)o[n]=numeric.rep(t,e,r+1);return o},numeric.dotMMsmall=function(t,e){var r,n,i,o,s,a,u,l,c,h,d;for(o=t.length,s=e.length,a=e[0].length,u=Array(o),r=o-1;r>=0;r--){for(l=Array(a),c=t[r],i=a-1;i>=0;i--){for(h=c[s-1]*e[s-1][i],n=s-2;n>=1;n-=2)d=n-1,h+=c[n]*e[n][i]+c[d]*e[d][i];0===n&&(h+=c[0]*e[0][i]),l[i]=h}u[r]=l}return u},numeric._getCol=function(t,e,r){var n,i=t.length;for(n=i-1;n>0;--n)r[n]=t[n][e],--n,r[n]=t[n][e];0===n&&(r[0]=t[0][e])},numeric.dotMMbig=function(t,e){var r,n,i,o=numeric._getCol,s=e.length,a=Array(s),u=t.length,l=e[0].length,c=new Array(u),h=numeric.dotVV;for(--s,--u,n=u;-1!==n;--n)c[n]=Array(l);for(--l,n=l;-1!==n;--n)for(o(e,n,a),i=u;-1!==i;--i)0,r=t[i],c[i][n]=h(r,a);return c},numeric.dotMV=function(t,e){var r,n=t.length,i=(e.length,Array(n)),o=numeric.dotVV;for(r=n-1;r>=0;r--)i[r]=o(t[r],e);return i},numeric.dotVM=function(t,e){var r,n,i,o,s,a,u;for(i=t.length,o=e[0].length,s=Array(o),n=o-1;n>=0;n--){for(a=t[i-1]*e[i-1][n],r=i-2;r>=1;r-=2)u=r-1,a+=t[r]*e[r][n]+t[u]*e[u][n];0===r&&(a+=t[0]*e[0][n]),s[n]=a}return s},numeric.dotVV=function(t,e){var r,n,i=t.length,o=t[i-1]*e[i-1];for(r=i-2;r>=1;r-=2)n=r-1,o+=t[r]*e[r]+t[n]*e[n];return 0===r&&(o+=t[0]*e[0]),o},numeric.dot=function(t,e){var r=numeric.dim;switch(1e3*r(t).length+r(e).length){case 2002:return e.length<10?numeric.dotMMsmall(t,e):numeric.dotMMbig(t,e);case 2001:return numeric.dotMV(t,e);case 1002:return numeric.dotVM(t,e);case 1001:return numeric.dotVV(t,e);case 1e3:return numeric.mulVS(t,e);case 1:return numeric.mulSV(t,e);case 0:return t*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},numeric.diag=function(t){var e,r,n,i,o=t.length,s=Array(o);for(e=o-1;e>=0;e--){for(i=Array(o),r=e+2,n=o-1;n>=r;n-=2)i[n]=0,i[n-1]=0;for(n>e&&(i[n]=0),i[e]=t[e],n=e-1;n>=1;n-=2)i[n]=0,i[n-1]=0;0===n&&(i[0]=0),s[e]=i}return s},numeric.getDiag=function(t){var e,r=Math.min(t.length,t[0].length),n=Array(r);for(e=r-1;e>=1;--e)n[e]=t[e][e],--e,n[e]=t[e][e];return 0===e&&(n[0]=t[0][0]),n},numeric.identity=function(t){return numeric.diag(numeric.rep([t],1))},numeric.pointwise=function(t,e,r){"undefined"===typeof r&&(r="");var n,i,o=[],s=/\[i\]$/,a="",u=!1;for(n=0;n<t.length;n++)s.test(t[n])?(i=t[n].substring(0,t[n].length-3),a=i):i=t[n],"ret"===i&&(u=!0),o.push(i);return o[t.length]="_s",o[t.length+1]="_k",o[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+a+');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i'+(u?"":", ret = Array(_n)")+";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+t.join(",")+",_s,_k+1);\n    return ret;\n}\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n    "+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric.pointwise2=function(t,e,r){"undefined"===typeof r&&(r="");var n,i,o=[],s=/\[i\]$/,a="",u=!1;for(n=0;n<t.length;n++)s.test(t[n])?(i=t[n].substring(0,t[n].length-3),a=i):i=t[n],"ret"===i&&(u=!0),o.push(i);return o[t.length]="var _n = "+a+".length;\nvar i"+(u?"":", ret = Array(_n)")+";\n"+r+"\nfor(i=_n-1;i!==-1;--i) {\n"+e+"\n}\nreturn ret;",Function.apply(null,o)},numeric._biforeach=function t(e,r,n,i,o){if(i!==n.length-1){var s,a=n[i];for(s=a-1;s>=0;s--)t("object"===typeof e?e[s]:e,"object"===typeof r?r[s]:r,n,i+1,o)}else o(e,r)},numeric._biforeach2=function t(e,r,n,i,o){if(i===n.length-1)return o(e,r);var s,a=n[i],u=Array(a);for(s=a-1;s>=0;--s)u[s]=t("object"===typeof e?e[s]:e,"object"===typeof r?r[s]:r,n,i+1,o);return u},numeric._foreach=function t(e,r,n,i){if(n!==r.length-1){var o,s=r[n];for(o=s-1;o>=0;o--)t(e[o],r,n+1,i)}else i(e)},numeric._foreach2=function t(e,r,n,i){if(n===r.length-1)return i(e);var o,s=r[n],a=Array(s);for(o=s-1;o>=0;o--)a[o]=t(e[o],r,n+1,i);return a},numeric.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},numeric.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},numeric.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],numeric.mathfuns2=["atan2","pow","max","min"],numeric.ops1={neg:"-",not:"!",bnot:"~",clone:""},numeric.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi)","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var t,e;for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],numeric.ops2[e]=e;for(t in numeric.ops2)if(numeric.ops2.hasOwnProperty(t)){e=numeric.ops2[t];var r,n,i="";-1!==numeric.myIndexOf.call(numeric.mathfuns2,t)?(i="var "+e+" = Math."+e+";\n",r=function(t,r,n){return t+" = "+e+"("+r+","+n+")"},n=function(t,r){return t+" = "+e+"("+t+","+r+")"}):(r=function(t,r,n){return t+" = "+r+" "+e+" "+n},n=numeric.opseq.hasOwnProperty(t+"eq")?function(t,r){return t+" "+e+"= "+r}:function(t,r){return t+" = "+t+" "+e+" "+r}),numeric[t+"VV"]=numeric.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),numeric[t+"SV"]=numeric.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),numeric[t+"VS"]=numeric.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),numeric[t]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+t+"VV, VS = numeric."+t+"VS, SV = numeric."+t+'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else '+n("x","y")+"\n}\nreturn x;\n"),numeric[e]=numeric[t],numeric[t+"eqV"]=numeric.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),numeric[t+"eqS"]=numeric.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),numeric[t+"eq"]=Function("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric."+t+"eqV, S = numeric."+t+'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n')}for(t=0;t<numeric.mathfuns2.length;++t)e=numeric.mathfuns2[t],delete numeric.ops2[e];for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],numeric.ops1[e]=e;for(t in numeric.ops1)numeric.ops1.hasOwnProperty(t)&&(i="",e=numeric.ops1[t],-1!==numeric.myIndexOf.call(numeric.mathfuns,t)&&Math.hasOwnProperty(e)&&(i="var "+e+" = Math."+e+";\n"),numeric[t+"eqV"]=numeric.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",i),numeric[t+"eq"]=Function("x",'if(typeof x !== "object") return '+e+"x\nvar i;\nvar V = numeric."+t+"eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"),numeric[t+"V"]=numeric.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",i),numeric[t]=Function("x",'if(typeof x !== "object") return '+e+"(x)\nvar i;\nvar V = numeric."+t+"V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n"));for(t=0;t<numeric.mathfuns.length;++t)e=numeric.mathfuns[t],delete numeric.ops1[e];for(t in numeric.mapreducers)numeric.mapreducers.hasOwnProperty(t)&&(e=numeric.mapreducers[t],numeric[t+"V"]=numeric.mapreduce2(e[0],e[1]),numeric[t]=Function("x","s","k",e[1]+'if(typeof x !== "object") {    xi = x;\n'+e[0]+';\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.'+t+"V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n"+e[0]+";\n}\nreturn accum;\n"))}(),numeric.truncVV=numeric.pointwise(["x[i]","y[i]"],"ret[i] = round(x[i]/y[i])*y[i];","var round = Math.round;"),numeric.truncVS=numeric.pointwise(["x[i]","y"],"ret[i] = round(x[i]/y)*y;","var round = Math.round;"),numeric.truncSV=numeric.pointwise(["x","y[i]"],"ret[i] = round(x/y[i])*y[i];","var round = Math.round;"),numeric.trunc=function(t,e){return"object"===typeof t?"object"===typeof e?numeric.truncVV(t,e):numeric.truncVS(t,e):"object"===typeof e?numeric.truncSV(t,e):Math.round(t/e)*e},numeric.inv=function(t){var e,r,n,i,o,s,a,u=numeric.dim(t),l=Math.abs,c=u[0],h=u[1],d=numeric.clone(t),p=numeric.identity(c);for(s=0;s<h;++s){var f=-1,m=-1;for(o=s;o!==c;++o)a=l(d[o][s]),a>m&&(f=o,m=a);for(r=d[f],d[f]=d[s],d[s]=r,i=p[f],p[f]=p[s],p[s]=i,t=r[s],a=s;a!==h;++a)r[a]/=t;for(a=h-1;-1!==a;--a)i[a]/=t;for(o=c-1;-1!==o;--o)if(o!==s){for(e=d[o],n=p[o],t=e[s],a=s+1;a!==h;++a)e[a]-=r[a]*t;for(a=h-1;a>0;--a)n[a]-=i[a]*t,--a,n[a]-=i[a]*t;0===a&&(n[0]-=i[0]*t)}}return p},numeric.det=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var r,n,i,o,s,a,u,l,c=e[0],h=1,d=numeric.clone(t);for(n=0;n<c-1;n++){for(i=n,r=n+1;r<c;r++)Math.abs(d[r][n])>Math.abs(d[i][n])&&(i=r);for(i!==n&&(u=d[i],d[i]=d[n],d[n]=u,h*=-1),o=d[n],r=n+1;r<c;r++){for(s=d[r],a=s[n]/o[n],i=n+1;i<c-1;i+=2)l=i+1,s[i]-=o[i]*a,s[l]-=o[l]*a;i!==c&&(s[i]-=o[i]*a)}if(0===o[n])return 0;h*=o[n]}return h*d[n][n]},numeric.transpose=function(t){var e,r,n,i,o,s=t.length,a=t[0].length,u=Array(a);for(r=0;r<a;r++)u[r]=Array(s);for(e=s-1;e>=1;e-=2){for(i=t[e],n=t[e-1],r=a-1;r>=1;--r)o=u[r],o[e]=i[r],o[e-1]=n[r],--r,o=u[r],o[e]=i[r],o[e-1]=n[r];0===r&&(o=u[0],o[e]=i[0],o[e-1]=n[0])}if(0===e){for(n=t[0],r=a-1;r>=1;--r)u[r][0]=n[r],--r,u[r][0]=n[r];0===r&&(u[0][0]=n[0])}return u},numeric.negtranspose=function(t){var e,r,n,i,o,s=t.length,a=t[0].length,u=Array(a);for(r=0;r<a;r++)u[r]=Array(s);for(e=s-1;e>=1;e-=2){for(i=t[e],n=t[e-1],r=a-1;r>=1;--r)o=u[r],o[e]=-i[r],o[e-1]=-n[r],--r,o=u[r],o[e]=-i[r],o[e-1]=-n[r];0===r&&(o=u[0],o[e]=-i[0],o[e-1]=-n[0])}if(0===e){for(n=t[0],r=a-1;r>=1;--r)u[r][0]=-n[r],--r,u[r][0]=-n[r];0===r&&(u[0][0]=-n[0])}return u},numeric._random=function t(e,r){var n,i,o=e[r],s=Array(o);if(r===e.length-1){for(i=Math.random,n=o-1;n>=1;n-=2)s[n]=i(),s[n-1]=i();return 0===n&&(s[0]=i()),s}for(n=o-1;n>=0;n--)s[n]=t(e,r+1);return s},numeric.random=function(t){return numeric._random(t,0)},numeric.norm2=function(t){return Math.sqrt(numeric.norm2Squared(t))},numeric.linspace=function(t,e,r){if("undefined"===typeof r&&(r=Math.max(Math.round(e-t)+1,1)),r<2)return 1===r?[t]:[];var n,i=Array(r);for(r--,n=r;n>=0;n--)i[n]=(n*e+(r-n)*t)/r;return i},numeric.getBlock=function(t,e,r){var n=numeric.dim(t);function i(t,o){var s,a=e[o],u=r[o]-a,l=Array(u);if(o===n.length-1){for(s=u;s>=0;s--)l[s]=t[s+a];return l}for(s=u;s>=0;s--)l[s]=i(t[s+a],o+1);return l}return i(t,0)},numeric.setBlock=function(t,e,r,n){var i=numeric.dim(t);function o(t,n,s){var a,u=e[s],l=r[s]-u;if(s===i.length-1)for(a=l;a>=0;a--)t[a+u]=n[a];for(a=l;a>=0;a--)o(t[a+u],n[a],s+1)}return o(t,n,0),t},numeric.getRange=function(t,e,r){var n,i,o,s,a=e.length,u=r.length,l=Array(a);for(n=a-1;-1!==n;--n)for(l[n]=Array(u),o=l[n],s=t[e[n]],i=u-1;-1!==i;--i)o[i]=s[r[i]];return l},numeric.blockMatrix=function(t){var e=numeric.dim(t);if(e.length<4)return numeric.blockMatrix([t]);var r,n,i,o,s,a=e[0],u=e[1];for(r=0,n=0,i=0;i<a;++i)r+=t[i][0].length;for(o=0;o<u;++o)n+=t[0][o][0].length;var l=Array(r);for(i=0;i<r;++i)l[i]=Array(n);var c,h,d,p,f,m=0;for(i=0;i<a;++i){for(c=n,o=u-1;-1!==o;--o)for(s=t[i][o],c-=s[0].length,d=s.length-1;-1!==d;--d)for(f=s[d],h=l[m+d],p=f.length-1;-1!==p;--p)h[c+p]=f[p];m+=t[i][0].length}return l},numeric.tensor=function(t,e){if("number"===typeof t||"number"===typeof e)return numeric.mul(t,e);var r=numeric.dim(t),n=numeric.dim(e);if(1!==r.length||1!==n.length)throw new Error("numeric: tensor product is only defined for vectors");var i,o,s,a,u=r[0],l=n[0],c=Array(u);for(o=u-1;o>=0;o--){for(i=Array(l),a=t[o],s=l-1;s>=3;--s)i[s]=a*e[s],--s,i[s]=a*e[s],--s,i[s]=a*e[s],--s,i[s]=a*e[s];while(s>=0)i[s]=a*e[s],--s;c[o]=i}return c},numeric.T=function(t,e){this.x=t,this.y=e},numeric.t=function(t,e){return new numeric.T(t,e)},numeric.Tbinop=function(t,e,r,n,i){var o;numeric.indexOf;if("string"!==typeof i)for(o in i="",numeric)numeric.hasOwnProperty(o)&&(t.indexOf(o)>=0||e.indexOf(o)>=0||r.indexOf(o)>=0||n.indexOf(o)>=0)&&o.length>1&&(i+="var "+o+" = numeric."+o+";\n");return Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+i+"\nif(x.y) {  if(y.y) {    return new numeric.T("+n+");\n  }\n  return new numeric.T("+r+");\n}\nif(y.y) {\n  return new numeric.T("+e+");\n}\nreturn new numeric.T("+t+");\n")},numeric.T.prototype.add=numeric.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),numeric.T.prototype.sub=numeric.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),numeric.T.prototype.mul=numeric.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),numeric.T.prototype.reciprocal=function(){var t=numeric.mul,e=numeric.div;if(this.y){var r=numeric.add(t(this.x,this.x),t(this.y,this.y));return new numeric.T(e(this.x,r),e(numeric.neg(this.y),r))}return new T(e(1,this.x))},numeric.T.prototype.div=function(t){if(t instanceof numeric.T||(t=new numeric.T(t)),t.y)return this.mul(t.reciprocal());var e=numeric.div;return this.y?new numeric.T(e(this.x,t.x),e(this.y,t.x)):new numeric.T(e(this.x,t.x))},numeric.T.prototype.dot=numeric.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),numeric.T.prototype.transpose=function(){var t=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(t(e),t(r)):new numeric.T(t(e))},numeric.T.prototype.transjugate=function(){var t=numeric.transpose,e=this.x,r=this.y;return r?new numeric.T(t(e),numeric.negtranspose(r)):new numeric.T(t(e))},numeric.Tunop=function(t,e,r){return"string"!==typeof r&&(r=""),Function("var x = this;\n"+r+"\nif(x.y) {  "+e+";\n}\n"+t+";\n")},numeric.T.prototype.exp=numeric.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),numeric.T.prototype.conj=numeric.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),numeric.T.prototype.neg=numeric.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),numeric.T.prototype.sin=numeric.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),numeric.T.prototype.cos=numeric.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),numeric.T.prototype.abs=numeric.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),numeric.T.prototype.log=numeric.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),numeric.T.prototype.norm2=numeric.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),numeric.T.prototype.inv=function(){var t=this;if("undefined"===typeof t.y)return new numeric.T(numeric.inv(t.x));var e,r,n,i,o,s,a,u,l,c,h,d,p,f,m,g,v,y,w=t.x.length,b=numeric.identity(w),x=numeric.rep([w,w],0),_=numeric.clone(t.x),S=numeric.clone(t.y);for(l=0;l<w;l++){for(f=_[l][l],m=S[l][l],d=f*f+m*m,h=l,c=l+1;c<w;c++)f=_[c][l],m=S[c][l],p=f*f+m*m,p>d&&(h=c,d=p);for(h!==l&&(y=_[l],_[l]=_[h],_[h]=y,y=S[l],S[l]=S[h],S[h]=y,y=b[l],b[l]=b[h],b[h]=y,y=x[l],x[l]=x[h],x[h]=y),e=_[l],r=S[l],o=b[l],s=x[l],f=e[l],m=r[l],c=l+1;c<w;c++)g=e[c],v=r[c],e[c]=(g*f+v*m)/d,r[c]=(v*f-g*m)/d;for(c=0;c<w;c++)g=o[c],v=s[c],o[c]=(g*f+v*m)/d,s[c]=(v*f-g*m)/d;for(c=l+1;c<w;c++){for(n=_[c],i=S[c],a=b[c],u=x[c],f=n[l],m=i[l],h=l+1;h<w;h++)g=e[h],v=r[h],n[h]-=g*f-v*m,i[h]-=v*f+g*m;for(h=0;h<w;h++)g=o[h],v=s[h],a[h]-=g*f-v*m,u[h]-=v*f+g*m}}for(l=w-1;l>0;l--)for(o=b[l],s=x[l],c=l-1;c>=0;c--)for(a=b[c],u=x[c],f=_[c][l],m=S[c][l],h=w-1;h>=0;h--)g=o[h],v=s[h],a[h]-=f*g-m*v,u[h]-=f*v+m*g;return new numeric.T(b,x)},numeric.T.prototype.get=function(t){var e,r=this.x,n=this.y,i=0,o=t.length;if(n){while(i<o)e=t[i],r=r[e],n=n[e],i++;return new numeric.T(r,n)}while(i<o)e=t[i],r=r[e],i++;return new numeric.T(r)},numeric.T.prototype.set=function(t,e){var r,n=this.x,i=this.y,o=0,s=t.length,a=e.x,u=e.y;if(0===s)return u?this.y=u:i&&(this.y=void 0),this.x=n,this;if(u){i||(i=numeric.rep(numeric.dim(n),0),this.y=i);while(o<s-1)r=t[o],n=n[r],i=i[r],o++;return r=t[o],n[r]=a,i[r]=u,this}if(i){while(o<s-1)r=t[o],n=n[r],i=i[r],o++;return r=t[o],n[r]=a,i[r]=a instanceof Array?numeric.rep(numeric.dim(a),0):0,this}while(o<s-1)r=t[o],n=n[r],o++;return r=t[o],n[r]=a,this},numeric.T.prototype.getRows=function(t,e){var r,n,i=e-t+1,o=Array(i),s=this.x,a=this.y;for(r=t;r<=e;r++)o[r-t]=s[r];if(a){for(n=Array(i),r=t;r<=e;r++)n[r-t]=a[r];return new numeric.T(o,n)}return new numeric.T(o)},numeric.T.prototype.setRows=function(t,e,r){var n,i=this.x,o=this.y,s=r.x,a=r.y;for(n=t;n<=e;n++)i[n]=s[n-t];if(a)for(o||(o=numeric.rep(numeric.dim(i),0),this.y=o),n=t;n<=e;n++)o[n]=a[n-t];else if(o)for(n=t;n<=e;n++)o[n]=numeric.rep([s[n-t].length],0);return this},numeric.T.prototype.getRow=function(t){var e=this.x,r=this.y;return r?new numeric.T(e[t],r[t]):new numeric.T(e[t])},numeric.T.prototype.setRow=function(t,e){var r=this.x,n=this.y,i=e.x,o=e.y;return r[t]=i,o?(n||(n=numeric.rep(numeric.dim(r),0),this.y=n),n[t]=o):n&&(n=numeric.rep([i.length],0)),this},numeric.T.prototype.getBlock=function(t,e){var r=this.x,n=this.y,i=numeric.getBlock;return n?new numeric.T(i(r,t,e),i(n,t,e)):new numeric.T(i(r,t,e))},numeric.T.prototype.setBlock=function(t,e,r){r instanceof numeric.T||(r=new numeric.T(r));var n=this.x,i=this.y,o=numeric.setBlock,s=r.x,a=r.y;if(a)return i||(this.y=numeric.rep(numeric.dim(this),0),i=this.y),o(n,t,e,s),o(i,t,e,a),this;o(n,t,e,s),i&&o(i,t,e,numeric.rep(numeric.dim(s),0))},numeric.T.rep=function(t,e){var r=numeric.T;e instanceof r||(e=new r(e));var n=e.x,i=e.y,o=numeric.rep;return i?new r(o(t,n),o(t,i)):new r(o(t,n))},numeric.T.diag=function(t){t instanceof numeric.T||(t=new numeric.T(t));var e=t.x,r=t.y,n=numeric.diag;return r?new numeric.T(n(e),n(r)):new numeric.T(n(e))},numeric.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return numeric.eig(this.x)},numeric.T.identity=function(t){return new numeric.T(numeric.identity(t))},numeric.T.prototype.getDiag=function(){var t=numeric,e=this.x,r=this.y;return r?new t.T(t.getDiag(e),t.getDiag(r)):new t.T(t.getDiag(e))},numeric.house=function(t){var e=numeric.clone(t),r=t[0]>=0?1:-1,n=r*numeric.norm2(t);e[0]+=n;var i=numeric.norm2(e);if(0===i)throw new Error("eig: internal error");return numeric.div(e,i)},numeric.toUpperHessenberg=function(t){var e=numeric.dim(t);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var r,n,i,o,s,a,u,l,c,h,d=e[0],p=numeric.clone(t),f=numeric.identity(d);for(n=0;n<d-2;n++){for(o=Array(d-n-1),r=n+1;r<d;r++)o[r-n-1]=p[r][n];if(numeric.norm2(o)>0){for(s=numeric.house(o),a=numeric.getBlock(p,[n+1,n],[d-1,d-1]),u=numeric.tensor(s,numeric.dot(s,a)),r=n+1;r<d;r++)for(l=p[r],c=u[r-n-1],i=n;i<d;i++)l[i]-=2*c[i-n];for(a=numeric.getBlock(p,[0,n+1],[d-1,d-1]),u=numeric.tensor(numeric.dot(a,s),s),r=0;r<d;r++)for(l=p[r],c=u[r],i=n+1;i<d;i++)l[i]-=2*c[i-n-1];for(a=Array(d-n-1),r=n+1;r<d;r++)a[r-n-1]=f[r];for(u=numeric.tensor(s,numeric.dot(s,a)),r=n+1;r<d;r++)for(h=f[r],c=u[r-n-1],i=0;i<d;i++)h[i]-=2*c[i]}}return{H:p,Q:f}},numeric.epsilon=2220446049250313e-31,numeric.QRFrancis=function(t,e){"undefined"===typeof e&&(e=1e4),t=numeric.clone(t);numeric.clone(t);var r,n,i,o,s,a,u,l,c,h,d,p,f,m,g,v,y,w,b=numeric.dim(t),x=b[0],_=numeric.identity(x);if(x<3)return{Q:_,B:[[0,x-1]]};var S=numeric.epsilon;for(w=0;w<e;w++){for(v=0;v<x-1;v++)if(Math.abs(t[v+1][v])<S*(Math.abs(t[v][v])+Math.abs(t[v+1][v+1]))){var M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[v,v]),e),E=numeric.QRFrancis(numeric.getBlock(t,[v+1,v+1],[x-1,x-1]),e);for(p=Array(v+1),g=0;g<=v;g++)p[g]=_[g];for(f=numeric.dot(M.Q,p),g=0;g<=v;g++)_[g]=f[g];for(p=Array(x-v-1),g=v+1;g<x;g++)p[g-v-1]=_[g];for(f=numeric.dot(E.Q,p),g=v+1;g<x;g++)_[g]=f[g-v-1];return{Q:_,B:M.B.concat(numeric.add(E.B,v+1))}}var T,A,P;if(i=t[x-2][x-2],o=t[x-2][x-1],s=t[x-1][x-2],a=t[x-1][x-1],l=i+a,u=i*a-o*s,c=numeric.getBlock(t,[0,0],[2,2]),l*l>=4*u)T=.5*(l+Math.sqrt(l*l-4*u)),A=.5*(l-Math.sqrt(l*l-4*u)),c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,T+A)),numeric.diag(numeric.rep([3],T*A)));else c=numeric.add(numeric.sub(numeric.dot(c,c),numeric.mul(c,l)),numeric.diag(numeric.rep([3],u)));for(r=[c[0][0],c[1][0],c[2][0]],n=numeric.house(r),p=[t[0],t[1],t[2]],f=numeric.tensor(n,numeric.dot(n,p)),g=0;g<3;g++)for(d=t[g],m=f[g],y=0;y<x;y++)d[y]-=2*m[y];for(p=numeric.getBlock(t,[0,0],[x-1,2]),f=numeric.tensor(numeric.dot(p,n),n),g=0;g<x;g++)for(d=t[g],m=f[g],y=0;y<3;y++)d[y]-=2*m[y];for(p=[_[0],_[1],_[2]],f=numeric.tensor(n,numeric.dot(n,p)),g=0;g<3;g++)for(h=_[g],m=f[g],y=0;y<x;y++)h[y]-=2*m[y];for(v=0;v<x-2;v++){for(y=v;y<=v+1;y++)if(Math.abs(t[y+1][y])<S*(Math.abs(t[y][y])+Math.abs(t[y+1][y+1]))){M=numeric.QRFrancis(numeric.getBlock(t,[0,0],[y,y]),e),E=numeric.QRFrancis(numeric.getBlock(t,[y+1,y+1],[x-1,x-1]),e);for(p=Array(y+1),g=0;g<=y;g++)p[g]=_[g];for(f=numeric.dot(M.Q,p),g=0;g<=y;g++)_[g]=f[g];for(p=Array(x-y-1),g=y+1;g<x;g++)p[g-y-1]=_[g];for(f=numeric.dot(E.Q,p),g=y+1;g<x;g++)_[g]=f[g-y-1];return{Q:_,B:M.B.concat(numeric.add(E.B,y+1))}}for(P=Math.min(x-1,v+3),r=Array(P-v),g=v+1;g<=P;g++)r[g-v-1]=t[g][v];for(n=numeric.house(r),p=numeric.getBlock(t,[v+1,v],[P,x-1]),f=numeric.tensor(n,numeric.dot(n,p)),g=v+1;g<=P;g++)for(d=t[g],m=f[g-v-1],y=v;y<x;y++)d[y]-=2*m[y-v];for(p=numeric.getBlock(t,[0,v+1],[x-1,P]),f=numeric.tensor(numeric.dot(p,n),n),g=0;g<x;g++)for(d=t[g],m=f[g],y=v+1;y<=P;y++)d[y]-=2*m[y-v-1];for(p=Array(P-v),g=v+1;g<=P;g++)p[g-v-1]=_[g];for(f=numeric.tensor(n,numeric.dot(n,p)),g=v+1;g<=P;g++)for(h=_[g],m=f[g-v-1],y=0;y<x;y++)h[y]-=2*m[y]}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},numeric.eig=function(t,e){var r,n,i,o,s,a,u,l,c,h,d,p,f,m,g,v,y,w=numeric.toUpperHessenberg(t),b=numeric.QRFrancis(w.H,e),x=numeric.T,_=t.length,S=b.B,M=numeric.dot(b.Q,numeric.dot(w.H,numeric.transpose(b.Q))),E=new x(numeric.dot(b.Q,w.Q)),T=S.length,A=Math.sqrt;for(n=0;n<T;n++)if(r=S[n][0],r===S[n][1]);else{if(o=r+1,s=M[r][r],a=M[r][o],u=M[o][r],l=M[o][o],0===a&&0===u)continue;c=-s-l,h=s*l-a*u,d=c*c-4*h,d>=0?(p=c<0?-.5*(c-A(d)):-.5*(c+A(d)),v=(s-p)*(s-p)+a*a,y=u*u+(l-p)*(l-p),v>y?(v=A(v),m=(s-p)/v,g=a/v):(y=A(y),m=u/y,g=(l-p)/y),i=new x([[g,-m],[m,g]]),E.setRows(r,o,i.dot(E.getRows(r,o)))):(p=-.5*c,f=.5*A(-d),v=(s-p)*(s-p)+a*a,y=u*u+(l-p)*(l-p),v>y?(v=A(v+f*f),m=(s-p)/v,g=a/v,p=0,f/=v):(y=A(y+f*f),m=u/y,g=(l-p)/y,p=f/y,f=0),i=new x([[g,-m],[m,g]],[[p,f],[f,-p]]),E.setRows(r,o,i.dot(E.getRows(r,o))))}var P=E.dot(t).dot(E.transjugate()),C=(_=t.length,numeric.T.identity(_));for(o=0;o<_;o++)if(o>0)for(n=o-1;n>=0;n--){var R=P.get([n,n]),L=P.get([o,o]);numeric.neq(R.x,L.x)||numeric.neq(R.y,L.y)?(p=P.getRow(n).getBlock([n],[o-1]),f=C.getRow(o).getBlock([n],[o-1]),C.set([o,n],P.get([n,o]).neg().sub(p.dot(f)).div(R.sub(L)))):C.setRow(o,C.getRow(n))}for(o=0;o<_;o++)p=C.getRow(o),C.setRow(o,p.div(p.norm2()));return C=C.transpose(),C=E.transjugate().dot(C),{lambda:P.getDiag(),E:C}},numeric.ccsSparse=function(t){var e,r,n,i=t.length,o=[];for(r=i-1;-1!==r;--r)for(n in e=t[r],e){n=parseInt(n);while(n>=o.length)o[o.length]=0;0!==e[n]&&o[n]++}var s=o.length,a=Array(s+1);for(a[0]=0,r=0;r<s;++r)a[r+1]=a[r]+o[r];var u=Array(a[s]),l=Array(a[s]);for(r=i-1;-1!==r;--r)for(n in e=t[r],e)0!==e[n]&&(o[n]--,u[a[n]+o[n]]=r,l[a[n]+o[n]]=e[n]);return[a,u,l]},numeric.ccsFull=function(t){var e,r,n,i,o=t[0],s=t[1],a=t[2],u=numeric.ccsDim(t),l=u[0],c=u[1],h=numeric.rep([l,c],0);for(e=0;e<c;e++)for(n=o[e],i=o[e+1],r=n;r<i;++r)h[s[r]][e]=a[r];return h},numeric.ccsTSolve=function(t,e,r,n,i){var o,s,a,u,l,c,h,d=t[0],p=t[1],f=t[2],m=d.length-1,g=Math.max,v=0;function y(t){var e;if(0===r[t]){for(r[t]=1,e=d[t];e<d[t+1];++e)y(p[e]);i[v]=t,++v}}for("undefined"===typeof n&&(r=numeric.rep([m],0)),"undefined"===typeof n&&(n=numeric.linspace(0,r.length-1)),"undefined"===typeof i&&(i=[]),o=n.length-1;-1!==o;--o)y(n[o]);for(i.length=v,o=i.length-1;-1!==o;--o)r[i[o]]=0;for(o=n.length-1;-1!==o;--o)s=n[o],r[s]=e[s];for(o=i.length-1;-1!==o;--o){for(s=i[o],a=d[s],u=g(d[s+1],a),l=a;l!==u;++l)if(p[l]===s){r[s]/=f[l];break}for(h=r[s],l=a;l!==u;++l)c=p[l],c!==s&&(r[c]-=h*f[l])}return r},numeric.ccsDFS=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS.prototype.dfs=function(t,e,r,n,i,o){var s,a,u,l=0,c=i.length,h=this.k,d=this.k1,p=this.j;if(0===n[t]){n[t]=1,p[0]=t,h[0]=a=e[t],d[0]=u=e[t+1];while(1)if(a>=u){if(i[c]=p[l],0===l)return;++c,--l,a=h[l],u=d[l]}else s=o[r[a]],0===n[s]?(n[s]=1,h[l]=a,++l,p[l]=s,a=e[s],d[l]=u=e[s+1]):++a}},numeric.ccsLPSolve=function(t,e,r,n,i,o,s){var a,u,l,c,h,d,p,f,m,g=t[0],v=t[1],y=t[2],w=(g.length,e[0]),b=e[1],x=e[2];for(u=w[i],l=w[i+1],n.length=0,a=u;a<l;++a)s.dfs(o[b[a]],g,v,r,n,o);for(a=n.length-1;-1!==a;--a)r[n[a]]=0;for(a=u;a!==l;++a)c=o[b[a]],r[c]=x[a];for(a=n.length-1;-1!==a;--a){for(c=n[a],h=g[c],d=g[c+1],p=h;p<d;++p)if(o[v[p]]===c){r[c]/=y[p];break}for(m=r[c],p=h;p<d;++p)f=o[v[p]],f!==c&&(r[f]-=m*y[p])}return r},numeric.ccsLUP1=function(t,e){var r,n,i,o,s,a,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],d=c[0],p=c[1],f=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),w=numeric.rep([l],0),b=numeric.ccsLPSolve,x=(Math.max,Math.abs),_=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),M=new numeric.ccsDFS(l);for("undefined"===typeof e&&(e=1),r=0;r<l;++r){for(b(c,t,y,w,r,S,M),o=-1,s=-1,n=w.length-1;-1!==n;--n)i=w[n],i<=r||(a=x(y[i]),a>o&&(s=i,o=a));for(x(y[r])<e*o&&(n=_[r],o=_[s],_[r]=o,S[o]=r,_[s]=n,S[n]=s,o=y[r],y[r]=y[s],y[s]=o),o=d[r],s=m[r],u=y[r],p[o]=_[r],f[o]=1,++o,n=w.length-1;-1!==n;--n)i=w[n],a=y[i],w[n]=0,y[i]=0,i<=r?(g[s]=i,v[s]=a,++s):(p[o]=_[i],f[o]=a/u,++o);d[r+1]=o,m[r+1]=s}for(n=p.length-1;-1!==n;--n)p[n]=S[p[n]];return{L:c,U:h,P:_,Pinv:S}},numeric.ccsDFS0=function(t){this.k=Array(t),this.k1=Array(t),this.j=Array(t)},numeric.ccsDFS0.prototype.dfs=function(t,e,r,n,i,o,s){var a,u,l,c=0,h=i.length,d=this.k,p=this.k1,f=this.j;if(0===n[t]){n[t]=1,f[0]=t,d[0]=u=e[o[t]],p[0]=l=e[o[t]+1];while(1){if(isNaN(u))throw new Error("Ow!");if(u>=l){if(i[h]=o[f[c]],0===c)return;++h,--c,u=d[c],l=p[c]}else a=r[u],0===n[a]?(n[a]=1,d[c]=u,++c,f[c]=a,a=o[a],u=e[a],p[c]=l=e[a+1]):++u}}},numeric.ccsLPSolve0=function(t,e,r,n,i,o,s,a){var u,l,c,h,d,p,f,m,g,v=t[0],y=t[1],w=t[2],b=(v.length,e[0]),x=e[1],_=e[2];for(l=b[i],c=b[i+1],n.length=0,u=l;u<c;++u)a.dfs(x[u],v,y,r,n,o,s);for(u=n.length-1;-1!==u;--u)h=n[u],r[s[h]]=0;for(u=l;u!==c;++u)h=x[u],r[h]=_[u];for(u=n.length-1;-1!==u;--u){for(h=n[u],m=s[h],d=v[h],p=v[h+1],f=d;f<p;++f)if(y[f]===m){r[m]/=w[f];break}for(g=r[m],f=d;f<p;++f)r[y[f]]-=g*w[f];r[m]=g}},numeric.ccsLUP0=function(t,e){var r,n,i,o,s,a,u,l=t[0].length-1,c=[numeric.rep([l+1],0),[],[]],h=[numeric.rep([l+1],0),[],[]],d=c[0],p=c[1],f=c[2],m=h[0],g=h[1],v=h[2],y=numeric.rep([l],0),w=numeric.rep([l],0),b=numeric.ccsLPSolve0,x=(Math.max,Math.abs),_=numeric.linspace(0,l-1),S=numeric.linspace(0,l-1),M=new numeric.ccsDFS0(l);for("undefined"===typeof e&&(e=1),r=0;r<l;++r){for(b(c,t,y,w,r,S,_,M),o=-1,s=-1,n=w.length-1;-1!==n;--n)i=w[n],i<=r||(a=x(y[_[i]]),a>o&&(s=i,o=a));for(x(y[_[r]])<e*o&&(n=_[r],o=_[s],_[r]=o,S[o]=r,_[s]=n,S[n]=s),o=d[r],s=m[r],u=y[_[r]],p[o]=_[r],f[o]=1,++o,n=w.length-1;-1!==n;--n)i=w[n],a=y[_[i]],w[n]=0,y[_[i]]=0,i<=r?(g[s]=i,v[s]=a,++s):(p[o]=_[i],f[o]=a/u,++o);d[r+1]=o,m[r+1]=s}for(n=p.length-1;-1!==n;--n)p[n]=S[p[n]];return{L:c,U:h,P:_,Pinv:S}},numeric.ccsLUP=numeric.ccsLUP0,numeric.ccsDim=function(t){return[numeric.sup(t[1])+1,t[0].length-1]},numeric.ccsGetBlock=function(t,e,r){var n=numeric.ccsDim(t),i=n[0],o=n[1];"undefined"===typeof e?e=numeric.linspace(0,i-1):"number"===typeof e&&(e=[e]),"undefined"===typeof r?r=numeric.linspace(0,o-1):"number"===typeof r&&(r=[r]);var s,a,u,l,c,h=e.length,d=r.length,p=numeric.rep([o],0),f=[],m=[],g=[p,f,m],v=t[0],y=t[1],w=t[2],b=numeric.rep([i],0),x=0,_=numeric.rep([i],0);for(a=0;a<d;++a){l=r[a];var S=v[l],M=v[l+1];for(s=S;s<M;++s)u=y[s],_[u]=1,b[u]=w[s];for(s=0;s<h;++s)c=e[s],_[c]&&(f[x]=s,m[x]=b[e[s]],++x);for(s=S;s<M;++s)u=y[s],_[u]=0;p[a+1]=x}return g},numeric.ccsDot=function(t,e){var r,n,i,o,s,a,u,l,c,h,d,p=t[0],f=t[1],m=t[2],g=e[0],v=e[1],y=e[2],w=numeric.ccsDim(t),b=numeric.ccsDim(e),x=w[0],_=(w[1],b[1]),S=numeric.rep([x],0),M=numeric.rep([x],0),E=Array(x),T=numeric.rep([_],0),A=[],P=[],C=[T,A,P];for(i=0;i!==_;++i){for(o=g[i],s=g[i+1],c=0,n=o;n<s;++n)for(h=v[n],d=y[n],a=p[h],u=p[h+1],r=a;r<u;++r)l=f[r],0===M[l]&&(E[c]=l,M[l]=1,c+=1),S[l]=S[l]+m[r]*d;for(o=T[i],s=o+c,T[i+1]=s,n=c-1;-1!==n;--n)d=o+n,r=E[n],A[d]=r,P[d]=S[r],M[r]=0,S[r]=0;T[i+1]=T[i]+c}return C},numeric.ccsLUPSolve=function(t,e){var r=t.L,n=t.U,i=(t.P,e[0]),o=!1;"object"!==typeof i&&(e=[[0,e.length],numeric.linspace(0,e.length-1),e],i=e[0],o=!0);var s,a,u,l,c,h,d=e[1],p=e[2],f=r[0].length-1,m=i.length-1,g=numeric.rep([f],0),v=Array(f),y=numeric.rep([f],0),w=Array(f),b=numeric.rep([m+1],0),x=[],_=[],S=numeric.ccsTSolve,M=0;for(s=0;s<m;++s){for(c=0,u=i[s],l=i[s+1],a=u;a<l;++a)h=t.Pinv[d[a]],w[c]=h,y[h]=p[a],++c;for(w.length=c,S(r,y,g,w,v),a=w.length-1;-1!==a;--a)y[w[a]]=0;if(S(n,g,y,v,w),o)return y;for(a=v.length-1;-1!==a;--a)g[v[a]]=0;for(a=w.length-1;-1!==a;--a)h=w[a],x[M]=h,_[M]=y[h],y[h]=0,++M;b[s+1]=M}return[b,x,_]},numeric.ccsbinop=function(t,e){return"undefined"===typeof e&&(e=""),Function("X","Y","var Xi = X[0], Xj = X[1], Xv = X[2];\nvar Yi = Y[0], Yj = Y[1], Yv = Y[2];\nvar n = Xi.length-1,m = Math.max(numeric.sup(Xj),numeric.sup(Yj))+1;\nvar Zi = numeric.rep([n+1],0), Zj = [], Zv = [];\nvar x = numeric.rep([m],0),y = numeric.rep([m],0);\nvar xk,yk,zk;\nvar i,j,j0,j1,k,p=0;\n"+e+"for(i=0;i<n;++i) {\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Xj[j];\n    x[k] = 1;\n    Zj[p] = k;\n    ++p;\n  }\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Yj[j];\n    y[k] = Yv[j];\n    if(x[k] === 0) {\n      Zj[p] = k;\n      ++p;\n    }\n  }\n  Zi[i+1] = p;\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = Xv[j];\n  j0 = Zi[i]; j1 = Zi[i+1];\n  for(j=j0;j!==j1;++j) {\n    k = Zj[j];\n    xk = x[k];\n    yk = y[k];\n"+t+"\n    Zv[j] = zk;\n  }\n  j0 = Xi[i]; j1 = Xi[i+1];\n  for(j=j0;j!==j1;++j) x[Xj[j]] = 0;\n  j0 = Yi[i]; j1 = Yi[i+1];\n  for(j=j0;j!==j1;++j) y[Yj[j]] = 0;\n}\nreturn [Zi,Zj,Zv];")},function(){var k,A,B,C;for(k in numeric.ops2)A=isFinite(eval("1"+numeric.ops2[k]+"0"))?"[Y[0],Y[1],numeric."+k+"(X,Y[2])]":"NaN",B=isFinite(eval("0"+numeric.ops2[k]+"1"))?"[X[0],X[1],numeric."+k+"(X[2],Y)]":"NaN",C=isFinite(eval("1"+numeric.ops2[k]+"0"))&&isFinite(eval("0"+numeric.ops2[k]+"1"))?"numeric.ccs"+k+"MM(X,Y)":"NaN",numeric["ccs"+k+"MM"]=numeric.ccsbinop("zk = xk "+numeric.ops2[k]+"yk;"),numeric["ccs"+k]=Function("X","Y",'if(typeof X === "number") return '+A+';\nif(typeof Y === "number") return '+B+";\nreturn "+C+";\n")}(),numeric.ccsScatter=function(t){var e,r=t[0],n=t[1],i=t[2],o=numeric.sup(n)+1,s=r.length,a=numeric.rep([o],0),u=Array(s),l=Array(s),c=numeric.rep([o],0);for(e=0;e<s;++e)c[n[e]]++;for(e=0;e<o;++e)a[e+1]=a[e]+c[e];var h,d,p=a.slice(0);for(e=0;e<s;++e)d=n[e],h=p[d],u[h]=r[e],l[h]=i[e],p[d]=p[d]+1;return[a,u,l]},numeric.ccsGather=function(t){var e,r,n,i,o,s=t[0],a=t[1],u=t[2],l=s.length-1,c=a.length,h=Array(c),d=Array(c),p=Array(c);for(o=0,e=0;e<l;++e)for(n=s[e],i=s[e+1],r=n;r!==i;++r)d[o]=e,h[o]=a[r],p[o]=u[r],++o;return[h,d,p]},numeric.sdim=function t(e,r,n){if("undefined"===typeof r&&(r=[]),"object"!==typeof e)return r;var i;for(i in"undefined"===typeof n&&(n=0),n in r||(r[n]=0),e.length>r[n]&&(r[n]=e.length),e)e.hasOwnProperty(i)&&t(e[i],r,n+1);return r},numeric.sclone=function t(e,r,n){"undefined"===typeof r&&(r=0),"undefined"===typeof n&&(n=numeric.sdim(e).length);var i,o=Array(e.length);if(r===n-1){for(i in e)e.hasOwnProperty(i)&&(o[i]=e[i]);return o}for(i in e)e.hasOwnProperty(i)&&(o[i]=t(e[i],r+1,n));return o},numeric.sdiag=function(t){var e,r,n=t.length,i=Array(n);for(e=n-1;e>=1;e-=2)r=e-1,i[e]=[],i[e][e]=t[e],i[r]=[],i[r][r]=t[r];return 0===e&&(i[0]=[],i[0][0]=t[e]),i},numeric.sidentity=function(t){return numeric.sdiag(numeric.rep([t],1))},numeric.stranspose=function(t){var e,r,n,i=[];t.length;for(e in t)if(t.hasOwnProperty(e))for(r in n=t[e],n)n.hasOwnProperty(r)&&("object"!==typeof i[r]&&(i[r]=[]),i[r][e]=n[r]);return i},numeric.sLUP=function(t,e){throw new Error("The function numeric.sLUP had a bug in it and has been removed. Please use the new numeric.ccsLUP function instead.")},numeric.sdotMM=function(t,e){var r,n,i,o,s,a,u,l=t.length,c=(e.length,numeric.stranspose(e)),h=c.length,d=Array(l);for(i=l-1;i>=0;i--){for(u=[],r=t[i],s=h-1;s>=0;s--){for(o in a=0,n=c[s],r)r.hasOwnProperty(o)&&o in n&&(a+=r[o]*n[o]);a&&(u[s]=a)}d[i]=u}return d},numeric.sdotMV=function(t,e){var r,n,i,o,s=t.length,a=Array(s);for(n=s-1;n>=0;n--){for(i in r=t[n],o=0,r)r.hasOwnProperty(i)&&e[i]&&(o+=r[i]*e[i]);o&&(a[n]=o)}return a},numeric.sdotVM=function(t,e){var r,n,i,o,s=[];for(r in t)if(t.hasOwnProperty(r))for(n in i=e[r],o=t[r],i)i.hasOwnProperty(n)&&(s[n]||(s[n]=0),s[n]+=o*i[n]);return s},numeric.sdotVV=function(t,e){var r,n=0;for(r in t)t[r]&&e[r]&&(n+=t[r]*e[r]);return n},numeric.sdot=function(t,e){var r=numeric.sdim(t).length,n=numeric.sdim(e).length,i=1e3*r+n;switch(i){case 0:return t*e;case 1001:return numeric.sdotVV(t,e);case 2001:return numeric.sdotMV(t,e);case 1002:return numeric.sdotVM(t,e);case 2002:return numeric.sdotMM(t,e);default:throw new Error("numeric.sdot not implemented for tensors of order "+r+" and "+n)}},numeric.sscatter=function(t){var e,r,n,i,o=t[0].length,s=t.length,a=[];for(r=o-1;r>=0;--r)if(t[s-1][r]){for(i=a,n=0;n<s-2;n++)e=t[n][r],i[e]||(i[e]=[]),i=i[e];i[t[n][r]]=t[n+1][r]}return a},numeric.sgather=function t(e,r,n){var i,o,s;for(o in"undefined"===typeof r&&(r=[]),"undefined"===typeof n&&(n=[]),i=n.length,e)if(e.hasOwnProperty(o))if(n[i]=parseInt(o),s=e[o],"number"===typeof s){if(s){if(0===r.length)for(o=i+1;o>=0;--o)r[o]=[];for(o=i;o>=0;--o)r[o].push(n[o]);r[i+1].push(s)}}else t(s,r,n);return n.length>i&&n.pop(),r},numeric.cLU=function(t){var e,r,n,i,o,s,a=t[0],u=t[1],l=t[2],c=a.length,h=0;for(e=0;e<c;e++)a[e]>h&&(h=a[e]);h++;var d,p=Array(h),f=Array(h),m=numeric.rep([h],1/0),g=numeric.rep([h],-1/0);for(n=0;n<c;n++)e=a[n],r=u[n],r<m[e]&&(m[e]=r),r>g[e]&&(g[e]=r);for(e=0;e<h-1;e++)g[e]>g[e+1]&&(g[e+1]=g[e]);for(e=h-1;e>=1;e--)m[e]<m[e-1]&&(m[e-1]=m[e]);for(e=0;e<h;e++)f[e]=numeric.rep([g[e]-m[e]+1],0),p[e]=numeric.rep([e-m[e]],0),e-m[e]+1,g[e]-e+1;for(n=0;n<c;n++)e=a[n],f[e][u[n]-m[e]]=l[n];for(e=0;e<h-1;e++)for(i=e-m[e],w=f[e],r=e+1;m[r]<=e&&r<h;r++)if(o=e-m[r],s=g[e]-e,b=f[r],d=b[o]/w[i],d){for(n=1;n<=s;n++)b[n+o]-=d*w[n+i];p[r][e-m[r]]=d}var v,y,w=[],b=[],x=[],_=[],S=[],M=[];for(c=0,v=0,e=0;e<h;e++){for(i=m[e],o=g[e],y=f[e],r=e;r<=o;r++)y[r-i]&&(w[c]=e,b[c]=r,x[c]=y[r-i],c++);for(y=p[e],r=i;r<e;r++)y[r-i]&&(_[v]=e,S[v]=r,M[v]=y[r-i],v++);_[v]=e,S[v]=e,M[v]=1,v++}return{U:[w,b,x],L:[_,S,M]}},numeric.cLUsolve=function(t,e){var r,n,i=t.L,o=t.U,s=numeric.clone(e),a=i[0],u=i[1],l=i[2],c=o[0],h=o[1],d=o[2],p=c.length,f=(a.length,s.length);for(n=0,r=0;r<f;r++){while(u[n]<r)s[r]-=l[n]*s[u[n]],n++;n++}for(n=p-1,r=f-1;r>=0;r--){while(h[n]>r)s[r]-=d[n]*s[h[n]],n--;s[r]/=d[n],n--}return s},numeric.cgrid=function(t,e){"number"===typeof t&&(t=[t,t]);var r,n,i,o=numeric.rep(t,-1);if("function"!==typeof e)switch(e){case"L":e=function(e,r){return e>=t[0]/2||r<t[1]/2};break;default:e=function(t,e){return!0};break}for(i=0,r=1;r<t[0]-1;r++)for(n=1;n<t[1]-1;n++)e(r,n)&&(o[r][n]=i,i++);return o},numeric.cdelsq=function(t){var e,r,n,i,o,s=[[-1,0],[0,-1],[0,1],[1,0]],a=numeric.dim(t),u=a[0],l=a[1],c=[],h=[],d=[];for(e=1;e<u-1;e++)for(r=1;r<l-1;r++)if(!(t[e][r]<0)){for(n=0;n<4;n++)i=e+s[n][0],o=r+s[n][1],t[i][o]<0||(c.push(t[e][r]),h.push(t[i][o]),d.push(-1));c.push(t[e][r]),h.push(t[e][r]),d.push(4)}return[c,h,d]},numeric.cdotMV=function(t,e){var r,n,i,o=t[0],s=t[1],a=t[2],u=o.length;for(i=0,n=0;n<u;n++)o[n]>i&&(i=o[n]);for(i++,r=numeric.rep([i],0),n=0;n<u;n++)r[o[n]]+=a[n]*e[s[n]];return r},numeric.Spline=function(t,e,r,n,i){this.x=t,this.yl=e,this.yr=r,this.kl=n,this.kr=i},numeric.Spline.prototype._at=function(t,e){var r,n,i,o=this.x,s=this.yl,a=this.yr,u=this.kl,l=this.kr,c=numeric.add,h=numeric.sub,d=numeric.mul;r=h(d(u[e],o[e+1]-o[e]),h(a[e+1],s[e])),n=c(d(l[e+1],o[e]-o[e+1]),h(a[e+1],s[e])),i=(t-o[e])/(o[e+1]-o[e]);var p=i*(1-i);return c(c(c(d(1-i,s[e]),d(i,a[e+1])),d(r,p*(1-i))),d(n,p*i))},numeric.Spline.prototype.at=function(t){if("number"===typeof t){var e,r,n,i=this.x,o=i.length,s=Math.floor;e=0,r=o-1;while(r-e>1)n=s((e+r)/2),i[n]<=t?e=n:r=n;return this._at(t,e)}o=t.length;var a,u=Array(o);for(a=o-1;-1!==a;--a)u[a]=this.at(t[a]);return u},numeric.Spline.prototype.diff=function(){var t,e,r,n=this.x,i=this.yl,o=this.yr,s=this.kl,a=this.kr,u=i.length,l=s,c=a,h=Array(u),d=Array(u),p=numeric.add,f=numeric.mul,m=numeric.div,g=numeric.sub;for(t=u-1;-1!==t;--t)e=n[t+1]-n[t],r=g(o[t+1],i[t]),h[t]=m(p(f(r,6),f(s[t],-4*e),f(a[t+1],-2*e)),e*e),d[t+1]=m(p(f(r,-6),f(s[t],2*e),f(a[t+1],4*e)),e*e);return new numeric.Spline(n,l,c,h,d)},numeric.Spline.prototype.roots=function(){function t(t){return t*t}var e=[],r=this.x,n=this.yl,i=this.yr,o=this.kl,s=this.kr;"number"===typeof n[0]&&(n=[n],i=[i],o=[o],s=[s]);var a,u,l,c,h,d,p,f,m,g,v,y,w,b,x,_,S,M,E,T,A,P,C,R=n.length,L=r.length-1,O=(e=Array(R),Math.sqrt);for(a=0;a!==R;++a){for(c=n[a],h=i[a],d=o[a],p=s[a],f=[],u=0;u!==L;u++){for(u>0&&h[u]*c[u]<0&&f.push(r[u]),_=r[u+1]-r[u],r[u],v=c[u],y=h[u+1],m=d[u]/_,g=p[u+1]/_,x=t(m-g+3*(v-y))+12*g*v,w=g+3*v+2*m-3*y,b=3*(g+m+2*(v-y)),x<=0?(M=w/b,S=M>r[u]&&M<r[u+1]?[r[u],M,r[u+1]]:[r[u],r[u+1]]):(M=(w-O(x))/b,E=(w+O(x))/b,S=[r[u]],M>r[u]&&M<r[u+1]&&S.push(M),E>r[u]&&E<r[u+1]&&S.push(E),S.push(r[u+1])),A=S[0],M=this._at(A,u),l=0;l<S.length-1;l++)if(P=S[l+1],E=this._at(P,u),0!==M)if(0===E||M*E>0)A=P,M=E;else{var I=0;while(1){if(C=(M*P-E*A)/(M-E),C<=A||C>=P)break;if(T=this._at(C,u),T*E>0)P=C,E=T,-1===I&&(M*=.5),I=-1;else{if(!(T*M>0))break;A=C,M=T,1===I&&(E*=.5),I=1}}f.push(C),A=S[l+1],M=this._at(A,u)}else f.push(A),A=P,M=E;0===E&&f.push(P)}e[a]=f}return"number"===typeof this.yl[0]?e[0]:e},numeric.spline=function(t,e,r,n){var i,o=t.length,s=[],a=[],u=[],l=numeric.sub,c=numeric.mul,h=numeric.add;for(i=o-2;i>=0;i--)a[i]=t[i+1]-t[i],u[i]=l(e[i+1],e[i]);"string"!==typeof r&&"string"!==typeof n||(r=n="periodic");var d=[[],[],[]];switch(typeof r){case"undefined":s[0]=c(3/(a[0]*a[0]),u[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/a[0],1/a[0]);break;case"string":s[0]=h(c(3/(a[o-2]*a[o-2]),u[o-2]),c(3/(a[0]*a[0]),u[0])),d[0].push(0,0,0),d[1].push(o-2,0,1),d[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:s[0]=r,d[0].push(0),d[1].push(0),d[2].push(1);break}for(i=1;i<o-1;i++)s[i]=h(c(3/(a[i-1]*a[i-1]),u[i-1]),c(3/(a[i]*a[i]),u[i])),d[0].push(i,i,i),d[1].push(i-1,i,i+1),d[2].push(1/a[i-1],2/a[i-1]+2/a[i],1/a[i]);switch(typeof n){case"undefined":s[o-1]=c(3/(a[o-2]*a[o-2]),u[o-2]),d[0].push(o-1,o-1),d[1].push(o-2,o-1),d[2].push(1/a[o-2],2/a[o-2]);break;case"string":d[1][d[1].length-1]=0;break;default:s[o-1]=n,d[0].push(o-1),d[1].push(o-1),d[2].push(1);break}s="number"!==typeof s[0]?numeric.transpose(s):[s];var p=Array(s.length);if("string"===typeof r)for(i=p.length-1;-1!==i;--i)p[i]=numeric.ccsLUPSolve(numeric.ccsLUP(numeric.ccsScatter(d)),s[i]),p[i][o-1]=p[i][0];else for(i=p.length-1;-1!==i;--i)p[i]=numeric.cLUsolve(numeric.cLU(d),s[i]);return p="number"===typeof e[0]?p[0]:numeric.transpose(p),new numeric.Spline(t,e,e,p,p)},numeric.fftpow2=function t(e,r){var n=e.length;if(1!==n){var i,o,s=Math.cos,a=Math.sin,u=Array(n/2),l=Array(n/2),c=Array(n/2),h=Array(n/2);for(o=n/2,i=n-1;-1!==i;--i)--o,c[o]=e[i],h[o]=r[i],--i,u[o]=e[i],l[o]=r[i];t(u,l),t(c,h),o=n/2;var d,p,f,m=-6.283185307179586/n;for(i=n-1;-1!==i;--i)--o,-1===o&&(o=n/2-1),d=m*i,p=s(d),f=a(d),e[i]=u[o]+p*c[o]-f*h[o],r[i]=l[o]+p*h[o]+f*c[o]}},numeric._ifftpow2=function t(e,r){var n=e.length;if(1!==n){var i,o,s=Math.cos,a=Math.sin,u=Array(n/2),l=Array(n/2),c=Array(n/2),h=Array(n/2);for(o=n/2,i=n-1;-1!==i;--i)--o,c[o]=e[i],h[o]=r[i],--i,u[o]=e[i],l[o]=r[i];t(u,l),t(c,h),o=n/2;var d,p,f,m=6.283185307179586/n;for(i=n-1;-1!==i;--i)--o,-1===o&&(o=n/2-1),d=m*i,p=s(d),f=a(d),e[i]=u[o]+p*c[o]-f*h[o],r[i]=l[o]+p*h[o]+f*c[o]}},numeric.ifftpow2=function(t,e){numeric._ifftpow2(t,e),numeric.diveq(t,t.length),numeric.diveq(e,e.length)},numeric.convpow2=function(t,e,r,n){numeric.fftpow2(t,e),numeric.fftpow2(r,n);var i,o,s,a,u,l=t.length;for(i=l-1;-1!==i;--i)o=t[i],a=e[i],s=r[i],u=n[i],t[i]=o*s-a*u,e[i]=o*u+a*s;numeric.ifftpow2(t,e)},numeric.T.prototype.fft=function(){var t,e,r=this.x,n=this.y,i=r.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,d=Math.sin,p=-3.141592653589793/i,f=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)f[t]=r[t];if("undefined"!==typeof n)for(t=0;t<i;t++)m[t]=n[t];for(l[0]=1,t=1;t<=u/2;t++)e=p*t*t,l[t]=h(e),c[t]=d(e),l[u-t]=h(e),c[u-t]=d(e);var g=new numeric.T(f,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g},numeric.T.prototype.ifft=function(){var t,e,r=this.x,n=this.y,i=r.length,o=Math.log,s=o(2),a=Math.ceil(o(2*i-1)/s),u=Math.pow(2,a),l=numeric.rep([u],0),c=numeric.rep([u],0),h=Math.cos,d=Math.sin,p=3.141592653589793/i,f=numeric.rep([u],0),m=numeric.rep([u],0);Math.floor(i/2);for(t=0;t<i;t++)f[t]=r[t];if("undefined"!==typeof n)for(t=0;t<i;t++)m[t]=n[t];for(l[0]=1,t=1;t<=u/2;t++)e=p*t*t,l[t]=h(e),c[t]=d(e),l[u-t]=h(e),c[u-t]=d(e);var g=new numeric.T(f,m),v=new numeric.T(l,c);return g=g.mul(v),numeric.convpow2(g.x,g.y,numeric.clone(v.x),numeric.neg(v.y)),g=g.mul(v),g.x.length=i,g.y.length=i,g.div(i)},numeric.gradient=function(t,e){var r=e.length,n=t(e);if(isNaN(n))throw new Error("gradient: f(x) is a NaN!");var i,o,s,a,u,l,c,h,d,p,f=Math.max,m=numeric.clone(e),g=Array(r),v=(numeric.div,numeric.sub,f=Math.max,.001),y=Math.abs,w=Math.min,b=0;for(i=0;i<r;i++){var x=f(1e-6*n,1e-8);while(1){if(++b,b>20)throw new Error("Numerical gradient fails");if(m[i]=e[i]+x,o=t(m),m[i]=e[i]-x,s=t(m),m[i]=e[i],isNaN(o)||isNaN(s))x/=16;else{if(g[i]=(o-s)/(2*x),u=e[i]-x,l=e[i],c=e[i]+x,h=(o-n)/x,d=(n-s)/x,p=f(y(g[i]),y(n),y(o),y(s),y(u),y(l),y(c),1e-8),a=w(f(y(h-g[i]),y(d-g[i]),y(h-d))/p,x/p),!(a>v))break;x/=16}}}return g},numeric.uncmin=function(t,e,r,n,i,o,s){var a=numeric.gradient;"undefined"===typeof s&&(s={}),"undefined"===typeof r&&(r=1e-8),"undefined"===typeof n&&(n=function(e){return a(t,e)}),"undefined"===typeof i&&(i=1e3),e=numeric.clone(e);var u,l,c=e.length,h=t(e);if(isNaN(h))throw new Error("uncmin: f(x0) is a NaN!");var d=Math.max,p=numeric.norm2;r=d(r,numeric.epsilon);var f,m,g,v,y,w,b,x,_,S,M=s.Hinv||numeric.identity(c),E=numeric.dot,T=(numeric.inv,numeric.sub),A=numeric.add,P=numeric.tensor,C=numeric.div,R=numeric.mul,L=numeric.all,O=numeric.isFinite,I=numeric.neg,D=0,N="";m=n(e);while(D<i){if("function"===typeof o&&o(D,e,h,m,M)){N="Callback returned true";break}if(!L(O(m))){N="Gradient has Infinity or NaN";break}if(f=I(E(M,m)),!L(O(f))){N="Search direction has Infinity or NaN";break}if(S=p(f),S<r){N="Newton step smaller than tol";break}_=1,l=E(m,f),y=e;while(D<i){if(_*S<r)break;if(v=R(f,_),y=A(e,v),u=t(y),!(u-h>=.1*_*l||isNaN(u)))break;_*=.5,++D}if(_*S<r){N="Line search step size smaller than tol";break}if(D===i){N="maxit reached during line search";break}g=n(y),w=T(g,m),x=E(w,v),b=E(M,w),M=T(A(M,R((x+E(w,b))/(x*x),P(v,v))),C(A(P(b,v),P(v,b)),x)),e=y,h=u,m=g,++D}return{solution:e,f:h,gradient:m,invHessian:M,iterations:D,message:N}},numeric.Dopri=function(t,e,r,n,i,o,s){this.x=t,this.y=e,this.f=r,this.ymid=n,this.iterations=i,this.events=s,this.message=o},numeric.Dopri.prototype._at=function(t,e){function r(t){return t*t}var n,i,o,s,a,u,l,c,h,d,p=this,f=p.x,m=p.y,g=p.f,v=p.ymid,y=(f.length,Math.floor,.5),w=numeric.add,b=numeric.mul,x=numeric.sub;return n=f[e],i=f[e+1],s=m[e],a=m[e+1],l=i-n,o=n+y*l,u=v[e],c=x(g[e],b(s,1/(n-o)+2/(n-i))),h=x(g[e+1],b(a,1/(i-o)+2/(i-n))),d=[r(t-i)*(t-o)/r(n-i)/(n-o),r(t-n)*r(t-i)/r(n-o)/r(i-o),r(t-n)*(t-o)/r(i-n)/(i-o),(t-n)*r(t-i)*(t-o)/r(n-i)/(n-o),(t-i)*r(t-n)*(t-o)/r(n-i)/(i-o)],w(w(w(w(b(s,d[0]),b(u,d[1])),b(a,d[2])),b(c,d[3])),b(h,d[4]))},numeric.Dopri.prototype.at=function(t){var e,r,n,i=Math.floor;if("number"!==typeof t){var o=t.length,s=Array(o);for(e=o-1;-1!==e;--e)s[e]=this.at(t[e]);return s}var a=this.x;e=0,r=a.length-1;while(r-e>1)n=i(.5*(e+r)),a[n]<=t?e=n:r=n;return this._at(t,e)},numeric.dopri=function(t,e,r,n,i,o,s){"undefined"===typeof i&&(i=1e-6),"undefined"===typeof o&&(o=1e3);var a,u,l,c,h,d,p,f,m,g,v,y,w,b=[t],x=[r],_=[n(t,r)],S=[],M=.2,E=[3/40,9/40],T=[44/45,-56/15,32/9],A=[19372/6561,-25360/2187,64448/6561,-212/729],P=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],C=[35/384,0,500/1113,125/192,-2187/6784,11/84],R=[.10013431883002395,0,.3918321794184259,-.02982460176594817,.05893268337240795,-.04497888809104361,5618549.5/235043384],L=[.2,.3,.8,8/9,1,1],O=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,1/40],I=0,D=(e-t)/10,N=0,k=numeric.add,F=numeric.mul,V=(Math.max,Math.min),z=Math.abs,U=numeric.norminf,j=Math.pow,B=numeric.any,H=numeric.lt,G=numeric.and,q=(numeric.sub,new numeric.Dopri(b,x,_,S,-1,""));"function"===typeof s&&(v=s(t,r));while(t<e&&N<o)if(++N,t+D>e&&(D=e-t),a=n(t+L[0]*D,k(r,F(M*D,_[I]))),u=n(t+L[1]*D,k(k(r,F(E[0]*D,_[I])),F(E[1]*D,a))),l=n(t+L[2]*D,k(k(k(r,F(T[0]*D,_[I])),F(T[1]*D,a)),F(T[2]*D,u))),c=n(t+L[3]*D,k(k(k(k(r,F(A[0]*D,_[I])),F(A[1]*D,a)),F(A[2]*D,u)),F(A[3]*D,l))),h=n(t+L[4]*D,k(k(k(k(k(r,F(P[0]*D,_[I])),F(P[1]*D,a)),F(P[2]*D,u)),F(P[3]*D,l)),F(P[4]*D,c))),m=k(k(k(k(k(r,F(_[I],D*C[0])),F(u,D*C[2])),F(l,D*C[3])),F(c,D*C[4])),F(h,D*C[5])),d=n(t+D,m),p=k(k(k(k(k(F(_[I],D*O[0]),F(u,D*O[2])),F(l,D*O[3])),F(c,D*O[4])),F(h,D*O[5])),F(d,D*O[6])),g="number"===typeof p?z(p):U(p),g>i){if(D=.2*D*j(i/g,.25),t+D===t){q.msg="Step size became too small";break}}else{if(S[I]=k(k(k(k(k(k(r,F(_[I],D*R[0])),F(u,D*R[2])),F(l,D*R[3])),F(c,D*R[4])),F(h,D*R[5])),F(d,D*R[6])),++I,b[I]=t+D,x[I]=m,_[I]=d,"function"===typeof s){var W,$,X=t,Y=t+.5*D;if(y=s(Y,S[I-1]),w=G(H(v,0),H(0,y)),B(w)||(X=Y,Y=t+D,v=y,y=s(Y,m),w=G(H(v,0),H(0,y))),B(w)){var Z,J,Q=0,K=1,tt=1;while(1){if("number"===typeof v)$=(tt*y*X-K*v*Y)/(tt*y-K*v);else for($=Y,f=v.length-1;-1!==f;--f)v[f]<0&&y[f]>0&&($=V($,(tt*y[f]*X-K*v[f]*Y)/(tt*y[f]-K*v[f])));if($<=X||$>=Y)break;W=q._at($,I-1),J=s($,W),Z=G(H(v,0),H(0,J)),B(Z)?(Y=$,y=J,w=Z,tt=1,-1===Q?K*=.5:K=1,Q=-1):(X=$,v=J,K=1,1===Q?tt*=.5:tt=1,Q=1)}return m=q._at(.5*(t+$),I-1),q.f[I]=n($,W),q.x[I]=$,q.y[I]=W,q.ymid[I-1]=m,q.events=w,q.iterations=N,q}}t+=D,r=m,v=y,D=V(.8*D*j(i/g,.25),4*D)}return q.iterations=N,q},numeric.LU=function(t,e){e=e||!1;var r,n,i,o,s,a,u,l,c,h=Math.abs,d=t.length,p=d-1,f=new Array(d);for(e||(t=numeric.clone(t)),i=0;i<d;++i){for(u=i,a=t[i],c=h(a[i]),n=i+1;n<d;++n)o=h(t[n][i]),c<o&&(c=o,u=n);for(f[i]=u,u!=i&&(t[i]=t[u],t[u]=a,a=t[i]),s=a[i],r=i+1;r<d;++r)t[r][i]/=s;for(r=i+1;r<d;++r){for(l=t[r],n=i+1;n<p;++n)l[n]-=l[i]*a[n],++n,l[n]-=l[i]*a[n];n===p&&(l[n]-=l[i]*a[n])}}return{LU:t,P:f}},numeric.LUsolve=function(t,e){var r,n,i,o,s,a=t.LU,u=a.length,l=numeric.clone(e),c=t.P;for(r=u-1;-1!==r;--r)l[r]=e[r];for(r=0;r<u;++r)for(i=c[r],c[r]!==r&&(s=l[r],l[r]=l[i],l[i]=s),o=a[r],n=0;n<r;++n)l[r]-=l[n]*o[n];for(r=u-1;r>=0;--r){for(o=a[r],n=r+1;n<u;++n)l[r]-=l[n]*o[n];l[r]/=o[r]}return l},numeric.solve=function(t,e,r){return numeric.LUsolve(numeric.LU(t,r),e)},numeric.echelonize=function(t){var e,r,n,i,o,s,a,u,l=numeric.dim(t),c=l[0],h=l[1],d=numeric.identity(c),p=Array(c),f=Math.abs,m=numeric.diveq;for(t=numeric.clone(t),e=0;e<c;++e){for(n=0,o=t[e],s=d[e],r=1;r<h;++r)f(o[n])<f(o[r])&&(n=r);for(p[e]=n,m(s,o[n]),m(o,o[n]),r=0;r<c;++r)if(r!==e){for(a=t[r],u=a[n],i=h-1;-1!==i;--i)a[i]-=o[i]*u;for(a=d[r],i=c-1;-1!==i;--i)a[i]-=s[i]*u}}return{I:d,A:t,P:p}},numeric.__solveLP=function(t,e,r,n,i,o,s){var a,u,l,c,h=numeric.sum,d=(numeric.log,numeric.mul),p=numeric.sub,f=numeric.dot,m=numeric.div,g=numeric.add,v=t.length,y=r.length,w=!1,b=0,x=1,_=(numeric.transpose(e),numeric.svd,numeric.transpose),S=(numeric.leq,Math.sqrt),M=Math.abs,E=(numeric.muleq,numeric.norminf,numeric.any,Math.min),T=numeric.all,A=numeric.gt,P=Array(v),C=Array(y),R=(numeric.rep([y],1),numeric.solve),L=p(r,f(e,o)),O=f(t,t);for(l=b;l<i;++l){var I,D;for(I=y-1;-1!==I;--I)C[I]=m(e[I],L[I]);var N=_(C);for(I=v-1;-1!==I;--I)P[I]=h(N[I]);x=.25*M(O/f(t,P));var k=100*S(O/f(P,P));for((!isFinite(x)||x>k)&&(x=k),c=g(t,d(x,P)),u=f(N,C),I=v-1;-1!==I;--I)u[I][I]+=1;D=R(u,m(c,x),!0);var F=m(L,f(e,D)),V=1;for(I=y-1;-1!==I;--I)F[I]<0&&(V=E(V,-.999*F[I]));if(a=p(o,d(D,V)),L=p(r,f(e,a)),!T(A(L,0)))return{solution:o,message:"",iterations:l};if(o=a,x<n)return{solution:a,message:"",iterations:l};if(s){var z=f(t,c),U=f(e,c);for(w=!0,I=y-1;-1!==I;--I)if(z*U[I]<0){w=!1;break}}else w=!(o[v-1]>=0);if(w)return{solution:a,message:"Unbounded",iterations:l}}return{solution:o,message:"maximum iteration count exceeded",iterations:l}},numeric._solveLP=function(t,e,r,n,i){var o=t.length,s=r.length,a=(numeric.sum,numeric.log,numeric.mul,numeric.sub),u=numeric.dot,l=(numeric.div,numeric.add,numeric.rep([o],0).concat([1])),c=numeric.rep([s,1],-1),h=numeric.blockMatrix([[e,c]]),d=r,p=numeric.rep([o],0).concat(Math.max(0,numeric.sup(numeric.neg(r)))+1),f=numeric.__solveLP(l,h,d,n,i,p,!1),m=numeric.clone(f.solution);m.length=o;var g=numeric.inf(a(r,u(e,m)));if(g<0)return{solution:NaN,message:"Infeasible",iterations:f.iterations};var v=numeric.__solveLP(t,e,r,n,i-f.iterations,m,!0);return v.iterations+=f.iterations,v},numeric.solveLP=function(t,e,r,n,i,o,s){if("undefined"===typeof s&&(s=1e3),"undefined"===typeof o&&(o=numeric.epsilon),"undefined"===typeof n)return numeric._solveLP(t,e,r,o,s);var a,u=n.length,l=n[0].length,c=e.length,h=numeric.echelonize(n),d=numeric.rep([l],0),p=h.P,f=[];for(a=p.length-1;-1!==a;--a)d[p[a]]=1;for(a=l-1;-1!==a;--a)0===d[a]&&f.push(a);var m=numeric.getRange,g=numeric.linspace(0,u-1),v=numeric.linspace(0,c-1),y=m(n,g,f),w=m(e,v,p),b=m(e,v,f),x=numeric.dot,_=numeric.sub,S=x(w,h.I),M=_(b,x(S,y)),E=_(r,x(S,i)),T=Array(p.length),A=Array(f.length);for(a=p.length-1;-1!==a;--a)T[a]=t[p[a]];for(a=f.length-1;-1!==a;--a)A[a]=t[f[a]];var P=_(A,x(T,x(h.I,y))),C=numeric._solveLP(P,M,E,o,s),R=C.solution;if(R!==R)return C;var L=x(h.I,_(i,x(y,R))),O=Array(t.length);for(a=p.length-1;-1!==a;--a)O[p[a]]=L[a];for(a=f.length-1;-1!==a;--a)O[f[a]]=R[a];return{solution:O,message:C.message,iterations:C.iterations}},numeric.MPStoLP=function(t){t instanceof String&&t.split("\n");var e,r,n,i,o=0,s=["Initial state","NAME","ROWS","COLUMNS","RHS","BOUNDS","ENDATA"],a=t.length,u=0,l={},c=[],h=0,d={},p=0,f=[],m=[],g=[];function v(r){throw new Error("MPStoLP: "+r+"\nLine "+e+": "+t[e]+"\nCurrent state: "+s[o]+"\n")}for(e=0;e<a;++e){n=t[e];var y=n.match(/\S*/g),w=[];for(r=0;r<y.length;++r)""!==y[r]&&w.push(y[r]);if(0!==w.length){for(r=0;r<s.length;++r)if(n.substr(0,s[r].length)===s[r])break;if(r<s.length){if(o=r,1===r&&(i=w[1]),6===r)return{name:i,c:f,A:numeric.transpose(m),b:g,rows:l,vars:d}}else switch(o){case 0:case 1:v("Unexpected line");case 2:switch(w[0]){case"N":0===u?u=w[1]:v("Two or more N rows");break;case"L":l[w[1]]=h,c[h]=1,g[h]=0,++h;break;case"G":l[w[1]]=h,c[h]=-1,g[h]=0,++h;break;case"E":l[w[1]]=h,c[h]=0,g[h]=0,++h;break;default:v("Parse error "+numeric.prettyPrint(w))}break;case 3:d.hasOwnProperty(w[0])||(d[w[0]]=p,f[p]=0,m[p]=numeric.rep([h],0),++p);var b=d[w[0]];for(r=1;r<w.length;r+=2)if(w[r]!==u){var x=l[w[r]];m[b][x]=(c[x]<0?-1:1)*parseFloat(w[r+1])}else f[b]=parseFloat(w[r+1]);break;case 4:for(r=1;r<w.length;r+=2)g[l[w[r]]]=(c[l[w[r]]]<0?-1:1)*parseFloat(w[r+1]);break;case 5:break;case 6:v("Internal error")}}}v("Reached end of file without ENDATA")},numeric.seedrandom={pow:Math.pow,random:Math.random},function(t,e,r,n,i,o,s){function a(t){var e,n,i=this,o=t.length,s=0,a=i.i=i.j=i.m=0;i.S=[],i.c=[],o||(t=[o++]);while(s<r)i.S[s]=s++;for(s=0;s<r;s++)e=i.S[s],a=c(a+e+t[s%o]),n=i.S[a],i.S[s]=n,i.S[a]=e;i.g=function(t){var e=i.S,n=c(i.i+1),o=e[n],s=c(i.j+o),a=e[s];e[n]=a,e[s]=o;var u=e[c(o+a)];while(--t)n=c(n+1),o=e[n],s=c(s+o),a=e[s],e[n]=a,e[s]=o,u=u*r+e[c(o+a)];return i.i=n,i.j=s,u},i.g(r)}function u(t,e,r,n,i){if(r=[],i=typeof t,e&&"object"==i)for(n in t)if(n.indexOf("S")<5)try{r.push(u(t[n],e-1))}catch(o){}return r.length?r:t+("string"!=i?"\0":"")}function l(t,e,r,n){for(t+="",r=0,n=0;n<t.length;n++)e[c(n)]=c((r^=19*e[c(n)])+t.charCodeAt(n));for(n in t="",e)t+=String.fromCharCode(e[n]);return t}function c(t){return t&r-1}e["seedrandom"]=function(c,h){var d,p=[];return c=l(u(h?[c,t]:arguments.length?c:[(new Date).getTime(),t,window],3),p),d=new a(p),l(d.S,t),e["random"]=function(){var t=d.g(n),e=s,a=0;while(t<i)t=(t+a)*r,e*=r,a=d.g(1);while(t>=o)t/=2,e/=2,a>>>=1;return(t+a)/e},c},s=e.pow(r,n),i=e.pow(2,i),o=2*i,l(e.random(),t)}([],numeric.seedrandom,256,6,52),function(t){function e(t){if("object"!==typeof t)return t;var r,n=[],i=t.length;for(r=0;r<i;r++)n[r+1]=e(t[r]);return n}function r(t){if("object"!==typeof t)return t;var e,n=[],i=t.length;for(e=1;e<i;e++)n[e-1]=r(t[e]);return n}function n(t,e,r){var n,i,o,s,a;for(o=1;o<=r;o+=1){for(t[o][o]=1/t[o][o],a=-t[o][o],n=1;n<o;n+=1)t[n][o]=a*t[n][o];if(s=o+1,r<s)break;for(i=s;i<=r;i+=1)for(a=t[o][i],t[o][i]=0,n=1;n<=o;n+=1)t[n][i]=t[n][i]+a*t[n][o]}}function i(t,e,r,n){var i,o,s,a;for(o=1;o<=r;o+=1){for(a=0,i=1;i<o;i+=1)a+=t[i][o]*n[i];n[o]=(n[o]-a)/t[o][o]}for(s=1;s<=r;s+=1)for(o=r+1-s,n[o]=n[o]/t[o][o],a=-n[o],i=1;i<o;i+=1)n[i]=n[i]+a*t[i][o]}function o(t,e,r,n){var i,o,s,a,u,l;for(o=1;o<=r;o+=1){if(n[1]=o,l=0,s=o-1,s<1){if(l=t[o][o]-l,l<=0)break;t[o][o]=Math.sqrt(l)}else{for(a=1;a<=s;a+=1){for(u=t[a][o],i=1;i<a;i+=1)u-=t[i][o]*t[i][a];u/=t[a][a],t[a][o]=u,l+=u*u}if(l=t[o][o]-l,l<=0)break;t[o][o]=Math.sqrt(l)}n[1]=0}}function s(t,e,r,s,a,u,l,c,h,d,p,f,m,g,v,y){var w,b,x,_,S,M,E,T,A,P,C,R,L,O,I,D,N,k,F,V,z,U,j,B,H,G,q;L=Math.min(s,d),x=2*s+L*(L+5)/2+2*d+1,B=1e-60;do{B+=B,H=1+.1*B,G=1+.2*B}while(H<=1||G<=1);for(w=1;w<=s;w+=1)v[w]=e[w];for(w=s+1;w<=x;w+=1)v[w]=0;for(w=1;w<=d;w+=1)f[w]=0;if(S=[],0===y[1]){if(o(t,r,s,S),0!==S[1])return void(y[1]=2);i(t,r,s,e),n(t,r,s)}else{for(b=1;b<=s;b+=1)for(a[b]=0,w=1;w<=b;w+=1)a[b]=a[b]+t[w][b]*e[w];for(b=1;b<=s;b+=1)for(e[b]=0,w=b;w<=s;w+=1)e[b]=e[b]+t[b][w]*a[w]}for(u[1]=0,b=1;b<=s;b+=1)for(a[b]=e[b],u[1]=u[1]+v[b]*a[b],v[b]=0,w=b+1;w<=s;w+=1)t[w][b]=0;for(u[1]=-u[1]/2,y[1]=0,E=s,T=E+s,C=T+L,A=C+L+1,P=A+L*(L+1)/2,O=P+d,w=1;w<=d;w+=1){for(D=0,b=1;b<=s;b+=1)D+=l[b][w]*l[b][w];v[O+w]=Math.sqrt(D)}function W(){for(g[1]=g[1]+1,x=P,w=1;w<=d;w+=1){for(x+=1,D=-c[w],b=1;b<=s;b+=1)D+=l[b][w]*a[b];if(Math.abs(D)<B&&(D=0),w>p)v[x]=D;else if(v[x]=-Math.abs(D),D>0){for(b=1;b<=s;b+=1)l[b][w]=-l[b][w];c[w]=-c[w]}}for(w=1;w<=m;w+=1)v[P+f[w]]=0;for(R=0,I=0,w=1;w<=d;w+=1)v[P+w]<I*v[O+w]&&(R=w,I=v[P+w]/v[O+w]);return 0===R?999:0}function $(){for(w=1;w<=s;w+=1){for(D=0,b=1;b<=s;b+=1)D+=t[b][w]*l[b][R];v[w]=D}for(_=E,w=1;w<=s;w+=1)v[_+w]=0;for(b=m+1;b<=s;b+=1)for(w=1;w<=s;w+=1)v[_+w]=v[_+w]+t[w][b]*v[b];for(U=!0,w=m;w>=1;w-=1){for(D=v[w],x=A+w*(w+3)/2,_=x-w,b=w+1;b<=m;b+=1)D-=v[x]*v[T+b],x+=b;if(D/=v[_],v[T+w]=D,f[w]<p)break;if(D<0)break;U=!1,M=w}if(!U)for(N=v[C+M]/v[T+M],w=1;w<=m;w+=1){if(f[w]<p)break;if(v[T+w]<0)break;I=v[C+w]/v[T+w],I<N&&(N=I,M=w)}for(D=0,w=E+1;w<=E+s;w+=1)D+=v[w]*v[w];if(Math.abs(D)<=B){if(U)return y[1]=1,999;for(w=1;w<=m;w+=1)v[C+w]=v[C+w]-N*v[T+w];return v[C+m+1]=v[C+m+1]+N,700}for(D=0,w=1;w<=s;w+=1)D+=v[E+w]*l[w][R];for(k=-v[P+R]/D,j=!0,U||N<k&&(k=N,j=!1),w=1;w<=s;w+=1)a[w]=a[w]+k*v[E+w],Math.abs(a[w])<B&&(a[w]=0);for(u[1]=u[1]+k*D*(k/2+v[C+m+1]),w=1;w<=m;w+=1)v[C+w]=v[C+w]-k*v[T+w];if(v[C+m+1]=v[C+m+1]+k,!j){for(D=-c[R],b=1;b<=s;b+=1)D+=a[b]*l[b][R];if(R>p)v[P+R]=D;else if(v[P+R]=-Math.abs(D),D>0){for(b=1;b<=s;b+=1)l[b][R]=-l[b][R];c[R]=-c[R]}return 700}for(m+=1,f[m]=R,x=A+(m-1)*m/2+1,w=1;w<=m-1;w+=1)v[x]=v[w],x+=1;if(m===s)v[x]=v[s];else{for(w=s;w>=m+1;w-=1){if(0===v[w])break;if(F=Math.max(Math.abs(v[w-1]),Math.abs(v[w])),V=Math.min(Math.abs(v[w-1]),Math.abs(v[w])),I=v[w-1]>=0?Math.abs(F*Math.sqrt(1+V*V/(F*F))):-Math.abs(F*Math.sqrt(1+V*V/(F*F))),F=v[w-1]/I,V=v[w]/I,1===F)break;if(0===F)for(v[w-1]=V*I,b=1;b<=s;b+=1)I=t[b][w-1],t[b][w-1]=t[b][w],t[b][w]=I;else for(v[w-1]=I,z=V/(1+F),b=1;b<=s;b+=1)I=F*t[b][w-1]+V*t[b][w],t[b][w]=z*(t[b][w-1]+I)-t[b][w],t[b][w-1]=I}v[x]=v[m]}return 0}function X(){if(x=A+M*(M+1)/2+1,_=x+M,0===v[_])return 798;if(F=Math.max(Math.abs(v[_-1]),Math.abs(v[_])),V=Math.min(Math.abs(v[_-1]),Math.abs(v[_])),I=v[_-1]>=0?Math.abs(F*Math.sqrt(1+V*V/(F*F))):-Math.abs(F*Math.sqrt(1+V*V/(F*F))),F=v[_-1]/I,V=v[_]/I,1===F)return 798;if(0===F){for(w=M+1;w<=m;w+=1)I=v[_-1],v[_-1]=v[_],v[_]=I,_+=w;for(w=1;w<=s;w+=1)I=t[w][M],t[w][M]=t[w][M+1],t[w][M+1]=I}else{for(z=V/(1+F),w=M+1;w<=m;w+=1)I=F*v[_-1]+V*v[_],v[_]=z*(v[_-1]+I)-v[_],v[_-1]=I,_+=w;for(w=1;w<=s;w+=1)I=F*t[w][M]+V*t[w][M+1],t[w][M+1]=z*(t[w][M]+I)-t[w][M+1],t[w][M]=I}return 0}function Y(){for(_=x-M,w=1;w<=M;w+=1)v[_]=v[x],x+=1,_+=1;return v[C+M]=v[C+M+1],f[M]=f[M+1],M+=1,M<m?797:0}function Z(){return v[C+m]=v[C+m+1],v[C+m+1]=0,f[m]=0,m-=1,g[2]=g[2]+1,0}m=0,g[1]=0,g[2]=0,q=0;while(1){if(q=W(),999===q)return;while(1){if(q=$(),0===q)break;if(999===q)return;if(700===q)if(M===m)Z();else{while(1)if(X(),q=Y(),797!==q)break;Z()}}}}function a(t,n,i,o,a,u){t=e(t),n=e(n),i=e(i);var l,c,h,d,p,f,m=[],g=[],v=[],y=[],w=[];if(a=a||0,u=u?e(u):[void 0,0],o=o?e(o):[],c=t.length-1,h=i[1].length-1,!o)for(l=1;l<=h;l+=1)o[l]=0;for(l=1;l<=h;l+=1)g[l]=0;for(d=0,p=Math.min(c,h),l=1;l<=c;l+=1)v[l]=0;for(m[1]=0,l=1;l<=2*c+p*(p+5)/2+2*h+1;l+=1)y[l]=0;for(l=1;l<=2;l+=1)w[l]=0;return s(t,n,c,c,v,m,i,o,c,h,a,g,d,w,y,u),f="",1===u[1]&&(f="constraints are inconsistent, no solution!"),2===u[1]&&(f="matrix D in quadratic function is not positive definite!"),{solution:r(v),value:r(m),unconstrained_solution:r(n),iterations:r(w),iact:r(g),message:f}}t.solveQP=a}(numeric),numeric.svd=function(t){var e,r=numeric.epsilon,n=1e-64/r,i=50,o=0,s=0,a=0,u=0,l=0,c=numeric.clone(t),h=c.length,d=c[0].length;if(h<d)throw"Need more rows than columns";var p=new Array(d),f=new Array(d);for(s=0;s<d;s++)p[s]=f[s]=0;var m=numeric.rep([d,d],0);function g(t,e){return t=Math.abs(t),e=Math.abs(e),t>e?t*Math.sqrt(1+e*e/t/t):0==e?t:e*Math.sqrt(1+t*t/e/e)}var v=0,y=0,w=0,b=0,x=0,_=0,S=0;for(s=0;s<d;s++){for(p[s]=y,S=0,l=s+1,a=s;a<h;a++)S+=c[a][s]*c[a][s];if(S<=n)y=0;else for(v=c[s][s],y=Math.sqrt(S),v>=0&&(y=-y),w=v*y-S,c[s][s]=v-y,a=l;a<d;a++){for(S=0,u=s;u<h;u++)S+=c[u][s]*c[u][a];for(v=S/w,u=s;u<h;u++)c[u][a]+=v*c[u][s]}for(f[s]=y,S=0,a=l;a<d;a++)S+=c[s][a]*c[s][a];if(S<=n)y=0;else{for(v=c[s][s+1],y=Math.sqrt(S),v>=0&&(y=-y),w=v*y-S,c[s][s+1]=v-y,a=l;a<d;a++)p[a]=c[s][a]/w;for(a=l;a<h;a++){for(S=0,u=l;u<d;u++)S+=c[a][u]*c[s][u];for(u=l;u<d;u++)c[a][u]+=S*p[u]}}x=Math.abs(f[s])+Math.abs(p[s]),x>b&&(b=x)}for(s=d-1;-1!=s;s+=-1){if(0!=y){for(w=y*c[s][s+1],a=l;a<d;a++)m[a][s]=c[s][a]/w;for(a=l;a<d;a++){for(S=0,u=l;u<d;u++)S+=c[s][u]*m[u][a];for(u=l;u<d;u++)m[u][a]+=S*m[u][s]}}for(a=l;a<d;a++)m[s][a]=0,m[a][s]=0;m[s][s]=1,y=p[s],l=s}for(s=d-1;-1!=s;s+=-1){for(l=s+1,y=f[s],a=l;a<d;a++)c[s][a]=0;if(0!=y){for(w=c[s][s]*y,a=l;a<d;a++){for(S=0,u=l;u<h;u++)S+=c[u][s]*c[u][a];for(v=S/w,u=s;u<h;u++)c[u][a]+=v*c[u][s]}for(a=s;a<h;a++)c[a][s]=c[a][s]/y}else for(a=s;a<h;a++)c[a][s]=0;c[s][s]+=1}for(r*=b,u=d-1;-1!=u;u+=-1)for(var M=0;M<i;M++){var E=!1;for(l=u;-1!=l;l+=-1){if(Math.abs(p[l])<=r){E=!0;break}if(Math.abs(f[l-1])<=r)break}if(!E){o=0,S=1;var T=l-1;for(s=l;s<u+1;s++){if(v=S*p[s],p[s]=o*p[s],Math.abs(v)<=r)break;for(y=f[s],w=g(v,y),f[s]=w,o=y/w,S=-v/w,a=0;a<h;a++)x=c[a][T],_=c[a][s],c[a][T]=x*o+_*S,c[a][s]=-x*S+_*o}}if(_=f[u],l==u){if(_<0)for(f[u]=-_,a=0;a<d;a++)m[a][u]=-m[a][u];break}if(M>=i-1)throw"Error: no convergence.";for(b=f[l],x=f[u-1],y=p[u-1],w=p[u],v=((x-_)*(x+_)+(y-w)*(y+w))/(2*w*x),y=g(v,1),v=v<0?((b-_)*(b+_)+w*(x/(v-y)-w))/b:((b-_)*(b+_)+w*(x/(v+y)-w))/b,o=1,S=1,s=l+1;s<u+1;s++){for(y=p[s],x=f[s],w=S*y,y*=o,_=g(v,w),p[s-1]=_,o=v/_,S=w/_,v=b*o+y*S,y=-b*S+y*o,w=x*S,x*=o,a=0;a<d;a++)b=m[a][s-1],_=m[a][s],m[a][s-1]=b*o+_*S,m[a][s]=-b*S+_*o;for(_=g(v,w),f[s-1]=_,o=v/_,S=w/_,v=o*y+S*x,b=-S*y+o*x,a=0;a<h;a++)x=c[a][s-1],_=c[a][s],c[a][s-1]=x*o+_*S,c[a][s]=-x*S+_*o}p[l]=0,p[u]=v,f[u]=b}for(s=0;s<f.length;s++)f[s]<r&&(f[s]=0);for(s=0;s<d;s++)for(a=s-1;a>=0;a--)if(f[a]<f[s]){for(o=f[a],f[a]=f[s],f[s]=o,u=0;u<c.length;u++)e=c[u][s],c[u][s]=c[u][a],c[u][a]=e;for(u=0;u<m.length;u++)e=m[u][s],m[u][s]=m[u][a],m[u][a]=e;s=a}return{U:c,S:f,V:m}}}).call(this,__webpack_require__("c8ba"))},cb29:function(t,e,r){var n=r("23e7"),i=r("81d5"),o=r("44d2");n({target:"Array",proto:!0},{fill:i}),o("fill")},cd26:function(t,e,r){"use strict";var n=r("ebb5"),i=n.aTypedArray,o=n.exportTypedArrayMethod,s=Math.floor;o("reverse",(function(){var t,e=this,r=i(e).length,n=s(r/2),o=0;while(o<n)t=e[o],e[o++]=e[--r],e[r]=t;return e}))},d0ea:function(t,e,r){var n=r("808a"),i=(r("16c3"),r("1f8f"),r("5915"),r("17fb")),o=r("faa1").EventEmitter,s=function(t){this.type=t.type,this.state=t.state};e.chooseProtocol=function(t){var e;switch(t.version){case 1:case 2:case 3:case 4:case 5:case 6:e=a(t),e.sendBackground=function(t,r){t.send(e.encode({background:r}))},e.sendFocused=function(t,r){t.send(e.encode({focused:r}))},e.sendOptimizeHMD=function(t,r){t.send(e.encode({optimizeHMD:r}))};break;default:throw"unrecognized version"}return e};var a=e.JSONProtocol=function(t){var e=function(t){if(t.event)return new s(t.event);e.emit("beforeFrameCreated",t);var r=new n(t);return e.emit("afterFrameCreated",r,t),r};return e.encode=function(t){return JSON.stringify(t)},e.version=t.version,e.serviceVersion=t.serviceVersion,e.versionLong="Version "+t.version,e.type="protocol",i.extend(e,o.prototype),e}},d139:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").find,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("find",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},d30e:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d="valid"+o,p=t.opts.$data&&a&&a.$data;if(p?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a,(a||p)&&!1!==t.opts.uniqueItems){p&&(i+=" var "+d+"; if ("+n+" === false || "+n+" === undefined) "+d+" = true; else if (typeof "+n+" != 'boolean') "+d+" = false; else { "),i+=" var i = "+h+".length , "+d+" = true , j; if (i > 1) { ";var f=t.schema.items&&t.schema.items.type,m=Array.isArray(f);if(!f||"object"==f||"array"==f||m&&(f.indexOf("object")>=0||f.indexOf("array")>=0))i+=" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+d+" = false; break outer; } } } ";else{i+=" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; ";var g="checkDataType"+(m?"s":"");i+=" if ("+t.util[g](f,"item",t.opts.strictNumbers,!0)+") continue; ",m&&(i+=" if (typeof item == 'string') item = '\"' + item; "),i+=" if (typeof itemIndices[item] == 'number') { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } "}i+=" } ",p&&(i+="  }  "),i+=" if (!"+d+") {   ";var v=v||[];v.push(i),i="",!1!==t.createErrors?(i+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { i: i, j: j } ",!1!==t.opts.messages&&(i+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),t.opts.verbose&&(i+=" , schema:  ",i+=p?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var y=i;i=v.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+y+"]); ":i+=" validate.errors = ["+y+"]; return false; ":i+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+=" } ",c&&(i+=" else { ")}else c&&(i+=" if (true) { ");return i}},d419:function(t,e){var r=t.exports=function(t){this.steps=[],this.controller=t};r.prototype.addStep=function(t){this.steps.push(t)},r.prototype.run=function(t){for(var e=this.steps.length,r=0;r!=e;r++){if(!t)break;t=this.steps[r](t)}return t},r.prototype.removeStep=function(t){var e=this.steps.indexOf(t);if(-1===e)throw"Step not found in pipeline";this.steps.splice(e,1)},r.prototype.addWrappedStep=function(t,e){var r=this.controller,n=function(n){var i,o,s;for(i="frame"==t?[n]:n[t+"s"]||[],o=0,s=i.length;o<s;o++)e.call(r,i[o]);return n};return this.addStep(n),n}},d4c2:function(t,e){t.exports=function(){return function(t){var e=t.pointables.sort((function(t,e){return t.z-e.z}))[0];return e&&e.valid&&(t.cursorPosition=e.tipPosition),t}}},d4ec:function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.d(e,"a",(function(){return n}))},d508:function(t,e,r){"use strict";t.exports=function(t,e,r){var n="",i=!0===t.schema.$async,o=t.util.schemaHasRulesExcept(t.schema,t.RULES.all,"$ref"),s=t.self._getId(t.schema);if(t.opts.strictKeywords){var a=t.util.schemaUnknownRules(t.schema,t.RULES.keywords);if(a){var u="unknown keyword: "+a;if("log"!==t.opts.strictKeywords)throw new Error(u);t.logger.warn(u)}}if(t.isTop&&(n+=" var validate = ",i&&(t.async=!0,n+="async "),n+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",s&&(t.opts.sourceCode||t.opts.processCode)&&(n+=" /*# sourceURL="+s+" */ ")),"boolean"==typeof t.schema||!o&&!t.schema.$ref){e="false schema";var l=t.level,c=t.dataLevel,h=t.schema[e],d=t.schemaPath+t.util.getProperty(e),p=t.errSchemaPath+"/"+e,f=!t.opts.allErrors,m="data"+(c||""),g="valid"+l;if(!1===t.schema){t.isTop?f=!0:n+=" var "+g+" = false; ";var v=v||[];v.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(x||"false schema")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(p)+" , params: {} ",!1!==t.opts.messages&&(n+=" , message: 'boolean schema is false' "),t.opts.verbose&&(n+=" , schema: false , parentSchema: validate.schema"+t.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";var y=n;n=v.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else t.isTop?n+=i?" return data; ":" validate.errors = null; return true; ":n+=" var "+g+" = true; ";return t.isTop&&(n+=" }; return validate; "),n}if(t.isTop){var w=t.isTop;l=t.level=0,c=t.dataLevel=0,m="data";if(t.rootId=t.resolve.fullPath(t.self._getId(t.root.schema)),t.baseId=t.baseId||t.rootId,delete t.isTop,t.dataPathArr=[void 0],void 0!==t.schema.default&&t.opts.useDefaults&&t.opts.strictDefaults){var b="default is ignored in the schema root";if("log"!==t.opts.strictDefaults)throw new Error(b);t.logger.warn(b)}n+=" var vErrors = null; ",n+=" var errors = 0;     ",n+=" if (rootData === undefined) rootData = data; "}else{l=t.level,c=t.dataLevel,m="data"+(c||"");if(s&&(t.baseId=t.resolve.url(t.baseId,s)),i&&!t.async)throw new Error("async schema in sync schema");n+=" var errs_"+l+" = errors;"}g="valid"+l,f=!t.opts.allErrors;var x,_="",S="",M=t.schema.type,E=Array.isArray(M);if(M&&t.opts.nullable&&!0===t.schema.nullable&&(E?-1==M.indexOf("null")&&(M=M.concat("null")):"null"!=M&&(M=[M,"null"],E=!0)),E&&1==M.length&&(M=M[0],E=!1),t.schema.$ref&&o){if("fail"==t.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+t.errSchemaPath+'" (see option extendRefs)');!0!==t.opts.extendRefs&&(o=!1,t.logger.warn('$ref: keywords ignored in schema at path "'+t.errSchemaPath+'"'))}if(t.schema.$comment&&t.opts.$comment&&(n+=" "+t.RULES.all.$comment.code(t,"$comment")),M){if(t.opts.coerceTypes)var T=t.util.coerceToTypes(t.opts.coerceTypes,M);var A=t.RULES.types[M];if(T||E||!0===A||A&&!et(A)){d=t.schemaPath+".type",p=t.errSchemaPath+"/type",d=t.schemaPath+".type",p=t.errSchemaPath+"/type";var P=E?"checkDataTypes":"checkDataType";if(n+=" if ("+t.util[P](M,m,t.opts.strictNumbers,!0)+") { ",T){var C="dataType"+l,R="coerced"+l;n+=" var "+C+" = typeof "+m+"; ","array"==t.opts.coerceTypes&&(n+=" if ("+C+" == 'object' && Array.isArray("+m+")) "+C+" = 'array'; "),n+=" var "+R+" = undefined; ";var L="",O=T;if(O){var I,D=-1,N=O.length-1;while(D<N)I=O[D+=1],D&&(n+=" if ("+R+" === undefined) { ",L+="}"),"array"==t.opts.coerceTypes&&"array"!=I&&(n+=" if ("+C+" == 'array' && "+m+".length == 1) { "+R+" = "+m+" = "+m+"[0]; "+C+" = typeof "+m+";  } "),"string"==I?n+=" if ("+C+" == 'number' || "+C+" == 'boolean') "+R+" = '' + "+m+"; else if ("+m+" === null) "+R+" = ''; ":"number"==I||"integer"==I?(n+=" if ("+C+" == 'boolean' || "+m+" === null || ("+C+" == 'string' && "+m+" && "+m+" == +"+m+" ","integer"==I&&(n+=" && !("+m+" % 1)"),n+=")) "+R+" = +"+m+"; "):"boolean"==I?n+=" if ("+m+" === 'false' || "+m+" === 0 || "+m+" === null) "+R+" = false; else if ("+m+" === 'true' || "+m+" === 1) "+R+" = true; ":"null"==I?n+=" if ("+m+" === '' || "+m+" === 0 || "+m+" === false) "+R+" = null; ":"array"==t.opts.coerceTypes&&"array"==I&&(n+=" if ("+C+" == 'string' || "+C+" == 'number' || "+C+" == 'boolean' || "+m+" == null) "+R+" = ["+m+"]; ")}n+=" "+L+" if ("+R+" === undefined) {   ";v=v||[];v.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(x||"type")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(p)+" , params: { type: '",n+=E?""+M.join(","):""+M,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=E?""+M.join(","):""+M,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=v.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } else {  ";var k=c?"data"+(c-1||""):"parentData",F=c?t.dataPathArr[c]:"parentDataProperty";n+=" "+m+" = "+R+"; ",c||(n+="if ("+k+" !== undefined)"),n+=" "+k+"["+F+"] = "+R+"; } "}else{v=v||[];v.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(x||"type")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(p)+" , params: { type: '",n+=E?""+M.join(","):""+M,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=E?""+M.join(","):""+M,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=v.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}n+=" } "}}if(t.schema.$ref&&!o)n+=" "+t.RULES.all.$ref.code(t,"$ref")+" ",f&&(n+=" } if (errors === ",n+=w?"0":"errs_"+l,n+=") { ",S+="}");else{var V=t.RULES;if(V){var z=-1,U=V.length-1;while(z<U)if(A=V[z+=1],et(A)){if(A.type&&(n+=" if ("+t.util.checkDataType(A.type,m,t.opts.strictNumbers)+") { "),t.opts.useDefaults)if("object"==A.type&&t.schema.properties){h=t.schema.properties;var j=Object.keys(h),B=j;if(B){var H,G=-1,q=B.length-1;while(G<q){H=B[G+=1];var W=h[H];if(void 0!==W.default){var $=m+t.util.getProperty(H);if(t.compositeRule){if(t.opts.strictDefaults){b="default is ignored for: "+$;if("log"!==t.opts.strictDefaults)throw new Error(b);t.logger.warn(b)}}else n+=" if ("+$+" === undefined ","empty"==t.opts.useDefaults&&(n+=" || "+$+" === null || "+$+" === '' "),n+=" ) "+$+" = ","shared"==t.opts.useDefaults?n+=" "+t.useDefault(W.default)+" ":n+=" "+JSON.stringify(W.default)+" ",n+="; "}}}}else if("array"==A.type&&Array.isArray(t.schema.items)){var X=t.schema.items;if(X){D=-1;var Y=X.length-1;while(D<Y)if(W=X[D+=1],void 0!==W.default){$=m+"["+D+"]";if(t.compositeRule){if(t.opts.strictDefaults){b="default is ignored for: "+$;if("log"!==t.opts.strictDefaults)throw new Error(b);t.logger.warn(b)}}else n+=" if ("+$+" === undefined ","empty"==t.opts.useDefaults&&(n+=" || "+$+" === null || "+$+" === '' "),n+=" ) "+$+" = ","shared"==t.opts.useDefaults?n+=" "+t.useDefault(W.default)+" ":n+=" "+JSON.stringify(W.default)+" ",n+="; "}}}var Z=A.rules;if(Z){var J,Q=-1,K=Z.length-1;while(Q<K)if(J=Z[Q+=1],rt(J)){var tt=J.code(t,J.keyword,A.type);tt&&(n+=" "+tt+" ",f&&(_+="}"))}}if(f&&(n+=" "+_+" ",_=""),A.type&&(n+=" } ",M&&M===A.type&&!T)){n+=" else { ";d=t.schemaPath+".type",p=t.errSchemaPath+"/type",v=v||[];v.push(n),n="",!1!==t.createErrors?(n+=" { keyword: '"+(x||"type")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(p)+" , params: { type: '",n+=E?""+M.join(","):""+M,n+="' } ",!1!==t.opts.messages&&(n+=" , message: 'should be ",n+=E?""+M.join(","):""+M,n+="' "),t.opts.verbose&&(n+=" , schema: validate.schema"+d+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+m+" "),n+=" } "):n+=" {} ";y=n;n=v.pop(),!t.compositeRule&&f?t.async?n+=" throw new ValidationError(["+y+"]); ":n+=" validate.errors = ["+y+"]; return false; ":n+=" var err = "+y+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" } "}f&&(n+=" if (errors === ",n+=w?"0":"errs_"+l,n+=") { ",S+="}")}}}function et(t){for(var e=t.rules,r=0;r<e.length;r++)if(rt(e[r]))return!0}function rt(e){return void 0!==t.schema[e.keyword]||e.implements&&nt(e)}function nt(e){for(var r=e.implements,n=0;n<r.length;n++)if(void 0!==t.schema[r[n]])return!0}return f&&(n+=" "+S+" "),w?(i?(n+=" if (errors === 0) return data;           ",n+=" else throw new ValidationError(vErrors); "):(n+=" validate.errors = vErrors; ",n+=" return errors === 0;       "),n+=" }; return validate;"):n+=" var "+g+" = errors === errs_"+l+";",n}},d58f:function(t,e,r){var n=r("1c0b"),i=r("7b0b"),o=r("44ad"),s=r("50c4"),a=function(t){return function(e,r,a,u){n(r);var l=i(e),c=o(l),h=s(l.length),d=t?h-1:0,p=t?-1:1;if(a<2)while(1){if(d in c){u=c[d],d+=p;break}if(d+=p,t?d<0:h<=d)throw TypeError("Reduce of empty array with no initial value")}for(;t?d>=0:h>d;d+=p)d in c&&(u=r(u,c[d],d,l));return u}};t.exports={left:a(!1),right:a(!0)}},d5d6:function(t,e,r){"use strict";var n=r("ebb5"),i=r("b727").forEach,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("forEach",(function(t){i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},d6ec:function(t,e,r){var n,i,o;
/*!
 * jQuery.scrollTo
 * Copyright (c) 2007-2015 Ariel Flesler - aflesler<a>gmail<d>com | http://flesler.blogspot.com
 * Licensed under MIT
 * http://flesler.blogspot.com/2007/10/jqueryscrollto.html
 * @projectDescription Lightweight, cross-browser and highly customizable animated scrolling with jQuery
 * @author Ariel Flesler
 * @version 2.1.2
 */(function(s){"use strict";i=[r("1157")],n=s,o="function"===typeof n?n.apply(e,i):n,void 0===o||(t.exports=o)})((function(t){"use strict";var e=t.scrollTo=function(e,r,n){return t(window).scrollTo(e,r,n)};function r(e){return!e.nodeName||-1!==t.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])}function n(e){return t.isFunction(e)||t.isPlainObject(e)?e:{top:e,left:e}}return e.defaults={axis:"xy",duration:0,limit:!0},t.fn.scrollTo=function(i,o,s){"object"===typeof o&&(s=o,o=0),"function"===typeof s&&(s={onAfter:s}),"max"===i&&(i=9e9),s=t.extend({},e.defaults,s),o=o||s.duration;var a=s.queue&&s.axis.length>1;return a&&(o/=2),s.offset=n(s.offset),s.over=n(s.over),this.each((function(){if(null!==i){var u,l=r(this),c=l?this.contentWindow||window:this,h=t(c),d=i,p={};switch(typeof d){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(d)){d=n(d);break}d=l?t(d):t(d,c);case"object":if(0===d.length)return;(d.is||d.style)&&(u=(d=t(d)).offset())}var f=t.isFunction(s.offset)&&s.offset(c,d)||s.offset;t.each(s.axis.split(""),(function(t,r){var n="x"===r?"Left":"Top",i=n.toLowerCase(),o="scroll"+n,g=h[o](),v=e.max(c,r);if(u)p[o]=u[i]+(l?0:g-h.offset()[i]),s.margin&&(p[o]-=parseInt(d.css("margin"+n),10)||0,p[o]-=parseInt(d.css("border"+n+"Width"),10)||0),p[o]+=f[i]||0,s.over[i]&&(p[o]+=d["x"===r?"width":"height"]()*s.over[i]);else{var y=d[i];p[o]=y.slice&&"%"===y.slice(-1)?parseFloat(y)/100*v:y}s.limit&&/^\d+$/.test(p[o])&&(p[o]=p[o]<=0?0:Math.min(p[o],v)),!t&&s.axis.length>1&&(g===p[o]?p={}:a&&(m(s.onAfterFirst),p={}))})),m(s.onAfter)}function m(e){var r=t.extend({},s,{queue:!0,duration:o,complete:e&&function(){e.call(c,d,s)}});h.animate(p,r)}}))},e.max=function(e,n){var i="x"===n?"Width":"Height",o="scroll"+i;if(!r(e))return e[o]-t(e)[i.toLowerCase()]();var s="client"+i,a=e.ownerDocument||e.document,u=a.documentElement,l=a.body;return Math.max(u[o],l[o])-Math.min(u[s],l[s])},t.Tween.propHooks.scrollLeft=t.Tween.propHooks.scrollTop={get:function(e){return t(e.elem)[e.prop]()},set:function(e){var r=this.get(e);if(e.options.interrupt&&e._last&&e._last!==r)return t(e.elem).stop();var n=Math.round(e.now);r!==n&&(t(e.elem)[e.prop](n),e._last=this.get(e))}},e}))},da3b:function(t,e,r){"use strict";t.exports=function(t,e,r){var n,i=" ",o=t.level,s=t.dataLevel,a=t.schema[e],u=t.schemaPath+t.util.getProperty(e),l=t.errSchemaPath+"/"+e,c=!t.opts.allErrors,h="data"+(s||""),d=t.opts.$data&&a&&a.$data;if(d?(i+=" var schema"+o+" = "+t.util.getData(a.$data,s,t.dataPathArr)+"; ",n="schema"+o):n=a,!d&&"number"!=typeof a)throw new Error(e+" must be number");var p="maxItems"==e?">":"<";i+="if ( ",d&&(i+=" ("+n+" !== undefined && typeof "+n+" != 'number') || "),i+=" "+h+".length "+p+" "+n+") { ";var f=e,m=m||[];m.push(i),i="",!1!==t.createErrors?(i+=" { keyword: '"+(f||"_limitItems")+"' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(l)+" , params: { limit: "+n+" } ",!1!==t.opts.messages&&(i+=" , message: 'should NOT have ",i+="maxItems"==e?"more":"fewer",i+=" than ",i+=d?"' + "+n+" + '":""+a,i+=" items' "),t.opts.verbose&&(i+=" , schema:  ",i+=d?"validate.schema"+u:""+a,i+="         , parentSchema: validate.schema"+t.schemaPath+" , data: "+h+" "),i+=" } "):i+=" {} ";var g=i;return i=m.pop(),!t.compositeRule&&c?t.async?i+=" throw new ValidationError(["+g+"]); ":i+=" validate.errors = ["+g+"]; return false; ":i+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",i+="} ",c&&(i+=" else { "),i}},dd93:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d="errs__"+i,p=t.util.copy(t);p.level++;var f="valid"+p.level,m=t.schema["then"],g=t.schema["else"],v=void 0!==m&&(t.opts.strictKeywords?"object"==typeof m&&Object.keys(m).length>0:t.util.schemaHasRules(m,t.RULES.all)),y=void 0!==g&&(t.opts.strictKeywords?"object"==typeof g&&Object.keys(g).length>0:t.util.schemaHasRules(g,t.RULES.all)),w=p.baseId;if(v||y){var b;p.createErrors=!1,p.schema=s,p.schemaPath=a,p.errSchemaPath=u,n+=" var "+d+" = errors; var "+h+" = true;  ";var x=t.compositeRule;t.compositeRule=p.compositeRule=!0,n+="  "+t.validate(p)+" ",p.baseId=w,p.createErrors=!0,n+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",t.compositeRule=p.compositeRule=x,v?(n+=" if ("+f+") {  ",p.schema=t.schema["then"],p.schemaPath=t.schemaPath+".then",p.errSchemaPath=t.errSchemaPath+"/then",n+="  "+t.validate(p)+" ",p.baseId=w,n+=" "+h+" = "+f+"; ",v&&y?(b="ifClause"+i,n+=" var "+b+" = 'then'; "):b="'then'",n+=" } ",y&&(n+=" else { ")):n+=" if (!"+f+") { ",y&&(p.schema=t.schema["else"],p.schemaPath=t.schemaPath+".else",p.errSchemaPath=t.errSchemaPath+"/else",n+="  "+t.validate(p)+" ",p.baseId=w,n+=" "+h+" = "+f+"; ",v&&y?(b="ifClause"+i,n+=" var "+b+" = 'else'; "):b="'else'",n+=" } "),n+=" if (!"+h+") {   var err =   ",!1!==t.createErrors?(n+=" { keyword: 'if' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { failingKeyword: "+b+" } ",!1!==t.opts.messages&&(n+=" , message: 'should match \"' + "+b+" + '\" schema' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!t.compositeRule&&l&&(t.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; "),n+=" }   ",l&&(n+=" else { ")}else l&&(n+=" if (true) { ");return n}},df2a:function(t,e,r){var n=r("9052"),i=n.vec3,o=t.exports=function(t){this.valid=!0,this.center=t.center,this.size=t.size,this.width=t.size[0],this.height=t.size[1],this.depth=t.size[2]};o.prototype.denormalizePoint=function(t){return i.fromValues((t[0]-.5)*this.size[0]+this.center[0],(t[1]-.5)*this.size[1]+this.center[1],(t[2]-.5)*this.size[2]+this.center[2])},o.prototype.normalizePoint=function(t,e){var r=i.fromValues((t[0]-this.center[0])/this.size[0]+.5,(t[1]-this.center[1])/this.size[1]+.5,(t[2]-this.center[2])/this.size[2]+.5);return e&&(r[0]=Math.min(Math.max(r[0],0),1),r[1]=Math.min(Math.max(r[1],0),1),r[2]=Math.min(Math.max(r[2],0),1)),r},o.prototype.toString=function(){return"InteractionBox [ width:"+this.width+" | height:"+this.height+" | depth:"+this.depth+" ]"},o.Invalid={valid:!1}},e099:function(t,e,r){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,r,a){return e=e||"&",r=r||"=",null===t&&(t=void 0),"object"===typeof t?o(s(t),(function(s){var a=encodeURIComponent(n(s))+r;return i(t[s])?o(t[s],(function(t){return a+encodeURIComponent(n(t))})).join(e):a+encodeURIComponent(n(t[s]))})).join(e):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var s=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},e303:function(t,e,r){var n=t.exports=r("956e"),i=r("17fb"),o=t.exports=function(t){n.call(this,t);var e=this;this.on("ready",(function(){e.startFocusLoop()})),this.on("disconnect",(function(){e.stopFocusLoop()}))};i.extend(o.prototype,n.prototype),o.__proto__=n,o.prototype.useSecure=function(){return"https:"===location.protocol},o.prototype.getScheme=function(){return this.useSecure()?"wss:":"ws:"},o.prototype.getPort=function(){return this.useSecure()?6436:6437},o.prototype.setupSocket=function(){var t=this,e=new WebSocket(this.getUrl());return e.onopen=function(){t.handleOpen()},e.onclose=function(e){t.handleClose(e["code"],e["reason"])},e.onmessage=function(e){t.handleData(e.data)},e.onerror=function(e){t.useSecure()&&"wss:"===t.scheme&&(t.scheme="ws:",t.port=6437,t.disconnect(),t.connect())},e},o.prototype.startFocusLoop=function(){if(!this.focusDetectorTimer){var t=this,e=null;e="undefined"!==typeof document.hidden?"hidden":"undefined"!==typeof document.mozHidden?"mozHidden":"undefined"!==typeof document.msHidden?"msHidden":"undefined"!==typeof document.webkitHidden?"webkitHidden":void 0,void 0===t.windowVisible&&(t.windowVisible=void 0===e||!1===document[e]);var r=window.addEventListener("focus",(function(e){t.windowVisible=!0,i()})),n=window.addEventListener("blur",(function(e){t.windowVisible=!1,i()}));this.on("disconnect",(function(){window.removeEventListener("focus",r),window.removeEventListener("blur",n)}));var i=function(){var r=void 0===e||!1===document[e];t.reportFocus(r&&t.windowVisible)};i(),this.focusDetectorTimer=setInterval(i,100)}},o.prototype.stopFocusLoop=function(){this.focusDetectorTimer&&(clearTimeout(this.focusDetectorTimer),delete this.focusDetectorTimer)}},e58c:function(t,e,r){"use strict";var n=r("fc6a"),i=r("a691"),o=r("50c4"),s=r("a640"),a=r("ae40"),u=Math.min,l=[].lastIndexOf,c=!!l&&1/[1].lastIndexOf(1,-0)<0,h=s("lastIndexOf"),d=a("indexOf",{ACCESSORS:!0,1:0}),p=c||!h||!d;t.exports=p?function(t){if(c)return l.apply(this,arguments)||0;var e=n(this),r=o(e.length),s=r-1;for(arguments.length>1&&(s=u(s,i(arguments[1]))),s<0&&(s=r+s);s>=0;s--)if(s in e&&e[s]===t)return s||0;return-1}:l},e735:function(t,e){(function(){function t(t,e){try{for(var r in e)Object.defineProperty(t.prototype,r,{value:e[r],enumerable:!1})}catch(n){t.prototype=e}}function e(t){var e=-1,r=t.length,n=[];while(++e<r)n.push(t[e]);return n}function r(t){return Array.prototype.slice.call(t)}function n(){}function i(t){return t}function o(){return this}function s(){return!0}function a(t){return"function"===typeof t?t:function(){return t}}function u(t,e,r){return function(){var n=r.apply(e,arguments);return arguments.length?t:n}}function l(t){return null!=t&&!isNaN(t)}function c(t){return t.length}function h(t){return null==t}function d(t){return t.trim().replace(/\s+/g," ")}function p(t){var e=1;while(t*e%1)e*=10;return e}function f(){}function m(t){function e(){var e,n=r,i=-1,o=n.length;while(++i<o)(e=n[i].on)&&e.apply(this,arguments);return t}var r=[],i=new n;return e.on=function(e,n){var o,s=i.get(e);return arguments.length<2?s&&s.on:(s&&(s.on=null,r=r.slice(0,o=r.indexOf(s)).concat(r.slice(o+1)),i.remove(e)),n&&r.push(i.set(e,{on:n})),t)},e}function g(t,e){return e-(t?1+Math.floor(Math.log(t+Math.pow(10,1+Math.floor(Math.log(t)/Math.LN10)-e))/Math.LN10):1)}function v(t){return t+""}function y(t){var e=t.lastIndexOf("."),r=e>=0?t.substring(e):(e=t.length,""),n=[];while(e>0)n.push(t.substring(e-=3,e+3));return n.reverse().join(",")+r}function w(t,e){var r=Math.pow(10,3*Math.abs(8-e));return{scale:e>8?function(t){return t/r}:function(t){return t*r},symbol:t}}function b(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function x(t){return function(e){return 1-t(1-e)}}function _(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function S(t){return t}function M(t){return function(e){return Math.pow(e,t)}}function E(t){return 1-Math.cos(t*Math.PI/2)}function T(t){return Math.pow(2,10*(t-1))}function A(t){return 1-Math.sqrt(1-t*t)}function P(t,e){var r;return arguments.length<2&&(e=.45),arguments.length<1?(t=1,r=e/4):r=e/(2*Math.PI)*Math.asin(1/t),function(n){return 1+t*Math.pow(2,10*-n)*Math.sin(2*(n-r)*Math.PI/e)}}function C(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function R(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function L(){d3.event.stopPropagation(),d3.event.preventDefault()}function O(){var t,e=d3.event;while(t=e.sourceEvent)e=t;return e}function I(t){var e=new f,r=0,n=arguments.length;while(++r<n)e[arguments[r]]=m(e);return e.of=function(r,n){return function(i){try{var o=i.sourceEvent=d3.event;i.target=t,d3.event=i,e[i.type].apply(r,n)}finally{d3.event=o}}},e}function D(t){var e=[t.a,t.b],r=[t.c,t.d],n=k(e),i=N(e,r),o=k(F(r,e,-i))||0;e[0]*r[1]<r[0]*e[1]&&(e[0]*=-1,e[1]*=-1,n*=-1,i*=-1),this.rotate=(n?Math.atan2(e[1],e[0]):Math.atan2(-r[0],r[1]))*oi,this.translate=[t.e,t.f],this.scale=[n,o],this.skew=o?Math.atan2(i,o)*oi:0}function N(t,e){return t[0]*e[0]+t[1]*e[1]}function k(t){var e=Math.sqrt(N(t,t));return e&&(t[0]/=e,t[1]/=e),e}function F(t,e,r){return t[0]+=r*e[0],t[1]+=r*e[1],t}function V(t){return"transform"==t?d3.interpolateTransform:d3.interpolate}function z(t,e){return e=e-(t=+t)?1/(e-t):0,function(r){return(r-t)*e}}function U(t,e){return e=e-(t=+t)?1/(e-t):0,function(r){return Math.max(0,Math.min(1,(r-t)*e))}}function j(){}function B(t,e,r){return new H(t,e,r)}function H(t,e,r){this.r=t,this.g=e,this.b=r}function G(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function q(t,e,r){var n,i,o,s=0,a=0,u=0;if(n=/([a-z]+)\((.*)\)/i.exec(t),n)switch(i=n[2].split(","),n[1]){case"hsl":return r(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return e(Y(i[0]),Y(i[1]),Y(i[2]))}return(o=li.get(t))?e(o.r,o.g,o.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(s=t.charAt(1),s+=s,a=t.charAt(2),a+=a,u=t.charAt(3),u+=u):7===t.length&&(s=t.substring(1,3),a=t.substring(3,5),u=t.substring(5,7)),s=parseInt(s,16),a=parseInt(a,16),u=parseInt(u,16)),e(s,a,u))}function W(t,e,r){var n,i,o=Math.min(t/=255,e/=255,r/=255),s=Math.max(t,e,r),a=s-o,u=(s+o)/2;return a?(i=u<.5?a/(s+o):a/(2-s-o),n=t==s?(e-r)/a+(e<r?6:0):e==s?(r-t)/a+2:(t-e)/a+4,n*=60):i=n=0,Z(n,i,u)}function $(t,e,r){t=X(t),e=X(e),r=X(r);var n=at((.4124564*t+.3575761*e+.1804375*r)/pi),i=at((.2126729*t+.7151522*e+.072175*r)/fi),o=at((.0193339*t+.119192*e+.9503041*r)/mi);return rt(116*i-16,500*(n-i),200*(i-o))}function X(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Y(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function Z(t,e,r){return new J(t,e,r)}function J(t,e,r){this.h=t,this.s=e,this.l=r}function Q(t,e,r){function n(t){return t>360?t-=360:t<0&&(t+=360),t<60?o+(s-o)*t/60:t<180?s:t<240?o+(s-o)*(240-t)/60:o}function i(t){return Math.round(255*n(t))}var o,s;return t%=360,t<0&&(t+=360),e=e<0?0:e>1?1:e,r=r<0?0:r>1?1:r,s=r<=.5?r*(1+e):r+e-r*e,o=2*r-s,B(i(t+120),i(t),i(t-120))}function K(t,e,r){return new tt(t,e,r)}function tt(t,e,r){this.h=t,this.c=e,this.l=r}function et(t,e,r){return rt(r,Math.cos(t*=Math.PI/180)*e,Math.sin(t)*e)}function rt(t,e,r){return new nt(t,e,r)}function nt(t,e,r){this.l=t,this.a=e,this.b=r}function it(t,e,r){var n=(t+16)/116,i=n+e/500,o=n-r/200;return i=st(i)*pi,n=st(n)*fi,o=st(o)*mi,B(ut(3.2404542*i-1.5371385*n-.4985314*o),ut(-.969266*i+1.8760108*n+.041556*o),ut(.0556434*i-.2040259*n+1.0572252*o))}function ot(t,e,r){return K(Math.atan2(r,e)/Math.PI*180,Math.sqrt(e*e+r*r),t)}function st(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function at(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function ut(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function lt(t){return qn(t,_i),t}function ct(t){return function(){return vi(t,this)}}function ht(t){return function(){return yi(t,this)}}function dt(t,e){function r(){this.removeAttribute(t)}function n(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function s(){var r=e.apply(this,arguments);null==r?this.removeAttribute(t):this.setAttribute(t,r)}function a(){var r=e.apply(this,arguments);null==r?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,r)}return t=d3.ns.qualify(t),null==e?t.local?n:r:"function"===typeof e?t.local?a:s:t.local?o:i}function pt(t){return new RegExp("(?:^|\\s+)"+d3.requote(t)+"(?:\\s+|$)","g")}function ft(t,e){function r(){var r=-1;while(++r<i)t[r](this,e)}function n(){var r=-1,n=e.apply(this,arguments);while(++r<i)t[r](this,n)}t=t.trim().split(/\s+/).map(mt);var i=t.length;return"function"===typeof e?n:r}function mt(t){var e=pt(t);return function(r,n){if(i=r.classList)return n?i.add(t):i.remove(t);var i=r.className,o=null!=i.baseVal,s=o?i.baseVal:i;n?(e.lastIndex=0,e.test(s)||(s=d(s+" "+t),o?i.baseVal=s:r.className=s)):s&&(s=d(s.replace(e," ")),o?i.baseVal=s:r.className=s)}}function gt(t,e,r){function n(){this.style.removeProperty(t)}function i(){this.style.setProperty(t,e,r)}function o(){var n=e.apply(this,arguments);null==n?this.style.removeProperty(t):this.style.setProperty(t,n,r)}return null==e?n:"function"===typeof e?o:i}function vt(t,e){function r(){delete this[t]}function n(){this[t]=e}function i(){var r=e.apply(this,arguments);null==r?delete this[t]:this[t]=r}return null==e?r:"function"===typeof e?i:n}function yt(t){return{__data__:t}}function wt(t){return function(){return xi(this,t)}}function bt(t){return arguments.length||(t=d3.ascending),function(e,r){return t(e&&e.__data__,r&&r.__data__)}}function xt(t,e,r){function n(){var e=this[o];e&&(this.removeEventListener(t,e,e.$),delete this[o])}function i(){function i(t){var r=d3.event;d3.event=t,a[0]=s.__data__;try{e.apply(s,a)}finally{d3.event=r}}var s=this,a=arguments;n.call(this),this.addEventListener(t,this[o]=i,i.$=r),i._=e}var o="__on"+t,s=t.indexOf(".");return s>0&&(t=t.substring(0,s)),e?i:n}function _t(t,e){for(var r=0,n=t.length;r<n;r++)for(var i,o=t[r],s=0,a=o.length;s<a;s++)(i=o[s])&&e(i,s,r);return t}function St(t){return qn(t,Mi),t}function Mt(t,e,r){qn(t,Ei);var i=new n,o=d3.dispatch("start","end"),s=Ii;return t.id=e,t.time=r,t.tween=function(e,r){return arguments.length<2?i.get(e):(null==r?i.remove(e):i.set(e,r),t)},t.ease=function(e){return arguments.length?(s="function"===typeof e?e:d3.ease.apply(d3,arguments),t):s},t.each=function(e,r){return arguments.length<2?Et.call(t,e):(o.on(e,r),t)},d3.timer((function(n){return _t(t,(function(t,a,u){function l(n){return m.active>e?h():(m.active=e,i.forEach((function(e,r){(r=r.call(t,g,a))&&d.push(r)})),o.start.call(t,g,a),c(n)||d3.timer(c,0,r),1)}function c(r){if(m.active!==e)return h();var n=(r-p)/f,i=s(n),u=d.length;while(u>0)d[--u].call(t,i);return n>=1?(h(),Ai=e,o.end.call(t,g,a),Ai=0,1):void 0}function h(){return--m.count||delete t.__transition__,1}var d=[],p=t.delay,f=t.duration,m=(t=t.node).__transition__||(t.__transition__={active:0,count:0}),g=t.__data__;++m.count,p<=n?l(n):d3.timer(l,p,r)}))}),0,r),t}function Et(t){var e=Ai,r=Ii,n=Li,i=Oi;return Ai=this.id,Ii=this.ease(),_t(this,(function(e,r,n){Li=e.delay,Oi=e.duration,t.call(e=e.node,e.__data__,r,n)})),Ai=e,Ii=r,Li=n,Oi=i,this}function Tt(t,e,r){return""!=r&&ki}function At(t,e){return d3.tween(t,V(e))}function Pt(){var t,e=Date.now(),r=zi;while(r)t=e-r.then,t>=r.delay&&(r.flush=r.callback(t)),r=r.next;var n=Ct()-e;n>24?(isFinite(n)&&(clearTimeout(Ni),Ni=setTimeout(Pt,n)),Di=0):(Di=1,Ui(Pt))}function Ct(){var t=null,e=zi,r=1/0;while(e)e.flush?(delete Vi[e.callback.id],e=t?t.next=e.next:zi=e.next):(r=Math.min(r,e.then+e.delay),e=(t=e).next);return r}function Rt(t,e){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var n=r.createSVGPoint();if(ji<0&&(window.scrollX||window.scrollY)){r=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=r[0][0].getScreenCTM();ji=!(i.f||i.e),r.remove()}return ji?(n.x=e.pageX,n.y=e.pageY):(n.x=e.clientX,n.y=e.clientY),n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function Lt(t){var e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}function Ot(t){return t.rangeExtent?t.rangeExtent():Lt(t.range())}function It(t,e){var r,n=0,i=t.length-1,o=t[n],s=t[i];return s<o&&(r=n,n=i,i=r,r=o,o=s,s=r),(e=e(s-o))&&(t[n]=e.floor(o),t[i]=e.ceil(s)),t}function Dt(){return Math}function Nt(t,e,r,n){function i(){var i=Math.min(t.length,e.length)>2?Bt:jt,u=n?U:z;return s=i(t,e,u,r),a=i(e,t,u,d3.interpolate),o}function o(t){return s(t)}var s,a;return o.invert=function(t){return a(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),i()):t},o.range=function(t){return arguments.length?(e=t,i()):e},o.rangeRound=function(t){return o.range(t).interpolate(d3.interpolateRound)},o.clamp=function(t){return arguments.length?(n=t,i()):n},o.interpolate=function(t){return arguments.length?(r=t,i()):r},o.ticks=function(e){return zt(t,e)},o.tickFormat=function(e){return Ut(t,e)},o.nice=function(){return It(t,Ft),i()},o.copy=function(){return Nt(t,e,r,n)},i()}function kt(t,e){return d3.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Ft(t){return t=Math.pow(10,Math.round(Math.log(t)/Math.LN10)-1),t&&{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}}function Vt(t,e){var r=Lt(t),n=r[1]-r[0],i=Math.pow(10,Math.floor(Math.log(n/e)/Math.LN10)),o=e/n*i;return o<=.15?i*=10:o<=.35?i*=5:o<=.75&&(i*=2),r[0]=Math.ceil(r[0]/i)*i,r[1]=Math.floor(r[1]/i)*i+.5*i,r[2]=i,r}function zt(t,e){return d3.range.apply(d3,Vt(t,e))}function Ut(t,e){return d3.format(",."+Math.max(0,-Math.floor(Math.log(Vt(t,e)[2])/Math.LN10+.01))+"f")}function jt(t,e,r,n){var i=r(t[0],t[1]),o=n(e[0],e[1]);return function(t){return o(i(t))}}function Bt(t,e,r,n){var i=[],o=[],s=0,a=Math.min(t.length,e.length)-1;t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());while(++s<=a)i.push(r(t[s-1],t[s])),o.push(n(e[s-1],e[s]));return function(e){var r=d3.bisect(t,e,1,a)-1;return o[r](i[r](e))}}function Ht(t,e){function r(r){return t(e(r))}var n=e.pow;return r.invert=function(e){return n(t.invert(e))},r.domain=function(i){return arguments.length?(e=i[0]<0?qt:Gt,n=e.pow,t.domain(i.map(e)),r):t.domain().map(n)},r.nice=function(){return t.domain(It(t.domain(),Dt)),r},r.ticks=function(){var r=Lt(t.domain()),i=[];if(r.every(isFinite)){var o=Math.floor(r[0]),s=Math.ceil(r[1]),a=n(r[0]),u=n(r[1]);if(e===qt)for(i.push(n(o));o++<s;)for(var l=9;l>0;l--)i.push(n(o)*l);else{for(;o<s;o++)for(l=1;l<10;l++)i.push(n(o)*l);i.push(n(o))}for(o=0;i[o]<a;o++);for(s=i.length;i[s-1]>u;s--);i=i.slice(o,s)}return i},r.tickFormat=function(t,i){if(arguments.length<2&&(i=Bi),arguments.length<1)return i;var o,s=Math.max(.1,t/r.ticks().length),a=e===qt?(o=-1e-12,Math.floor):(o=1e-12,Math.ceil);return function(t){return t/n(a(e(t)+o))<=s?i(t):""}},r.copy=function(){return Ht(t.copy(),e)},kt(r,t)}function Gt(t){return Math.log(t<0?0:t)/Math.LN10}function qt(t){return-Math.log(t>0?0:-t)/Math.LN10}function Wt(t,e){function r(e){return t(n(e))}var n=$t(e),i=$t(1/e);return r.invert=function(e){return i(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e.map(n)),r):t.domain().map(i)},r.ticks=function(t){return zt(r.domain(),t)},r.tickFormat=function(t){return Ut(r.domain(),t)},r.nice=function(){return r.domain(It(r.domain(),Ft))},r.exponent=function(t){if(!arguments.length)return e;var o=r.domain();return n=$t(e=t),i=$t(1/e),r.domain(o)},r.copy=function(){return Wt(t.copy(),e)},kt(r,t)}function $t(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Xt(t,e){function r(e){return s[((o.get(e)||o.set(e,t.push(e)))-1)%s.length]}function i(e,r){return d3.range(t.length).map((function(t){return e+r*t}))}var o,s,a;return r.domain=function(i){if(!arguments.length)return t;t=[],o=new n;var s,a=-1,u=i.length;while(++a<u)o.has(s=i[a])||o.set(s,t.push(s));return r[e.t].apply(r,e.a)},r.range=function(t){return arguments.length?(s=t,a=0,e={t:"range",a:arguments},r):s},r.rangePoints=function(n,o){arguments.length<2&&(o=0);var u=n[0],l=n[1],c=(l-u)/(Math.max(1,t.length-1)+o);return s=i(t.length<2?(u+l)/2:u+c*o/2,c),a=0,e={t:"rangePoints",a:arguments},r},r.rangeBands=function(n,o,u){arguments.length<2&&(o=0),arguments.length<3&&(u=o);var l=n[1]<n[0],c=n[l-0],h=n[1-l],d=(h-c)/(t.length-o+2*u);return s=i(c+d*u,d),l&&s.reverse(),a=d*(1-o),e={t:"rangeBands",a:arguments},r},r.rangeRoundBands=function(n,o,u){arguments.length<2&&(o=0),arguments.length<3&&(u=o);var l=n[1]<n[0],c=n[l-0],h=n[1-l],d=Math.floor((h-c)/(t.length-o+2*u)),p=h-c-(t.length-o)*d;return s=i(c+Math.round(p/2),d),l&&s.reverse(),a=Math.round(d*(1-o)),e={t:"rangeRoundBands",a:arguments},r},r.rangeBand=function(){return a},r.rangeExtent=function(){return Lt(e.a[0])},r.copy=function(){return Xt(t,e)},r.domain(t)}function Yt(t,e){function r(){var r=0,o=(t.length,e.length);i=[];while(++r<o)i[r-1]=d3.quantile(t,r/o);return n}function n(t){return isNaN(t=+t)?NaN:e[d3.bisect(i,t)]}var i;return n.domain=function(e){return arguments.length?(t=e.filter((function(t){return!isNaN(t)})).sort(d3.ascending),r()):t},n.range=function(t){return arguments.length?(e=t,r()):e},n.quantiles=function(){return i},n.copy=function(){return Yt(t,e)},r()}function Zt(t,e,r){function n(e){return r[Math.max(0,Math.min(s,Math.floor(o*(e-t))))]}function i(){return o=r.length/(e-t),s=r.length-1,n}var o,s;return n.domain=function(r){return arguments.length?(t=+r[0],e=+r[r.length-1],i()):[t,e]},n.range=function(t){return arguments.length?(r=t,i()):r},n.copy=function(){return Zt(t,e,r)},i()}function Jt(t,e){function r(r){return e[d3.bisect(t,r)]}return r.domain=function(e){return arguments.length?(t=e,r):t},r.range=function(t){return arguments.length?(e=t,r):e},r.copy=function(){return Jt(t,e)},r}function Qt(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(r){return arguments.length?(t=r.map(e),e):t},e.ticks=function(e){return zt(t,e)},e.tickFormat=function(e){return Ut(t,e)},e.copy=function(){return Qt(t)},e}function Kt(t){return t.innerRadius}function te(t){return t.outerRadius}function ee(t){return t.startAngle}function re(t){return t.endAngle}function ne(t){function e(e){function s(){c.push("M",o(t(h),l))}var u,c=[],h=[],d=-1,p=e.length,f=a(r),m=a(n);while(++d<p)i.call(this,u=e[d],d)?h.push([+f.call(this,u,d),+m.call(this,u,d)]):h.length&&(s(),h=[]);return h.length&&s(),c.length?c.join(""):null}var r=ie,n=oe,i=s,o=se,u=o.key,l=.7;return e.x=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(n=t,e):n},e.defined=function(t){return arguments.length?(i=t,e):i},e.interpolate=function(t){return arguments.length?(u="function"===typeof t?o=t:(o=Yi.get(t)||se).key,e):u},e.tension=function(t){return arguments.length?(l=t,e):l},e}function ie(t){return t[0]}function oe(t){return t[1]}function se(t){return t.join("L")}function ae(t){return se(t)+"Z"}function ue(t){var e=0,r=t.length,n=t[0],i=[n[0],",",n[1]];while(++e<r)i.push("V",(n=t[e])[1],"H",n[0]);return i.join("")}function le(t){var e=0,r=t.length,n=t[0],i=[n[0],",",n[1]];while(++e<r)i.push("H",(n=t[e])[0],"V",n[1]);return i.join("")}function ce(t,e){return t.length<4?se(t):t[1]+pe(t.slice(1,t.length-1),fe(t,e))}function he(t,e){return t.length<3?se(t):t[0]+pe((t.push(t[0]),t),fe([t[t.length-2]].concat(t,[t[1]]),e))}function de(t,e,r){return t.length<3?se(t):t[0]+pe(t,fe(t,e))}function pe(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return se(t);var r=t.length!=e.length,n="",i=t[0],o=t[1],s=e[0],a=s,u=1;if(r&&(n+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],i=t[1],u=2),e.length>1){a=e[1],o=t[u],u++,n+="C"+(i[0]+s[0])+","+(i[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var l=2;l<e.length;l++,u++)o=t[u],a=e[l],n+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(r){var c=t[u];n+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return n}function fe(t,e){var r,n=[],i=(1-e)/2,o=t[0],s=t[1],a=1,u=t.length;while(++a<u)r=o,o=s,s=t[a],n.push([i*(s[0]-r[0]),i*(s[1]-r[1])]);return n}function me(t){if(t.length<3)return se(t);var e=1,r=t.length,n=t[0],i=n[0],o=n[1],s=[i,i,i,(n=t[1])[0]],a=[o,o,o,n[1]],u=[i,",",o];be(u,s,a);while(++e<r)n=t[e],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),be(u,s,a);e=-1;while(++e<2)s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),be(u,s,a);return u.join("")}function ge(t){if(t.length<4)return se(t);var e,r=[],n=-1,i=t.length,o=[0],s=[0];while(++n<3)e=t[n],o.push(e[0]),s.push(e[1]);r.push(we(Qi,o)+","+we(Qi,s)),--n;while(++n<i)e=t[n],o.shift(),o.push(e[0]),s.shift(),s.push(e[1]),be(r,o,s);return r.join("")}function ve(t){var e,r,n=-1,i=t.length,o=i+4,s=[],a=[];while(++n<4)r=t[n%i],s.push(r[0]),a.push(r[1]);e=[we(Qi,s),",",we(Qi,a)],--n;while(++n<o)r=t[n%i],s.shift(),s.push(r[0]),a.shift(),a.push(r[1]),be(e,s,a);return e.join("")}function ye(t,e){var r=t.length-1;if(r){var n,i,o=t[0][0],s=t[0][1],a=t[r][0]-o,u=t[r][1]-s,l=-1;while(++l<=r)n=t[l],i=l/r,n[0]=e*n[0]+(1-e)*(o+i*a),n[1]=e*n[1]+(1-e)*(s+i*u)}return me(t)}function we(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function be(t,e,r){t.push("C",we(Zi,e),",",we(Zi,r),",",we(Ji,e),",",we(Ji,r),",",we(Qi,e),",",we(Qi,r))}function xe(t,e){return(e[1]-t[1])/(e[0]-t[0])}function _e(t){var e=0,r=t.length-1,n=[],i=t[0],o=t[1],s=n[0]=xe(i,o);while(++e<r)n[e]=(s+(s=xe(i=o,o=t[e+1])))/2;return n[e]=s,n}function Se(t){var e,r,n,i,o=[],s=_e(t),a=-1,u=t.length-1;while(++a<u)e=xe(t[a],t[a+1]),Math.abs(e)<1e-6?s[a]=s[a+1]=0:(r=s[a]/e,n=s[a+1]/e,i=r*r+n*n,i>9&&(i=3*e/Math.sqrt(i),s[a]=i*r,s[a+1]=i*n));a=-1;while(++a<=u)i=(t[Math.min(u,a+1)][0]-t[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([i||0,s[a]*i||0]);return o}function Me(t){return t.length<3?se(t):t[0]+pe(t,Se(t))}function Ee(t){var e,r,n,i=-1,o=t.length;while(++i<o)e=t[i],r=e[0],n=e[1]+$i,e[0]=r*Math.cos(n),e[1]=r*Math.sin(n);return t}function Te(t){function e(e){function s(){g.push("M",l(t(y),p),d,h(t(v.reverse()),p),"Z")}var c,f,m,g=[],v=[],y=[],w=-1,b=e.length,x=a(r),_=a(i),S=r===n?function(){return f}:a(n),M=i===o?function(){return m}:a(o);while(++w<b)u.call(this,c=e[w],w)?(v.push([f=+x.call(this,c,w),m=+_.call(this,c,w)]),y.push([+S.call(this,c,w),+M.call(this,c,w)])):v.length&&(s(),v=[],y=[]);return v.length&&s(),g.length?g.join(""):null}var r=ie,n=ie,i=0,o=oe,u=s,l=se,c=l.key,h=l,d="L",p=.7;return e.x=function(t){return arguments.length?(r=n=t,e):n},e.x0=function(t){return arguments.length?(r=t,e):r},e.x1=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=o=t,e):o},e.y0=function(t){return arguments.length?(i=t,e):i},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(u=t,e):u},e.interpolate=function(t){return arguments.length?(c="function"===typeof t?l=t:(l=Yi.get(t)||se).key,h=l.reverse||l,d=l.closed?"M":"L",e):c},e.tension=function(t){return arguments.length?(p=t,e):p},e}function Ae(t){return t.source}function Pe(t){return t.target}function Ce(t){return t.radius}function Re(t){return[t.x,t.y]}function Le(t){return function(){var e=t.apply(this,arguments),r=e[0],n=e[1]+$i;return[r*Math.cos(n),r*Math.sin(n)]}}function Oe(){return 64}function Ie(){return"circle"}function De(t){var e=Math.sqrt(t/Math.PI);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Ne(t,e){t.attr("transform",(function(t){return"translate("+e(t)+",0)"}))}function ke(t,e){t.attr("transform",(function(t){return"translate(0,"+e(t)+")"}))}function Fe(t,e,r){if(n=[],r&&e.length>1){var n,i,o,s=Lt(t.domain()),a=-1,u=e.length,l=(e[1]-e[0])/++r;while(++a<u)for(i=r;--i>0;)(o=+e[a]-i*l)>=s[0]&&n.push(o);for(--a,i=0;++i<r&&(o=+e[a]+i*l)<s[1];)n.push(o)}return n}function Ve(){io||(io=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var t,e=d3.event;try{io.scrollTop=1e3,io.dispatchEvent(e),t=1e3-io.scrollTop}catch(r){t=e.wheelDelta||5*-e.detail}return t}function ze(t){var e=t.source,r=t.target,n=je(e,r),i=[e];while(e!==n)e=e.parent,i.push(e);var o=i.length;while(r!==n)i.splice(o,0,r),r=r.parent;return i}function Ue(t){var e=[],r=t.parent;while(null!=r)e.push(t),t=r,r=r.parent;return e.push(t),e}function je(t,e){if(t===e)return t;var r=Ue(t),n=Ue(e),i=r.pop(),o=n.pop(),s=null;while(i===o)s=i,i=r.pop(),o=n.pop();return s}function Be(t){t.fixed|=2}function He(t){t.fixed&=1}function Ge(t){t.fixed|=4}function qe(t){t.fixed&=3}function We(t,e,r){var n=0,i=0;if(t.charge=0,!t.leaf){var o,s=t.nodes,a=s.length,u=-1;while(++u<a)o=s[u],null!=o&&(We(o,e,r),t.charge+=o.charge,n+=o.charge*o.cx,i+=o.charge*o.cy)}if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=e*r[t.point.index];t.charge+=t.pointCharge=l,n+=l*t.point.x,i+=l*t.point.y}t.cx=n/t.charge,t.cy=i/t.charge}function $e(t){return 20}function Xe(t){return 1}function Ye(t){return t.x}function Ze(t){return t.y}function Je(t,e,r){t.y0=e,t.y=r}function Qe(t){return d3.range(t.length)}function Ke(t){var e=-1,r=t[0].length,n=[];while(++e<r)n[e]=0;return n}function tr(t){for(var e,r=1,n=0,i=t[0][1],o=t.length;r<o;++r)(e=t[r][1])>i&&(n=r,i=e);return n}function er(t){return t.reduce(rr,0)}function rr(t,e){return t+e[1]}function nr(t,e){return ir(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function ir(t,e){var r=-1,n=+t[0],i=(t[1]-n)/e,o=[];while(++r<=e)o[r]=i*r+n;return o}function or(t){return[d3.min(t),d3.max(t)]}function sr(t,e){return d3.rebind(t,e,"sort","children","value"),t.links=cr,t.nodes=function(e){return lo=!0,(t.nodes=t)(e)},t}function ar(t){return t.children}function ur(t){return t.value}function lr(t,e){return e.value-t.value}function cr(t){return d3.merge(t.map((function(t){return(t.children||[]).map((function(e){return{source:t,target:e}}))})))}function hr(t,e){return t.value-e.value}function dr(t,e){var r=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=r,r._pack_prev=e}function pr(t,e){t._pack_next=e,e._pack_prev=t}function fr(t,e){var r=e.x-t.x,n=e.y-t.y,i=t.r+e.r;return i*i-r*r-n*n>.001}function mr(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),p=Math.max(t.y+t.r,p)}if((r=t.children)&&(l=r.length)){var r,n,i,o,s,a,u,l,c=1/0,h=-1/0,d=1/0,p=-1/0;if(r.forEach(gr),n=r[0],n.x=-n.r,n.y=0,e(n),l>1&&(i=r[1],i.x=i.r,i.y=0,e(i),l>2))for(o=r[2],wr(n,i,o),e(o),dr(n,o),n._pack_prev=o,dr(o,i),i=n._pack_next,s=3;s<l;s++){wr(n,i,o=r[s]);var f=0,m=1,g=1;for(a=i._pack_next;a!==i;a=a._pack_next,m++)if(fr(a,o)){f=1;break}if(1==f)for(u=n._pack_prev;u!==a._pack_prev;u=u._pack_prev,g++)if(fr(u,o))break;f?(m<g||m==g&&i.r<n.r?pr(n,i=a):pr(n=u,i),s--):(dr(n,o),i=o,e(o))}var v=(c+h)/2,y=(d+p)/2,w=0;for(s=0;s<l;s++)o=r[s],o.x-=v,o.y-=y,w=Math.max(w,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=w,r.forEach(vr)}}function gr(t){t._pack_next=t._pack_prev=t}function vr(t){delete t._pack_next,delete t._pack_prev}function yr(t,e,r,n){var i=t.children;if(t.x=e+=n*t.x,t.y=r+=n*t.y,t.r*=n,i){var o=-1,s=i.length;while(++o<s)yr(i[o],e,r,n)}}function wr(t,e,r){var n=t.r+r.r,i=e.x-t.x,o=e.y-t.y;if(n&&(i||o)){var s=e.r+r.r,a=i*i+o*o;s*=s,n*=n;var u=.5+(n-s)/(2*a),l=Math.sqrt(Math.max(0,2*s*(n+a)-(n-=a)*n-s*s))/(2*a);r.x=t.x+u*i+l*o,r.y=t.y+u*o-l*i}else r.x=t.x+n,r.y=t.y}function br(t){return 1+d3.max(t,(function(t){return t.y}))}function xr(t){return t.reduce((function(t,e){return t+e.x}),0)/t.length}function _r(t){var e=t.children;return e&&e.length?_r(e[0]):t}function Sr(t){var e,r=t.children;return r&&(e=r.length)?Sr(r[e-1]):t}function Mr(t,e){return t.parent==e.parent?1:2}function Er(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function Tr(t){var e,r=t.children;return r&&(e=r.length)?r[e-1]:t._tree.thread}function Ar(t,e){var r=t.children;if(r&&(i=r.length)){var n,i,o=-1;while(++o<i)e(n=Ar(r[o],e),t)>0&&(t=n)}return t}function Pr(t,e){return t.x-e.x}function Cr(t,e){return e.x-t.x}function Rr(t,e){return t.depth-e.depth}function Lr(t,e){function r(t,n){var i=t.children;if(i&&(s=i.length)){var o,s,a=null,u=-1;while(++u<s)o=i[u],r(o,a),a=o}e(t,n)}r(t,null)}function Or(t){var e,r=0,n=0,i=t.children,o=i.length;while(--o>=0)e=i[o]._tree,e.prelim+=r,e.mod+=r,r+=e.shift+(n+=e.change)}function Ir(t,e,r){t=t._tree,e=e._tree;var n=r/(e.number-t.number);t.change+=n,e.change-=n,e.shift+=r,e.prelim+=r,e.mod+=r}function Dr(t,e,r){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:r}function Nr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function kr(t,e){var r=t.x+e[3],n=t.y+e[0],i=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return i<0&&(r+=i/2,i=0),o<0&&(n+=o/2,o=0),{x:r,y:n,dx:i,dy:o}}function Fr(t,e){function r(t,n){d3.text(t,e,(function(t){n(t&&r.parse(t))}))}function n(e){return e.map(i).join(t)}function i(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var o=new RegExp("\r\n|["+t+"\r\n]","g"),s=new RegExp('["'+t+"\n]"),a=t.charCodeAt(0);return r.parse=function(t){var e;return r.parseRows(t,(function(t,r){if(r){var n={},i=-1,o=e.length;while(++i<o)n[e[i]]=t[i];return n}return e=t,null}))},r.parseRows=function(t,e){function r(){if(o.lastIndex>=t.length)return u;if(i)return i=!1,s;var e=o.lastIndex;if(34===t.charCodeAt(e)){var r=e;while(r++<t.length)if(34===t.charCodeAt(r)){if(34!==t.charCodeAt(r+1))break;r++}o.lastIndex=r+2;var n=t.charCodeAt(r+1);return 13===n?(i=!0,10===t.charCodeAt(r+2)&&o.lastIndex++):10===n&&(i=!0),t.substring(e+1,r).replace(/""/g,'"')}var l=o.exec(t);return l?(i=l[0].charCodeAt(0)!==a,t.substring(e,l.index)):(o.lastIndex=t.length,t.substring(e))}var n,i,s={},u={},l=[],c=0;o.lastIndex=0;while((n=r())!==u){var h=[];while(n!==s&&n!==u)h.push(n),n=r();e&&!(h=e(h,c++))||l.push(h)}return l},r.format=function(t){return t.map(n).join("\n")},r}function Vr(t,e){return function(r){return r&&t.hasOwnProperty(r.type)?t[r.type](r):e}}function zr(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ur(t,e){ho.hasOwnProperty(t.type)&&ho[t.type](t,e)}function jr(t,e){Ur(t.geometry,e)}function Br(t,e){for(var r=t.features,n=0,i=r.length;n<i;n++)Ur(r[n].geometry,e)}function Hr(t,e){for(var r=t.geometries,n=0,i=r.length;n<i;n++)Ur(r[n],e)}function Gr(t,e){for(var r=t.coordinates,n=0,i=r.length;n<i;n++)e.apply(null,r[n])}function qr(t,e){for(var r=t.coordinates,n=0,i=r.length;n<i;n++)for(var o=r[n],s=0,a=o.length;s<a;s++)e.apply(null,o[s])}function Wr(t,e){for(var r=t.coordinates,n=0,i=r.length;n<i;n++)for(var o=r[n][0],s=0,a=o.length;s<a;s++)e.apply(null,o[s])}function $r(t,e){e.apply(null,t.coordinates)}function Xr(t,e){for(var r=t.coordinates[0],n=0,i=r.length;n<i;n++)e.apply(null,r[n])}function Yr(t){return t.source}function Zr(t){return t.target}function Jr(){function t(t){var e=Math.sin(t*=p)*f,r=Math.sin(p-t)*f,n=r*o+e*h,a=r*s+e*d,u=r*i+e*c;return[Math.atan2(a,n)/co,Math.atan2(u,Math.sqrt(n*n+a*a))/co]}var e,r,n,i,o,s,a,u,l,c,h,d,p,f;return t.distance=function(){return null==p&&(f=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,i*c+n*l*Math.cos(a-e)))))),p},t.source=function(a){var u=Math.cos(e=a[0]*co),l=Math.sin(e);return n=Math.cos(r=a[1]*co),i=Math.sin(r),o=n*u,s=n*l,p=null,t},t.target=function(e){var r=Math.cos(a=e[0]*co),n=Math.sin(a);return l=Math.cos(u=e[1]*co),c=Math.sin(u),h=l*r,d=l*n,p=null,t},t}function Qr(t,e){var r=Jr().source(t).target(e);return r.distance(),r}function Kr(t){var e=0,r=0;while(1){if(t(e,r))return[e,r];0===e?(e=r+1,r=0):(e-=1,r+=1)}}function tn(t,e,r,n){var i,o,s,a,u,l,c;return i=n[t],o=i[0],s=i[1],i=n[e],a=i[0],u=i[1],i=n[r],l=i[0],c=i[1],(c-s)*(a-o)-(u-s)*(l-o)>0}function en(t,e,r){return(r[0]-e[0])*(t[1]-e[1])<(r[1]-e[1])*(t[0]-e[0])}function rn(t,e,r,n){var i=t[0],o=e[0],s=r[0],a=n[0],u=t[1],l=e[1],c=r[1],h=n[1],d=i-s,p=o-i,f=a-s,m=u-c,g=l-u,v=h-c,y=(f*m-v*d)/(v*p-f*g);return[i+y*p,u+y*g]}function nn(t,e){var r={list:t.map((function(t,e){return{index:e,x:t[0],y:t[1]}})).sort((function(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0})),bottomSite:null},n={list:[],leftEnd:null,rightEnd:null,init:function(){n.leftEnd=n.createHalfEdge(null,"l"),n.rightEnd=n.createHalfEdge(null,"l"),n.leftEnd.r=n.rightEnd,n.rightEnd.l=n.leftEnd,n.list.unshift(n.leftEnd,n.rightEnd)},createHalfEdge:function(t,e){return{edge:t,side:e,vertex:null,l:null,r:null}},insert:function(t,e){e.l=t,e.r=t.r,t.r.l=e,t.r=e},leftBound:function(t){var e=n.leftEnd;do{e=e.r}while(e!=n.rightEnd&&i.rightOf(e,t));return e=e.l,e},del:function(t){t.l.r=t.r,t.r.l=t.l,t.edge=null},right:function(t){return t.r},left:function(t){return t.l},leftRegion:function(t){return null==t.edge?r.bottomSite:t.edge.region[t.side]},rightRegion:function(t){return null==t.edge?r.bottomSite:t.edge.region[mo[t.side]]}},i={bisect:function(t,e){var r={region:{l:t,r:e},ep:{l:null,r:null}},n=e.x-t.x,i=e.y-t.y,o=n>0?n:-n,s=i>0?i:-i;return r.c=t.x*n+t.y*i+.5*(n*n+i*i),o>s?(r.a=1,r.b=i/n,r.c/=n):(r.b=1,r.a=n/i,r.c/=i),r},intersect:function(t,e){var r=t.edge,n=e.edge;if(!r||!n||r.region.r==n.region.r)return null;var i=r.a*n.b-r.b*n.a;if(Math.abs(i)<1e-10)return null;var o,s,a=(r.c*n.b-n.c*r.b)/i,u=(n.c*r.a-r.c*n.a)/i,l=r.region.r,c=n.region.r;l.y<c.y||l.y==c.y&&l.x<c.x?(o=t,s=r):(o=e,s=n);var h=a>=s.region.r.x;return h&&"l"===o.side||!h&&"r"===o.side?null:{x:a,y:u}},rightOf:function(t,e){var r=t.edge,n=r.region.r,i=e.x>n.x;if(i&&"l"===t.side)return 1;if(!i&&"r"===t.side)return 0;if(1===r.a){var o=e.y-n.y,s=e.x-n.x,a=0,u=0;if(!i&&r.b<0||i&&r.b>=0?u=a=o>=r.b*s:(u=e.x+e.y*r.b>r.c,r.b<0&&(u=!u),u||(a=1)),!a){var l=n.x-r.region.l.x;u=r.b*(s*s-o*o)<l*o*(1+2*s/l+r.b*r.b),r.b<0&&(u=!u)}}else{var c=r.c-r.a*e.x,h=e.y-c,d=e.x-n.x,p=c-n.y;u=h*h>d*d+p*p}return"l"===t.side?u:!u},endPoint:function(t,r,n){t.ep[r]=n,t.ep[mo[r]]&&e(t)},distance:function(t,e){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)}},o={list:[],insert:function(t,e,r){t.vertex=e,t.ystar=e.y+r;for(var n=0,i=o.list,s=i.length;n<s;n++){var a=i[n];if(!(t.ystar>a.ystar||t.ystar==a.ystar&&e.x>a.vertex.x))break}i.splice(n,0,t)},del:function(t){for(var e=0,r=o.list,n=r.length;e<n&&r[e]!=t;++e);r.splice(e,1)},empty:function(){return 0===o.list.length},nextEvent:function(t){for(var e=0,r=o.list,n=r.length;e<n;++e)if(r[e]==t)return r[e+1];return null},min:function(){var t=o.list[0];return{x:t.vertex.x,y:t.ystar}},extractMin:function(){return o.list.shift()}};n.init(),r.bottomSite=r.list.shift();var s,a,u,l,c,h,d,p,f,m,g,v,y,w=r.list.shift();while(1)if(o.empty()||(s=o.min()),w&&(o.empty()||w.y<s.y||w.y==s.y&&w.x<s.x))a=n.leftBound(w),u=n.right(a),d=n.rightRegion(a),v=i.bisect(d,w),h=n.createHalfEdge(v,"l"),n.insert(a,h),m=i.intersect(a,h),m&&(o.del(a),o.insert(a,m,i.distance(m,w))),a=h,h=n.createHalfEdge(v,"r"),n.insert(a,h),m=i.intersect(h,u),m&&o.insert(h,m,i.distance(m,w)),w=r.list.shift();else{if(o.empty())break;a=o.extractMin(),l=n.left(a),u=n.right(a),c=n.right(u),d=n.leftRegion(a),p=n.rightRegion(u),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(u.edge,u.side,g),n.del(a),o.del(u),n.del(u),y="l",d.y>p.y&&(f=d,d=p,p=f,y="r"),v=i.bisect(d,p),h=n.createHalfEdge(v,y),n.insert(l,h),i.endPoint(v,mo[y],g),m=i.intersect(l,h),m&&(o.del(l),o.insert(l,m,i.distance(m,d))),m=i.intersect(h,c),m&&o.insert(h,m,i.distance(m,d))}for(a=n.right(n.leftEnd);a!=n.rightEnd;a=n.right(a))e(a.edge)}function on(){return{leaf:!0,nodes:[],point:null}}function sn(t,e,r,n,i,o){if(!t(e,r,n,i,o)){var s=.5*(r+i),a=.5*(n+o),u=e.nodes;u[0]&&sn(t,u[0],r,n,s,a),u[1]&&sn(t,u[1],s,n,i,a),u[2]&&sn(t,u[2],r,a,s,o),u[3]&&sn(t,u[3],s,a,i,o)}}function an(t){return{x:t[0],y:t[1]}}function un(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function ln(t){return t.substring(0,3)}function cn(t,e,r,n){var i,o,s=0,a=e.length,u=r.length;while(s<a){if(n>=u)return-1;if(i=e.charCodeAt(s++),37==i){if(o=Fo[e.charAt(s++)],!o||(n=o(t,r,n))<0)return-1}else if(i!=r.charCodeAt(n++))return-1}return n}function hn(t){return new RegExp("^(?:"+t.map(d3.requote).join("|")+")","i")}function dn(t){var e=new n,r=-1,i=t.length;while(++r<i)e.set(t[r].toLowerCase(),r);return e}function pn(t,e,r){Lo.lastIndex=0;var n=Lo.exec(e.substring(r));return n?r+=n[0].length:-1}function fn(t,e,r){Ro.lastIndex=0;var n=Ro.exec(e.substring(r));return n?r+=n[0].length:-1}function mn(t,e,r){Do.lastIndex=0;var n=Do.exec(e.substring(r));return n?(t.m=No.get(n[0].toLowerCase()),r+=n[0].length):-1}function gn(t,e,r){Oo.lastIndex=0;var n=Oo.exec(e.substring(r));return n?(t.m=Io.get(n[0].toLowerCase()),r+=n[0].length):-1}function vn(t,e,r){return cn(t,ko.c.toString(),e,r)}function yn(t,e,r){return cn(t,ko.x.toString(),e,r)}function wn(t,e,r){return cn(t,ko.X.toString(),e,r)}function bn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+4));return n?(t.y=+n[0],r+=n[0].length):-1}function xn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.y=_n(+n[0]),r+=n[0].length):-1}function _n(t){return t+(t>68?1900:2e3)}function Sn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.m=n[0]-1,r+=n[0].length):-1}function Mn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.d=+n[0],r+=n[0].length):-1}function En(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.H=+n[0],r+=n[0].length):-1}function Tn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.M=+n[0],r+=n[0].length):-1}function An(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+2));return n?(t.S=+n[0],r+=n[0].length):-1}function Pn(t,e,r){Vo.lastIndex=0;var n=Vo.exec(e.substring(r,r+3));return n?(t.L=+n[0],r+=n[0].length):-1}function Cn(t,e,r){var n=zo.get(e.substring(r,r+=2).toLowerCase());return null==n?-1:(t.p=n,r)}function Rn(t){var e=t.getTimezoneOffset(),r=e>0?"-":"+",n=~~(Math.abs(e)/60),i=Math.abs(e)%60;return r+To(n)+To(i)}function Ln(t){return t.toISOString()}function On(t,e,r){function n(e){var r=t(e),n=o(r,1);return e-r<n-e?r:n}function i(r){return e(r=t(new go(r-1)),1),r}function o(t,r){return e(t=new go(+t),r),t}function s(t,n,o){var s=i(t),a=[];if(o>1)while(s<n)r(s)%o||a.push(new Date(+s)),e(s,1);else while(s<n)a.push(new Date(+s)),e(s,1);return a}function a(t,e,r){try{go=un;var n=new un;return n._=t,s(n,e,r)}finally{go=Date}}t.floor=t,t.round=n,t.ceil=i,t.offset=o,t.range=s;var u=t.utc=In(t);return u.floor=u,u.round=In(n),u.ceil=In(i),u.offset=In(o),u.range=a,t}function In(t){return function(e,r){try{go=un;var n=new un;return n._=e,t(n,r)._}finally{go=Date}}}function Dn(t,e,r){function n(e){return t(e)}return n.invert=function(e){return kn(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e),n):t.domain().map(kn)},n.nice=function(t){return n.domain(It(n.domain(),(function(){return t})))},n.ticks=function(r,i){var o=Nn(n.domain());if("function"!==typeof r){var s=o[1]-o[0],a=s/r,u=d3.bisect(jo,a);if(u==jo.length)return e.year(o,r);if(!u)return t.ticks(r).map(kn);Math.log(a/jo[u-1])<Math.log(jo[u]/a)&&--u,r=e[u],i=r[1],r=r[0].range}return r(o[0],new Date(+o[1]+1),i)},n.tickFormat=function(){return r},n.copy=function(){return Dn(t.copy(),e,r)},d3.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Nn(t){var e=t[0],r=t[t.length-1];return e<r?[e,r]:[r,e]}function kn(t){return new Date(t)}function Fn(t){return function(e){var r=t.length-1,n=t[r];while(!n[1](e))n=t[--r];return n[0](e)}}function Vn(t){var e=new Date(t,0,1);return e.setFullYear(t),e}function zn(t){var e=t.getFullYear(),r=Vn(e),n=Vn(e+1);return e+(t-r)/(n-r)}function Un(t){var e=new Date(Date.UTC(t,0,1));return e.setUTCFullYear(t),e}function jn(t){var e=t.getUTCFullYear(),r=Un(e),n=Un(e+1);return e+(t-r)/(n-r)}Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Yo){var Bn=CSSStyleDeclaration.prototype,Hn=Bn.setProperty;Bn.setProperty=function(t,e,r){Hn.call(this,t,e+"",r)}}d3={version:"2.10.3"};var Gn=r;try{Gn(document.documentElement.childNodes)[0].nodeType}catch(Zo){Gn=e}var qn=[].__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var r in e)t[r]=e[r]};d3.map=function(t){var e=new n;for(var r in t)e.set(r,t[r]);return e},t(n,{has:function(t){return Wn+t in this},get:function(t){return this[Wn+t]},set:function(t,e){return this[Wn+t]=e},remove:function(t){return t=Wn+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach((function(e){t.push(e)})),t},values:function(){var t=[];return this.forEach((function(e,r){t.push(r)})),t},entries:function(){var t=[];return this.forEach((function(e,r){t.push({key:e,value:r})})),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===$n&&t.call(this,e.substring(1),this[e])}});var Wn="\0",$n=Wn.charCodeAt(0);d3.functor=a,d3.rebind=function(t,e){var r,n=1,i=arguments.length;while(++n<i)t[r=arguments[n]]=u(t,e,e[r]);return t},d3.ascending=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},d3.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},d3.mean=function(t,e){var r,n=t.length,i=0,o=-1,s=0;if(1===arguments.length)while(++o<n)l(r=t[o])&&(i+=(r-i)/++s);else while(++o<n)l(r=e.call(t,t[o],o))&&(i+=(r-i)/++s);return s?i:void 0},d3.median=function(t,e){return arguments.length>1&&(t=t.map(e)),t=t.filter(l),t.length?d3.quantile(t.sort(d3.ascending),.5):void 0},d3.min=function(t,e){var r,n,i=-1,o=t.length;if(1===arguments.length){while(++i<o&&(null==(r=t[i])||r!=r))r=void 0;while(++i<o)null!=(n=t[i])&&r>n&&(r=n)}else{while(++i<o&&(null==(r=e.call(t,t[i],i))||r!=r))r=void 0;while(++i<o)null!=(n=e.call(t,t[i],i))&&r>n&&(r=n)}return r},d3.max=function(t,e){var r,n,i=-1,o=t.length;if(1===arguments.length){while(++i<o&&(null==(r=t[i])||r!=r))r=void 0;while(++i<o)null!=(n=t[i])&&n>r&&(r=n)}else{while(++i<o&&(null==(r=e.call(t,t[i],i))||r!=r))r=void 0;while(++i<o)null!=(n=e.call(t,t[i],i))&&n>r&&(r=n)}return r},d3.extent=function(t,e){var r,n,i,o=-1,s=t.length;if(1===arguments.length){while(++o<s&&(null==(r=i=t[o])||r!=r))r=i=void 0;while(++o<s)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else{while(++o<s&&(null==(r=i=e.call(t,t[o],o))||r!=r))r=void 0;while(++o<s)null!=(n=e.call(t,t[o],o))&&(r>n&&(r=n),i<n&&(i=n))}return[r,i]},d3.random={normal:function(t,e){var r=arguments.length;return r<2&&(e=1),r<1&&(t=0),function(){var r,n,i;do{r=2*Math.random()-1,n=2*Math.random()-1,i=r*r+n*n}while(!i||i>1);return t+e*r*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(t,e){var r=arguments.length;r<2&&(e=1),r<1&&(t=0);var n=d3.random.normal();return function(){return Math.exp(t+e*n())}},irwinHall:function(t){return function(){for(var e=0,r=0;r<t;r++)e+=Math.random();return e/t}}},d3.sum=function(t,e){var r,n=0,i=t.length,o=-1;if(1===arguments.length)while(++o<i)isNaN(r=+t[o])||(n+=r);else while(++o<i)isNaN(r=+e.call(t,t[o],o))||(n+=r);return n},d3.quantile=function(t,e){var r=(t.length-1)*e+1,n=Math.floor(r),i=t[n-1],o=r-n;return o?i+o*(t[n]-i):i},d3.transpose=function(t){return d3.zip.apply(d3,t)},d3.zip=function(){if(!(n=arguments.length))return[];for(var t=-1,e=d3.min(arguments,c),r=new Array(e);++t<e;)for(var n,i=-1,o=r[t]=new Array(n);++i<n;)o[i]=arguments[i][t];return r},d3.bisector=function(t){return{left:function(e,r,n,i){arguments.length<3&&(n=0),arguments.length<4&&(i=e.length);while(n<i){var o=n+i>>>1;t.call(e,e[o],o)<r?n=o+1:i=o}return n},right:function(e,r,n,i){arguments.length<3&&(n=0),arguments.length<4&&(i=e.length);while(n<i){var o=n+i>>>1;r<t.call(e,e[o],o)?i=o:n=o+1}return n}}};var Xn=d3.bisector((function(t){return t}));d3.bisectLeft=Xn.left,d3.bisect=d3.bisectRight=Xn.right,d3.first=function(t,e){var r,n=0,i=t.length,o=t[0];1===arguments.length&&(e=d3.ascending);while(++n<i)e.call(t,o,r=t[n])>0&&(o=r);return o},d3.last=function(t,e){var r,n=0,i=t.length,o=t[0];1===arguments.length&&(e=d3.ascending);while(++n<i)e.call(t,o,r=t[n])<=0&&(o=r);return o},d3.nest=function(){function t(e,a){if(a>=s.length)return i?i.call(o,e):r?e.sort(r):e;var u,l,c,h=-1,d=e.length,p=s[a++],f=new n,m={};while(++h<d)(c=f.get(u=p(l=e[h])))?c.push(l):f.set(u,[l]);return f.forEach((function(e,r){m[e]=t(r,a)})),m}function e(t,r){if(r>=s.length)return t;var n,i=[],o=a[r++];for(n in t)i.push({key:n,values:e(t[n],r)});return o&&i.sort((function(t,e){return o(t.key,e.key)})),i}var r,i,o={},s=[],a=[];return o.map=function(e){return t(e,0)},o.entries=function(r){return e(t(r,0),0)},o.key=function(t){return s.push(t),o},o.sortKeys=function(t){return a[s.length-1]=t,o},o.sortValues=function(t){return r=t,o},o.rollup=function(t){return i=t,o},o},d3.keys=function(t){var e=[];for(var r in t)e.push(r);return e},d3.values=function(t){var e=[];for(var r in t)e.push(t[r]);return e},d3.entries=function(t){var e=[];for(var r in t)e.push({key:r,value:t[r]});return e},d3.permute=function(t,e){var r=[],n=-1,i=e.length;while(++n<i)r[n]=t[e[n]];return r},d3.merge=function(t){return Array.prototype.concat.apply([],t)},d3.split=function(t,e){var r,n=[],i=[],o=-1,s=t.length;arguments.length<2&&(e=h);while(++o<s)e.call(i,r=t[o],o)?i=[]:(i.length||n.push(i),i.push(r));return n},d3.range=function(t,e,r){if(arguments.length<3&&(r=1,arguments.length<2&&(e=t,t=0)),(e-t)/r===1/0)throw new Error("infinite range");var n,i=[],o=p(Math.abs(r)),s=-1;if(t*=o,e*=o,r*=o,r<0)while((n=t+r*++s)>e)i.push(n/o);else while((n=t+r*++s)<e)i.push(n/o);return i},d3.requote=function(t){return t.replace(Yn,"\\$&")};var Yn=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},d3.xhr=function(t,e,r){var n=new XMLHttpRequest;arguments.length<3?(r=e,e=null):e&&n.overrideMimeType&&n.overrideMimeType(e),n.open("GET",t,!0),e&&n.setRequestHeader("Accept",e),n.onreadystatechange=function(){if(4===n.readyState){var t=n.status;r(!t&&n.response||t>=200&&t<300||304===t?n:null)}},n.send(null)},d3.text=function(t,e,r){function n(t){r(t&&t.responseText)}arguments.length<3&&(r=e,e=null),d3.xhr(t,e,n)},d3.json=function(t,e){d3.text(t,"application/json",(function(t){e(t?JSON.parse(t):null)}))},d3.html=function(t,e){d3.text(t,"text/html",(function(t){if(null!=t){var r=document.createRange();r.selectNode(document.body),t=r.createContextualFragment(t)}e(t)}))},d3.xml=function(t,e,r){function n(t){r(t&&t.responseXML)}arguments.length<3&&(r=e,e=null),d3.xhr(t,e,n)};var Zn={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:Zn,qualify:function(t){var e=t.indexOf(":"),r=t;return e>=0&&(r=t.substring(0,e),t=t.substring(e+1)),Zn.hasOwnProperty(r)?{space:Zn[r],local:t}:t}},d3.dispatch=function(){var t=new f,e=-1,r=arguments.length;while(++e<r)t[arguments[e]]=m(t);return t},f.prototype.on=function(t,e){var r=t.indexOf("."),n="";return r>0&&(n=t.substring(r+1),t=t.substring(0,r)),arguments.length<2?this[t].on(n):this[t].on(n,e)},d3.format=function(t){var e=Jn.exec(t),r=e[1]||" ",n=e[3]||"",i=e[5],o=+e[6],s=e[7],a=e[8],u=e[9],l=1,c="",h=!1;switch(a&&(a=+a.substring(1)),i&&(r="0",s&&(o-=Math.floor((o-1)/4))),u){case"n":s=!0,u="g";break;case"%":l=100,c="%",u="f";break;case"p":l=100,c="%",u="r";break;case"d":h=!0,a=0;break;case"s":l=-1,u="r";break}return"r"!=u||a||(u="g"),u=Qn.get(u)||v,function(t){if(h&&t%1)return"";var e=t<0&&(t=-t)?"-":n;if(l<0){var d=d3.formatPrefix(t,a);t=d.scale(t),c=d.symbol}else t*=l;if(t=u(t,a),i){var p=t.length+e.length;p<o&&(t=new Array(o-p+1).join(r)+t),s&&(t=y(t)),t=e+t}else{s&&(t=y(t)),t=e+t;p=t.length;p<o&&(t=new Array(o-p+1).join(r)+t)}return t+c}};var Jn=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,Qn=d3.map({g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return d3.round(t,e=g(t,e)).toFixed(Math.max(0,Math.min(20,e)))}}),Kn=["y","z","a","f","p","n","μ","m","","k","M","G","T","P","E","Z","Y"].map(w);d3.formatPrefix=function(t,e){var r=0;return t&&(t<0&&(t*=-1),e&&(t=d3.round(t,g(t,e))),r=1+Math.floor(1e-12+Math.log(t)/Math.LN10),r=Math.max(-24,Math.min(24,3*Math.floor((r<=0?r+1:r-1)/3)))),Kn[8+r/3]};var ti=M(2),ei=M(3),ri=function(){return S},ni=d3.map({linear:ri,poly:M,quad:function(){return ti},cubic:function(){return ei},sin:function(){return E},exp:function(){return T},circle:function(){return A},elastic:P,back:C,bounce:function(){return R}}),ii=d3.map({in:S,out:x,"in-out":_,"out-in":function(t){return _(x(t))}});d3.ease=function(t){var e=t.indexOf("-"),r=e>=0?t.substring(0,e):t,n=e>=0?t.substring(e+1):"in";return r=ni.get(r)||ri,n=ii.get(n)||S,b(n(r.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(t){var e=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(t){e.setAttribute("transform",t);var r=e.transform.baseVal.consolidate();return new D(r?r.matrix:si)})(t)},D.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var oi=180/Math.PI,si={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(t,e){var r,n=d3.interpolators.length;while(--n>=0&&!(r=d3.interpolators[n](t,e)));return r},d3.interpolateNumber=function(t,e){return e-=t,function(r){return t+e*r}},d3.interpolateRound=function(t,e){return e-=t,function(r){return Math.round(t+e*r)}},d3.interpolateString=function(t,e){var r,n,i,o,s,a=0,u=[],l=[];for(ai.lastIndex=0,n=0;r=ai.exec(e);++n)r.index&&u.push(e.substring(a,r.index)),l.push({i:u.length,x:r[0]}),u.push(null),a=ai.lastIndex;for(a<e.length&&u.push(e.substring(a)),n=0,o=l.length;(r=ai.exec(t))&&n<o;++n)if(s=l[n],s.x==r[0]){if(s.i)if(null==u[s.i+1])for(u[s.i-1]+=s.x,u.splice(s.i,1),i=n+1;i<o;++i)l[i].i--;else for(u[s.i-1]+=s.x+u[s.i+1],u.splice(s.i,2),i=n+1;i<o;++i)l[i].i-=2;else if(null==u[s.i+1])u[s.i]=s.x;else for(u[s.i]=s.x+u[s.i+1],u.splice(s.i+1,1),i=n+1;i<o;++i)l[i].i--;l.splice(n,1),o--,n--}else s.x=d3.interpolateNumber(parseFloat(r[0]),parseFloat(s.x));while(n<o)s=l.pop(),null==u[s.i+1]?u[s.i]=s.x:(u[s.i]=s.x+u[s.i+1],u.splice(s.i+1,1)),o--;return 1===u.length?null==u[0]?l[0].x:function(){return e}:function(t){for(n=0;n<o;++n)u[(s=l[n]).i]=s.x(t);return u.join("")}},d3.interpolateTransform=function(t,e){var r,n=[],i=[],o=d3.transform(t),s=d3.transform(e),a=o.translate,u=s.translate,l=o.rotate,c=s.rotate,h=o.skew,d=s.skew,p=o.scale,f=s.scale;return a[0]!=u[0]||a[1]!=u[1]?(n.push("translate(",null,",",null,")"),i.push({i:1,x:d3.interpolateNumber(a[0],u[0])},{i:3,x:d3.interpolateNumber(a[1],u[1])})):u[0]||u[1]?n.push("translate("+u+")"):n.push(""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),i.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(l,c)})):c&&n.push(n.pop()+"rotate("+c+")"),h!=d?i.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(h,d)}):d&&n.push(n.pop()+"skewX("+d+")"),p[0]!=f[0]||p[1]!=f[1]?(r=n.push(n.pop()+"scale(",null,",",null,")"),i.push({i:r-4,x:d3.interpolateNumber(p[0],f[0])},{i:r-2,x:d3.interpolateNumber(p[1],f[1])})):1==f[0]&&1==f[1]||n.push(n.pop()+"scale("+f+")"),r=i.length,function(t){var e,o=-1;while(++o<r)n[(e=i[o]).i]=e.x(t);return n.join("")}},d3.interpolateRgb=function(t,e){t=d3.rgb(t),e=d3.rgb(e);var r=t.r,n=t.g,i=t.b,o=e.r-r,s=e.g-n,a=e.b-i;return function(t){return"#"+G(Math.round(r+o*t))+G(Math.round(n+s*t))+G(Math.round(i+a*t))}},d3.interpolateHsl=function(t,e){t=d3.hsl(t),e=d3.hsl(e);var r=t.h,n=t.s,i=t.l,o=e.h-r,s=e.s-n,a=e.l-i;return o>180?o-=360:o<-180&&(o+=360),function(t){return Q(r+o*t,n+s*t,i+a*t)+""}},d3.interpolateLab=function(t,e){t=d3.lab(t),e=d3.lab(e);var r=t.l,n=t.a,i=t.b,o=e.l-r,s=e.a-n,a=e.b-i;return function(t){return it(r+o*t,n+s*t,i+a*t)+""}},d3.interpolateHcl=function(t,e){t=d3.hcl(t),e=d3.hcl(e);var r=t.h,n=t.c,i=t.l,o=e.h-r,s=e.c-n,a=e.l-i;return o>180?o-=360:o<-180&&(o+=360),function(t){return et(r+o*t,n+s*t,i+a*t)+""}},d3.interpolateArray=function(t,e){var r,n=[],i=[],o=t.length,s=e.length,a=Math.min(t.length,e.length);for(r=0;r<a;++r)n.push(d3.interpolate(t[r],e[r]));for(;r<o;++r)i[r]=t[r];for(;r<s;++r)i[r]=e[r];return function(t){for(r=0;r<a;++r)i[r]=n[r](t);return i}},d3.interpolateObject=function(t,e){var r,n={},i={};for(r in t)r in e?n[r]=V(r)(t[r],e[r]):i[r]=t[r];for(r in e)r in t||(i[r]=e[r]);return function(t){for(r in n)i[r]=n[r](t);return i}};var ai=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(t,e){return e instanceof Array&&d3.interpolateArray(t,e)},function(t,e){return("string"===typeof t||"string"===typeof e)&&d3.interpolateString(t+"",e+"")},function(t,e){return("string"===typeof e?li.has(e)||/^(#|rgb\(|hsl\()/.test(e):e instanceof j)&&d3.interpolateRgb(t,e)},function(t,e){return!isNaN(t=+t)&&!isNaN(e=+e)&&d3.interpolateNumber(t,e)}],j.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(t,e,r){return 1===arguments.length?t instanceof H?B(t.r,t.g,t.b):q(""+t,B,Q):B(~~t,~~e,~~r)};var ui=H.prototype=new j;ui.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,r=this.g,n=this.b,i=30;return e||r||n?(e&&e<i&&(e=i),r&&r<i&&(r=i),n&&n<i&&(n=i),B(Math.min(255,Math.floor(e/t)),Math.min(255,Math.floor(r/t)),Math.min(255,Math.floor(n/t)))):B(i,i,i)},ui.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),B(Math.floor(t*this.r),Math.floor(t*this.g),Math.floor(t*this.b))},ui.hsl=function(){return W(this.r,this.g,this.b)},ui.toString=function(){return"#"+G(this.r)+G(this.g)+G(this.b)};var li=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});li.forEach((function(t,e){li.set(t,q(e,B,Q))})),d3.hsl=function(t,e,r){return 1===arguments.length?t instanceof J?Z(t.h,t.s,t.l):q(""+t,W,Z):Z(+t,+e,+r)};var ci=J.prototype=new j;ci.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),Z(this.h,this.s,this.l/t)},ci.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),Z(this.h,this.s,t*this.l)},ci.rgb=function(){return Q(this.h,this.s,this.l)},d3.hcl=function(t,e,r){return 1===arguments.length?t instanceof tt?K(t.h,t.c,t.l):ot(t instanceof nt?t.l:(t=$((t=d3.rgb(t)).r,t.g,t.b)).l,t.a,t.b):K(+t,+e,+r)};var hi=tt.prototype=new j;hi.brighter=function(t){return K(this.h,this.c,Math.min(100,this.l+di*(arguments.length?t:1)))},hi.darker=function(t){return K(this.h,this.c,Math.max(0,this.l-di*(arguments.length?t:1)))},hi.rgb=function(){return et(this.h,this.c,this.l).rgb()},d3.lab=function(t,e,r){return 1===arguments.length?t instanceof nt?rt(t.l,t.a,t.b):t instanceof tt?et(t.l,t.c,t.h):$((t=d3.rgb(t)).r,t.g,t.b):rt(+t,+e,+r)};var di=18,pi=.95047,fi=1,mi=1.08883,gi=nt.prototype=new j;gi.brighter=function(t){return rt(Math.min(100,this.l+di*(arguments.length?t:1)),this.a,this.b)},gi.darker=function(t){return rt(Math.max(0,this.l-di*(arguments.length?t:1)),this.a,this.b)},gi.rgb=function(){return it(this.l,this.a,this.b)};var vi=function(t,e){return e.querySelector(t)},yi=function(t,e){return e.querySelectorAll(t)},wi=document.documentElement,bi=wi.matchesSelector||wi.webkitMatchesSelector||wi.mozMatchesSelector||wi.msMatchesSelector||wi.oMatchesSelector,xi=function(t,e){return bi.call(t,e)};"function"===typeof Sizzle&&(vi=function(t,e){return Sizzle(t,e)[0]||null},yi=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},xi=Sizzle.matchesSelector);var _i=[];d3.selection=function(){return Si},d3.selection.prototype=_i,_i.select=function(t){var e,r,n,i,o=[];"function"!==typeof t&&(t=ct(t));for(var s=-1,a=this.length;++s<a;){o.push(e=[]),e.parentNode=(n=this[s]).parentNode;for(var u=-1,l=n.length;++u<l;)(i=n[u])?(e.push(r=t.call(i,i.__data__,u)),r&&"__data__"in i&&(r.__data__=i.__data__)):e.push(null)}return lt(o)},_i.selectAll=function(t){var e,r,n=[];"function"!==typeof t&&(t=ht(t));for(var i=-1,o=this.length;++i<o;)for(var s=this[i],a=-1,u=s.length;++a<u;)(r=s[a])&&(n.push(e=Gn(t.call(r,r.__data__,a))),e.parentNode=r);return lt(n)},_i.attr=function(t,e){if(arguments.length<2){if("string"===typeof t){var r=this.node();return t=d3.ns.qualify(t),t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}for(e in t)this.each(dt(e,t[e]));return this}return this.each(dt(t,e))},_i.classed=function(t,e){if(arguments.length<2){if("string"===typeof t){var r=this.node(),n=(t=t.trim().split(/^|\s+/g)).length,i=-1;if(e=r.classList){while(++i<n)if(!e.contains(t[i]))return!1}else{e=r.className,null!=e.baseVal&&(e=e.baseVal);while(++i<n)if(!pt(t[i]).test(e))return!1}return!0}for(e in t)this.each(ft(e,t[e]));return this}return this.each(ft(t,e))},_i.style=function(t,e,r){var n=arguments.length;if(n<3){if("string"!==typeof t){for(r in n<2&&(e=""),t)this.each(gt(r,t[r],e));return this}if(n<2)return window.getComputedStyle(this.node(),null).getPropertyValue(t);r=""}return this.each(gt(t,e,r))},_i.property=function(t,e){if(arguments.length<2){if("string"===typeof t)return this.node()[t];for(e in t)this.each(vt(e,t[e]));return this}return this.each(vt(t,e))},_i.text=function(t){return arguments.length<1?this.node().textContent:this.each("function"===typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t})},_i.html=function(t){return arguments.length<1?this.node().innerHTML:this.each("function"===typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t})},_i.append=function(t){function e(){return this.appendChild(document.createElementNS(this.namespaceURI,t))}function r(){return this.appendChild(document.createElementNS(t.space,t.local))}return t=d3.ns.qualify(t),this.select(t.local?r:e)},_i.insert=function(t,e){function r(){return this.insertBefore(document.createElementNS(this.namespaceURI,t),vi(e,this))}function n(){return this.insertBefore(document.createElementNS(t.space,t.local),vi(e,this))}return t=d3.ns.qualify(t),this.select(t.local?n:r)},_i.remove=function(){return this.each((function(){var t=this.parentNode;t&&t.removeChild(this)}))},_i.data=function(t,e){function r(t,r){var i,o,s,a=t.length,h=r.length,d=Math.min(a,h),p=Math.max(a,h),f=[],m=[],g=[];if(e){var v,y=new n,w=[],b=r.length;for(i=-1;++i<a;)v=e.call(o=t[i],o.__data__,i),y.has(v)?g[b++]=o:y.set(v,o),w.push(v);for(i=-1;++i<h;)v=e.call(r,s=r[i],i),y.has(v)?(f[i]=o=y.get(v),o.__data__=s,m[i]=g[i]=null):(m[i]=yt(s),f[i]=g[i]=null),y.remove(v);for(i=-1;++i<a;)y.has(w[i])&&(g[i]=t[i])}else{for(i=-1;++i<d;)o=t[i],s=r[i],o?(o.__data__=s,f[i]=o,m[i]=g[i]=null):(m[i]=yt(s),f[i]=g[i]=null);for(;i<h;++i)m[i]=yt(r[i]),f[i]=g[i]=null;for(;i<p;++i)g[i]=t[i],m[i]=f[i]=null}m.update=f,m.parentNode=f.parentNode=g.parentNode=t.parentNode,u.push(m),l.push(f),c.push(g)}var i,o,s=-1,a=this.length;if(!arguments.length){t=new Array(a=(i=this[0]).length);while(++s<a)(o=i[s])&&(t[s]=o.__data__);return t}var u=St([]),l=lt([]),c=lt([]);if("function"===typeof t)while(++s<a)r(i=this[s],t.call(i,i.parentNode.__data__,s));else while(++s<a)r(i=this[s],t);return l.enter=function(){return u},l.exit=function(){return c},l},_i.datum=_i.map=function(t){return arguments.length<1?this.property("__data__"):this.property("__data__",t)},_i.filter=function(t){var e,r,n,i=[];"function"!==typeof t&&(t=wt(t));for(var o=0,s=this.length;o<s;o++){i.push(e=[]),e.parentNode=(r=this[o]).parentNode;for(var a=0,u=r.length;a<u;a++)(n=r[a])&&t.call(n,n.__data__,a)&&e.push(n)}return lt(i)},_i.order=function(){for(var t=-1,e=this.length;++t<e;)for(var r,n=this[t],i=n.length-1,o=n[i];--i>=0;)(r=n[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},_i.sort=function(t){t=bt.apply(this,arguments);for(var e=-1,r=this.length;++e<r;)this[e].sort(t);return this.order()},_i.on=function(t,e,r){var n=arguments.length;if(n<3){if("string"!==typeof t){for(r in n<2&&(e=!1),t)this.each(xt(r,t[r],e));return this}if(n<2)return(n=this.node()["__on"+t])&&n._;r=!1}return this.each(xt(t,e,r))},_i.each=function(t){return _t(this,(function(e,r,n){t.call(e,e.__data__,r,n)}))},_i.call=function(t){return t.apply(this,(arguments[0]=this,arguments)),this},_i.empty=function(){return!this.node()},_i.node=function(t){for(var e=0,r=this.length;e<r;e++)for(var n=this[e],i=0,o=n.length;i<o;i++){var s=n[i];if(s)return s}return null},_i.transition=function(){for(var t,e,r=[],n=-1,i=this.length;++n<i;){r.push(t=[]);for(var o=this[n],s=-1,a=o.length;++s<a;)t.push((e=o[s])?{node:e,delay:Li,duration:Oi}:null)}return Mt(r,Ai||++Ti,Date.now())};var Si=lt([[document]]);Si[0].parentNode=wi,d3.select=function(t){return"string"===typeof t?Si.select(t):lt([[t]])},d3.selectAll=function(t){return"string"===typeof t?Si.selectAll(t):lt([Gn(t)])};var Mi=[];d3.selection.enter=St,d3.selection.enter.prototype=Mi,Mi.append=_i.append,Mi.insert=_i.insert,Mi.empty=_i.empty,Mi.node=_i.node,Mi.select=function(t){for(var e,r,n,i,o,s=[],a=-1,u=this.length;++a<u;){n=(i=this[a]).update,s.push(e=[]),e.parentNode=i.parentNode;for(var l=-1,c=i.length;++l<c;)(o=i[l])?(e.push(n[l]=r=t.call(i.parentNode,o.__data__,l)),r.__data__=o.__data__):e.push(null)}return lt(s)};var Ei=[],Ti=0,Ai=0,Pi=0,Ci=250,Ri=d3.ease("cubic-in-out"),Li=Pi,Oi=Ci,Ii=Ri;Ei.call=_i.call,d3.transition=function(t){return arguments.length?Ai?t.transition():t:Si.transition()},d3.transition.prototype=Ei,Ei.select=function(t){var e,r,n,i=[];"function"!==typeof t&&(t=ct(t));for(var o=-1,s=this.length;++o<s;){i.push(e=[]);for(var a=this[o],u=-1,l=a.length;++u<l;)(n=a[u])&&(r=t.call(n.node,n.node.__data__,u))?("__data__"in n.node&&(r.__data__=n.node.__data__),e.push({node:r,delay:n.delay,duration:n.duration})):e.push(null)}return Mt(i,this.id,this.time).ease(this.ease())},Ei.selectAll=function(t){var e,r,n,i=[];"function"!==typeof t&&(t=ht(t));for(var o=-1,s=this.length;++o<s;)for(var a=this[o],u=-1,l=a.length;++u<l;)if(n=a[u]){r=t.call(n.node,n.node.__data__,u),i.push(e=[]);for(var c=-1,h=r.length;++c<h;)e.push({node:r[c],delay:n.delay,duration:n.duration})}return Mt(i,this.id,this.time).ease(this.ease())},Ei.filter=function(t){var e,r,n=[];"function"!==typeof t&&(t=wt(t));for(var i=0,o=this.length;i<o;i++){n.push(e=[]);for(var s=this[i],a=0,u=s.length;a<u;a++)(r=s[a])&&t.call(r.node,r.node.__data__,a)&&e.push(r)}return Mt(n,this.id,this.time).ease(this.ease())},Ei.attr=function(t,e){if(arguments.length<2){for(e in t)this.attrTween(e,At(t[e],e));return this}return this.attrTween(t,At(e,t))},Ei.attrTween=function(t,e){function r(t,r){var n=e.call(this,t,r,this.getAttribute(i));return n===ki?(this.removeAttribute(i),null):n&&function(t){this.setAttribute(i,n(t))}}function n(t,r){var n=e.call(this,t,r,this.getAttributeNS(i.space,i.local));return n===ki?(this.removeAttributeNS(i.space,i.local),null):n&&function(t){this.setAttributeNS(i.space,i.local,n(t))}}var i=d3.ns.qualify(t);return this.tween("attr."+t,i.local?n:r)},Ei.style=function(t,e,r){var n=arguments.length;if(n<3){if("string"!==typeof t){for(r in n<2&&(e=""),t)this.styleTween(r,At(t[r],r),e);return this}r=""}return this.styleTween(t,At(e,t),r)},Ei.styleTween=function(t,e,r){return arguments.length<3&&(r=""),this.tween("style."+t,(function(n,i){var o=e.call(this,n,i,window.getComputedStyle(this,null).getPropertyValue(t));return o===ki?(this.style.removeProperty(t),null):o&&function(e){this.style.setProperty(t,o(e),r)}}))},Ei.text=function(t){return this.tween("text",(function(e,r){this.textContent="function"===typeof t?t.call(this,e,r):t}))},Ei.remove=function(){return this.each("end.transition",(function(){var t;!this.__transition__&&(t=this.parentNode)&&t.removeChild(this)}))},Ei.delay=function(t){return _t(this,"function"===typeof t?function(e,r,n){e.delay=0|t.call(e=e.node,e.__data__,r,n)}:(t|=0,function(e){e.delay=t}))},Ei.duration=function(t){return _t(this,"function"===typeof t?function(e,r,n){e.duration=Math.max(1,0|t.call(e=e.node,e.__data__,r,n))}:(t=Math.max(1,0|t),function(e){e.duration=t}))},Ei.transition=function(){return this.select(o)},d3.tween=function(t,e){function r(r,n,i){var o=t.call(this,r,n);return null==o?""!=i&&ki:i!=o&&e(i,o+"")}function n(r,n,i){return i!=t&&e(i,t)}return"function"===typeof t?r:null==t?Tt:(t+="",n)};var Di,Ni,ki={},Fi=0,Vi={},zi=null;d3.timer=function(t,e,r){if(arguments.length<3){if(arguments.length<2)e=0;else if(!isFinite(e))return;r=Date.now()}var n=Vi[t.id];n&&n.callback===t?(n.then=r,n.delay=e):Vi[t.id=++Fi]=zi={callback:t,then:r,delay:e,next:zi},Di||(Ni=clearTimeout(Ni),Di=1,Ui(Pt))},d3.timer.flush=function(){var t,e=Date.now(),r=zi;while(r)t=e-r.then,r.delay||(r.flush=r.callback(t)),r=r.next;Ct()};var Ui=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,17)};d3.mouse=function(t){return Rt(t,O())};var ji=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(t,e){return arguments.length<2&&(e=O().touches),e?Gn(e).map((function(e){var r=Rt(t,e);return r.identifier=e.identifier,r})):[]},d3.scale={},d3.scale.linear=function(){return Nt([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Ht(d3.scale.linear(),Gt)};var Bi=d3.format(".0e");Gt.pow=function(t){return Math.pow(10,t)},qt.pow=function(t){return-Math.pow(10,-t)},d3.scale.pow=function(){return Wt(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return Xt([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(Hi)},d3.scale.category20=function(){return d3.scale.ordinal().range(Gi)},d3.scale.category20b=function(){return d3.scale.ordinal().range(qi)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Wi)};var Hi=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Gi=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],qi=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Wi=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Yt([],[])},d3.scale.quantize=function(){return Zt(0,1,[0,1])},d3.scale.threshold=function(){return Jt([.5],[0,1])},d3.scale.identity=function(){return Qt([0,1])},d3.svg={},d3.svg.arc=function(){function t(){var t=e.apply(this,arguments),o=r.apply(this,arguments),s=n.apply(this,arguments)+$i,a=i.apply(this,arguments)+$i,u=(a<s&&(u=s,s=a,a=u),a-s),l=u<Math.PI?"0":"1",c=Math.cos(s),h=Math.sin(s),d=Math.cos(a),p=Math.sin(a);return u>=Xi?t?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":t?"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*d+","+o*p+"L"+t*d+","+t*p+"A"+t+","+t+" 0 "+l+",0 "+t*c+","+t*h+"Z":"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*d+","+o*p+"L0,0Z"}var e=Kt,r=te,n=ee,i=re;return t.innerRadius=function(r){return arguments.length?(e=a(r),t):e},t.outerRadius=function(e){return arguments.length?(r=a(e),t):r},t.startAngle=function(e){return arguments.length?(n=a(e),t):n},t.endAngle=function(e){return arguments.length?(i=a(e),t):i},t.centroid=function(){var t=(e.apply(this,arguments)+r.apply(this,arguments))/2,o=(n.apply(this,arguments)+i.apply(this,arguments))/2+$i;return[Math.cos(o)*t,Math.sin(o)*t]},t};var $i=-Math.PI/2,Xi=2*Math.PI-1e-6;d3.svg.line=function(){return ne(i)};var Yi=d3.map({linear:se,"linear-closed":ae,"step-before":ue,"step-after":le,basis:me,"basis-open":ge,"basis-closed":ve,bundle:ye,cardinal:de,"cardinal-open":ce,"cardinal-closed":he,monotone:Me});Yi.forEach((function(t,e){e.key=t,e.closed=/-closed$/.test(t)}));var Zi=[0,2/3,1/3,0],Ji=[0,1/3,2/3,0],Qi=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var t=ne(Ee);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},ue.reverse=le,le.reverse=ue,d3.svg.area=function(){return Te(i)},d3.svg.area.radial=function(){var t=Te(Ee);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},d3.svg.chord=function(){function t(t,a){var u=e(this,o,t,a),l=e(this,s,t,a);return"M"+u.p0+n(u.r,u.p1,u.a1-u.a0)+(r(u,l)?i(u.r,u.p1,u.r,u.p0):i(u.r,u.p1,l.r,l.p0)+n(l.r,l.p1,l.a1-l.a0)+i(l.r,l.p1,u.r,u.p0))+"Z"}function e(t,e,r,n){var i=e.call(t,r,n),o=u.call(t,i,n),s=l.call(t,i,n)+$i,a=c.call(t,i,n)+$i;return{r:o,a0:s,a1:a,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(a),o*Math.sin(a)]}}function r(t,e){return t.a0==e.a0&&t.a1==e.a1}function n(t,e,r){return"A"+t+","+t+" 0 "+ +(r>Math.PI)+",1 "+e}function i(t,e,r,n){return"Q 0,0 "+n}var o=Ae,s=Pe,u=Ce,l=ee,c=re;return t.radius=function(e){return arguments.length?(u=a(e),t):u},t.source=function(e){return arguments.length?(o=a(e),t):o},t.target=function(e){return arguments.length?(s=a(e),t):s},t.startAngle=function(e){return arguments.length?(l=a(e),t):l},t.endAngle=function(e){return arguments.length?(c=a(e),t):c},t},d3.svg.diagonal=function(){function t(t,i){var o=e.call(this,t,i),s=r.call(this,t,i),a=(o.y+s.y)/2,u=[o,{x:o.x,y:a},{x:s.x,y:a},s];return u=u.map(n),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var e=Ae,r=Pe,n=Re;return t.source=function(r){return arguments.length?(e=a(r),t):e},t.target=function(e){return arguments.length?(r=a(e),t):r},t.projection=function(e){return arguments.length?(n=e,t):n},t},d3.svg.diagonal.radial=function(){var t=d3.svg.diagonal(),e=Re,r=t.projection;return t.projection=function(t){return arguments.length?r(Le(e=t)):e},t},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function t(t,n){return(Ki.get(e.call(this,t,n))||De)(r.call(this,t,n))}var e=Ie,r=Oe;return t.type=function(r){return arguments.length?(e=a(r),t):e},t.size=function(e){return arguments.length?(r=a(e),t):r},t};var Ki=d3.map({circle:De,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*eo)),r=e*eo;return"M0,"+-e+"L"+r+",0 0,"+e+" "+-r+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/to),r=e*to/2;return"M0,"+r+"L"+e+","+-r+" "+-e+","+-r+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/to),r=e*to/2;return"M0,"+-r+"L"+e+","+r+" "+-e+","+r+"Z"}});d3.svg.symbolTypes=Ki.keys();var to=Math.sqrt(3),eo=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function t(t){t.each((function(){var t,h=d3.select(this),d=null==l?r.ticks?r.ticks.apply(r,u):r.domain():l,p=null==e?r.tickFormat?r.tickFormat.apply(r,u):String:e,f=Fe(r,d,c),m=h.selectAll(".minor").data(f,String),g=m.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),v=d3.transition(m.exit()).style("opacity",1e-6).remove(),y=d3.transition(m).style("opacity",1),w=h.selectAll("g").data(d,String),b=w.enter().insert("g","path").style("opacity",1e-6),x=d3.transition(w.exit()).style("opacity",1e-6).remove(),_=d3.transition(w).style("opacity",1),S=Ot(r),M=h.selectAll(".domain").data([0]),E=(M.enter().append("path").attr("class","domain"),d3.transition(M)),T=r.copy(),A=this.__chart__||T;this.__chart__=T,b.append("line").attr("class","tick"),b.append("text");var P=b.select("line"),C=_.select("line"),R=w.select("text").text(p),L=b.select("text"),O=_.select("text");switch(n){case"bottom":t=Ne,g.attr("y2",o),y.attr("x2",0).attr("y2",o),P.attr("y2",i),L.attr("y",Math.max(i,0)+a),C.attr("x2",0).attr("y2",i),O.attr("x",0).attr("y",Math.max(i,0)+a),R.attr("dy",".71em").attr("text-anchor","middle"),E.attr("d","M"+S[0]+","+s+"V0H"+S[1]+"V"+s);break;case"top":t=Ne,g.attr("y2",-o),y.attr("x2",0).attr("y2",-o),P.attr("y2",-i),L.attr("y",-(Math.max(i,0)+a)),C.attr("x2",0).attr("y2",-i),O.attr("x",0).attr("y",-(Math.max(i,0)+a)),R.attr("dy","0em").attr("text-anchor","middle"),E.attr("d","M"+S[0]+","+-s+"V0H"+S[1]+"V"+-s);break;case"left":t=ke,g.attr("x2",-o),y.attr("x2",-o).attr("y2",0),P.attr("x2",-i),L.attr("x",-(Math.max(i,0)+a)),C.attr("x2",-i).attr("y2",0),O.attr("x",-(Math.max(i,0)+a)).attr("y",0),R.attr("dy",".32em").attr("text-anchor","end"),E.attr("d","M"+-s+","+S[0]+"H0V"+S[1]+"H"+-s);break;case"right":t=ke,g.attr("x2",o),y.attr("x2",o).attr("y2",0),P.attr("x2",i),L.attr("x",Math.max(i,0)+a),C.attr("x2",i).attr("y2",0),O.attr("x",Math.max(i,0)+a).attr("y",0),R.attr("dy",".32em").attr("text-anchor","start"),E.attr("d","M"+s+","+S[0]+"H0V"+S[1]+"H"+s);break}if(r.ticks)b.call(t,A),_.call(t,T),x.call(t,T),g.call(t,A),y.call(t,T),v.call(t,T);else{var I=T.rangeBand()/2,D=function(t){return T(t)+I};b.call(t,D),_.call(t,D)}}))}var e,r=d3.scale.linear(),n="bottom",i=6,o=6,s=6,a=3,u=[10],l=null,c=0;return t.scale=function(e){return arguments.length?(r=e,t):r},t.orient=function(e){return arguments.length?(n=e,t):n},t.ticks=function(){return arguments.length?(u=arguments,t):u},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(r){return arguments.length?(e=r,t):e},t.tickSize=function(e,r,n){if(!arguments.length)return i;var a=arguments.length-1;return i=+e,o=a>1?+r:i,s=a>0?+arguments[a]:i,t},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(e){return arguments.length?(c=+e,t):c},t},d3.svg.brush=function(){function t(o){o.each((function(){var o,s=d3.select(this),c=s.selectAll(".background").data([0]),h=s.selectAll(".extent").data([0]),d=s.selectAll(".resize").data(l,String);s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),c.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),h.enter().append("rect").attr("class","extent").style("cursor","move"),d.enter().append("g").attr("class",(function(t){return"resize "+t})).style("cursor",(function(t){return ro[t]})).append("rect").attr("x",(function(t){return/[ew]$/.test(t)?-3:null})).attr("y",(function(t){return/^[ns]/.test(t)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",t.empty()?"none":null),d.exit().remove(),a&&(o=Ot(a),c.attr("x",o[0]).attr("width",o[1]-o[0]),r(s)),u&&(o=Ot(u),c.attr("y",o[0]).attr("height",o[1]-o[0]),n(s)),e(s)}))}function e(t){t.selectAll(".resize").attr("transform",(function(t){return"translate("+c[+/e$/.test(t)][0]+","+c[+/^s/.test(t)][1]+")"}))}function r(t){t.select(".extent").attr("x",c[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1][0]-c[0][0])}function n(t){t.select(".extent").attr("y",c[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",c[1][1]-c[0][1])}function i(){function i(){var t=d3.event.changedTouches;return t?d3.touches(v,t)[0]:d3.mouse(v)}function l(){32==d3.event.keyCode&&(M||(m=null,E[0]-=c[1][0],E[1]-=c[1][1],M=2),L())}function h(){32==d3.event.keyCode&&2==M&&(E[0]+=c[1][0],E[1]+=c[1][1],M=0,L())}function d(){var t=i(),o=!1;g&&(t[0]+=g[0],t[1]+=g[1]),M||(d3.event.altKey?(m||(m=[(c[0][0]+c[1][0])/2,(c[0][1]+c[1][1])/2]),E[0]=c[+(t[0]<m[0])][0],E[1]=c[+(t[1]<m[1])][1]):m=null),_&&p(t,a,0)&&(r(b),o=!0),S&&p(t,u,1)&&(n(b),o=!0),o&&(e(b),w({type:"brush",mode:M?"move":"resize"}))}function p(t,e,r){var n,i,s=Ot(e),a=s[0],u=s[1],l=E[r],h=c[1][r]-c[0][r];if(M&&(a-=l,u-=h+l),n=Math.max(a,Math.min(u,t[r])),M?i=(n+=l)+h:(m&&(l=Math.max(a,Math.min(u,2*m[r]-n))),l<n?(i=n,n=l):i=l),c[0][r]!==n||c[1][r]!==i)return o=null,c[0][r]=n,c[1][r]=i,!0}function f(){d(),b.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),d3.select("body").style("cursor",null),T.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),w({type:"brushend"}),L()}var m,g,v=this,y=d3.select(d3.event.target),w=s.of(v,arguments),b=d3.select(v),x=y.datum(),_=!/^(n|s)$/.test(x)&&a,S=!/^(e|w)$/.test(x)&&u,M=y.classed("extent"),E=i(),T=d3.select(window).on("mousemove.brush",d).on("mouseup.brush",f).on("touchmove.brush",d).on("touchend.brush",f).on("keydown.brush",l).on("keyup.brush",h);if(M)E[0]=c[0][0]-E[0],E[1]=c[0][1]-E[1];else if(x){var A=+/w$/.test(x),P=+/^n/.test(x);g=[c[1-A][0]-E[0],c[1-P][1]-E[1]],E[0]=c[A][0],E[1]=c[P][1]}else d3.event.altKey&&(m=E.slice());b.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",y.style("cursor")),w({type:"brushstart"}),d(),L()}var o,s=I(t,"brushstart","brush","brushend"),a=null,u=null,l=no[0],c=[[0,0],[0,0]];return t.x=function(e){return arguments.length?(a=e,l=no[!a<<1|!u],t):a},t.y=function(e){return arguments.length?(u=e,l=no[!a<<1|!u],t):u},t.extent=function(e){var r,n,i,s,l;return arguments.length?(o=[[0,0],[0,0]],a&&(r=e[0],n=e[1],u&&(r=r[0],n=n[0]),o[0][0]=r,o[1][0]=n,a.invert&&(r=a(r),n=a(n)),n<r&&(l=r,r=n,n=l),c[0][0]=0|r,c[1][0]=0|n),u&&(i=e[0],s=e[1],a&&(i=i[1],s=s[1]),o[0][1]=i,o[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(l=i,i=s,s=l),c[0][1]=0|i,c[1][1]=0|s),t):(e=o||c,a&&(r=e[0][0],n=e[1][0],o||(r=c[0][0],n=c[1][0],a.invert&&(r=a.invert(r),n=a.invert(n)),n<r&&(l=r,r=n,n=l))),u&&(i=e[0][1],s=e[1][1],o||(i=c[0][1],s=c[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(l=i,i=s,s=l))),a&&u?[[r,i],[n,s]]:a?[r,n]:u&&[i,s])},t.clear=function(){return o=null,c[0][0]=c[0][1]=c[1][0]=c[1][1]=0,t},t.empty=function(){return a&&c[0][0]===c[1][0]||u&&c[0][1]===c[1][1]},d3.rebind(t,s,"on")};var ro={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},no=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function t(){this.on("mousedown.drag",e).on("touchstart.drag",e)}function e(){function t(){var t=a.parentNode;return c?d3.touches(t).filter((function(t){return t.identifier===c}))[0]:d3.mouse(t)}function e(){if(!a.parentNode)return i();var e=t(),r=e[0]-h[0],n=e[1]-h[1];d|=r|n,h=e,L(),u({type:"drag",x:e[0]+s[0],y:e[1]+s[1],dx:r,dy:n})}function i(){u({type:"dragend"}),d&&(L(),d3.event.target===l&&p.on("click.drag",o,!0)),p.on(c?"touchmove.drag-"+c:"mousemove.drag",null).on(c?"touchend.drag-"+c:"mouseup.drag",null)}function o(){L(),p.on("click.drag",null)}var s,a=this,u=r.of(a,arguments),l=d3.event.target,c=d3.event.touches&&d3.event.changedTouches[0].identifier,h=t(),d=0,p=d3.select(window).on(c?"touchmove.drag-"+c:"mousemove.drag",e).on(c?"touchend.drag-"+c:"mouseup.drag",i,!0);n?(s=n.apply(a,arguments),s=[s.x-h[0],s.y-h[1]]):s=[0,0],c||L(),u({type:"dragstart"})}var r=I(t,"drag","dragstart","dragend"),n=null;return t.origin=function(e){return arguments.length?(n=e,t):n},d3.rebind(t,r,"on")},d3.behavior.zoom=function(){function t(){this.on("mousedown.zoom",s).on("mousewheel.zoom",a).on("mousemove.zoom",u).on("DOMMouseScroll.zoom",a).on("dblclick.zoom",l).on("touchstart.zoom",c).on("touchmove.zoom",h).on("touchend.zoom",c)}function e(t){return[(t[0]-w[0])/b,(t[1]-w[1])/b]}function r(t){return[t[0]*b+w[0],t[1]*b+w[1]]}function n(t){b=Math.max(x[0],Math.min(x[1],t))}function i(t,e){e=r(e),w[0]+=t[0]-e[0],w[1]+=t[1]-e[1]}function o(t){m&&m.domain(f.range().map((function(t){return(t-w[0])/b})).map(f.invert)),v&&v.domain(g.range().map((function(t){return(t-w[1])/b})).map(g.invert)),d3.event.preventDefault(),t({type:"zoom",scale:b,translate:w})}function s(){function t(){l=1,i(d3.mouse(s),h),o(a)}function r(){l&&L(),c.on("mousemove.zoom",null).on("mouseup.zoom",null),l&&d3.event.target===u&&c.on("click.zoom",n,!0)}function n(){L(),c.on("click.zoom",null)}var s=this,a=_.of(s,arguments),u=d3.event.target,l=0,c=d3.select(window).on("mousemove.zoom",t).on("mouseup.zoom",r),h=e(d3.mouse(s));window.focus(),L()}function a(){d||(d=e(d3.mouse(this))),n(Math.pow(2,.002*Ve())*b),i(d3.mouse(this),d),o(_.of(this,arguments))}function u(){d=null}function l(){var t=d3.mouse(this),r=e(t);n(d3.event.shiftKey?b/2:2*b),i(t,r),o(_.of(this,arguments))}function c(){var t=d3.touches(this),r=Date.now();if(p=b,d={},t.forEach((function(t){d[t.identifier]=e(t)})),L(),1===t.length){if(r-y<500){var s=t[0],a=e(t[0]);n(2*b),i(s,a),o(_.of(this,arguments))}y=r}}function h(){var t=d3.touches(this),e=t[0],r=d[e.identifier];if(s=t[1]){var s,a=d[s.identifier];e=[(e[0]+s[0])/2,(e[1]+s[1])/2],r=[(r[0]+a[0])/2,(r[1]+a[1])/2],n(d3.event.scale*p)}i(e,r),y=null,o(_.of(this,arguments))}var d,p,f,m,g,v,y,w=[0,0],b=1,x=oo,_=I(t,"zoom");return t.translate=function(e){return arguments.length?(w=e.map(Number),t):w},t.scale=function(e){return arguments.length?(b=+e,t):b},t.scaleExtent=function(e){return arguments.length?(x=null==e?oo:e.map(Number),t):x},t.x=function(e){return arguments.length?(m=e,f=e.copy(),t):m},t.y=function(e){return arguments.length?(v=e,g=e.copy(),t):v},d3.rebind(t,_,"on")};var io,oo=[0,1/0];d3.layout={},d3.layout.bundle=function(){return function(t){var e=[],r=-1,n=t.length;while(++r<n)e.push(ze(t[r]));return e}},d3.layout.chord=function(){function t(){var t,l,h,d,p,f={},m=[],g=d3.range(o),v=[];r=[],n=[],t=0,d=-1;while(++d<o){l=0,p=-1;while(++p<o)l+=i[d][p];m.push(l),v.push(d3.range(o)),t+=l}s&&g.sort((function(t,e){return s(m[t],m[e])})),a&&v.forEach((function(t,e){t.sort((function(t,r){return a(i[e][t],i[e][r])}))})),t=(2*Math.PI-c*o)/t,l=0,d=-1;while(++d<o){h=l,p=-1;while(++p<o){var y=g[d],w=v[y][p],b=i[y][w],x=l,_=l+=b*t;f[y+"-"+w]={index:y,subindex:w,startAngle:x,endAngle:_,value:b}}n[y]={index:y,startAngle:h,endAngle:l,value:(l-h)/t},l+=c}d=-1;while(++d<o){p=d-1;while(++p<o){var S=f[d+"-"+p],M=f[p+"-"+d];(S.value||M.value)&&r.push(S.value<M.value?{source:M,target:S}:{source:S,target:M})}}u&&e()}function e(){r.sort((function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)}))}var r,n,i,o,s,a,u,l={},c=0;return l.matrix=function(t){return arguments.length?(o=(i=t)&&i.length,r=n=null,l):i},l.padding=function(t){return arguments.length?(c=t,r=n=null,l):c},l.sortGroups=function(t){return arguments.length?(s=t,r=n=null,l):s},l.sortSubgroups=function(t){return arguments.length?(a=t,r=null,l):a},l.sortChords=function(t){return arguments.length?(u=t,r&&e(),l):u},l.chords=function(){return r||t(),r},l.groups=function(){return n||t(),n},l},d3.layout.force=function(){function t(t){return function(e,r,n,i,o){if(e.point!==t){var s=e.cx-t.x,a=e.cy-t.y,u=1/Math.sqrt(s*s+a*a);if((i-r)*u<v){var l=e.charge*u*u;return t.px-=s*l,t.py-=a*l,!0}if(e.point&&isFinite(u)){l=e.pointCharge*u*u;t.px-=s*l,t.py-=a*l}}return!e.charge}}function e(t){t.px=d3.event.x,t.py=d3.event.y,l.resume()}var r,n,o,s,u,l={},c=d3.dispatch("start","tick","end"),h=[1,1],d=.9,p=$e,f=Xe,m=-30,g=.1,v=.8,y=[],w=[];return l.tick=function(){if((n*=.99)<.005)return c.end({type:"end",alpha:n=0}),!0;var e,r,i,a,l,p,f,v,b,x=y.length,_=w.length;for(r=0;r<_;++r)i=w[r],a=i.source,l=i.target,v=l.x-a.x,b=l.y-a.y,(p=v*v+b*b)&&(p=n*s[r]*((p=Math.sqrt(p))-o[r])/p,v*=p,b*=p,l.x-=v*(f=a.weight/(l.weight+a.weight)),l.y-=b*f,a.x+=v*(f=1-f),a.y+=b*f);if((f=n*g)&&(v=h[0]/2,b=h[1]/2,r=-1,f))while(++r<x)i=y[r],i.x+=(v-i.x)*f,i.y+=(b-i.y)*f;if(m){We(e=d3.geom.quadtree(y),n,u),r=-1;while(++r<x)(i=y[r]).fixed||e.visit(t(i))}r=-1;while(++r<x)i=y[r],i.fixed?(i.x=i.px,i.y=i.py):(i.x-=(i.px-(i.px=i.x))*d,i.y-=(i.py-(i.py=i.y))*d);c.tick({type:"tick",alpha:n})},l.nodes=function(t){return arguments.length?(y=t,l):y},l.links=function(t){return arguments.length?(w=t,l):w},l.size=function(t){return arguments.length?(h=t,l):h},l.linkDistance=function(t){return arguments.length?(p=a(t),l):p},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f=a(t),l):f},l.friction=function(t){return arguments.length?(d=t,l):d},l.charge=function(t){return arguments.length?(m="function"===typeof t?t:+t,l):m},l.gravity=function(t){return arguments.length?(g=t,l):g},l.theta=function(t){return arguments.length?(v=t,l):v},l.alpha=function(t){return arguments.length?(n?n=t>0?t:0:t>0&&(c.start({type:"start",alpha:n=t}),d3.timer(l.tick)),l):n},l.start=function(){function t(t,n){var i,o=e(r),s=-1,a=o.length;while(++s<a)if(!isNaN(i=o[s][t]))return i;return Math.random()*n}function e(){if(!i){for(i=[],n=0;n<c;++n)i[n]=[];for(n=0;n<d;++n){var t=w[n];i[t.source.index].push(t.target),i[t.target.index].push(t.source)}}return i[r]}var r,n,i,a,c=y.length,d=w.length,g=h[0],v=h[1];for(r=0;r<c;++r)(a=y[r]).index=r,a.weight=0;for(o=[],s=[],r=0;r<d;++r)a=w[r],"number"==typeof a.source&&(a.source=y[a.source]),"number"==typeof a.target&&(a.target=y[a.target]),o[r]=p.call(this,a,r),s[r]=f.call(this,a,r),++a.source.weight,++a.target.weight;for(r=0;r<c;++r)a=y[r],isNaN(a.x)&&(a.x=t("x",g)),isNaN(a.y)&&(a.y=t("y",v)),isNaN(a.px)&&(a.px=a.x),isNaN(a.py)&&(a.py=a.y);if(u=[],"function"===typeof m)for(r=0;r<c;++r)u[r]=+m.call(this,y[r],r);else for(r=0;r<c;++r)u[r]=m;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){r||(r=d3.behavior.drag().origin(i).on("dragstart",Be).on("drag",e).on("dragend",He)),this.on("mouseover.force",Ge).on("mouseout.force",qe).call(r)},d3.rebind(l,c,"on")},d3.layout.partition=function(){function t(e,r,n,i){var o=e.children;if(e.x=r,e.y=e.depth*i,e.dx=n,e.dy=i,o&&(s=o.length)){var s,a,u,l=-1;n=e.value?n/e.value:0;while(++l<s)t(a=o[l],r,u=a.value*n,i),r+=u}}function e(t){var r=t.children,n=0;if(r&&(i=r.length)){var i,o=-1;while(++o<i)n=Math.max(n,e(r[o]))}return 1+n}function r(r,o){var s=n.call(this,r,o);return t(s[0],0,i[0],i[1]/e(s[0])),s}var n=d3.layout.hierarchy(),i=[1,1];return r.size=function(t){return arguments.length?(i=t,r):i},sr(r,n)},d3.layout.pie=function(){function t(o,s){var a=o.map((function(r,n){return+e.call(t,r,n)})),u=+("function"===typeof n?n.apply(this,arguments):n),l=(("function"===typeof i?i.apply(this,arguments):i)-n)/d3.sum(a),c=d3.range(o.length);null!=r&&c.sort(r===so?function(t,e){return a[e]-a[t]}:function(t,e){return r(o[t],o[e])});var h=[];return c.forEach((function(t){var e;h[t]={data:o[t],value:e=a[t],startAngle:u,endAngle:u+=e*l}})),h}var e=Number,r=so,n=0,i=2*Math.PI;return t.value=function(r){return arguments.length?(e=r,t):e},t.sort=function(e){return arguments.length?(r=e,t):r},t.startAngle=function(e){return arguments.length?(n=e,t):n},t.endAngle=function(e){return arguments.length?(i=e,t):i},t};var so={};d3.layout.stack=function(){function t(i,u){var l=i.map((function(r,n){return e.call(t,r,n)})),c=l.map((function(e,r){return e.map((function(e,r){return[s.call(t,e,r),a.call(t,e,r)]}))})),h=r.call(t,c,u);l=d3.permute(l,h),c=d3.permute(c,h);var d,p,f,m=n.call(t,c,u),g=l.length,v=l[0].length;for(p=0;p<v;++p)for(o.call(t,l[0][p],f=m[p],c[0][p][1]),d=1;d<g;++d)o.call(t,l[d][p],f+=c[d-1][p][1],c[d][p][1]);return i}var e=i,r=Qe,n=Ke,o=Je,s=Ye,a=Ze;return t.values=function(r){return arguments.length?(e=r,t):e},t.order=function(e){return arguments.length?(r="function"===typeof e?e:ao.get(e)||Qe,t):r},t.offset=function(e){return arguments.length?(n="function"===typeof e?e:uo.get(e)||Ke,t):n},t.x=function(e){return arguments.length?(s=e,t):s},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(o=e,t):o},t};var ao=d3.map({"inside-out":function(t){var e,r,n=t.length,i=t.map(tr),o=t.map(er),s=d3.range(n).sort((function(t,e){return i[t]-i[e]})),a=0,u=0,l=[],c=[];for(e=0;e<n;++e)r=s[e],a<u?(a+=o[r],l.push(r)):(u+=o[r],c.push(r));return c.reverse().concat(l)},reverse:function(t){return d3.range(t.length).reverse()},default:Qe}),uo=d3.map({silhouette:function(t){var e,r,n,i=t.length,o=t[0].length,s=[],a=0,u=[];for(r=0;r<o;++r){for(e=0,n=0;e<i;e++)n+=t[e][r][1];n>a&&(a=n),s.push(n)}for(r=0;r<o;++r)u[r]=(a-s[r])/2;return u},wiggle:function(t){var e,r,n,i,o,s,a,u,l,c=t.length,h=t[0],d=h.length,p=[];for(p[0]=u=l=0,r=1;r<d;++r){for(e=0,i=0;e<c;++e)i+=t[e][r][1];for(e=0,o=0,a=h[r][0]-h[r-1][0];e<c;++e){for(n=0,s=(t[e][r][1]-t[e][r-1][1])/(2*a);n<e;++n)s+=(t[n][r][1]-t[n][r-1][1])/a;o+=s*t[e][r][1]}p[r]=u-=i?o/i*a:0,u<l&&(l=u)}for(r=0;r<d;++r)p[r]-=l;return p},expand:function(t){var e,r,n,i=t.length,o=t[0].length,s=1/i,a=[];for(r=0;r<o;++r){for(e=0,n=0;e<i;e++)n+=t[e][r][1];if(n)for(e=0;e<i;e++)t[e][r][1]/=n;else for(e=0;e<i;e++)t[e][r][1]=s}for(r=0;r<o;++r)a[r]=0;return a},zero:Ke});d3.layout.histogram=function(){function t(t,o){var s,a,u=[],l=t.map(r,this),c=n.call(this,l,o),h=i.call(this,c,l,o),d=(o=-1,l.length),p=h.length-1,f=e?1:1/d;while(++o<p)s=u[o]=[],s.dx=h[o+1]-(s.x=h[o]),s.y=0;if(p>0){o=-1;while(++o<d)a=l[o],a>=c[0]&&a<=c[1]&&(s=u[d3.bisect(h,a,1,p)-1],s.y+=f,s.push(t[o]))}return u}var e=!0,r=Number,n=or,i=nr;return t.value=function(e){return arguments.length?(r=e,t):r},t.range=function(e){return arguments.length?(n=a(e),t):n},t.bins=function(e){return arguments.length?(i="number"===typeof e?function(t){return ir(t,e)}:a(e),t):i},t.frequency=function(r){return arguments.length?(e=!!r,t):e},t},d3.layout.hierarchy=function(){function t(e,s,a){var u=i.call(r,e,s),l=lo?e:{data:e};if(l.depth=s,a.push(l),u&&(c=u.length)){var c,h,d=-1,p=l.children=[],f=0,m=s+1;while(++d<c)h=t(u[d],m,a),h.parent=l,p.push(h),f+=h.value;n&&p.sort(n),o&&(l.value=f)}else o&&(l.value=+o.call(r,e,s)||0);return l}function e(t,n){var i=t.children,s=0;if(i&&(a=i.length)){var a,u=-1,l=n+1;while(++u<a)s+=e(i[u],l)}else o&&(s=+o.call(r,lo?t:t.data,n)||0);return o&&(t.value=s),s}function r(e){var r=[];return t(e,0,r),r}var n=lr,i=ar,o=ur;return r.sort=function(t){return arguments.length?(n=t,r):n},r.children=function(t){return arguments.length?(i=t,r):i},r.value=function(t){return arguments.length?(o=t,r):o},r.revalue=function(t){return e(t,0),t},r};var lo=!1;d3.layout.pack=function(){function t(t,i){var o=e.call(this,t,i),s=o[0];s.x=0,s.y=0,Lr(s,(function(t){t.r=Math.sqrt(t.value)})),Lr(s,mr);var a=n[0],u=n[1],l=Math.max(2*s.r/a,2*s.r/u);if(r>0){var c=r*l/2;Lr(s,(function(t){t.r+=c})),Lr(s,mr),Lr(s,(function(t){t.r-=c})),l=Math.max(2*s.r/a,2*s.r/u)}return yr(s,a/2,u/2,1/l),o}var e=d3.layout.hierarchy().sort(hr),r=0,n=[1,1];return t.size=function(e){return arguments.length?(n=e,t):n},t.padding=function(e){return arguments.length?(r=+e,t):r},sr(t,e)},d3.layout.cluster=function(){function t(t,i){var o,s=e.call(this,t,i),a=s[0],u=0;Lr(a,(function(t){var e=t.children;e&&e.length?(t.x=xr(e),t.y=br(e)):(t.x=o?u+=r(t,o):0,t.y=0,o=t)}));var l=_r(a),c=Sr(a),h=l.x-r(l,c)/2,d=c.x+r(c,l)/2;return Lr(a,(function(t){t.x=(t.x-h)/(d-h)*n[0],t.y=(1-(a.y?t.y/a.y:1))*n[1]})),s}var e=d3.layout.hierarchy().sort(null).value(null),r=Mr,n=[1,1];return t.separation=function(e){return arguments.length?(r=e,t):r},t.size=function(e){return arguments.length?(n=e,t):n},sr(t,e)},d3.layout.tree=function(){function t(t,i){function o(t,e){var n=t.children,i=t._tree;if(n&&(s=n.length)){var s,u,l,c=n[0],h=c,d=-1;while(++d<s)l=n[d],o(l,u),h=a(l,u,h),u=l;Or(t);var p=.5*(c._tree.prelim+l._tree.prelim);e?(i.prelim=e._tree.prelim+r(t,e),i.mod=i.prelim-p):i.prelim=p}else e&&(i.prelim=e._tree.prelim+r(t,e))}function s(t,e){t.x=t._tree.prelim+e;var r=t.children;if(r&&(n=r.length)){var n,i=-1;e+=t._tree.mod;while(++i<n)s(r[i],e)}}function a(t,e,n){if(e){var i,o=t,s=t,a=e,u=t.parent.children[0],l=o._tree.mod,c=s._tree.mod,h=a._tree.mod,d=u._tree.mod;while(a=Tr(a),o=Er(o),a&&o)u=Er(u),s=Tr(s),s._tree.ancestor=t,i=a._tree.prelim+h-o._tree.prelim-l+r(a,o),i>0&&(Ir(Dr(a,t,n),t,i),l+=i,c+=i),h+=a._tree.mod,l+=o._tree.mod,d+=u._tree.mod,c+=s._tree.mod;a&&!Tr(s)&&(s._tree.thread=a,s._tree.mod+=h-c),o&&!Er(u)&&(u._tree.thread=o,u._tree.mod+=l-d,n=t)}return n}var u=e.call(this,t,i),l=u[0];Lr(l,(function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}})),o(l),s(l,-l._tree.prelim);var c=Ar(l,Cr),h=Ar(l,Pr),d=Ar(l,Rr),p=c.x-r(c,h)/2,f=h.x+r(h,c)/2,m=d.depth||1;return Lr(l,(function(t){t.x=(t.x-p)/(f-p)*n[0],t.y=t.depth/m*n[1],delete t._tree})),u}var e=d3.layout.hierarchy().sort(null).value(null),r=Mr,n=[1,1];return t.separation=function(e){return arguments.length?(r=e,t):r},t.size=function(e){return arguments.length?(n=e,t):n},sr(t,e)},d3.layout.treemap=function(){function t(t,e){var r,n,i=-1,o=t.length;while(++i<o)n=(r=t[i]).value*(e<0?0:e),r.area=isNaN(n)||n<=0?0:n}function e(r){var o=r.children;if(o&&o.length){var s,a,u,l=h(r),c=[],d=o.slice(),p=1/0,f=Math.min(l.dx,l.dy);t(d,l.dx*l.dy/r.value),c.area=0;while((u=d.length)>0)c.push(s=d[u-1]),c.area+=s.area,(a=n(c,f))<=p?(d.pop(),p=a):(c.area-=c.pop().area,i(c,f,l,!1),f=Math.min(l.dx,l.dy),c.length=c.area=0,p=1/0);c.length&&(i(c,f,l,!0),c.length=c.area=0),o.forEach(e)}}function r(e){var n=e.children;if(n&&n.length){var o,s=h(e),a=n.slice(),u=[];t(a,s.dx*s.dy/e.value),u.area=0;while(o=a.pop())u.push(o),u.area+=o.area,null!=o.z&&(i(u,o.z?s.dx:s.dy,s,!a.length),u.length=u.area=0);n.forEach(r)}}function n(t,e){var r,n=t.area,i=0,o=1/0,s=-1,a=t.length;while(++s<a)(r=t[s].area)&&(r<o&&(o=r),r>i&&(i=r));return n*=n,e*=e,n?Math.max(e*i*p/n,n/(e*o*p)):1/0}function i(t,e,r,n){var i,o=-1,s=t.length,a=r.x,l=r.y,c=e?u(t.area/e):0;if(e==r.dx){(n||c>r.dy)&&(c=r.dy);while(++o<s)i=t[o],i.x=a,i.y=l,i.dy=c,a+=i.dx=Math.min(r.x+r.dx-a,c?u(i.area/c):0);i.z=!0,i.dx+=r.x+r.dx-a,r.y+=c,r.dy-=c}else{(n||c>r.dx)&&(c=r.dx);while(++o<s)i=t[o],i.x=a,i.y=l,i.dx=c,l+=i.dy=Math.min(r.y+r.dy-l,c?u(i.area/c):0);i.z=!1,i.dy+=r.y+r.dy-l,r.x+=c,r.dx-=c}}function o(n){var i=s||a(n),o=i[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],s&&a.revalue(o),t([o],o.dx*o.dy/o.value),(s?r:e)(o),d&&(s=i),i}var s,a=d3.layout.hierarchy(),u=Math.round,l=[1,1],c=null,h=Nr,d=!1,p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(l=t,o):l},o.padding=function(t){function e(e){var r=t.call(o,e,e.depth);return null==r?Nr(e):kr(e,"number"===typeof r?[r,r,r,r]:r)}function r(e){return kr(e,t)}return arguments.length?(h=null==(c=t)?Nr:"function"===(n=typeof t)?e:"number"===n?(t=[t,t,t,t],r):r,o):c;var n},o.round=function(t){return arguments.length?(u=t?Math.round:Number,o):u!=Number},o.sticky=function(t){return arguments.length?(d=t,s=null,o):d},o.ratio=function(t){return arguments.length?(p=t,o):p},sr(o,a)},d3.csv=Fr(",","text/csv"),d3.tsv=Fr("\t","text/tab-separated-values"),d3.geo={};var co=Math.PI/180;d3.geo.azimuthal=function(){function t(t){var e,n=t[0]*co-r,l=t[1]*co,c=Math.cos(n),h=Math.sin(n),d=Math.cos(l),p=Math.sin(l),f="orthographic"!==s?o*p+i*d*c:null,m="stereographic"===s?1/(1+f):"gnomonic"===s?1/f:"equidistant"===s?(e=Math.acos(f),e?e/Math.sin(e):0):"equalarea"===s?Math.sqrt(2/(1+f)):1,g=m*d*h,v=m*(o*d*c-i*p);return[a*g+u[0],a*v+u[1]]}var e,r,n,i,o,s="orthographic",a=200,u=[480,250];return t.invert=function(t){var e=(t[0]-u[0])/a,n=(t[1]-u[1])/a,l=Math.sqrt(e*e+n*n),c="stereographic"===s?2*Math.atan(l):"gnomonic"===s?Math.atan(l):"equidistant"===s?l:"equalarea"===s?2*Math.asin(.5*l):Math.asin(l),h=Math.sin(c),d=Math.cos(c);return[(r+Math.atan2(e*h,l*i*d+n*o*h))/co,Math.asin(d*o-(l?n*h*i/l:0))/co]},t.mode=function(e){return arguments.length?(s=e+"",t):s},t.origin=function(s){return arguments.length?(e=s,r=e[0]*co,n=e[1]*co,i=Math.cos(n),o=Math.sin(n),t):e},t.scale=function(e){return arguments.length?(a=+e,t):a},t.translate=function(e){return arguments.length?(u=[+e[0],+e[1]],t):u},t.origin([0,0])},d3.geo.albers=function(){function t(t){var e=n*(co*t[0]-r),s=Math.sqrt(i-2*n*Math.sin(co*t[1]))/n;return[u*s*Math.sin(e)+l[0],u*(s*Math.cos(e)-o)+l[1]]}function e(){var e=co*a[0],u=co*a[1],l=co*s[1],c=Math.sin(e),h=Math.cos(e);return r=co*s[0],n=.5*(c+Math.sin(u)),i=h*h+2*n*c,o=Math.sqrt(i-2*n*Math.sin(l))/n,t}var r,n,i,o,s=[-98,38],a=[29.5,45.5],u=1e3,l=[480,250];return t.invert=function(t){var e=(t[0]-l[0])/u,s=(t[1]-l[1])/u,a=o+s,c=Math.atan2(e,a),h=Math.sqrt(e*e+a*a);return[(r+c/n)/co,Math.asin((i-h*h*n*n)/(2*n))/co]},t.origin=function(t){return arguments.length?(s=[+t[0],+t[1]],e()):s},t.parallels=function(t){return arguments.length?(a=[+t[0],+t[1]],e()):a},t.scale=function(e){return arguments.length?(u=+e,t):u},t.translate=function(e){return arguments.length?(l=[+e[0],+e[1]],t):l},e()},d3.geo.albersUsa=function(){function t(t){var o=t[0],s=t[1];return(s>50?r:o<-140?n:s<21?i:e)(t)}var e=d3.geo.albers(),r=d3.geo.albers().origin([-160,60]).parallels([55,65]),n=d3.geo.albers().origin([-160,20]).parallels([8,18]),i=d3.geo.albers().origin([-60,10]).parallels([8,18]);return t.scale=function(o){return arguments.length?(e.scale(o),r.scale(.6*o),n.scale(o),i.scale(1.5*o),t.translate(e.translate())):e.scale()},t.translate=function(o){if(!arguments.length)return e.translate();var s=e.scale()/1e3,a=o[0],u=o[1];return e.translate(o),r.translate([a-400*s,u+170*s]),n.translate([a-190*s,u+200*s]),i.translate([a+580*s,u+430*s]),t},t.scale(e.scale())},d3.geo.bonne=function(){function t(t){var a=t[0]*co-e,u=t[1]*co-r;if(n){var l=i+n-u,c=a*Math.cos(u)/l;a=l*Math.sin(c),u=l*Math.cos(c)-i}else a*=Math.cos(u),u*=-1;return[o*a+s[0],o*u+s[1]]}var e,r,n,i,o=200,s=[480,250];return t.invert=function(t){var r=(t[0]-s[0])/o,a=(t[1]-s[1])/o;if(n){var u=i+a,l=Math.sqrt(r*r+u*u);a=i+n-l,r=e+l*Math.atan2(r,u)/Math.cos(a)}else a*=-1,r/=Math.cos(a);return[r/co,a/co]},t.parallel=function(e){return arguments.length?(i=1/Math.tan(n=e*co),t):n/co},t.origin=function(n){return arguments.length?(e=n[0]*co,r=n[1]*co,t):[e/co,r/co]},t.scale=function(e){return arguments.length?(o=+e,t):o},t.translate=function(e){return arguments.length?(s=[+e[0],+e[1]],t):s},t.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function t(t){var n=t[0]/360,i=-t[1]/360;return[e*n+r[0],e*i+r[1]]}var e=500,r=[480,250];return t.invert=function(t){var n=(t[0]-r[0])/e,i=(t[1]-r[1])/e;return[360*n,-360*i]},t.scale=function(r){return arguments.length?(e=+r,t):e},t.translate=function(e){return arguments.length?(r=[+e[0],+e[1]],t):r},t},d3.geo.mercator=function(){function t(t){var n=t[0]/360,i=-Math.log(Math.tan(Math.PI/4+t[1]*co/2))/co/360;return[e*n+r[0],e*Math.max(-.5,Math.min(.5,i))+r[1]]}var e=500,r=[480,250];return t.invert=function(t){var n=(t[0]-r[0])/e,i=(t[1]-r[1])/e;return[360*n,2*Math.atan(Math.exp(-360*i*co))/co-90]},t.scale=function(r){return arguments.length?(e=+r,t):e},t.translate=function(e){return arguments.length?(r=[+e[0],+e[1]],t):r},t},d3.geo.path=function(){function t(t,e){"function"===typeof o&&(s=zr(o.apply(this,arguments))),l(t);var r=u.length?u.join(""):null;return u=[],r}function e(t){return a(t).join(",")}function r(t){var e=i(t[0]),r=0,n=t.length;while(++r<n)e-=i(t[r]);return e}function n(t){var e=d3.geom.polygon(t[0].map(a)),r=e.area(),n=e.centroid(r<0?(r*=-1,1):-1),i=n[0],o=n[1],s=r,u=0,l=t.length;while(++u<l)e=d3.geom.polygon(t[u].map(a)),r=e.area(),n=e.centroid(r<0?(r*=-1,1):-1),i-=n[0],o-=n[1],s-=r;return[i,o,6*s]}function i(t){return Math.abs(d3.geom.polygon(t.map(a)).area())}var o=4.5,s=zr(o),a=d3.geo.albersUsa(),u=[],l=Vr({FeatureCollection:function(t){var e=t.features,r=-1,n=e.length;while(++r<n)u.push(l(e[r].geometry))},Feature:function(t){l(t.geometry)},Point:function(t){u.push("M",e(t.coordinates),s)},MultiPoint:function(t){var r=t.coordinates,n=-1,i=r.length;while(++n<i)u.push("M",e(r[n]),s)},LineString:function(t){var r=t.coordinates,n=-1,i=r.length;u.push("M");while(++n<i)u.push(e(r[n]),"L");u.pop()},MultiLineString:function(t){var r,n,i,o=t.coordinates,s=-1,a=o.length;while(++s<a){r=o[s],n=-1,i=r.length,u.push("M");while(++n<i)u.push(e(r[n]),"L");u.pop()}},Polygon:function(t){var r,n,i,o=t.coordinates,s=-1,a=o.length;while(++s<a)if(r=o[s],n=-1,(i=r.length-1)>0){u.push("M");while(++n<i)u.push(e(r[n]),"L");u[u.length-1]="Z"}},MultiPolygon:function(t){var r,n,i,o,s,a,l=t.coordinates,c=-1,h=l.length;while(++c<h){r=l[c],n=-1,i=r.length;while(++n<i)if(o=r[n],s=-1,(a=o.length-1)>0){u.push("M");while(++s<a)u.push(e(o[s]),"L");u[u.length-1]="Z"}}},GeometryCollection:function(t){var e=t.geometries,r=-1,n=e.length;while(++r<n)u.push(l(e[r]))}}),c=t.area=Vr({FeatureCollection:function(t){var e=0,r=t.features,n=-1,i=r.length;while(++n<i)e+=c(r[n]);return e},Feature:function(t){return c(t.geometry)},Polygon:function(t){return r(t.coordinates)},MultiPolygon:function(t){var e=0,n=t.coordinates,i=-1,o=n.length;while(++i<o)e+=r(n[i]);return e},GeometryCollection:function(t){var e=0,r=t.geometries,n=-1,i=r.length;while(++n<i)e+=c(r[n]);return e}},0),h=t.centroid=Vr({Feature:function(t){return h(t.geometry)},Polygon:function(t){var e=n(t.coordinates);return[e[0]/e[2],e[1]/e[2]]},MultiPolygon:function(t){var e,r=t.coordinates,i=0,o=0,s=0,a=-1,u=r.length;while(++a<u)e=n(r[a]),i+=e[0],o+=e[1],s+=e[2];return[i/s,o/s]}});return t.projection=function(e){return a=e,t},t.pointRadius=function(e){return"function"===typeof e?o=e:(o=+e,s=zr(o)),t},t},d3.geo.bounds=function(t){var e=1/0,r=1/0,n=-1/0,i=-1/0;return Ur(t,(function(t,o){t<e&&(e=t),t>n&&(n=t),o<r&&(r=o),o>i&&(i=o)})),[[e,r],[n,i]]};var ho={Feature:jr,FeatureCollection:Br,GeometryCollection:Hr,LineString:Gr,MultiLineString:qr,MultiPoint:Gr,MultiPolygon:Wr,Point:$r,Polygon:Xr};d3.geo.circle=function(){function t(){}function e(t){return u.distance(t)<a}function r(t){var e,r,i,o,s,l=-1,c=t.length,h=[];while(++l<c)s=u.distance(i=t[l]),s<a?(r&&h.push(Qr(r,i)((o-a)/(o-s))),h.push(i),e=r=null):(r=i,!e&&h.length&&(h.push(Qr(h[h.length-1],r)((a-o)/(s-o))),e=r)),o=s;return e=t[0],r=h[0],!r||i[0]!==e[0]||i[1]!==e[1]||i[0]===r[0]&&i[1]===r[1]||h.push(r),n(h)}function n(t){var e,r,n,i=0,o=t.length,s=o?[t[0]]:t,a=u.source();while(++i<o)for(n=u.source(t[i-1])(t[i]).coordinates,e=0,r=n.length;++e<r;)s.push(n[e]);return u.source(a),s}var o=[0,0],s=89.99,a=s*co,u=d3.geo.greatArc().source(o).target(i);t.clip=function(t){return"function"===typeof o&&u.source(o.apply(this,arguments)),l(t)||null};var l=Vr({FeatureCollection:function(t){var e=t.features.map(l).filter(i);return e&&(t=Object.create(t),t.features=e,t)},Feature:function(t){var e=l(t.geometry);return e&&(t=Object.create(t),t.geometry=e,t)},Point:function(t){return e(t.coordinates)&&t},MultiPoint:function(t){var r=t.coordinates.filter(e);return r.length&&{type:t.type,coordinates:r}},LineString:function(t){var e=r(t.coordinates);return e.length&&(t=Object.create(t),t.coordinates=e,t)},MultiLineString:function(t){var e=t.coordinates.map(r).filter((function(t){return t.length}));return e.length&&(t=Object.create(t),t.coordinates=e,t)},Polygon:function(t){var e=t.coordinates.map(r);return e[0].length&&(t=Object.create(t),t.coordinates=e,t)},MultiPolygon:function(t){var e=t.coordinates.map((function(t){return t.map(r)})).filter((function(t){return t[0].length}));return e.length&&(t=Object.create(t),t.coordinates=e,t)},GeometryCollection:function(t){var e=t.geometries.map(l).filter(i);return e.length&&(t=Object.create(t),t.geometries=e,t)}});return t.origin=function(e){return arguments.length?(o=e,"function"!==typeof o&&u.source(o),t):o},t.angle=function(e){return arguments.length?(a=(s=+e)*co,t):s},d3.rebind(t,u,"precision")},d3.geo.greatArc=function(){function t(){var n=t.distance.apply(this,arguments),i=0,a=o/n,u=[e];while((i+=a)<1)u.push(s(i));return u.push(r),{type:"LineString",coordinates:u}}var e,r,n=Yr,i=Zr,o=6*co,s=Jr();return t.distance=function(){return"function"===typeof n&&s.source(e=n.apply(this,arguments)),"function"===typeof i&&s.target(r=i.apply(this,arguments)),s.distance()},t.source=function(r){return arguments.length?(n=r,"function"!==typeof n&&s.source(e=n),t):n},t.target=function(e){return arguments.length?(i=e,"function"!==typeof i&&s.target(r=i),t):i},t.precision=function(e){return arguments.length?(o=e*co,t):o/co},t},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(t,e){var r=e||Kr(t),n=[],i=r[0],o=r[1],s=0,a=0,u=NaN,l=NaN,c=0;do{c=0,t(i-1,o-1)&&(c+=1),t(i,o-1)&&(c+=2),t(i-1,o)&&(c+=4),t(i,o)&&(c+=8),6===c?(s=-1===l?-1:1,a=0):9===c?(s=0,a=1===u?-1:1):(s=po[c],a=fo[c]),s!=u&&a!=l&&(n.push([i,o]),u=s,l=a),i+=s,o+=a}while(r[0]!=i||r[1]!=o);return n};var po=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],fo=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(t){if(t.length<3)return[];var e,r,n,i,o,s,a,u,l,c,h=t.length,d=h-1,p=[],f=[],m=0;for(e=1;e<h;++e)t[e][1]<t[m][1]?m=e:t[e][1]==t[m][1]&&(m=t[e][0]<t[m][0]?e:m);for(e=0;e<h;++e)e!==m&&(i=t[e][1]-t[m][1],n=t[e][0]-t[m][0],p.push({angle:Math.atan2(i,n),index:e}));for(p.sort((function(t,e){return t.angle-e.angle})),l=p[0].angle,u=p[0].index,a=0,e=1;e<d;++e)r=p[e].index,l==p[e].angle?(n=t[u][0]-t[m][0],i=t[u][1]-t[m][1],o=t[r][0]-t[m][0],s=t[r][1]-t[m][1],n*n+i*i>=o*o+s*s?p[e].index=-1:(p[a].index=-1,l=p[e].angle,a=e,u=r)):(l=p[e].angle,a=e,u=r);for(f.push(m),e=0,r=0;e<2;++r)-1!==p[r].index&&(f.push(p[r].index),e++);for(c=f.length;r<d;++r)if(-1!==p[r].index){while(!tn(f[c-2],f[c-1],p[r].index,t))--c;f[c++]=p[r].index}var g=[];for(e=0;e<c;++e)g.push(t[f[e]]);return g},d3.geom.polygon=function(t){return t.area=function(){var e=0,r=t.length,n=t[r-1][0]*t[0][1],i=t[r-1][1]*t[0][0];while(++e<r)n+=t[e-1][0]*t[e][1],i+=t[e-1][1]*t[e][0];return.5*(i-n)},t.centroid=function(e){var r,n,i=-1,o=t.length,s=0,a=0,u=t[o-1];arguments.length||(e=-1/(6*t.area()));while(++i<o)r=u,u=t[i],n=r[0]*u[1]-u[0]*r[1],s+=(r[0]+u[0])*n,a+=(r[1]+u[1])*n;return[s*e,a*e]},t.clip=function(e){var r,n,i,o,s,a,u=-1,l=t.length,c=t[l-1];while(++u<l){r=e.slice(),e.length=0,o=t[u],s=r[(i=r.length)-1],n=-1;while(++n<i)a=r[n],en(a,c,o)?(en(s,c,o)||e.push(rn(s,a,c,o)),e.push(a)):en(s,c,o)&&e.push(rn(s,a,c,o)),s=a;c=o}return e},t},d3.geom.voronoi=function(t){var e=t.map((function(){return[]}));return nn(t,(function(t){var r,n,i,o,s,a;1===t.a&&t.b>=0?(r=t.ep.r,n=t.ep.l):(r=t.ep.l,n=t.ep.r),1===t.a?(s=r?r.y:-1e6,i=t.c-t.b*s,a=n?n.y:1e6,o=t.c-t.b*a):(i=r?r.x:-1e6,s=t.c-t.a*i,o=n?n.x:1e6,a=t.c-t.a*o);var u=[i,s],l=[o,a];e[t.region.l.index].push(u,l),e[t.region.r.index].push(u,l)})),e.map((function(e,r){var n=t[r][0],i=t[r][1];return e.forEach((function(t){t.angle=Math.atan2(t[0]-n,t[1]-i)})),e.sort((function(t,e){return t.angle-e.angle})).filter((function(t,r){return!r||t.angle-e[r-1].angle>1e-10}))}))};var mo={l:"r",r:"l"};d3.geom.delaunay=function(t){var e=t.map((function(){return[]})),r=[];return nn(t,(function(r){e[r.region.l.index].push(t[r.region.r.index])})),e.forEach((function(e,n){var i=t[n],o=i[0],s=i[1];e.forEach((function(t){t.angle=Math.atan2(t[0]-o,t[1]-s)})),e.sort((function(t,e){return t.angle-e.angle}));for(var a=0,u=e.length-1;a<u;a++)r.push([i,e[a],e[a+1]])})),r},d3.geom.quadtree=function(t,e,r,n,i){function o(t,e,r,n,i,o){if(!isNaN(e.x)&&!isNaN(e.y))if(t.leaf){var a=t.point;a?(Math.abs(a.x-e.x)+Math.abs(a.y-e.y)<.01||(t.point=null,s(t,a,r,n,i,o)),s(t,e,r,n,i,o)):t.point=e}else s(t,e,r,n,i,o)}function s(t,e,r,n,i,s){var a=.5*(r+i),u=.5*(n+s),l=e.x>=a,c=e.y>=u,h=(c<<1)+l;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]=on()),l?r=a:i=a,c?n=u:s=u,o(t,e,r,n,i,s)}var a,u=-1,l=t.length;if(l&&isNaN(t[0].x)&&(t=t.map(an)),arguments.length<5)if(3===arguments.length)i=n=r,r=e;else{e=r=1/0,n=i=-1/0;while(++u<l)a=t[u],a.x<e&&(e=a.x),a.y<r&&(r=a.y),a.x>n&&(n=a.x),a.y>i&&(i=a.y);var c=n-e,h=i-r;c>h?i=r+c:n=e+h}var d=on();return d.add=function(t){o(d,t,e,r,n,i)},d.visit=function(t){sn(t,d,e,r,n,i)},t.forEach(d.add),d},d3.time={};var go=Date,vo=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];un.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){yo.setUTCDate.apply(this._,arguments)},setDay:function(){yo.setUTCDay.apply(this._,arguments)},setFullYear:function(){yo.setUTCFullYear.apply(this._,arguments)},setHours:function(){yo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){yo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){yo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){yo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){yo.setUTCSeconds.apply(this._,arguments)},setTime:function(){yo.setTime.apply(this._,arguments)}};var yo=Date.prototype,wo="%a %b %e %H:%M:%S %Y",bo="%m/%d/%y",xo="%H:%M:%S",_o=vo,So=_o.map(ln),Mo=["January","February","March","April","May","June","July","August","September","October","November","December"],Eo=Mo.map(ln);d3.time.format=function(t){function e(e){var n,i,o=[],s=-1,a=0;while(++s<r)37==t.charCodeAt(s)&&(o.push(t.substring(a,s),(i=ko[n=t.charAt(++s)])?i(e):n),a=s+1);return o.push(t.substring(a,s)),o.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},n=cn(r,t,e,0);if(n!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=new go;return i.setFullYear(r.y,r.m,r.d),i.setHours(r.H,r.M,r.S,r.L),i},e.toString=function(){return t},e};var To=d3.format("02d"),Ao=d3.format("03d"),Po=d3.format("04d"),Co=d3.format("2d"),Ro=hn(_o),Lo=hn(So),Oo=hn(Mo),Io=dn(Mo),Do=hn(Eo),No=dn(Eo),ko={a:function(t){return So[t.getDay()]},A:function(t){return _o[t.getDay()]},b:function(t){return Eo[t.getMonth()]},B:function(t){return Mo[t.getMonth()]},c:d3.time.format(wo),d:function(t){return To(t.getDate())},e:function(t){return Co(t.getDate())},H:function(t){return To(t.getHours())},I:function(t){return To(t.getHours()%12||12)},j:function(t){return Ao(1+d3.time.dayOfYear(t))},L:function(t){return Ao(t.getMilliseconds())},m:function(t){return To(t.getMonth()+1)},M:function(t){return To(t.getMinutes())},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t){return To(t.getSeconds())},U:function(t){return To(d3.time.sundayOfYear(t))},w:function(t){return t.getDay()},W:function(t){return To(d3.time.mondayOfYear(t))},x:d3.time.format(bo),X:d3.time.format(xo),y:function(t){return To(t.getFullYear()%100)},Y:function(t){return Po(t.getFullYear()%1e4)},Z:Rn,"%":function(t){return"%"}},Fo={a:pn,A:fn,b:mn,B:gn,c:vn,d:Mn,e:Mn,H:En,I:En,L:Pn,m:Sn,M:Tn,p:Cn,S:An,x:yn,X:wn,y:xn,Y:bn},Vo=/^\s*\d+/,zo=d3.map({am:0,pm:1});d3.time.format.utc=function(t){function e(t){try{go=un;var e=new go;return e._=t,r(e)}finally{go=Date}}var r=d3.time.format(t);return e.parse=function(t){try{go=un;var e=r.parse(t);return e&&e._}finally{go=Date}},e.toString=r.toString,e};var Uo=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Ln:Uo,Ln.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Ln.toString=Uo.toString,d3.time.second=On((function(t){return new go(1e3*Math.floor(t/1e3))}),(function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))}),(function(t){return t.getSeconds()})),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=On((function(t){return new go(6e4*Math.floor(t/6e4))}),(function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))}),(function(t){return t.getMinutes()})),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=On((function(t){var e=t.getTimezoneOffset()/60;return new go(36e5*(Math.floor(t/36e5-e)+e))}),(function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))}),(function(t){return t.getHours()})),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=On((function(t){var e=new go(1970,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t){return t.getDate()-1})),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(t){var e=d3.time.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},vo.forEach((function(t,e){t=t.toLowerCase(),e=7-e;var r=d3.time[t]=On((function(t){return(t=d3.time.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t}),(function(t,e){t.setDate(t.getDate()+7*Math.floor(e))}),(function(t){var r=d3.time.year(t).getDay();return Math.floor((d3.time.dayOfYear(t)+(r+e)%7)/7)-(r!==e)}));d3.time[t+"s"]=r.range,d3.time[t+"s"].utc=r.utc.range,d3.time[t+"OfYear"]=function(t){var r=d3.time.year(t).getDay();return Math.floor((d3.time.dayOfYear(t)+(r+e)%7)/7)}})),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=On((function(t){return t=d3.time.day(t),t.setDate(1),t}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t){return t.getMonth()})),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=On((function(t){return t=d3.time.day(t),t.setMonth(0,1),t}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t){return t.getFullYear()})),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var jo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Bo=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Ho=[[d3.time.format("%Y"),function(t){return!0}],[d3.time.format("%B"),function(t){return t.getMonth()}],[d3.time.format("%b %d"),function(t){return 1!=t.getDate()}],[d3.time.format("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[d3.time.format("%I %p"),function(t){return t.getHours()}],[d3.time.format("%I:%M"),function(t){return t.getMinutes()}],[d3.time.format(":%S"),function(t){return t.getSeconds()}],[d3.time.format(".%L"),function(t){return t.getMilliseconds()}]],Go=d3.scale.linear(),qo=Fn(Ho);Bo.year=function(t,e){return Go.domain(t.map(zn)).ticks(e).map(Vn)},d3.time.scale=function(){return Dn(d3.scale.linear(),Bo,qo)};var Wo=Bo.map((function(t){return[t[0].utc,t[1]]})),$o=[[d3.time.format.utc("%Y"),function(t){return!0}],[d3.time.format.utc("%B"),function(t){return t.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(t){return 1!=t.getUTCDate()}],[d3.time.format.utc("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[d3.time.format.utc("%I %p"),function(t){return t.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(t){return t.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(t){return t.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(t){return t.getUTCMilliseconds()}]],Xo=Fn($o);Wo.year=function(t,e){return Go.domain(t.map(jn)).ticks(e).map(Un)},d3.time.scale.utc=function(){return Dn(d3.scale.linear(),Wo,Xo)}})()},e8c2:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.level,o=t.dataLevel,s=t.schema[e],a=t.schemaPath+t.util.getProperty(e),u=t.errSchemaPath+"/"+e,l=!t.opts.allErrors,c="data"+(o||""),h="valid"+i,d=t.opts.$data&&s&&s.$data;d&&(n+=" var schema"+i+" = "+t.util.getData(s.$data,o,t.dataPathArr)+"; ");var p="i"+i,f="schema"+i;d||(n+=" var "+f+" = validate.schema"+a+";"),n+="var "+h+";",d&&(n+=" if (schema"+i+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+i+")) "+h+" = false; else {"),n+=h+" = false;for (var "+p+"=0; "+p+"<"+f+".length; "+p+"++) if (equal("+c+", "+f+"["+p+"])) { "+h+" = true; break; }",d&&(n+="  }  "),n+=" if (!"+h+") {   ";var m=m||[];m.push(n),n="",!1!==t.createErrors?(n+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+t.errorPath+" , schemaPath: "+t.util.toQuotedString(u)+" , params: { allowedValues: schema"+i+" } ",!1!==t.opts.messages&&(n+=" , message: 'should be equal to one of the allowed values' "),t.opts.verbose&&(n+=" , schema: validate.schema"+a+" , parentSchema: validate.schema"+t.schemaPath+" , data: "+c+" "),n+=" } "):n+=" {} ";var g=n;return n=m.pop(),!t.compositeRule&&l?t.async?n+=" throw new ValidationError(["+g+"]); ":n+=" validate.errors = ["+g+"]; return false; ":n+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",n+=" }",l&&(n+=" else { "),n}},e91a:function(t,e,r){e.UI={Region:r("4a75"),Cursor:r("d4c2")}},e91f:function(t,e,r){"use strict";var n=r("ebb5"),i=r("4d64").indexOf,o=n.aTypedArray,s=n.exportTypedArrayMethod;s("indexOf",(function(t){return i(o(this),t,arguments.length>1?arguments[1]:void 0)}))},ea07:function(t,e,r){"use strict";t.exports=function(t,e,r){var n=" ",i=t.schema[e],o=t.schemaPath+t.util.getProperty(e),s=t.errSchemaPath+"/"+e,a=!t.opts.allErrors,u=t.util.copy(t),l="";u.level++;var c="valid"+u.level,h=u.baseId,d=!0,p=i;if(p){var f,m=-1,g=p.length-1;while(m<g)f=p[m+=1],(t.opts.strictKeywords?"object"==typeof f&&Object.keys(f).length>0:t.util.schemaHasRules(f,t.RULES.all))&&(d=!1,u.schema=f,u.schemaPath=o+"["+m+"]",u.errSchemaPath=s+"/"+m,n+="  "+t.validate(u)+" ",u.baseId=h,a&&(n+=" if ("+c+") { ",l+="}"))}return a&&(n+=d?" if (true) { ":" "+l.slice(0,-1)+" "),n}},ea9c:function(t,e,r){"use strict";var n=t.exports=function(){this._cache={}};n.prototype.put=function(t,e){this._cache[t]=e},n.prototype.get=function(t){return this._cache[t]},n.prototype.del=function(t){delete this._cache[t]},n.prototype.clear=function(){this._cache={}}},ebb5:function(t,e,r){"use strict";var n,i=r("a981"),o=r("83ab"),s=r("da84"),a=r("861d"),u=r("5135"),l=r("f5df"),c=r("9112"),h=r("6eeb"),d=r("9bf2").f,p=r("e163"),f=r("d2bb"),m=r("b622"),g=r("90e3"),v=s.Int8Array,y=v&&v.prototype,w=s.Uint8ClampedArray,b=w&&w.prototype,x=v&&p(v),_=y&&p(y),S=Object.prototype,M=S.isPrototypeOf,E=m("toStringTag"),T=g("TYPED_ARRAY_TAG"),A=i&&!!f&&"Opera"!==l(s.opera),P=!1,C={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},R=function(t){var e=l(t);return"DataView"===e||u(C,e)},L=function(t){return a(t)&&u(C,l(t))},O=function(t){if(L(t))return t;throw TypeError("Target is not a typed array")},I=function(t){if(f){if(M.call(x,t))return t}else for(var e in C)if(u(C,n)){var r=s[e];if(r&&(t===r||M.call(r,t)))return t}throw TypeError("Target is not a typed array constructor")},D=function(t,e,r){if(o){if(r)for(var n in C){var i=s[n];i&&u(i.prototype,t)&&delete i.prototype[t]}_[t]&&!r||h(_,t,r?e:A&&y[t]||e)}},N=function(t,e,r){var n,i;if(o){if(f){if(r)for(n in C)i=s[n],i&&u(i,t)&&delete i[t];if(x[t]&&!r)return;try{return h(x,t,r?e:A&&v[t]||e)}catch(a){}}for(n in C)i=s[n],!i||i[t]&&!r||h(i,t,e)}};for(n in C)s[n]||(A=!1);if((!A||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},A))for(n in C)s[n]&&f(s[n],x);if((!A||!_||_===S)&&(_=x.prototype,A))for(n in C)s[n]&&f(s[n].prototype,_);if(A&&p(b)!==_&&f(b,_),o&&!u(_,E))for(n in P=!0,d(_,E,{get:function(){return a(this)?this[T]:void 0}}),C)s[n]&&c(s[n],T,n);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:A,TYPED_ARRAY_TAG:P&&T,aTypedArray:O,aTypedArrayConstructor:I,exportTypedArrayMethod:D,exportTypedArrayStaticMethod:N,isView:R,isTypedArray:L,TypedArray:x,TypedArrayPrototype:_}},f21a:function(t,e,r){},f71e:function(t,e,r){"use strict";t.exports=function(t,e){e||(e={}),"function"===typeof e&&(e={cmp:e});var r="boolean"===typeof e.cycles&&e.cycles,n=e.cmp&&function(t){return function(e){return function(r,n){var i={key:r,value:e[r]},o={key:n,value:e[n]};return t(i,o)}}}(e.cmp),i=[];return function t(e){if(e&&e.toJSON&&"function"===typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!==typeof e)return JSON.stringify(e);var o,s;if(Array.isArray(e)){for(s="[",o=0;o<e.length;o++)o&&(s+=","),s+=t(e[o])||"null";return s+"]"}if(null===e)return"null";if(-1!==i.indexOf(e)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var a=i.push(e)-1,u=Object.keys(e).sort(n&&n(e));for(s="",o=0;o<u.length;o++){var l=u[o],c=t(e[l]);c&&(s&&(s+=","),s+=JSON.stringify(l)+":"+c)}return i.splice(a,1),"{"+s+"}"}}(t)}},f8cd:function(t,e,r){var n=r("a691");t.exports=function(t){var e=n(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}},faa1:function(t,e,r){"use strict";var n,i="object"===typeof Reflect?Reflect:null,o=i&&"function"===typeof i.apply?i.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};function s(t){console&&console.warn&&console.warn(t)}n=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var a=Number.isNaN||function(t){return t!==t};function u(){u.init.call(this)}t.exports=u,t.exports.once=b,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var l=10;function c(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?u.defaultMaxListeners:t._maxListeners}function d(t,e,r,n){var i,o,a;if(c(r),o=t._events,void 0===o?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),a=o[e]),void 0===a)a=o[e]=r,++t._eventsCount;else if("function"===typeof a?a=o[e]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),i=h(t),i>0&&a.length>i&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,s(u)}return t}function p(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=p.bind(n);return i.listener=r,n.wrapFn=i,i}function m(t,e,r){var n=t._events;if(void 0===n)return[];var i=n[e];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?w(i):v(i,i.length)}function g(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function v(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function y(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function w(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function b(t,e){return new Promise((function(r,n){function i(){void 0!==o&&t.removeListener("error",o),r([].slice.call(arguments))}var o;"error"!==e&&(o=function(r){t.removeListener(e,i),n(r)},t.once("error",o)),t.once(e,i)}))}Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(t){if("number"!==typeof t||t<0||a(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");l=t}}),u.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||a(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},u.prototype.getMaxListeners=function(){return h(this)},u.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(e.length>0&&(s=e[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[t];if(void 0===u)return!1;if("function"===typeof u)o(u,this,e);else{var l=u.length,c=v(u,l);for(r=0;r<l;++r)o(c[r],this,e)}return!0},u.prototype.addListener=function(t,e){return d(this,t,e,!1)},u.prototype.on=u.prototype.addListener,u.prototype.prependListener=function(t,e){return d(this,t,e,!0)},u.prototype.once=function(t,e){return c(e),this.on(t,f(this,t,e)),this},u.prototype.prependOnceListener=function(t,e){return c(e),this.prependListener(t,f(this,t,e)),this},u.prototype.removeListener=function(t,e){var r,n,i,o,s;if(c(e),n=this._events,void 0===n)return this;if(r=n[t],void 0===r)return this;if(r===e||r.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!==typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===e||r[o].listener===e){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():y(r,i),1===r.length&&(n[t]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",t,s||e)}return this},u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=function(t){var e,r,n;if(r=this._events,void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)i=o[n],"removeListener"!==i&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],"function"===typeof e)this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},u.prototype.listeners=function(t){return m(this,t,!0)},u.prototype.rawListeners=function(t){return m(this,t,!1)},u.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):g.call(t,e)},u.prototype.listenerCount=g,u.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},fb2c:function(t,e,r){var n=r("74e8");n("Uint32",(function(t){return function(e,r,n){return t(this,e,r,n)}}))},fbda:function(t,e,r){"use strict";function n(t,e){for(var r in e=e||{},t)e[r]=t[r];return e}function i(t,e,r,n){var i=n?" !== ":" === ",o=n?" || ":" && ",s=n?"!":"",a=n?"":"!";switch(t){case"null":return e+i+"null";case"array":return s+"Array.isArray("+e+")";case"object":return"("+s+e+o+"typeof "+e+i+'"object"'+o+a+"Array.isArray("+e+"))";case"integer":return"(typeof "+e+i+'"number"'+o+a+"("+e+" % 1)"+o+e+i+e+(r?o+s+"isFinite("+e+")":"")+")";case"number":return"(typeof "+e+i+'"'+t+'"'+(r?o+s+"isFinite("+e+")":"")+")";default:return"typeof "+e+i+'"'+t+'"'}}function o(t,e,r){switch(t.length){case 1:return i(t[0],e,r,!0);default:var n="",o=u(t);for(var s in o.array&&o.object&&(n=o.null?"(":"(!"+e+" || ",n+="typeof "+e+' !== "object")',delete o.null,delete o.array,delete o.object),o.number&&delete o.integer,o)n+=(n?" && ":"")+i(s,e,r,!0);return n}}t.exports={copy:n,checkDataType:i,checkDataTypes:o,coerceToTypes:a,toHash:u,getProperty:h,escapeQuotes:d,equal:r("694b"),ucs2length:r("775e"),varOccurences:p,varReplace:f,schemaHasRules:m,schemaHasRulesExcept:g,schemaUnknownRules:v,toQuotedString:y,getPathExpr:w,getPath:b,getData:S,unescapeFragment:E,unescapeJsonPointer:P,escapeFragment:T,escapeJsonPointer:A};var s=u(["string","number","integer","boolean","null"]);function a(t,e){if(Array.isArray(e)){for(var r=[],n=0;n<e.length;n++){var i=e[n];(s[i]||"array"===t&&"array"===i)&&(r[r.length]=i)}if(r.length)return r}else{if(s[e])return[e];if("array"===t&&"array"===e)return["array"]}}function u(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=!0;return e}var l=/^[a-z$_][a-z$_0-9]*$/i,c=/'|\\/g;function h(t){return"number"==typeof t?"["+t+"]":l.test(t)?"."+t:"['"+d(t)+"']"}function d(t){return t.replace(c,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}function p(t,e){e+="[^0-9]";var r=t.match(new RegExp(e,"g"));return r?r.length:0}function f(t,e,r){return e+="([^0-9])",r=r.replace(/\$/g,"$$$$"),t.replace(new RegExp(e,"g"),r+"$1")}function m(t,e){if("boolean"==typeof t)return!t;for(var r in t)if(e[r])return!0}function g(t,e,r){if("boolean"==typeof t)return!t&&"not"!=r;for(var n in t)if(n!=r&&e[n])return!0}function v(t,e){if("boolean"!=typeof t)for(var r in t)if(!e[r])return r}function y(t){return"'"+d(t)+"'"}function w(t,e,r,n){var i=r?"'/' + "+e+(n?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):n?"'[' + "+e+" + ']'":"'[\\'' + "+e+" + '\\']'";return M(t,i)}function b(t,e,r){var n=y(r?"/"+A(e):h(e));return M(t,n)}var x=/^\/(?:[^~]|~0|~1)*$/,_=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function S(t,e,r){var n,i,o,s;if(""===t)return"rootData";if("/"==t[0]){if(!x.test(t))throw new Error("Invalid JSON-pointer: "+t);i=t,o="rootData"}else{if(s=t.match(_),!s)throw new Error("Invalid JSON-pointer: "+t);if(n=+s[1],i=s[2],"#"==i){if(n>=e)throw new Error("Cannot access property/index "+n+" levels up, current level is "+e);return r[e-n]}if(n>e)throw new Error("Cannot access data "+n+" levels up, current level is "+e);if(o="data"+(e-n||""),!i)return o}for(var a=o,u=i.split("/"),l=0;l<u.length;l++){var c=u[l];c&&(o+=h(P(c)),a+=" && "+o)}return a}function M(t,e){return'""'==t?e:(t+" + "+e).replace(/([^\\])' \+ '/g,"$1")}function E(t){return P(decodeURIComponent(t))}function T(t){return encodeURIComponent(A(t))}function A(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}function P(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}},fff2:function(t,e,r){"use strict";var n=/^[a-z_$][a-z0-9_$-]*$/i,i=r("7236"),o=r("7976");function s(t,e){var r=this.RULES;if(r.keywords[t])throw new Error("Keyword "+t+" is already defined");if(!n.test(t))throw new Error("Keyword "+t+" is not a valid identifier");if(e){this.validateKeyword(e,!0);var o=e.type;if(Array.isArray(o))for(var s=0;s<o.length;s++)u(t,o[s],e);else u(t,o,e);var a=e.metaSchema;a&&(e.$data&&this._opts.$data&&(a={anyOf:[a,{$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"}]}),e.validateSchema=this.compile(a,!0))}function u(t,e,n){for(var o,s=0;s<r.length;s++){var a=r[s];if(a.type==e){o=a;break}}o||(o={type:e,rules:[]},r.push(o));var u={keyword:t,definition:n,custom:!0,code:i,implements:n.implements};o.rules.push(u),r.custom[t]=u}return r.keywords[t]=r.all[t]=!0,this}function a(t){var e=this.RULES.custom[t];return e?e.definition:this.RULES.keywords[t]||!1}function u(t){var e=this.RULES;delete e.keywords[t],delete e.all[t],delete e.custom[t];for(var r=0;r<e.length;r++)for(var n=e[r].rules,i=0;i<n.length;i++)if(n[i].keyword==t){n.splice(i,1);break}return this}function l(t,e){l.errors=null;var r=this._validateKeyword=this._validateKeyword||this.compile(o,!0);if(r(t))return!0;if(l.errors=r.errors,e)throw new Error("custom keyword definition is invalid: "+this.errorsText(r.errors));return!1}t.exports={add:s,get:a,remove:u,validate:l}}}]);
//# sourceMappingURL=vendor~wrapper.69274221.js.map